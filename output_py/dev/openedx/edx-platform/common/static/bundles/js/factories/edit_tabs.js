(function(e, a) { for(var i in a) e[i] = a[i]; }(window, webpackJsonp([9,61],{

/***/ "./cms/djangoapps/pipeline_js/js/xmodule.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// This file is designed to load all the XModule Javascript files in one wad
// using requirejs. It is passed through the Mako template system, which
// populates the `urls` variable with a list of paths to XModule JS files.
// These files assume that several libraries are available and bound to
// variables in the global context, so we load those libraries with requirejs
// and attach them to the global context manually.
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/js/vendor/codemirror-compressed.js"), __webpack_require__("./common/static/js/vendor/tinymce/js/tinymce/tinymce.js"), __webpack_require__("./node_modules/scriptjs/dist/script.js"), __webpack_require__("./common/static/js/vendor/tinymce/js/tinymce/jquery.tinymce.min.js"), __webpack_require__("./common/static/js/vendor/jquery.qtip.min.js"), __webpack_require__("./common/static/common/js/vendor/jquery.scrollTo.js"), __webpack_require__("./common/static/js/vendor/flot/jquery.flot.min.js"), __webpack_require__("./common/static/js/vendor/jquery.cookie.js"), __webpack_require__("./common/static/js/src/utility.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, CodeMirror, tinymce, $script) {
  'use strict';

  window.$ = $;
  window._ = _;
  $script('https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js' + '?config=TeX-MML-AM_SVG&delayStartupUntil=configured', 'mathjax', function () {
    window.MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['\\(', '\\)'], ['[mathjaxinline]', '[/mathjaxinline]']],
        displayMath: [['\\[', '\\]'], ['[mathjax]', '[/mathjax]']]
      }
    }); // In order to eliminate all flashing during interactive
    // preview, it is necessary to set processSectionDelay to 0
    // (remove delay between input and output phases). This
    // effectively disables fast preview, regardless of
    // the fast preview setting as shown in the context menu.

    window.MathJax.Hub.processSectionDelay = 0;
    window.MathJax.Hub.Configured();
  });
  window.CodeMirror = CodeMirror;
  window.RequireJS = {
    requirejs: {},
    // This is never used by current xmodules
    require: $script,
    // $script([deps], callback) acts approximately like the require function
    define: __webpack_require__("./node_modules/webpack/buildin/amd-define.js")
  };
  /**
   * Loads all modules one-by-one in exact order.
   * The module should be used until we'll use RequireJS for XModules.
   * @param {Array} modules A list of urls.
   * @return {jQuery Promise}
   **/

  function requireQueue(modules) {
    var deferred = $.Deferred();

    function loadScript(queue) {
      $script.ready('mathjax', function () {
        // Loads the next script if queue is not empty.
        if (queue.length) {
          $script([queue.shift()], function () {
            loadScript(queue);
          });
        } else {
          deferred.resolve();
        }
      });
    }

    loadScript(modules.concat());
    return deferred.promise();
  } // if (!window.xmoduleUrls) {
  //     throw Error('window.xmoduleUrls must be defined');
  // }


  return requireQueue([]);
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/cms/js/main.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(AjaxPrefix, jQuery) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* globals AjaxPrefix */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__("./common/static/js/vendor/domReady.js"), __webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/common/js/vendor/underscore.string.js"), __webpack_require__(2), __webpack_require__(3), __webpack_require__("./common/static/common/js/components/views/feedback_notification.js"), __webpack_require__("./common/static/js/src/ajax_prefix.js"), __webpack_require__("./common/static/js/src/ajax_prefix.js"), __webpack_require__("./common/static/js/vendor/jquery.cookie.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (domReady, $, _, str, Backbone, gettext, NotificationView) {
  'use strict';

  var main, sendJSON;

  main = function main() {
    AjaxPrefix.addAjaxPrefix(jQuery, function () {
      return $("meta[name='path_prefix']").attr('content');
    });
    window.CMS = window.CMS || {};
    window.CMS.URL = window.CMS.URL || {};

    window.onTouchBasedDevice = function () {
      return navigator.userAgent.match(/iPhone|iPod|iPad|Android/i);
    };

    _.extend(window.CMS, Backbone.Events);

    Backbone.emulateHTTP = true;
    $.ajaxSetup({
      headers: {
        'X-CSRFToken': $.cookie('csrftoken')
      },
      dataType: 'json',
      content: {
        script: false
      }
    });
    $(document).ajaxError(function (event, jqXHR, ajaxSettings) {
      var msg,
          contentType,
          message = gettext('This may be happening because of an error with our server or your internet connection. Try refreshing the page or making sure you are online.'); // eslint-disable-line max-len

      if (ajaxSettings.notifyOnError === false) {
        return;
      }

      contentType = jqXHR.getResponseHeader('content-type');

      if (contentType && contentType.indexOf('json') > -1 && jqXHR.responseText) {
        message = JSON.parse(jqXHR.responseText).error;
      }

      msg = new NotificationView.Error({
        title: gettext("Studio's having trouble saving your work"),
        message: message
      });
      console.log('Studio AJAX Error', {
        // eslint-disable-line no-console
        url: event.currentTarget.URL,
        response: jqXHR.responseText,
        status: jqXHR.status
      });
      return msg.show();
    });

    sendJSON = function sendJSON(url, data, callback, type) {
      // eslint-disable-line no-param-reassign
      if ($.isFunction(data)) {
        callback = data;
        data = undefined;
      }

      return $.ajax({
        url: url,
        type: type,
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        data: JSON.stringify(data),
        success: callback,
        global: data ? data.global : true // Trigger global AJAX error handler or not

      });
    };

    $.postJSON = function (url, data, callback) {
      // eslint-disable-line no-param-reassign
      return sendJSON(url, data, callback, 'POST');
    };

    $.patchJSON = function (url, data, callback) {
      // eslint-disable-line no-param-reassign
      return sendJSON(url, data, callback, 'PATCH');
    };

    return domReady(function () {
      if (window.onTouchBasedDevice()) {
        return $('body').addClass('touch-based-device');
      }

      return null;
    });
  };

  main();
  return main;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__("./common/static/js/src/ajax_prefix.js"), __webpack_require__(0)))

/***/ }),

/***/ "./cms/static/cms/js/xblock/cms.runtime.v1.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(_) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(2), __webpack_require__("./common/static/common/js/xblock/runtime.v1.js"), __webpack_require__(6), __webpack_require__(3), __webpack_require__("./cms/static/js/utils/modal.js"), __webpack_require__("./common/static/common/js/components/views/feedback_notification.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, Backbone, XBlock, URI, gettext, ModalUtils, NotificationView) {
  'use strict';

  var __hasProp = {}.hasOwnProperty,
      __extends = function __extends(child, parent) {
    var key;

    for (key in parent) {
      if (__hasProp.call(parent, key)) {
        child[key] = parent[key];
      }
    }

    function Ctor() {
      this.constructor = child;
    }

    Ctor.prototype = parent.prototype;
    child.prototype = new Ctor();
    child.__super__ = parent.prototype;
    return child;
  },
      BaseRuntime = {},
      PreviewRuntime = {},
      StudioRuntime = {};

  BaseRuntime.v1 = function (_super) {
    __extends(v1, _super);

    v1.prototype.handlerUrl = function (element, handlerName, suffix, query) {
      var uri;
      uri = URI(this.handlerPrefix).segment($(element).data('usage-id')).segment('handler').segment(handlerName);

      if (suffix !== null) {
        uri.segment(suffix);
      }

      if (query !== null) {
        uri.search(query);
      }

      return uri.toString();
    };

    function v1() {
      v1.__super__.constructor.call(this);

      this.dispatcher = _.clone(Backbone.Events);
      this.listenTo('save', this._handleSave);
      this.listenTo('cancel', this._handleCancel);
      this.listenTo('error', this._handleError);
      this.listenTo('modal-shown', function (data) {
        this.modal = data;
      });
      this.listenTo('modal-hidden', function () {
        this.modal = null;
      });
      this.listenTo('page-shown', function (data) {
        this.page = data;
      });
    }
    /**
     * Notify the Studio client-side runtime of an event so that it
     * can update the UI in a consistent way.
     *
     * @param {string} name The name of the event.
     * @param {object} data A JSON representation of the data to be included with the event.
     */


    v1.prototype.notify = function (name, data) {
      this.dispatcher.trigger(name, data);
    };
    /**
     * Listen to a Studio event and invoke the specified callback when it is triggered.
     *
     * @param {string} name The name of the event.
     * @param {function} callback The callback to be invoked.
     */


    v1.prototype.listenTo = function (name, callback) {
      this.dispatcher.bind(name, callback, this);
    };
    /**
     * Refresh the view for the xblock represented by the specified element.
     *
     * @param {element} element The element representing the XBlock.
     */


    v1.prototype.refreshXBlock = function (element) {
      if (this.page) {
        this.page.refreshXBlock(element);
      }
    };

    v1.prototype._handleError = function (data) {
      var message, title;
      message = data.message || data.msg;

      if (message) {
        // TODO: remove 'Open Assessment' specific default title
        title = data.title || gettext('OpenAssessment Save Error');
        this.alert = new NotificationView.Error({
          title: title,
          message: message,
          closeIcon: false,
          shown: false
        });
        this.alert.show();
      }
    };

    v1.prototype._handleSave = function (data) {
      var message; // Starting to save, so show a notification

      if (data.state === 'start') {
        message = data.message || gettext('Saving');
        this.notification = new NotificationView.Mini({
          title: message
        });
        this.notification.show();
      } else if (data.state === 'end') {
        // Finished saving, so hide the notification and refresh appropriately
        this._hideAlerts();

        if (this.modal && this.modal.onSave) {
          // Notify the modal that the save has completed so that it can hide itself
          // and then refresh the xblock.
          this.modal.onSave();
        } else if (data.element) {
          // ... else ask it to refresh the newly saved xblock
          this.refreshXBlock(data.element);
        }

        this.notification.hide();
      }
    };

    v1.prototype._handleCancel = function () {
      this._hideAlerts();

      if (this.modal) {
        this.modal.cancel();
        this.notify('modal-hidden');
      }
    };
    /**
     * Hide any alerts that are being shown.
     */


    v1.prototype._hideAlerts = function () {
      if (this.alert && this.alert.options.shown) {
        this.alert.hide();
      }
    };

    return v1;
  }(XBlock.Runtime.v1);

  PreviewRuntime.v1 = function (_super) {
    __extends(v1, _super);

    function v1() {
      return v1.__super__.constructor.apply(this, arguments);
    }

    v1.prototype.handlerPrefix = '/preview/xblock';
    return v1;
  }(BaseRuntime.v1);

  StudioRuntime.v1 = function (_super) {
    __extends(v1, _super);

    function v1() {
      return v1.__super__.constructor.apply(this, arguments);
    }

    v1.prototype.handlerPrefix = '/xblock';
    return v1;
  }(BaseRuntime.v1); // Install the runtime's into the global namespace


  window.BaseRuntime = BaseRuntime;
  window.PreviewRuntime = PreviewRuntime;
  window.StudioRuntime = StudioRuntime;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(1)))

/***/ }),

/***/ "./cms/static/js/base.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__("./common/static/js/vendor/domReady.js"), __webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./common/static/common/js/components/views/feedback_notification.js"), __webpack_require__("./common/static/common/js/components/views/feedback_prompt.js"), __webpack_require__("./cms/static/js/utils/date_utils.js"), __webpack_require__("./cms/static/js/utils/module.js"), __webpack_require__("./cms/static/js/utils/handle_iframe_binding.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/dropdown-menu/dropdown-menu-view.js"), __webpack_require__("./common/static/js/vendor/jquery-ui.min.js"), __webpack_require__("./common/static/js/vendor/jquery.leanModal.js"), __webpack_require__("./common/static/js/vendor/jquery.form.js"), __webpack_require__("./common/static/js/vendor/jquery.smooth-scroll.min.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (domReady, $, _, gettext, NotificationView, PromptView, DateUtils, ModuleUtils, IframeUtils, DropdownMenuView) {
  'use strict';

  var $body;

  function smoothScrollLink(e) {
    e.preventDefault();
    $.smoothScroll({
      offset: -200,
      easing: 'swing',
      speed: 1000,
      scrollElement: null,
      scrollTarget: $(this).attr('href')
    });
  }

  function hideNotification(e) {
    e.preventDefault();
    $(this).closest('.wrapper-notification').removeClass('is-shown').addClass('is-hiding').attr('aria-hidden', 'true');
  }

  function hideAlert(e) {
    e.preventDefault();
    $(this).closest('.wrapper-alert').removeClass('is-shown');
  }

  domReady(function () {
    var dropdownMenuView;
    $body = $('body');
    $body.on('click', '.embeddable-xml-input', function () {
      $(this).select();
    });
    $body.addClass('js'); // alerts/notifications - manual close

    $('.action-alert-close, .alert.has-actions .nav-actions a').bind('click', hideAlert);
    $('.action-notification-close').bind('click', hideNotification); // nav - dropdown related

    $body.click(function () {
      $('.nav-dd .nav-item .wrapper-nav-sub').removeClass('is-shown');
      $('.nav-dd .nav-item .title').removeClass('is-selected');
    });
    $('.nav-dd .nav-item, .filterable-column .nav-item').click(function (e) {
      var $subnav = $(this).find('.wrapper-nav-sub'),
          $title = $(this).find('.title');

      if ($subnav.hasClass('is-shown')) {
        $subnav.removeClass('is-shown');
        $title.removeClass('is-selected');
      } else {
        $('.nav-dd .nav-item .title').removeClass('is-selected');
        $('.nav-dd .nav-item .wrapper-nav-sub').removeClass('is-shown');
        $title.addClass('is-selected');
        $subnav.addClass('is-shown'); // if propagation is not stopped, the event will bubble up to the
        // body element, which will close the dropdown.

        e.stopPropagation();
      }
    }); // general link management - new window/tab

    $('a[rel="external"]:not([title])').attr('title', gettext('This link will open in a new browser window/tab'));
    $('a[rel="external"]').attr({
      rel: 'noopener external',
      target: '_blank'
    }); // general link management - lean modal window

    $('a[rel="modal"]').attr('title', gettext('This link will open in a modal window')).leanModal({
      overlay: 0.50,
      closeButton: '.action-modal-close'
    });
    $('.action-modal-close').click(function (e) {
      e.preventDefault();
    }); // general link management - smooth scrolling page links

    $('a[rel*="view"][href^="#"]').bind('click', smoothScrollLink);
    IframeUtils.iframeBinding(); // disable ajax caching in IE so that backbone fetches work

    if ($.browser.msie) {
      $.ajaxSetup({
        cache: false
      });
    } // Initiate the edx tool kit dropdown menu


    if ($('.js-header-user-menu').length) {
      dropdownMenuView = new DropdownMenuView({
        el: '.js-header-user-menu'
      });
      dropdownMenuView.postRender();
    }

    window.studioNavMenuActive = true;
  });
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end require()

/***/ }),

/***/ "./cms/static/js/collections/metadata.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__("./cms/static/js/models/metadata.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, MetadataModel) {
  var MetadataCollection = Backbone.Collection.extend({
    model: MetadataModel,
    comparator: 'display_name'
  });
  return MetadataCollection;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/factories/base.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// We can't convert this to an es6 module until all factories that use it have been converted out
// of RequireJS
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__("./cms/static/js/base.js"), __webpack_require__("./cms/static/cms/js/main.js"), __webpack_require__("./common/static/js/src/logger.js"), __webpack_require__("./common/static/js/vendor/timepicker/datepair.js"), __webpack_require__("./common/static/js/src/accessibility_tools.js"), __webpack_require__("./common/static/js/src/ie_shim.js"), __webpack_require__("./common/static/js/src/tooltip_manager.js"), __webpack_require__("./common/static/js/src/lang_edx.js"), __webpack_require__("./cms/static/js/models/course.js"), __webpack_require__("./common/static/js/src/jquery_extend_patch.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function () {
  'use strict';
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/factories/edit_tabs.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (immutable) */ __webpack_exports__["default"] = EditTabsFactory;
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditTabsFactory", function() { return EditTabsFactory; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_js_models_explicit_url__ = __webpack_require__("./cms/static/js/models/explicit_url.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_js_models_explicit_url___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_js_models_explicit_url__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_js_views_tabs__ = __webpack_require__("./cms/static/js/views/tabs.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_js_views_tabs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_js_views_tabs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_xmodule__ = __webpack_require__("./cms/djangoapps/pipeline_js/js/xmodule.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_xmodule___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_xmodule__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__base__ = __webpack_require__("./cms/static/js/factories/base.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__base___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__base__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_cms_js_main__ = __webpack_require__("./cms/static/cms/js/main.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_cms_js_main___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_cms_js_main__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_xblock_cms_runtime_v1__ = __webpack_require__("./cms/static/cms/js/xblock/cms.runtime.v1.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_xblock_cms_runtime_v1___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_xblock_cms_runtime_v1__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_xmodule_js_src_xmodule__ = __webpack_require__("./xmodule/js/src/xmodule.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_xmodule_js_src_xmodule___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_xmodule_js_src_xmodule__);






 // Force the XBlockToXModuleShim to load for Static Tabs

'use strict';

function EditTabsFactory(courseLocation, explicitUrl) {
  __WEBPACK_IMPORTED_MODULE_2_xmodule__["done"](function () {
    var model = new __WEBPACK_IMPORTED_MODULE_0_js_models_explicit_url__({
      id: courseLocation,
      explicit_url: explicitUrl
    }),
        editView;
    editView = new __WEBPACK_IMPORTED_MODULE_1_js_views_tabs__({
      el: $('.tab-list'),
      model: model,
      mast: $('.wrapper-mast')
    });
  });
}
;

/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(0)))

/***/ }),

/***/ "./cms/static/js/models/course.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2)], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone) {
  var Course = Backbone.Model.extend({
    defaults: {
      name: ''
    },
    validate: function validate(attrs, options) {
      if (!attrs.name) {
        return gettext('You must specify a name');
      }
    }
  });
  return Course;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/models/explicit_url.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * A model that simply allows the update URL to be passed
 * in as an argument.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2)], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone) {
  return Backbone.Model.extend({
    defaults: {
      explicit_url: ''
    },
    url: function url() {
      return this.get('explicit_url');
    }
  });
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/models/license.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, _) {
  var LicenseModel = Backbone.Model.extend({
    defaults: {
      type: null,
      options: {},
      custom: false // either `false`, or a string

    },
    initialize: function initialize(attributes) {
      if (attributes && attributes.asString) {
        this.setFromString(attributes.asString);
        this.unset('asString');
      }
    },
    toString: function toString() {
      var custom = this.get('custom');

      if (custom) {
        return custom;
      }

      var type = this.get('type'),
          options = this.get('options');

      if (_.isEmpty(options)) {
        return type || '';
      } // options are where it gets tricky


      var optionStrings = _.map(options, function (value, key) {
        if (_.isBoolean(value)) {
          return value ? key : null;
        } else {
          return key + '=' + value;
        }
      }); // filter out nulls


      optionStrings = _.filter(optionStrings, _.identity); // build license string and return

      return type + ': ' + optionStrings.join(' ');
    },
    setFromString: function setFromString(string, options) {
      if (!string) {
        // reset to defaults
        return this.set(this.defaults, options);
      }

      var colonIndex = string.indexOf(':'),
          spaceIndex = string.indexOf(' '); // a string without a colon could be a custom license, or a license
      // type without options

      if (colonIndex == -1) {
        if (spaceIndex == -1) {
          // if there's no space, it's a license type without options
          return this.set({
            type: string,
            options: {},
            custom: false
          }, options);
        } else {
          // if there is a space, it's a custom license
          return this.set({
            type: null,
            options: {},
            custom: string
          }, options);
        }
      } // there is a colon, which indicates a license type with options.


      var type = string.substring(0, colonIndex),
          optionsObj = {},
          optionsString = string.substring(colonIndex + 1);

      _.each(optionsString.split(' '), function (optionString) {
        if (_.isEmpty(optionString)) {
          return;
        }

        var eqIndex = optionString.indexOf('=');

        if (eqIndex == -1) {
          // this is a boolean flag
          optionsObj[optionString] = true;
        } else {
          // this is a key-value pair
          var optionKey = optionString.substring(0, eqIndex);
          var optionVal = optionString.substring(eqIndex + 1);
          optionsObj[optionKey] = optionVal;
        }
      });

      return this.set({
        type: type,
        options: optionsObj,
        custom: false
      }, options);
    }
  });
  return LicenseModel;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/models/metadata.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2)], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone) {
  /**
   * Model used for metadata setting editors. This model does not do its own saving,
   * as that is done by module_edit.js.
   */
  var Metadata = Backbone.Model.extend({
    defaults: {
      field_name: null,
      display_name: null,
      value: null,
      explicitly_set: null,
      default_value: null,
      options: null,
      type: null,
      custom: false // Used only for non-metadata fields

    },
    initialize: function initialize() {
      this.original_value = this.get('value');
      this.original_explicitly_set = this.get('explicitly_set');
    },

    /**
     * Returns true if the stored value is different, or if the "explicitly_set"
     * property has changed.
     */
    isModified: function isModified() {
      // A non-metadata field will handle itself
      if (this.get('custom') === true) {
        return false;
      }

      if (!this.get('explicitly_set') && !this.original_explicitly_set) {
        return false;
      }

      if (this.get('explicitly_set') && this.original_explicitly_set) {
        return this.get('value') !== this.original_value;
      }

      return true;
    },

    /**
     * Returns true if a non-default/non-inherited value has been set.
     */
    isExplicitlySet: function isExplicitlySet() {
      return this.get('explicitly_set');
    },

    /**
     * The value, as shown in the UI. This may be an inherited or default value.
     */
    getDisplayValue: function getDisplayValue() {
      return this.get('value');
    },

    /**
     * The value, as should be returned to the server. if 'isExplicitlySet'
     * returns false, this method returns null to indicate that the value
     * is not set at this level.
     */
    getValue: function getValue() {
      return this.get('explicitly_set') ? this.get('value') : null;
    },

    /**
     * Sets the displayed value.
     */
    setValue: function setValue(value) {
      this.set({
        explicitly_set: true,
        value: value
      });
    },

    /**
     * Returns the field name, which should be used for persisting the metadata
     * field to the server.
     */
    getFieldName: function getFieldName() {
      return this.get('field_name');
    },

    /**
     * Returns the options. This may be a array of possible values, or an object
     * with properties like "max", "min" and "step".
     */
    getOptions: function getOptions() {
      return this.get('options');
    },

    /**
     * Returns the type of this metadata field. Possible values are SELECT_TYPE,
     * INTEGER_TYPE, and FLOAT_TYPE, GENERIC_TYPE.
     */
    getType: function getType() {
      return this.get('type');
    },

    /**
     * Reverts the value to the default_value specified at construction, and updates the
     * explicitly_set property.
     */
    clear: function clear() {
      this.set({
        explicitly_set: false,
        value: this.get('default_value')
      });
    }
  });
  Metadata.SELECT_TYPE = 'Select';
  Metadata.INTEGER_TYPE = 'Integer';
  Metadata.FLOAT_TYPE = 'Float';
  Metadata.GENERIC_TYPE = 'Generic';
  Metadata.LIST_TYPE = 'List';
  Metadata.DICT_TYPE = 'Dict';
  Metadata.VIDEO_LIST_TYPE = 'VideoList';
  Metadata.RELATIVE_TIME_TYPE = 'RelativeTime';
  return Metadata;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/models/module_info.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__("./cms/static/js/utils/module.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, ModuleUtils) {
  var ModuleInfo = Backbone.Model.extend({
    urlRoot: ModuleUtils.urlRoot,
    defaults: {
      id: null,
      data: null,
      metadata: null,
      children: null
    }
  });
  return ModuleInfo;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/models/uploads.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__(1), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, _, gettext) {
  var FileUpload = Backbone.Model.extend({
    defaults: {
      title: '',
      message: '',
      selectedFile: null,
      uploading: false,
      uploadedBytes: 0,
      totalBytes: 0,
      finished: false,
      mimeTypes: [],
      fileFormats: []
    },
    validate: function validate(attrs, options) {
      if (attrs.selectedFile && !this.checkTypeValidity(attrs.selectedFile)) {
        return {
          message: _.template(gettext('Only <%- fileTypes %> files can be uploaded. Please select a file ending in <%- (fileExtensions) %> to upload.'))( // eslint-disable-line max-len
          this.formatValidTypes()),
          attributes: {
            selectedFile: true
          }
        };
      }
    },
    // Return a list of this uploader's valid file types
    fileTypes: function fileTypes() {
      var mimeTypes = _.map(this.attributes.mimeTypes, function (type) {
        return type.split('/')[1].toUpperCase();
      }),
          fileFormats = _.map(this.attributes.fileFormats, function (type) {
        return type.toUpperCase();
      });

      return mimeTypes.concat(fileFormats);
    },
    checkTypeValidity: function checkTypeValidity(file) {
      var attrs = this.attributes,
          getRegExp = function getRegExp(formats) {
        // Creates regular expression like: /(?:.+)\.(jpg|png|gif)$/i
        return RegExp('(?:.+)\\.(' + formats.join('|') + ')$', 'i');
      };

      return attrs.mimeTypes.length === 0 && attrs.fileFormats.length === 0 || _.contains(attrs.mimeTypes, file.type) || getRegExp(attrs.fileFormats).test(file.name);
    },
    // Return strings for the valid file types and extensions this
    // uploader accepts, formatted as natural language
    formatValidTypes: function formatValidTypes() {
      var attrs = this.attributes;

      if (attrs.mimeTypes.concat(attrs.fileFormats).length === 1) {
        return {
          fileTypes: this.fileTypes()[0],
          fileExtensions: '.' + this.fileTypes()[0].toLowerCase()
        };
      }

      var or = gettext('or');

      var formatTypes = function formatTypes(types) {
        return _.template('<%- initial %> <%- or %> <%- last %>')({
          initial: _.initial(types).join(', '),
          or: or,
          last: _.last(types)
        });
      };

      return {
        fileTypes: formatTypes(this.fileTypes()),
        fileExtensions: formatTypes(_.map(this.fileTypes(), function (type) {
          return '.' + type.toLowerCase();
        }))
      };
    }
  });
  return FileUpload;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end define()

/***/ }),

/***/ "./cms/static/js/models/xblock_info.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__(1), __webpack_require__("./common/static/common/js/vendor/underscore.string.js"), __webpack_require__("./cms/static/js/utils/module.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, _, str, ModuleUtils) {
  'use strict';

  var XBlockInfo = Backbone.Model.extend({
    urlRoot: ModuleUtils.urlRoot,
    // NOTE: 'publish' is not an attribute on XBlockInfo, but it is used to signal the publish
    // and discard changes actions. Therefore 'publish' cannot be introduced as an attribute.
    defaults: {
      id: null,
      display_name: null,
      category: null,
      data: null,
      metadata: null,

      /**
       * The Studio URL for this xblock, or null if it doesn't have one.
       */
      studio_url: null,

      /**
       * An optional object with information about the children as well as about
       * the primary xblock type that is supported as a child.
       */
      child_info: null,

      /**
       * An optional object with information about each of the ancestors.
       */
      ancestor_info: null,

      /**
       * Date of the last edit to this xblock or any of its descendants.
       */
      edited_on: null,

      /**
       * User who last edited the xblock or any of its descendants. Will only be present if
       * publishing info was explicitly requested.
       */
      edited_by: null,

      /**
       * True iff a published version of the xblock exists.
       */
      published: null,

      /**
       * Date of the last publish of this xblock, or null if never published.
       */
      published_on: null,

      /**
       * User who last published the xblock, or null if never published. Will only be present if
       * publishing info was explicitly requested.
       */
      published_by: null,

      /**
       * True if the xblock is a parentable xblock.
       */
      has_children: null,

      /**
       * True if the xblock has changes.
       * Note: this is not always provided as a performance optimization. It is only provided for
       * verticals functioning as units.
       */
      has_changes: null,

      /**
       * Represents the possible publish states for an xblock. See the documentation
       * for XBlockVisibility to see a comprehensive enumeration of the states.
       */
      visibility_state: null,

      /**
       * True if the release date of the xblock is in the past.
       */
      released_to_students: null,

      /**
       * If the xblock is published, the date on which it will be released to students.
       * This can be null if the release date is unscheduled.
       */
      release_date: null,

      /**
       * The xblock which is determining the release date. For instance, for a unit,
       * this will either be the parent subsection or the grandparent section.
       * This can be null if the release date is unscheduled. Will only be present if
       * publishing info was explicitly requested.
       */
      release_date_from: null,

      /**
       * True if this xblock is currently visible to students. This is computed server-side
       * so that the logic isn't duplicated on the client. Will only be present if
       * publishing info was explicitly requested.
       */
      currently_visible_to_students: null,

      /**
       * If xblock is graded, the date after which student assessment will be evaluated.
       * It has same format as release date, for example: 'Jan 02, 2015 at 00:00 UTC'.
       */
      due_date: null,

      /**
       * Grading policy for xblock.
       */
      format: null,

      /**
       * List of course graders names.
       */
      course_graders: null,

      /**
       * True if this xblock contributes to the final course grade.
       */
      graded: null,

      /**
       * The same as `release_date` but as an ISO-formatted date string.
       */
      start: null,

      /**
       * The same as `due_date` but as an ISO-formatted date string.
       */
      due: null,

      /**
       * True iff this xblock is explicitly staff locked.
       */
      has_explicit_staff_lock: null,

      /**
       * True iff this any of this xblock's ancestors are staff locked.
       */
      ancestor_has_staff_lock: null,

      /**
       * The xblock which is determining the staff lock value. For instance, for a unit,
       * this will either be the parent subsection or the grandparent section.
       * This can be null if the xblock has no inherited staff lock. Will only be present if
       * publishing info was explicitly requested.
       */
      staff_lock_from: null,

      /**
       * True iff this xblock should display a "Contains staff only content" message.
       */
      staff_only_message: null,

      /**
       * True iff this xblock is a unit, and it has children that are only visible to certain
       * user partition groups. Note that this is not a recursive property. Will only be present if
       * publishing info was explicitly requested.
       */
      has_partition_group_components: null,

      /**
       * actions defines the state of delete, drag and child add functionality for a xblock.
       * currently, each xblock has default value of 'True' for keys: deletable, draggable and childAddable.
       */
      actions: null,

      /**
       * Header visible to UI.
       */
      is_header_visible: null,

      /**
       * Optional explanatory message about the xblock.
       */
      explanatory_message: null,

      /**
       * The XBlock's group access rules.  This is a dictionary keyed to user partition IDs,
       * where the values are lists of group IDs.
       */
      group_access: null,

      /**
       * User partition dictionary.  This is pre-processed by Studio, so it contains
       * some additional fields that are not stored in the course descriptor
       * (for example, which groups are selected for this particular XBlock).
       */
      user_partitions: null,

      /**
       * This xBlock's Highlights to message to learners.
       */
      highlights: [],
      highlights_enabled: false,
      highlights_enabled_for_messaging: false,
      highlights_preview_only: true,
      highlights_doc_url: ''
    },
    initialize: function initialize() {
      // Extend our Model by helper methods.
      _.extend(this, this.getCategoryHelpers());
    },
    parse: function parse(response) {
      if (response.ancestor_info) {
        response.ancestor_info.ancestors = this.parseXBlockInfoList(response.ancestor_info.ancestors);
      }

      if (response.child_info) {
        response.child_info.children = this.parseXBlockInfoList(response.child_info.children);
      }

      return response;
    },
    parseXBlockInfoList: function parseXBlockInfoList(list) {
      return _.map(list, function (item) {
        return this.createChild(item);
      }, this);
    },
    createChild: function createChild(response) {
      return new XBlockInfo(response, {
        parse: true
      });
    },
    hasChildren: function hasChildren() {
      var childInfo = this.get('child_info');
      return childInfo && childInfo.children.length > 0;
    },
    isPublishable: function isPublishable() {
      return !this.get('published') || this.get('has_changes');
    },
    isDeletable: function isDeletable() {
      return this.isActionRequired('deletable');
    },
    isDuplicable: function isDuplicable() {
      return this.isActionRequired('duplicable');
    },
    isDraggable: function isDraggable() {
      return this.isActionRequired('draggable');
    },
    isChildAddable: function isChildAddable() {
      return this.isActionRequired('childAddable');
    },
    isHeaderVisible: function isHeaderVisible() {
      if (this.get('is_header_visible') !== null) {
        return this.get('is_header_visible');
      }

      return true;
    },

    /**
     * Return true if action is required e.g. delete, drag, add new child etc or if given key is not present.
     * @return {boolean}
    */
    isActionRequired: function isActionRequired(actionName) {
      var actions = this.get('actions');

      if (actions !== null) {
        if (_.has(actions, actionName) && !actions[actionName]) {
          return false;
        }
      }

      return true;
    },

    /**
     * Return a list of convenience methods to check affiliation to the category.
     * @return {Array}
    */
    getCategoryHelpers: function getCategoryHelpers() {
      var categories = ['course', 'chapter', 'sequential', 'vertical'],
          helpers = {};

      _.each(categories, function (item) {
        helpers['is' + str.titleize(item)] = function () {
          return this.get('category') === item;
        };
      }, this);

      return helpers;
    },

    /**
     * Check if we can edit current XBlock or not on Course Outline page.
     * @return {Boolean}
     */
    isEditableOnCourseOutline: function isEditableOnCourseOutline() {
      return this.isSequential() || this.isChapter() || this.isVertical();
    }
  });
  return XBlockInfo;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/change_on_enter.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($) {
  // Trigger "Change" event on "Enter" keyup event
  var triggerChangeEventOnEnter = function triggerChangeEventOnEnter(e) {
    if (e.which == 13) {
      $(this).trigger('change').blur();
    }
  };

  return triggerChangeEventOnEnter;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/date_utils.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__("./common/static/js/vendor/date.js"), __webpack_require__("./cms/static/js/utils/change_on_enter.js"), __webpack_require__("./common/static/js/vendor/jquery-ui.min.js"), __webpack_require__("./common/static/js/vendor/timepicker/jquery.timepicker.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, date, TriggerChangeEventOnEnter) {
  'use strict';

  function getDate(datepickerInput, timepickerInput) {
    // given a pair of inputs (datepicker and timepicker), return a JS Date
    // object that corresponds to the datetime.js that they represent. Assume
    // UTC timezone, NOT the timezone of the user's browser.
    var selectedDate = null,
        selectedTime = null;

    if (datepickerInput.length > 0) {
      selectedDate = $(datepickerInput).datepicker('getDate');
    }

    if (timepickerInput.length > 0) {
      selectedTime = $(timepickerInput).timepicker('getTime');
    }

    if (selectedDate && selectedTime) {
      return new Date(Date.UTC(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate(), selectedTime.getHours(), selectedTime.getMinutes()));
    } else if (selectedDate) {
      return new Date(Date.UTC(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate()));
    } else {
      return null;
    }
  }

  function setDate(datepickerInput, timepickerInput, datetime) {
    // given a pair of inputs (datepicker and timepicker) and the date as an
    // ISO-formatted date string.
    var parsedDatetime = Date.parse(datetime);

    if (parsedDatetime) {
      $(datepickerInput).datepicker('setDate', parsedDatetime);

      if (timepickerInput.length > 0) {
        $(timepickerInput).timepicker('setTime', parsedDatetime);
      }
    }
  }

  function renderDate(dateArg) {
    // Render a localized date from an argument that can be passed to
    // the Date constructor (e.g. another Date or an ISO 8601 string)
    var dateObj = new Date(dateArg);
    return dateObj.toLocaleString([], {
      timeZone: 'UTC',
      timeZoneName: 'short'
    });
  }

  function parseDateFromString(stringDate) {
    if (stringDate && typeof stringDate === 'string') {
      return new Date(stringDate);
    } else {
      return stringDate;
    }
  }

  function convertDateStringsToObjects(obj, dateFields) {
    var i;

    for (i = 0; i < dateFields.length; i++) {
      if (obj[dateFields[i]]) {
        obj[dateFields[i]] = parseDateFromString(obj[dateFields[i]]);
      }
    }

    return obj;
  }

  function setupDatePicker(fieldName, view, index) {
    var cacheModel;
    var div;
    var datefield;
    var timefield;
    var cacheview;
    var setfield;
    var currentDate;

    if (typeof index !== 'undefined' && view.hasOwnProperty('collection')) {
      cacheModel = view.collection.models[index];
      div = view.$el.find('#' + view.collectionSelector(cacheModel.cid));
    } else {
      cacheModel = view.model;
      div = view.$el.find('#' + view.fieldToSelectorMap[fieldName]);
    }

    datefield = $(div).find('input.date');
    timefield = $(div).find('input.time');
    cacheview = view;

    setfield = function setfield(event) {
      var newVal = getDate(datefield, timefield); // Setting to null clears the time as well, as date and time are linked.
      // Note also that the validation logic prevents us from clearing the start date
      // (start date is required by the back end).

      cacheview.clearValidationErrors();
      cacheview.setAndValidate(fieldName, newVal || null, event);
    }; // instrument as date and time pickers


    timefield.timepicker({
      timeFormat: 'H:i'
    });
    datefield.datepicker(); // Using the change event causes setfield to be triggered twice, but it is necessary
    // to pick up when the date is typed directly in the field.

    datefield.change(setfield).keyup(TriggerChangeEventOnEnter);
    timefield.on('changeTime', setfield);
    timefield.on('input', setfield);
    currentDate = null;

    if (cacheModel) {
      currentDate = cacheModel.get(fieldName);
    } // timepicker doesn't let us set null, so check that we have a time


    if (currentDate) {
      setDate(datefield, timefield, currentDate);
    } else {
      // but reset fields either way
      timefield.val('');
      datefield.val('');
    }
  }

  return {
    getDate: getDate,
    setDate: setDate,
    renderDate: renderDate,
    convertDateStringsToObjects: convertDateStringsToObjects,
    parseDateFromString: parseDateFromString,
    setupDatePicker: setupDatePicker
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/handle_iframe_binding.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($) {
  var iframeBinding = function iframeBinding(e) {
    var target_element = null;

    if (typeof e === 'undefined') {
      target_element = $('iframe, embed');
    } else {
      if (typeof e.nodeName !== 'undefined') {
        target_element = $(e).find('iframe, embed');
      } else {
        target_element = e.$('iframe, embed');
      }
    }

    modifyTagContent(target_element);
  };

  var modifyTagContent = function modifyTagContent(target_element) {
    target_element.each(function () {
      if ($(this).prop('tagName') === 'IFRAME') {
        var ifr_source = $(this).attr('src'); // Modify iframe src only if it is not empty

        if (ifr_source) {
          var wmode = 'wmode=transparent';

          if (ifr_source.indexOf('?') !== -1) {
            var getQString = ifr_source.split('?');

            if (getQString[1].search('wmode=transparent') === -1) {
              var oldString = getQString[1];
              var newString = getQString[0];
              $(this).attr('src', newString + '?' + wmode + '&' + oldString);
            }
          } // The TinyMCE editor is hosted in an iframe, and before the iframe is
          // removed we execute this code. To avoid throwing an error when setting the
          // attr, check that the source doesn't start with the value specified by TinyMCE ('javascript:""').
          else if (ifr_source.lastIndexOf('javascript:', 0) !== 0) {
            $(this).attr('src', ifr_source + '?' + wmode);
          }
        }
      } else {
        $(this).attr('wmode', 'transparent');
      }
    });
  }; // Modify iframe/embed tags in provided html string
  // Use this method when provided data is just html sting not dom element
  // This method will only modify iframe (add wmode=transparent in url querystring) and embed (add wmode=transparent as attribute)
  // tags in html string so both tags will attach to dom and don't create z-index problem for other popups
  // Note: embed tags should be modified before rendering as they are static objects as compared to iframes
  // Note: this method can modify unintended html (invalid tags) while converting to dom object


  var iframeBindingHtml = function iframeBindingHtml(html_string) {
    if (html_string) {
      var target_element = null;
      var temp_content = document.createElement('div');
      $(temp_content).html(html_string);
      target_element = $(temp_content).find('iframe, embed');

      if (target_element.length > 0) {
        modifyTagContent(target_element);
        html_string = $(temp_content).html();
      }
    }

    return html_string;
  };

  return {
    iframeBinding: iframeBinding,
    iframeBindingHtml: iframeBindingHtml
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/modal.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($) {
  /**
   * Hides the modal and modal cover, using the standard selectors.
   * Note though that the class "is-fixed" on the modal cover
   * prevents the closing operation.
   */
  var hideModal = function hideModal(e) {
    if (e) {
      e.preventDefault();
    }

    var $modalCover = getModalCover(); // Unit editors (module_edit) do not want the modal cover to hide when users click outside
    // of the editor. Users must press Cancel or Save to exit the editor.

    if (!$modalCover.hasClass('is-fixed')) {
      getModal().hide();
      hideModalCover($modalCover);
    }
  };
  /**
   * Hides just the modal cover. Caller can pass in a specific
   * element as the modal cover, otherwise the standard selector will be used.
   *
   * This method also unbinds the click handler on the modal cover.
   */


  var hideModalCover = function hideModalCover(modalCover) {
    if (modalCover == undefined) {
      modalCover = getModalCover();
    }

    modalCover.hide();
    modalCover.removeClass('is-fixed');
    modalCover.unbind('click');
  };
  /**
   * Shows the modal and modal cover, using the standard selectors.
   */


  var showModal = function showModal() {
    getModal().show();
    showModalCover();
  };
  /**
   * Shows just the modal cover. The caller can optionally choose
   * to have the class "is-fixed" added to the cover, and
   * the user can also choose to specify a custom click handler
   * for the modal cover.
   *
   * This method returns the modal cover element.
   */


  var showModalCover = function showModalCover(addFixed, clickHandler) {
    var $modalCover = getModalCover();
    $modalCover.show();

    if (addFixed) {
      $modalCover.addClass('is-fixed');
    }

    $modalCover.unbind('click');

    if (clickHandler) {
      $modalCover.bind('click', clickHandler);
    } else {
      $modalCover.bind('click', hideModal);
    }

    return $modalCover;
  };

  var getModalCover = function getModalCover() {
    return $('.modal-cover');
  };

  var getModal = function getModal() {
    return $('.modal, .showAsModal');
  };

  return {
    showModal: showModal,
    hideModal: hideModal,
    showModalCover: showModalCover,
    hideModalCover: hideModalCover
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/module.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Utilities for modules/xblocks.
 *
 * Returns:
 *
 * urlRoot: the root for creating/updating an xblock.
 * getUpdateUrl: a utility method that returns the xblock update URL, appending
 *               the location if passed in.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = function (_) {
  var urlRoot = '/xblock';

  var getUpdateUrl = function getUpdateUrl(locator) {
    if (_.isUndefined(locator)) {
      return urlRoot + '/';
    } else {
      return urlRoot + '/' + locator;
    }
  };

  return {
    urlRoot: urlRoot,
    getUpdateUrl: getUpdateUrl
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/utils/templates.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _) {
  /**
   * Loads the named template from the page, or logs an error if it fails.
   * @param name The name of the template.
   * @returns The loaded template.
   */
  var loadTemplate = function loadTemplate(name) {
    var templateSelector = '#' + name + '-tpl',
        templateText = $(templateSelector).text();

    if (!templateText) {
      console.error('Failed to load ' + name + ' template');
    }

    return _.template(templateText);
  };

  return {
    loadTemplate: loadTemplate
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/abstract_editor.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__("./cms/static/js/views/baseview.js"), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = function (BaseView, _) {
  var AbstractEditor = BaseView.extend({
    // Model is MetadataModel
    initialize: function initialize() {
      var self = this;

      var templateName = _.result(this, 'templateName'); // Backbone model cid is only unique within the collection.


      this.uniqueId = _.uniqueId(templateName + '_');
      this.template = this.loadTemplate(templateName); // xss-lint: disable=javascript-jquery-html

      this.$el.html(this.template({
        model: this.model,
        uniqueId: this.uniqueId
      }));
      this.listenTo(this.model, 'change', this.render);
      this.render();
    },

    /**
     * The ID/name of the template. Subclasses must override this.
     */
    templateName: '',

    /**
     * Returns the value currently displayed in the editor/view. Subclasses should implement this method.
     */
    getValueFromEditor: function getValueFromEditor() {},

    /**
     * Sets the value currently displayed in the editor/view. Subclasses should implement this method.
     */
    setValueInEditor: function setValueInEditor(value) {},

    /**
     * Sets the value in the model, using the value currently displayed in the view.
     */
    updateModel: function updateModel() {
      this.model.setValue(this.getValueFromEditor());
    },

    /**
     * Clears the value currently set in the model (reverting to the default).
     */
    clear: function clear() {
      this.model.clear();
    },

    /**
     * Shows the clear button, if it is not already showing.
     */
    showClearButton: function showClearButton() {
      if (!this.$el.hasClass('is-set')) {
        this.$el.addClass('is-set');
        this.getClearButton().removeClass('inactive');
        this.getClearButton().addClass('active');
      }
    },

    /**
     * Returns the clear button.
     */
    getClearButton: function getClearButton() {
      return this.$el.find('.setting-clear');
    },

    /**
     * Renders the editor, updating the value displayed in the view, as well as the state of
     * the clear button.
     */
    render: function render() {
      if (!this.template) return;
      this.setValueInEditor(this.model.getDisplayValue());

      if (this.model.isExplicitlySet()) {
        this.showClearButton();
      } else {
        this.$el.removeClass('is-set');
        this.getClearButton().addClass('inactive');
        this.getClearButton().removeClass('active');
      }

      return this;
    },

    /**
     * Loads the named template from the page, or logs an error if it fails.
     * @param name The name of the template.
     * @returns The loaded template.
     */
    loadTemplate: function loadTemplate(name) {
      var templateSelector = '#' + name,
          templateText = $(templateSelector).text();

      if (!templateText) {
        console.error('Failed to load ' + name + ' template');
      }

      return _.template(templateText);
    }
  });
  return AbstractEditor;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./cms/static/js/views/baseview.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(2), __webpack_require__(3), __webpack_require__("./cms/static/js/utils/handle_iframe_binding.js"), __webpack_require__("./cms/static/js/utils/templates.js"), __webpack_require__("./common/static/common/js/components/utils/view_utils.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, Backbone, gettext, IframeUtils, TemplateUtils, ViewUtils) {
  /*
   This view is extended from backbone to provide useful functionality for all Studio views.
   This functionality includes:
   - automatic expand and collapse of elements with the 'ui-toggle-expansion' class specified
   - additional control of rendering by overriding 'beforeRender' or 'afterRender'
    Note: the default 'afterRender' function calls a utility function 'iframeBinding' which modifies
   iframe src urls on a page so that they are rendered as part of the DOM.
   */
  var BaseView = Backbone.View.extend({
    events: {
      'click .ui-toggle-expansion': 'toggleExpandCollapse'
    },
    options: {
      // UX is moving towards using 'is-collapsed' in preference over 'collapsed',
      // but use the old scheme as the default so that existing code doesn't need
      // to be rewritten.
      collapsedClass: 'collapsed'
    },
    // override the constructor function
    constructor: function constructor(options) {
      _.bindAll(this, 'beforeRender', 'render', 'afterRender'); // Merge passed options and view's options property and
      // attach to the view's options property


      if (this.options) {
        options = _.extend({}, _.result(this, 'options'), options);
      } // trunc is not available in IE, and it provides polyfill for it.
      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/trunc


      if (!Math.trunc) {
        Math.trunc = function (v) {
          v = +v; // eslint-disable-line no-param-reassign

          return v - v % 1 || (!isFinite(v) || v === 0 ? v : v < 0 ? -0 : 0);
        };
      }

      this.options = options;

      var _this = this; // xss-lint: disable=javascript-jquery-insertion


      this.render = _.wrap(this.render, function (render, options) {
        _this.beforeRender();

        render(options);

        _this.afterRender();

        return _this;
      }); // call Backbone's own constructor

      Backbone.View.prototype.constructor.apply(this, arguments);
    },
    beforeRender: function beforeRender() {},
    render: function render() {
      return this;
    },
    afterRender: function afterRender() {
      IframeUtils.iframeBinding(this);
    },
    toggleExpandCollapse: function toggleExpandCollapse(event) {
      var $target = $(event.target); // Don't propagate the event as it is possible that two views will both contain
      // this element, e.g. clicking on the element of a child view container in a parent.

      event.stopPropagation();
      event.preventDefault();
      ViewUtils.toggleExpandCollapse($target, this.options.collapsedClass);
    },

    /**
     * Loads the named template from the page, or logs an error if it fails.
     * @param name The name of the template.
     * @returns The loaded template.
     */
    loadTemplate: function loadTemplate(name) {
      return TemplateUtils.loadTemplate(name);
    }
  });
  return BaseView;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/license.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(__webpack_provided_edx_dot_HtmlUtils, $) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__("./cms/static/js/views/baseview.js"), __webpack_require__(1), __webpack_require__("./cms/templates/js/license-selector.underscore")], __WEBPACK_AMD_DEFINE_RESULT__ = function (BaseView, _, licenseSelectorTemplate) {
  var defaultLicenseInfo = {
    'all-rights-reserved': {
      name: gettext('All Rights Reserved'),
      tooltip: gettext('You reserve all rights for your work')
    },
    'creative-commons': {
      name: gettext('Creative Commons'),
      tooltip: gettext('You waive some rights for your work, such that others can use it too'),
      url: 'https://creativecommons.org/about',
      options: {
        ver: {
          name: gettext('Version'),
          type: 'string',
          "default": '4.0'
        },
        BY: {
          name: gettext('Attribution'),
          type: 'boolean',
          "default": true,
          help: gettext('Allow others to copy, distribute, display and perform your copyrighted work but only if they give credit the way you request. Currently, this option is required.'),
          disabled: true
        },
        NC: {
          name: gettext('Noncommercial'),
          type: 'boolean',
          "default": true,
          help: gettext('Allow others to copy, distribute, display and perform your work - and derivative works based upon it - but for noncommercial purposes only.')
        },
        ND: {
          name: gettext('No Derivatives'),
          type: 'boolean',
          "default": true,
          help: gettext('Allow others to copy, distribute, display and perform only verbatim copies of your work, not derivative works based upon it. This option is incompatible with "Share Alike".'),
          conflictsWith: ['SA']
        },
        SA: {
          name: gettext('Share Alike'),
          type: 'boolean',
          "default": false,
          help: gettext('Allow others to distribute derivative works only under a license identical to the license that governs your work. This option is incompatible with "No Derivatives".'),
          conflictsWith: ['ND']
        }
      },
      option_order: ['BY', 'NC', 'ND', 'SA']
    }
  };
  var LicenseView = BaseView.extend({
    events: {
      'click ul.license-types li button': 'onLicenseClick',
      'click ul.license-options li': 'onOptionClick'
    },
    initialize: function initialize(options) {
      this.licenseInfo = options.licenseInfo || defaultLicenseInfo;
      this.showPreview = !!options.showPreview; // coerce to boolean
      // Rerender when the model changes

      this.listenTo(this.model, 'change', this.render);
      this.render();
    },
    getDefaultOptionsForLicenseType: function getDefaultOptionsForLicenseType(licenseType) {
      if (!this.licenseInfo[licenseType]) {
        // custom license type, no options
        return {};
      }

      if (!this.licenseInfo[licenseType].options) {
        // defined license type without options
        return {};
      }

      var defaults = {};

      _.each(this.licenseInfo[licenseType].options, function (value, key) {
        defaults[key] = value["default"];
      });

      return defaults;
    },
    render: function render() {
      __webpack_provided_edx_dot_HtmlUtils.setHtml(this.$el, __webpack_provided_edx_dot_HtmlUtils.template(licenseSelectorTemplate)({
        model: this.model.attributes,
        licenseString: this.model.toString() || '',
        licenseInfo: this.licenseInfo,
        showPreview: this.showPreview,
        previewButton: false
      }));
      return this;
    },
    onLicenseClick: function onLicenseClick(e) {
      var $li = $(e.srcElement || e.target).closest('li');
      var licenseType = $li.data('license'); // Check that we've selected a different license type than what's currently selected

      if (licenseType != this.model.attributes.type) {
        this.model.set({
          type: licenseType,
          options: this.getDefaultOptionsForLicenseType(licenseType)
        }); // Fire the change event manually

        this.model.trigger('change change:type');
      }

      e.preventDefault();
    },
    onOptionClick: function onOptionClick(e) {
      var licenseType = this.model.get('type'),
          licenseOptions = $.extend({}, this.model.get('options')),
          $li = $(e.srcElement || e.target).closest('li');
      var optionKey = $li.data('option');
      var licenseInfo = this.licenseInfo[licenseType];
      var optionInfo = licenseInfo.options[optionKey];

      if (optionInfo.disabled) {
        // we're done here
        return;
      }

      var currentOptionValue = licenseOptions[optionKey];

      if (optionInfo.type === 'boolean') {
        // toggle current value
        currentOptionValue = !currentOptionValue;
        licenseOptions[optionKey] = currentOptionValue;
      } // check for conflicts


      if (currentOptionValue && optionInfo.conflictsWith) {
        var conflicts = optionInfo.conflictsWith;

        for (var i = 0; i < conflicts.length; i++) {
          // Uncheck all conflicts
          licenseOptions[conflicts[i]] = false;
          console.log(licenseOptions);
        }
      }

      this.model.set({
        options: licenseOptions
      }); // Backbone has trouble identifying when objects change, so we'll
      // fire the change event manually.

      this.model.trigger('change change:options');
      e.preventDefault();
    }
  });
  return LicenseView;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js"), __webpack_require__(0)))

/***/ }),

/***/ "./cms/static/js/views/metadata.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__("./cms/static/js/views/baseview.js"), __webpack_require__(1), __webpack_require__("./cms/static/js/models/metadata.js"), __webpack_require__("./cms/static/js/views/abstract_editor.js"), __webpack_require__("./cms/static/js/models/uploads.js"), __webpack_require__("./cms/static/js/views/uploads.js"), __webpack_require__("./cms/static/js/models/license.js"), __webpack_require__("./cms/static/js/views/license.js"), __webpack_require__("./cms/static/js/views/video/transcripts/utils.js"), __webpack_require__("./cms/static/js/views/video/transcripts/metadata_videolist.js"), __webpack_require__("./cms/static/js/views/video/translations_editor.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, BaseView, _, MetadataModel, AbstractEditor, FileUpload, UploadDialog, LicenseModel, LicenseView, TranscriptUtils, VideoList, VideoTranslations, HtmlUtils) {
  'use strict';

  var Metadata = {};
  Metadata.Editor = BaseView.extend({
    // Store rendered view references
    views: {},
    // Model is CMS.Models.MetadataCollection,
    initialize: function initialize() {
      var self = this,
          counter = 0,
          locator = self.$el.closest('[data-locator]').data('locator'),
          courseKey = self.$el.closest('[data-course-key]').data('course-key'),
          attributes = {
        numEntries: this.collection.length,
        locator: locator
      };
      this.template = this.loadTemplate('metadata-editor');
      this.$el.html(HtmlUtils.HTML(this.template(attributes)).toString());
      this.collection.each(function (model) {
        var data = {
          el: self.$el.find('.metadata_entry')[counter++],
          courseKey: courseKey,
          locator: locator,
          model: model
        },
            conversions = {
          Select: 'Option',
          Float: 'Number',
          Integer: 'Number'
        },
            type = model.getType();

        if (conversions[type]) {
          type = conversions[type];
        }

        if (_.isFunction(Metadata[type])) {
          self.views[data.model.getFieldName()] = new Metadata[type](data);
        } else {
          // Everything else is treated as GENERIC_TYPE, which uses String editor.
          self.views[data.model.getFieldName()] = new Metadata.String(data);
        }
      });
    },

    /**
     * Returns just the modified metadata values, in the format used to persist to the server.
     */
    getModifiedMetadataValues: function getModifiedMetadataValues() {
      var modified_values = {};
      this.collection.each(function (model) {
        if (model.isModified()) {
          modified_values[model.getFieldName()] = model.getValue();
        }
      });
      return modified_values;
    },

    /**
     * Returns a display name for the component related to this metadata. This method looks to see
     * if there is a metadata entry called 'display_name', and if so, it returns its value. If there
     * is no such entry, or if display_name does not have a value set, it returns an empty string.
     */
    getDisplayName: function getDisplayName() {
      var displayName = '';
      this.collection.each(function (model) {
        if (model.get('field_name') === 'display_name') {
          var displayNameValue = model.get('value'); // It is possible that there is no display name value set. In that case, return empty string.

          displayName = displayNameValue || '';
        }
      });
      return displayName;
    }
  });
  Metadata.VideoList = VideoList;
  Metadata.VideoTranslations = VideoTranslations;
  Metadata.String = AbstractEditor.extend({
    events: {
      'change input': 'updateModel',
      'keypress .setting-input': 'showClearButton',
      'click .setting-clear': 'clear'
    },
    templateName: 'metadata-string-entry',
    render: function render() {
      AbstractEditor.prototype.render.apply(this); // If the model has property `non editable` equals `true`,
      // the field is disabled, but user is able to clear it.

      if (this.model.get('non_editable')) {
        this.$el.find('#' + this.uniqueId).prop('readonly', true).addClass('is-disabled').attr('aria-disabled', true);
      }
    },
    getValueFromEditor: function getValueFromEditor() {
      return this.$el.find('#' + this.uniqueId).val();
    },
    setValueInEditor: function setValueInEditor(value) {
      this.$el.find('input').val(value);
    }
  });
  Metadata.VideoID = Metadata.String.extend({
    // Delay between check_transcript requests
    requestDelay: 300,
    initialize: function initialize() {
      Metadata.String.prototype.initialize.apply(this, arguments);
      this.$el.on('input', 'input', _.debounce(_.bind(this.inputChange, this), this.requestDelay));
    },
    render: function render() {
      Metadata.String.prototype.render.apply(this, arguments);
      TranscriptUtils.Storage.set('edx_video_id', this.getValueFromEditor());
    },
    clear: function clear() {
      this.model.setValue('');
      this.inputChange();
    },
    getData: function getData() {
      return [{
        mode: 'edx_video_id',
        type: 'edx_video_id',
        video: this.getValueFromEditor()
      }];
    },
    inputChange: function inputChange() {
      TranscriptUtils.Storage.set('edx_video_id', this.getValueFromEditor());
      Backbone.trigger('transcripts:basicTabFieldChanged');
    }
  });
  Metadata.Number = AbstractEditor.extend({
    events: {
      'change input': 'updateModel',
      'keypress .setting-input': 'keyPressed',
      'change .setting-input': 'changed',
      'click .setting-clear': 'clear'
    },
    render: function render() {
      AbstractEditor.prototype.render.apply(this);

      if (!this.initialized) {
        var numToString = function numToString(val) {
          return val.toFixed(4);
        };

        var min = 'min';
        var max = 'max';
        var step = 'step';
        var options = this.model.getOptions();

        if (options.hasOwnProperty(min)) {
          this.min = Number(options[min]);
          this.$el.find('input').attr(min, numToString(this.min));
        }

        if (options.hasOwnProperty(max)) {
          this.max = Number(options[max]);
          this.$el.find('input').attr(max, numToString(this.max));
        }

        var stepValue = undefined;

        if (options.hasOwnProperty(step)) {
          // Parse step and convert to String. Polyfill doesn't like float values like ".1" (expects "0.1").
          stepValue = numToString(Number(options[step]));
        } else if (this.isIntegerField()) {
          stepValue = '1';
        }

        if (stepValue !== undefined) {
          this.$el.find('input').attr(step, stepValue);
        } // Manually runs polyfill for input number types to correct for Firefox non-support.
        // inputNumber will be undefined when unit test is running.


        if ($.fn.inputNumber) {
          this.$el.find('.setting-input-number').inputNumber();
        }

        this.initialized = true;
      }

      return this;
    },
    templateName: 'metadata-number-entry',
    getValueFromEditor: function getValueFromEditor() {
      return this.$el.find('#' + this.uniqueId).val();
    },
    setValueInEditor: function setValueInEditor(value) {
      this.$el.find('input').val(value);
    },

    /**
     * Returns true if this view is restricted to integers, as opposed to floating points values.
     */
    isIntegerField: function isIntegerField() {
      return this.model.getType() === 'Integer';
    },
    keyPressed: function keyPressed(e) {
      this.showClearButton(); // This first filtering if statement is take from polyfill to prevent
      // non-numeric input (for browsers that don't use polyfill because they DO have a number input type).

      var _ref, _ref1;

      if ((_ref = e.keyCode) !== 8 && _ref !== 9 && _ref !== 35 && _ref !== 36 && _ref !== 37 && _ref !== 39 && (_ref1 = e.which) !== 45 && _ref1 !== 46 && _ref1 !== 48 && _ref1 !== 49 && _ref1 !== 50 && _ref1 !== 51 && _ref1 !== 52 && _ref1 !== 53 && _ref1 !== 54 && _ref1 !== 55 && _ref1 !== 56 && _ref1 !== 57) {
        e.preventDefault();
      } // For integers, prevent decimal points.


      if (this.isIntegerField() && e.keyCode === 46) {
        e.preventDefault();
      }
    },
    changed: function changed() {
      // Limit value to the range specified by min and max (necessary for browsers that aren't using polyfill).
      // Prevent integer/float fields value to be empty (set them to their defaults)
      var value = this.getValueFromEditor();

      if (value) {
        if (this.max !== undefined && value > this.max) {
          value = this.max;
        } else if (this.min != undefined && value < this.min) {
          value = this.min;
        }

        this.setValueInEditor(value);
        this.updateModel();
      } else {
        this.clear();
      }
    }
  });
  Metadata.Option = AbstractEditor.extend({
    events: {
      'change select': 'updateModel',
      'click .setting-clear': 'clear'
    },
    templateName: 'metadata-option-entry',
    getValueFromEditor: function getValueFromEditor() {
      var selectedText = this.$el.find('#' + this.uniqueId).find(':selected').text();
      var selectedValue;

      _.each(this.model.getOptions(), function (modelValue) {
        if (modelValue === selectedText) {
          selectedValue = modelValue;
        } else if (modelValue.display_name === selectedText) {
          selectedValue = modelValue.value;
        }
      });

      return selectedValue;
    },
    setValueInEditor: function setValueInEditor(value) {
      // Value here is the json value as used by the field. The choice may instead be showing display names.
      // Find the display name matching the value passed in.
      _.each(this.model.getOptions(), function (modelValue) {
        if (modelValue.value === value) {
          value = modelValue.display_name;
        }
      });

      this.$el.find('#' + this.uniqueId + ' option').filter(function () {
        return $(this).text() === value;
      }).prop('selected', true);
    }
  });
  Metadata.PublicAccess = Metadata.Option.extend({
    templateName: 'metadata-option-public-access',
    initialize: function initialize() {
      Metadata.Option.prototype.initialize.apply(this, arguments);
      this.listenTo(this.model, 'change', this.updateUrlFieldVisibility);
      this.updateUrlFieldVisibility();
    },
    updateUrlFieldVisibility: function updateUrlFieldVisibility() {
      var urlContainer = this.$el.find('.public-access-block-url-container');

      if (this.getValueFromEditor()) {
        urlContainer.removeClass('is-hidden');
      } else {
        urlContainer.addClass('is-hidden');
      }
    }
  });
  Metadata.List = AbstractEditor.extend({
    events: {
      'click .setting-clear': 'clear',
      'keypress .setting-input': 'showClearButton',
      'change input': 'updateModel',
      'input input': 'enableAdd',
      'click .create-setting': 'addEntry',
      'click .remove-setting': 'removeEntry'
    },
    templateName: 'metadata-list-entry',
    getValueFromEditor: function getValueFromEditor() {
      return _.map(this.$el.find('li input'), function (ele) {
        return ele.value.trim();
      }).filter(_.identity);
    },
    setValueInEditor: function setValueInEditor(value) {
      var list = this.$el.find('ol');
      list.empty();

      _.each(value, function (ele, index) {
        var template = _.template(HtmlUtils.joinHtml(HtmlUtils.HTML('<li class="list-settings-item">'), HtmlUtils.HTML('<input type="text" class="input" value="<%- ele %>">'), HtmlUtils.HTML('<a href="#" class="remove-action remove-setting" data-index="<%- index %>"><span class="icon fa fa-times-circle" aria-hidden="true"></span><span class="sr">'), // eslint-disable-line max-len
        gettext('Remove'), HtmlUtils.HTML('</span></a>'), HtmlUtils.HTML('</li>')).toString());

        list.append(HtmlUtils.HTML($(template({
          ele: ele,
          index: index
        }))).toString());
      });
    },
    addEntry: function addEntry(event) {
      event.preventDefault(); // We don't call updateModel here since it's bound to the
      // change event

      var list = this.model.get('value') || [];
      this.setValueInEditor(list.concat(['']));
      this.$el.find('.create-setting').addClass('is-disabled').attr('aria-disabled', true);
    },
    removeEntry: function removeEntry(event) {
      event.preventDefault();
      var entry = $(event.currentTarget).siblings().val();
      this.setValueInEditor(_.without(this.model.get('value'), entry));
      this.updateModel();
      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    enableAdd: function enableAdd() {
      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    clear: function clear() {
      AbstractEditor.prototype.clear.apply(this, arguments);

      if (_.isNull(this.model.getValue())) {
        this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
      }
    }
  });
  Metadata.RelativeTime = AbstractEditor.extend({
    defaultValue: '00:00:00',
    // By default max value of RelativeTime field on Backend is 23:59:59,
    // that is 86399 seconds.
    maxTimeInSeconds: 86399,
    events: {
      'focus input': 'addSelection',
      'mouseup input': 'mouseUpHandler',
      'change input': 'updateModel',
      'keypress .setting-input': 'showClearButton',
      'click .setting-clear': 'clear'
    },
    templateName: 'metadata-string-entry',
    getValueFromEditor: function getValueFromEditor() {
      var $input = this.$el.find('#' + this.uniqueId);
      return $input.val();
    },
    updateModel: function updateModel() {
      var value = this.getValueFromEditor(),
          time = this.parseRelativeTime(value);
      this.model.setValue(time); // Sometimes, `parseRelativeTime` method returns the same value for
      // the different inputs. In this case, model will not be
      // updated (it already has the same value) and we should
      // call `render` method manually.
      // Examples:
      //   value => 23:59:59; parseRelativeTime => 23:59:59
      //   value => 44:59:59; parseRelativeTime => 23:59:59

      if (value !== time && !this.model.hasChanged('value')) {
        this.render();
      }
    },
    parseRelativeTime: function parseRelativeTime(value) {
      // This function ensure you have two-digits
      var pad = function pad(number) {
        return number < 10 ? '0' + number : number;
      },
          // Removes all white-spaces and splits by `:`.
      list = value.replace(/\s+/g, '').split(':'),
          seconds,
          date;

      list = _.map(list, function (num) {
        return Math.max(0, parseInt(num, 10) || 0);
      }).reverse();
      seconds = _.reduce(list, function (memo, num, index) {
        return memo + num * Math.pow(60, index);
      }, 0); // multiply by 1000 because Date() requires milliseconds

      date = new Date(Math.min(seconds, this.maxTimeInSeconds) * 1000);
      return [pad(date.getUTCHours()), pad(date.getUTCMinutes()), pad(date.getUTCSeconds())].join(':');
    },
    setValueInEditor: function setValueInEditor(value) {
      if (!value) {
        value = this.defaultValue;
      }

      this.$el.find('input').val(value);
    },
    addSelection: function addSelection(event) {
      $(event.currentTarget).select();
    },
    mouseUpHandler: function mouseUpHandler(event) {
      // Prevents default behavior to make works selection in WebKit
      // browsers
      event.preventDefault();
    }
  });
  Metadata.Dict = AbstractEditor.extend({
    events: {
      'click .setting-clear': 'clear',
      'keypress .setting-input': 'showClearButton',
      'change input': 'updateModel',
      'input input': 'enableAdd',
      'click .create-setting': 'addEntry',
      'click .remove-setting': 'removeEntry'
    },
    templateName: 'metadata-dict-entry',
    getValueFromEditor: function getValueFromEditor() {
      var dict = {};

      _.each(this.$el.find('li'), function (li, index) {
        var key = $(li).find('.input-key').val().trim(),
            value = $(li).find('.input-value').val().trim(); // Keys should be unique, so if our keys are duplicated and
        // second key is empty or key and value are empty just do
        // nothing. Otherwise, it'll be overwritten by the new value.

        if (value === '') {
          if (key === '' || key in dict) {
            return false;
          }
        }

        dict[key] = value;
      });

      return dict;
    },
    setValueInEditor: function setValueInEditor(value) {
      var list = this.$el.find('ol'),
          frag = document.createDocumentFragment();

      _.each(value, function (value, key) {
        var template = _.template(HtmlUtils.joinHtml(HtmlUtils.HTML('<li class="list-settings-item">'), HtmlUtils.HTML('<input type="text" class="input input-key" value="<%- key %>">'), HtmlUtils.HTML('<input type="text" class="input input-value" value="<%- value %>">'), HtmlUtils.HTML('<a href="#" class="remove-action remove-setting" data-value="<%- value %>"><span class="icon fa fa-times-circle" aria-hidden="true"></span><span class="sr">Remove</span></a>'), // eslint-disable-line max-len
        HtmlUtils.HTML('</li>')).toString());

        frag.appendChild($(template({
          key: key,
          value: value
        }))[0]);
      }); // xss-lint: disable=javascript-jquery-html


      list.html([frag]);
    },
    addEntry: function addEntry(event) {
      event.preventDefault(); // We don't call updateModel here since it's bound to the
      // change event

      var dict = $.extend(true, {}, this.model.get('value')) || {};
      dict[''] = '';
      this.setValueInEditor(dict);
      this.$el.find('.create-setting').addClass('is-disabled').attr('aria-disabled', true);
    },
    removeEntry: function removeEntry(event) {
      event.preventDefault();
      var entry = $(event.currentTarget).siblings('.input-key').val();
      this.setValueInEditor(_.omit(this.model.get('value'), entry));
      this.updateModel();
      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    enableAdd: function enableAdd() {
      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    clear: function clear() {
      AbstractEditor.prototype.clear.apply(this, arguments);

      if (_.isNull(this.model.getValue())) {
        this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
      }
    }
  });
  /**
   * Provides convenient way to upload/download files in component edit.
   * The editor uploads files directly to course assets and stores link
   * to uploaded file.
   */

  Metadata.FileUploader = AbstractEditor.extend({
    events: {
      'click .upload-setting': 'upload',
      'click .setting-clear': 'clear'
    },
    templateName: 'metadata-file-uploader-entry',
    templateButtonsName: 'metadata-file-uploader-item',
    initialize: function initialize() {
      this.buttonTemplate = this.loadTemplate(this.templateButtonsName);
      AbstractEditor.prototype.initialize.apply(this);
    },
    getValueFromEditor: function getValueFromEditor() {
      return this.$('#' + this.uniqueId).val();
    },
    setValueInEditor: function setValueInEditor(value) {
      var html = this.buttonTemplate({
        model: this.model,
        uniqueId: this.uniqueId
      });
      this.$('#' + this.uniqueId).val(value);
      this.$('.wrapper-uploader-actions').html(HtmlUtils.HTML(html).toString());
    },
    upload: function upload(event) {
      var self = this,
          $target = $(event.currentTarget),
          url = '/assets/' + this.options.courseKey + '/',
          model = new FileUpload({
        title: gettext('Upload File')
      }),
          view = new UploadDialog({
        model: model,
        url: url,
        parentElement: $target.closest('.xblock-editor'),
        onSuccess: function onSuccess(response) {
          if (response.asset && response.asset.url) {
            self.model.setValue(response.asset.url);
          }
        }
      }).show();
      event.preventDefault();
    }
  });
  Metadata.License = AbstractEditor.extend({
    initialize: function initialize(options) {
      this.licenseModel = new LicenseModel({
        asString: this.model.getValue()
      });
      this.licenseView = new LicenseView({
        model: this.licenseModel
      }); // Rerender when the license model changes

      this.listenTo(this.licenseModel, 'change', this.setLicense);
      this.render();
    },
    render: function render() {
      this.licenseView.render().$el.css('display', 'inline');
      this.licenseView.undelegateEvents();
      this.$el.empty().append(this.licenseView.el); // restore event bindings

      this.licenseView.delegateEvents();
      return this;
    },
    setLicense: function setLicense() {
      this.model.setValue(this.licenseModel.toString());
      this.render();
    }
  });
  return Metadata;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./cms/static/js/views/modals/base_modal.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * This is a base modal implementation that provides common utilities.
 *
 * A modal implementation should override the following methods:
 *
 *   getTitle():
 *     returns the title for the modal.
 *   getContentHtml():
 *     returns the HTML content to be shown inside the modal.
 *
 * A modal implementation should also provide the following options:
 *
 *   modalName: A string identifying the modal.
 *   modalType: A string identifying the type of the modal.
 *   modalSize: A string, either 'sm', 'med', or 'lg' indicating the
 *     size of the modal.
 *   viewSpecificClasses: A string of CSS classes to be attached to
 *     the modal window.
 *   addPrimaryActionButton: A boolean indicating whether to include a primary action
 *     button on the modal.
 *   primaryActionButtonType: A string to be used as type for primary action button.
 *   primaryActionButtonTitle: A string to be used as title for primary action button.
 *   showEditorModeButtons: Whether to show editor mode button in the modal header.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./cms/static/js/views/baseview.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, BaseView) {
  var BaseModal = BaseView.extend({
    events: {
      'click .action-cancel': 'cancel'
    },
    options: _.extend({}, BaseView.prototype.options, {
      type: 'prompt',
      closeIcon: false,
      icon: false,
      modalName: 'basic',
      modalType: 'generic',
      modalSize: 'lg',
      title: '',
      modalWindowClass: '.modal-window',
      // A list of class names, separated by space.
      viewSpecificClasses: '',
      addPrimaryActionButton: false,
      primaryActionButtonType: 'save',
      primaryActionButtonTitle: gettext('Save'),
      showEditorModeButtons: true
    }),
    initialize: function initialize() {
      var parent = this.options.parent,
          parentElement = this.options.parentElement;
      this.modalTemplate = this.loadTemplate('basic-modal');
      this.buttonTemplate = this.loadTemplate('modal-button');

      if (parent) {
        parentElement = parent.$el;
      } else if (!parentElement) {
        parentElement = this.$el.closest(this.options.modalWindowClass);

        if (parentElement.length === 0) {
          parentElement = $('body');
        }
      }

      this.parentElement = parentElement;
    },
    render: function render() {
      // xss-lint: disable=javascript-jquery-html
      this.$el.html(this.modalTemplate({
        name: this.options.modalName,
        type: this.options.modalType,
        size: this.options.modalSize,
        title: this.getTitle(),
        modalSRTitle: this.options.modalSRTitle,
        showEditorModeButtons: this.options.showEditorModeButtons,
        viewSpecificClasses: this.options.viewSpecificClasses
      }));
      this.addActionButtons();
      this.renderContents();
      this.parentElement.append(this.$el);
    },
    getTitle: function getTitle() {
      return this.options.title;
    },
    renderContents: function renderContents() {
      var contentHtml = this.getContentHtml(); // xss-lint: disable=javascript-jquery-html

      this.$('.modal-content').html(contentHtml);
    },

    /**
     * Returns the content to be shown in the modal.
     */
    getContentHtml: function getContentHtml() {
      return '';
    },
    show: function show(focusModal) {
      var focusModalWindow = focusModal === undefined;
      this.render();
      this.resize();
      $(window).resize(_.bind(this.resize, this)); // child may want to have its own focus management

      if (focusModalWindow) {
        // after showing and resizing, send focus
        this.$el.find(this.options.modalWindowClass).focus();
      }
    },
    hide: function hide() {
      // Completely remove the modal from the DOM
      this.undelegateEvents();
      this.$el.html('');
    },
    cancel: function cancel(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation(); // Make sure parent modals don't see the click
      }

      this.hide();
    },

    /**
     * Adds the action buttons to the modal.
     */
    addActionButtons: function addActionButtons() {
      if (this.options.addPrimaryActionButton) {
        this.addActionButton(this.options.primaryActionButtonType, this.options.primaryActionButtonTitle, true);
      }

      this.addActionButton('cancel', gettext('Cancel'));
    },

    /**
     * Adds a new action button to the modal.
     * @param type The type of the action.
     * @param name The action's name.
     * @param isPrimary True if this button is the primary one.
     */
    addActionButton: function addActionButton(type, name, isPrimary) {
      var html = this.buttonTemplate({
        type: type,
        name: name,
        isPrimary: isPrimary
      }); // xss-lint: disable=javascript-jquery-append

      this.getActionBar().find('ul').append(html);
    },

    /**
     * Returns the action bar that contains the modal's action buttons.
     */
    getActionBar: function getActionBar() {
      return this.$(this.options.modalWindowClass + ' > div > .modal-actions');
    },

    /**
     * Returns the action button of the specified type.
     */
    getActionButton: function getActionButton(type) {
      return this.getActionBar().find('.action-' + type);
    },
    enableActionButton: function enableActionButton(type) {
      this.getActionBar().find('.action-' + type).prop('disabled', false).removeClass('is-disabled');
    },
    disableActionButton: function disableActionButton(type) {
      this.getActionBar().find('.action-' + type).prop('disabled', true).addClass('is-disabled');
    },
    resize: function resize() {
      var top, left, modalWindow, modalWidth, modalHeight, availableWidth, availableHeight, maxWidth, maxHeight;
      modalWindow = this.$el.find(this.options.modalWindowClass);
      availableWidth = $(window).width();
      availableHeight = $(window).height();
      maxWidth = availableWidth * 0.98;
      maxHeight = availableHeight * 0.98;
      modalWidth = Math.min(modalWindow.outerWidth(), maxWidth);
      modalHeight = Math.min(modalWindow.outerHeight(), maxHeight);
      left = (availableWidth - modalWidth) / 2;
      top = (availableHeight - modalHeight) / 2;
      modalWindow.css({
        top: top + $(window).scrollTop(),
        left: left + $(window).scrollLeft()
      });
    }
  });
  return BaseModal;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/modals/edit_xblock.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * The EditXBlockModal is a Backbone view that shows an xblock editor in a modal window.
 * It is invoked using the edit method which is passed an existing rendered xblock,
 * and upon save an optional refresh function can be invoked to update the display.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(2), __webpack_require__(3), __webpack_require__("./cms/static/js/views/modals/base_modal.js"), __webpack_require__("./common/static/common/js/components/utils/view_utils.js"), __webpack_require__("./cms/static/js/views/utils/xblock_utils.js"), __webpack_require__("./cms/static/js/views/xblock_editor.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, Backbone, gettext, BaseModal, ViewUtils, XBlockViewUtils, XBlockEditorView) {
  'use strict';

  var EditXBlockModal = BaseModal.extend({
    events: _.extend({}, BaseModal.prototype.events, {
      'click .action-save': 'save',
      'click .action-modes a': 'changeMode',
      'click .title-edit-button': 'clickTitleButton'
    }),
    options: $.extend({}, BaseModal.prototype.options, {
      modalName: 'edit-xblock',
      view: 'studio_view',
      viewSpecificClasses: 'modal-editor confirm',
      // Translators: "title" is the name of the current component being edited.
      titleFormat: gettext('Editing: {title}'),
      addPrimaryActionButton: true
    }),
    initialize: function initialize() {
      BaseModal.prototype.initialize.call(this);
      this.template = this.loadTemplate('edit-xblock-modal');
      this.editorModeButtonTemplate = this.loadTemplate('editor-mode-button');
    },

    /**
     * Show an edit modal for the specified xblock
     * @param xblockElement The element that contains the xblock to be edited.
     * @param rootXBlockInfo An XBlockInfo model that describes the root xblock on the page.
     * @param options A standard options object.
     */
    edit: function edit(xblockElement, rootXBlockInfo, options) {
      this.xblockElement = xblockElement;
      this.xblockInfo = XBlockViewUtils.findXBlockInfo(xblockElement, rootXBlockInfo);
      this.options.modalType = this.xblockInfo.get('category');
      this.editOptions = options;
      this.render();
      this.show(); // Hide the action bar until we know which buttons we want

      this.getActionBar().hide(); // Display the xblock after the modal is shown as there are some xblocks
      // that depend upon being visible when they initialize, e.g. the problem xmodule.

      this.displayXBlock();
    },
    getContentHtml: function getContentHtml() {
      return this.template({
        xblockInfo: this.xblockInfo
      });
    },
    displayXBlock: function displayXBlock() {
      this.editorView = new XBlockEditorView({
        el: this.$('.xblock-editor'),
        model: this.xblockInfo,
        view: this.options.view
      });
      this.editorView.render({
        success: _.bind(this.onDisplayXBlock, this)
      });
    },
    createTitleEditor: function createTitleEditor(title) {
      // xss-lint: disable=javascript-jquery-html
      this.$('.modal-window-title').html(this.loadTemplate('edit-title-button')({
        title: title
      }));
    },
    onDisplayXBlock: function onDisplayXBlock() {
      var editorView = this.editorView,
          title = this.getTitle(),
          readOnlyView = this.editOptions && this.editOptions.readOnlyView || !this.canSave(); // Notify the runtime that the modal has been shown

      editorView.notifyRuntime('modal-shown', this); // Update the modal's header

      if (editorView.hasCustomTabs()) {
        // Hide the modal's header as the custom editor provides its own
        this.$('.modal-header').hide(); // Update the custom editor's title

        editorView.$('.component-name').text(title);
      } else if (editorView.getDataEditor() && editorView.getMetadataEditor()) {
        this.createTitleEditor(title);
        this.addDefaultModes(); // If the plugins content element exists, add a button to reveal it.

        if (this.$('.wrapper-comp-plugins').length > 0) {
          this.addModeButton('plugins', gettext('Plugins'));
        }

        this.selectMode(editorView.mode);
      } else {
        this.$('.modal-window-title').text(title);
      } // If the xblock is not using custom buttons then choose which buttons to show


      if (!editorView.hasCustomButtons()) {
        // If the xblock does not support save then disable the save button
        if (readOnlyView) {
          this.disableSave();
        }

        this.getActionBar().show();
      }

      this.resize();
    },
    canSave: function canSave() {
      return this.editorView.xblock.save || this.editorView.xblock.collectFieldData;
    },
    disableSave: function disableSave() {
      var saveButton = this.getActionButton('save'),
          cancelButton = this.getActionButton('cancel');
      saveButton.parent().hide();
      cancelButton.text(gettext('Close'));
      cancelButton.addClass('action-primary');
    },
    getTitle: function getTitle() {
      var displayName = this.xblockInfo.get('display_name');

      if (!displayName) {
        if (this.xblockInfo.isVertical()) {
          displayName = gettext('Unit');
        } else {
          displayName = gettext('Component');
        }
      }

      return edx.StringUtils.interpolate(this.options.titleFormat, {
        title: displayName
      });
    },
    addDefaultModes: function addDefaultModes() {
      var defaultModes, i, mode;
      defaultModes = this.editorView.getDefaultModes();

      for (i = 0; i < defaultModes.length; i++) {
        mode = defaultModes[i];
        this.addModeButton(mode.id, mode.name);
      }
    },
    changeMode: function changeMode(event) {
      var $parent = $(event.target.parentElement),
          mode = $parent.data('mode');
      event.preventDefault();
      this.selectMode(mode);
    },
    selectMode: function selectMode(mode) {
      var editorView = this.editorView,
          buttonSelector;
      editorView.selectMode(mode);
      this.$('.editor-modes a').removeClass('is-set');

      if (mode) {
        buttonSelector = '.' + mode + '-button';
        this.$(buttonSelector).addClass('is-set');
      }
    },
    save: function save(event) {
      var self = this,
          editorView = this.editorView,
          xblockInfo = this.xblockInfo,
          data = null;

      try {
        data = editorView.getXBlockFieldData();
      } catch (e) {
        ViewUtils.showErrorMeassage(gettext("Studio's having trouble parsing the problem component's content"), e.message, 10000);
        ViewUtils.setScrollOffset(editorView.$el, 100);
        return null;
      }

      event.preventDefault();

      if (data) {
        ViewUtils.runOperationShowingMessage(gettext('Saving'), function () {
          return xblockInfo.save(data);
        }).done(function () {
          self.onSave();
        });
      }

      return null;
    },
    onSave: function onSave() {
      var refresh = this.editOptions.refresh;
      this.hide();

      if (refresh) {
        refresh(this.xblockInfo);
      }
    },
    hide: function hide() {
      // Notify child views to stop listening events
      Backbone.trigger('xblock:editorModalHidden');
      BaseModal.prototype.hide.call(this); // Notify the runtime that the modal has been hidden

      this.editorView.notifyRuntime('modal-hidden');
    },
    addModeButton: function addModeButton(mode, displayName) {
      var buttonPanel = this.$('.editor-modes'); // xss-lint: disable=javascript-jquery-append

      buttonPanel.append(this.editorModeButtonTemplate({
        mode: mode,
        displayName: displayName
      }));
    },
    clickTitleButton: function clickTitleButton(event) {
      var self = this,
          oldTitle = this.xblockInfo.get('display_name'),
          titleElt = this.$('.modal-window-title'),
          $input = $('<input type="text" size="40" />'),
          changeFunc = function changeFunc(evt) {
        var newTitle = $(evt.target).val();

        if (oldTitle !== newTitle) {
          self.xblockInfo.set('display_name', newTitle);
          self.xblockInfo.save({
            metadata: {
              display_name: newTitle
            }
          });
        }

        self.createTitleEditor(self.getTitle());
        return true;
      };

      event.preventDefault();
      $input.val(oldTitle);
      $input.change(changeFunc).blur(changeFunc);
      titleElt.html($input); // xss-lint: disable=javascript-jquery-html

      $input.focus().select();
      $(event.target).remove();
      return true;
    }
  });
  return EditXBlockModal;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/module_edit.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function () {
  'use strict';

  var __hasProp = {}.hasOwnProperty,
      __extends = function __extends(child, parent) {
    var key;

    for (key in parent) {
      if (__hasProp.call(parent, key)) {
        child[key] = parent[key];
      }
    }

    function Ctor() {
      this.constructor = child;
    }

    Ctor.prototype = parent.prototype;
    child.prototype = new Ctor();
    child.__super__ = parent.prototype;
    return child;
  };

  !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./common/static/common/js/xblock/runtime.v1.js"), __webpack_require__("./cms/static/js/views/xblock.js"), __webpack_require__("./cms/static/js/views/modals/edit_xblock.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, XBlock, XBlockView, EditXBlockModal) {
    var ModuleEdit = function (_super) {
      __extends(ModuleEdit, _super);

      function ModuleEdit() {
        return ModuleEdit.__super__.constructor.apply(this, arguments);
      }

      ModuleEdit.prototype.tagName = 'li';
      ModuleEdit.prototype.className = 'component';
      ModuleEdit.prototype.editorMode = 'editor-mode';
      ModuleEdit.prototype.events = {
        'click .edit-button': 'clickEditButton',
        'click .delete-button': 'onDelete'
      };

      ModuleEdit.prototype.initialize = function () {
        this.onDelete = this.options.onDelete;
        return this.render();
      };

      ModuleEdit.prototype.loadDisplay = function () {
        var xblockElement;
        xblockElement = this.$el.find('.xblock-student_view');

        if (xblockElement.length > 0) {
          return XBlock.initializeBlock(xblockElement);
        }
      };

      ModuleEdit.prototype.createItem = function (parent, payload, callback) {
        var _this = this;

        if (_.isNull(callback)) {
          callback = function callback() {};
        }

        payload.parent_locator = parent;
        return $.postJSON(this.model.urlRoot + '/', payload, function (data) {
          _this.model.set({
            id: data.locator
          });

          _this.$el.data('locator', data.locator);

          _this.$el.data('courseKey', data.courseKey);

          return _this.render();
        }).success(callback);
      };

      ModuleEdit.prototype.loadView = function (viewName, target, callback) {
        var _this = this;

        if (this.model.id) {
          return $.ajax({
            url: '' + decodeURIComponent(this.model.url()) + '/' + viewName,
            type: 'GET',
            cache: false,
            headers: {
              Accept: 'application/json'
            },
            success: function success(fragment) {
              return _this.renderXBlockFragment(fragment, target).done(callback);
            }
          });
        }
      };

      ModuleEdit.prototype.render = function () {
        var _this = this;

        return this.loadView('student_view', this.$el, function () {
          _this.loadDisplay();

          return _this.delegateEvents();
        });
      };

      ModuleEdit.prototype.clickEditButton = function (event) {
        var modal;
        event.preventDefault();
        modal = new EditXBlockModal();
        return modal.edit(this.$el, this.model, {
          refresh: _.bind(this.render, this)
        });
      };

      return ModuleEdit;
    }(XBlockView);

    return ModuleEdit;
  }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
}).call(this);

/***/ }),

/***/ "./cms/static/js/views/tabs.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* globals analytics, course_location_analytics */
(function (analytics, course_location_analytics) {
  'use strict';

  var __hasProp = {}.hasOwnProperty,
      __extends = function __extends(child, parent) {
    var key;

    for (key in parent) {
      if (__hasProp.call(parent, key)) {
        child[key] = parent[key];
      }
    }

    function Ctor() {
      this.constructor = child;
    }

    Ctor.prototype = parent.prototype;
    child.prototype = new Ctor();
    child.__super__ = parent.prototype;
    return child;
  };

  !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1), __webpack_require__(0), __webpack_require__("./common/static/js/vendor/jquery-ui.min.js"), __webpack_require__(2), __webpack_require__("./common/static/common/js/components/views/feedback_prompt.js"), __webpack_require__("./common/static/common/js/components/views/feedback_notification.js"), __webpack_require__("./cms/static/js/views/module_edit.js"), __webpack_require__("./cms/static/js/models/module_info.js"), __webpack_require__("./cms/static/js/utils/module.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function (_, $, ui, Backbone, PromptView, NotificationView, ModuleEditView, ModuleModel, ModuleUtils) {
    var TabsEdit;

    TabsEdit = function (_super) {
      __extends(TabsEdit, _super);

      function TabsEdit() {
        var self = this;

        this.deleteTab = function () {
          return TabsEdit.prototype.deleteTab.apply(self, arguments);
        };

        this.addNewTab = function () {
          return TabsEdit.prototype.addNewTab.apply(self, arguments);
        };

        this.tabMoved = function () {
          return TabsEdit.prototype.tabMoved.apply(self, arguments);
        };

        this.toggleVisibilityOfTab = function () {
          return TabsEdit.prototype.toggleVisibilityOfTab.apply(self, arguments);
        };

        this.initialize = function () {
          return TabsEdit.prototype.initialize.apply(self, arguments);
        };

        return TabsEdit.__super__.constructor.apply(this, arguments);
      }

      TabsEdit.prototype.initialize = function (options) {
        var self = this;
        this.$('.component').each(function (idx, element) {
          var model;
          model = new ModuleModel({
            id: $(element).data('locator')
          });
          return new ModuleEditView({
            el: element,
            onDelete: self.deleteTab,
            model: model
          });
        });
        this.options = _.extend({}, options);
        this.options.mast.find('.new-tab').on('click', this.addNewTab);
        $('.add-pages .new-tab').on('click', this.addNewTab);
        $('.toggle-checkbox').on('click', this.toggleVisibilityOfTab);
        return this.$('.course-nav-list').sortable({
          handle: '.drag-handle',
          update: this.tabMoved,
          helper: 'clone',
          opacity: '0.5',
          placeholder: 'component-placeholder',
          forcePlaceholderSize: true,
          axis: 'y',
          items: '> .is-movable'
        });
      };

      TabsEdit.prototype.toggleVisibilityOfTab = function (event) {
        var checkbox_element, saving, tab_element;
        checkbox_element = event.target;
        tab_element = $(checkbox_element).parents('.course-tab')[0];
        saving = new NotificationView.Mini({
          title: gettext('Saving')
        });
        saving.show();
        return $.ajax({
          type: 'POST',
          url: this.model.url(),
          data: JSON.stringify({
            tab_id_locator: {
              tab_id: $(tab_element).data('tab-id'),
              tab_locator: $(tab_element).data('locator')
            },
            is_hidden: $(checkbox_element).is(':checked')
          }),
          contentType: 'application/json'
        }).success(function () {
          return saving.hide();
        });
      };

      TabsEdit.prototype.tabMoved = function () {
        var saving, tabs;
        tabs = [];
        this.$('.course-tab').each(function (idx, element) {
          return tabs.push({
            tab_id: $(element).data('tab-id'),
            tab_locator: $(element).data('locator')
          });
        });
        analytics.track('Reordered Pages', {
          course: course_location_analytics
        });
        saving = new NotificationView.Mini({
          title: gettext('Saving')
        });
        saving.show();
        return $.ajax({
          type: 'POST',
          url: this.model.url(),
          data: JSON.stringify({
            tabs: tabs
          }),
          contentType: 'application/json'
        }).success(function () {
          return saving.hide();
        });
      };

      TabsEdit.prototype.addNewTab = function (event) {
        var editor;
        event.preventDefault();
        editor = new ModuleEditView({
          onDelete: this.deleteTab,
          model: new ModuleModel()
        });
        $('.new-component-item').before(editor.$el);
        editor.$el.addClass('course-tab is-movable');
        editor.$el.addClass('new');
        setTimeout(function () {
          return editor.$el.removeClass('new');
        }, 1000);
        $('html, body').animate({
          scrollTop: $('.new-component-item').offset().top
        }, 500);
        editor.createItem(this.model.get('id'), {
          category: 'static_tab'
        });
        return analytics.track('Added Page', {
          course: course_location_analytics
        });
      };

      TabsEdit.prototype.deleteTab = function (event) {
        var confirm;
        confirm = new PromptView.Warning({
          title: gettext('Delete Page Confirmation'),
          message: gettext('Are you sure you want to delete this page? This action cannot be undone.'),
          actions: {
            primary: {
              text: gettext('OK'),
              click: function click(view) {
                var $component, deleting;
                view.hide();
                $component = $(event.currentTarget).parents('.component');
                analytics.track('Deleted Page', {
                  course: course_location_analytics,
                  id: $component.data('locator')
                });
                deleting = new NotificationView.Mini({
                  title: gettext('Deleting')
                });
                deleting.show();
                return $.ajax({
                  type: 'DELETE',
                  url: ModuleUtils.getUpdateUrl($component.data('locator'))
                }).success(function () {
                  $component.remove();
                  return deleting.hide();
                });
              }
            },
            secondary: [{
              text: gettext('Cancel'),
              click: function click(view) {
                return view.hide();
              }
            }]
          }
        });
        return confirm.show();
      };

      return TabsEdit;
    }(Backbone.View);

    return TabsEdit;
  }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
}).call(this, analytics, course_location_analytics);

/***/ }),

/***/ "./cms/static/js/views/uploads.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./cms/static/js/views/modals/base_modal.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js"), __webpack_require__("./common/static/js/vendor/jquery.form.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, BaseModal, HtmlUtils) {
  'use strict';

  var UploadDialog = BaseModal.extend({
    events: _.extend({}, BaseModal.prototype.events, {
      'change input[type=file]': 'selectFile',
      'click .action-upload': 'upload'
    }),
    options: $.extend({}, BaseModal.prototype.options, {
      modalName: 'assetupload',
      modalSize: 'med',
      successMessageTimeout: 2000,
      // 2 seconds
      viewSpecificClasses: 'confirm'
    }),
    initialize: function initialize(options) {
      BaseModal.prototype.initialize.call(this);
      this.template = this.loadTemplate('upload-dialog');
      this.listenTo(this.model, 'change', this.renderContents);
      this.options.title = this.model.get('title'); // `uploadData` can contain extra data that
      // can be POSTed along with the file.

      this.uploadData = _.extend({}, options.uploadData);
    },
    addActionButtons: function addActionButtons() {
      this.addActionButton('upload', gettext('Upload'), true);
      BaseModal.prototype.addActionButtons.call(this);
    },
    renderContents: function renderContents() {
      var isValid = this.model.isValid(),
          selectedFile = this.model.get('selectedFile'),
          oldInput = this.$('input[type=file]');
      BaseModal.prototype.renderContents.call(this); // Ideally, we'd like to tell the browser to pre-populate the
      // <input type="file"> with the selectedFile if we have one -- but
      // browser security prohibits that. So instead, we'll swap out the
      // new input (that has no file selected) with the old input (that
      // already has the selectedFile selected). However, we only want to do
      // this if the selected file is valid: if it isn't, we want to render
      // a blank input to prompt the user to upload a different (valid) file.

      if (selectedFile && isValid) {
        $(oldInput).removeClass('error');
        this.$('input[type=file]').replaceWith(HtmlUtils.HTML(oldInput).toString());
        this.$('.action-upload').removeClass('disabled');
      } else {
        this.$('.action-upload').addClass('disabled');
      }

      return this;
    },
    getContentHtml: function getContentHtml() {
      return this.template({
        url: this.options.url || CMS.URL.UPLOAD_ASSET,
        message: this.model.get('message'),
        selectedFile: this.model.get('selectedFile'),
        uploading: this.model.get('uploading'),
        uploadedBytes: this.model.get('uploadedBytes'),
        totalBytes: this.model.get('totalBytes'),
        finished: this.model.get('finished'),
        error: this.model.validationError
      });
    },
    selectFile: function selectFile(e) {
      var selectedFile = e.target.files[0] || null;
      this.model.set({
        selectedFile: selectedFile
      }); // This change event triggering necessary for FireFox, because the browser don't
      // consider change of File object (file input field) as a change in model.

      if (selectedFile && $.isEmptyObject(this.model.changed)) {
        this.model.trigger('change');
      }
    },
    upload: function upload(e) {
      var uploadAjaxData = _.extend({}, this.uploadData); // don't show the generic error notification; we're in a modal,
      // and we're better off modifying it instead.


      uploadAjaxData.notifyOnError = false;

      if (e && e.preventDefault) {
        e.preventDefault();
      }

      this.model.set('uploading', true);
      this.$('form').ajaxSubmit({
        success: _.bind(this.success, this),
        error: _.bind(this.error, this),
        uploadProgress: _.bind(this.progress, this),
        data: uploadAjaxData
      });
    },
    progress: function progress(event, position, total) {
      this.model.set({
        uploadedBytes: position,
        totalBytes: total
      });
    },
    success: function success(response, statusText, xhr, form) {
      this.model.set({
        uploading: false,
        finished: true
      });

      if (this.options.onSuccess) {
        this.options.onSuccess(response, statusText, xhr, form);
      }

      var that = this;
      this.removalTimeout = setTimeout(function () {
        that.hide();
      }, this.options.successMessageTimeout);
    },
    error: function error() {
      this.model.set({
        uploading: false,
        uploadedBytes: 0,
        title: gettext("We're sorry, there was an error")
      });
    }
  });
  return UploadDialog;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end define()

/***/ }),

/***/ "./cms/static/js/views/utils/xblock_utils.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Provides utilities for views to work with xblocks.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./common/static/common/js/components/utils/view_utils.js"), __webpack_require__("./cms/static/js/utils/module.js"), __webpack_require__("./cms/static/js/models/xblock_info.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/string-utils.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, ViewUtils, ModuleUtils, XBlockInfo, StringUtils) {
  'use strict';

  var addXBlock, duplicateXBlock, deleteXBlock, createUpdateRequestData, updateXBlockField, VisibilityState, getXBlockVisibilityClass, getXBlockListTypeClass, updateXBlockFields, getXBlockType, findXBlockInfo, moveXBlock;
  /**
   * Represents the possible visibility states for an xblock:
   *
   *   live - the block and all of its descendants are live to students (excluding staff only)
   *     Note: Live means both published and released.
   *
   *   ready - the block is ready to go live and all of its descendants are live or ready (excluding staff only)
   *     Note: content is ready when it is published and scheduled with a release date in the future.
   *
   *   unscheduled - the block and all of its descendants have no release date (excluding staff only)
   *     Note: it is valid for items to be published with no release date in which case they are unscheduled.
   *
   *   needsAttention - the block or its descendants need attention
   *     i.e. there is some content that is not fully live, ready, unscheduled or staff only.
   *     For example: one subsection has draft content, or there's both unreleased and released content
   *     in one section.
   *
   *   staffOnly - all of the block's content is to be shown to staff only
   *     Note: staff only items do not affect their parent's state.
   */

  VisibilityState = {
    live: 'live',
    ready: 'ready',
    unscheduled: 'unscheduled',
    needsAttention: 'needs_attention',
    staffOnly: 'staff_only',
    gated: 'gated'
  };
  /**
   * Adds an xblock based upon the data attributes of the specified add button. A promise
   * is returned, and the new locator is passed to all done handlers.
   * @param target The add button that was clicked upon.
   * @returns {jQuery promise} A promise representing the addition of the xblock.
   */

  addXBlock = function addXBlock(target) {
    var parentLocator = target.data('parent'),
        category = target.data('category'),
        displayName = target.data('default-name');
    return ViewUtils.runOperationShowingMessage(gettext('Adding'), function () {
      var addOperation = $.Deferred();
      analytics.track('Created a ' + category, {
        course: course_location_analytics,
        display_name: displayName
      });
      $.postJSON(ModuleUtils.getUpdateUrl(), {
        parent_locator: parentLocator,
        category: category,
        display_name: displayName
      }, function (data) {
        var locator = data.locator;
        addOperation.resolve(locator);
      });
      return addOperation.promise();
    });
  };
  /**
   * Duplicates the specified xblock element in its parent xblock.
   * @param {jquery Element}  xblockElement  The xblock element to be duplicated.
   * @param {jquery Element}  parentElement  Parent element of the xblock element to be duplicated,
   *      new duplicated xblock would be placed under this xblock.
   * @returns {jQuery promise} A promise representing the duplication of the xblock.
   */


  duplicateXBlock = function duplicateXBlock(xblockElement, parentElement) {
    return ViewUtils.runOperationShowingMessage(gettext('Duplicating'), function () {
      var duplicationOperation = $.Deferred();
      $.postJSON(ModuleUtils.getUpdateUrl(), {
        duplicate_source_locator: xblockElement.data('locator'),
        parent_locator: parentElement.data('locator')
      }, function (data) {
        duplicationOperation.resolve(data);
      }).fail(function () {
        duplicationOperation.reject();
      });
      return duplicationOperation.promise();
    });
  };
  /**
   * Moves the specified xblock in a new parent xblock.
   * @param {String}  sourceLocator  Locator of xblock element to be moved.
   * @param {String}  targetParentLocator  Locator of the target parent xblock, moved xblock would be placed
   *      under this xblock.
   * @param {Integer}  targetIndex  Intended index position of the xblock in parent xblock. If provided,
   *      xblock would be placed at the particular index in the parent xblock.
   * @returns {jQuery promise} A promise representing the moving of the xblock.
   */


  moveXBlock = function moveXBlock(sourceLocator, targetParentLocator, targetIndex) {
    var moveOperation = $.Deferred(),
        operationText = targetIndex !== undefined ? gettext('Undo moving') : gettext('Moving');
    return ViewUtils.runOperationShowingMessage(operationText, function () {
      $.patchJSON(ModuleUtils.getUpdateUrl(), {
        move_source_locator: sourceLocator,
        parent_locator: targetParentLocator,
        target_index: targetIndex
      }, function (response) {
        moveOperation.resolve(response);
      }).fail(function () {
        moveOperation.reject();
      });
      return moveOperation.promise();
    });
  };
  /**
   * Deletes the specified xblock.
   * @param xblockInfo The model for the xblock to be deleted.
   * @param xblockType A string representing the type of the xblock to be deleted.
   * @returns {jQuery promise} A promise representing the deletion of the xblock.
   */


  deleteXBlock = function deleteXBlock(xblockInfo, xblockType) {
    var deletion = $.Deferred(),
        url = ModuleUtils.getUpdateUrl(xblockInfo.id),
        operation = function operation() {
      ViewUtils.runOperationShowingMessage(gettext('Deleting'), function () {
        return $.ajax({
          type: 'DELETE',
          url: url
        }).success(function () {
          deletion.resolve();
        });
      });
    },
        messageBody;

    xblockType = xblockType || 'component'; // eslint-disable-line no-param-reassign

    messageBody = StringUtils.interpolate(gettext('Deleting this {xblock_type} is permanent and cannot be undone.'), {
      xblock_type: xblockType
    }, true);

    if (xblockInfo.get('is_prereq')) {
      messageBody += ' ' + gettext('Any content that has listed this content as a prerequisite will also have access limitations removed.'); // eslint-disable-line max-len

      ViewUtils.confirmThenRunOperation(StringUtils.interpolate(gettext('Delete this {xblock_type} (and prerequisite)?'), {
        xblock_type: xblockType
      }, true), messageBody, StringUtils.interpolate(gettext('Yes, delete this {xblock_type}'), {
        xblock_type: xblockType
      }, true), operation);
    } else {
      ViewUtils.confirmThenRunOperation(StringUtils.interpolate(gettext('Delete this {xblock_type}?'), {
        xblock_type: xblockType
      }, true), messageBody, StringUtils.interpolate(gettext('Yes, delete this {xblock_type}'), {
        xblock_type: xblockType
      }, true), operation);
    }

    return deletion.promise();
  };

  createUpdateRequestData = function createUpdateRequestData(fieldName, newValue) {
    var metadata = {};
    metadata[fieldName] = newValue;
    return {
      metadata: metadata
    };
  };
  /**
   * Updates the specified field of an xblock to a new value.
   * @param {Backbone Model} xblockInfo The XBlockInfo model representing the xblock.
   * @param {String} fieldName The xblock field name to be updated.
   * @param {*} newValue The new value for the field.
   * @returns {jQuery promise} A promise representing the updating of the field.
   */


  updateXBlockField = function updateXBlockField(xblockInfo, fieldName, newValue) {
    var requestData = createUpdateRequestData(fieldName, newValue);
    return ViewUtils.runOperationShowingMessage(gettext('Saving'), function () {
      return xblockInfo.save(requestData, {
        patch: true
      });
    });
  };
  /**
   * Updates the specified fields of an xblock to a new values.
   * @param {Backbone Model} xblockInfo The XBlockInfo model representing the xblock.
   * @param {Object} xblockData Object representing xblock data as accepted on server.
   * @param {Object} [options] Hash with options.
   * @returns {jQuery promise} A promise representing the updating of the xblock values.
   */


  updateXBlockFields = function updateXBlockFields(xblockInfo, xblockData, options) {
    options = _.extend({}, {
      patch: true
    }, options);
    return ViewUtils.runOperationShowingMessage(gettext('Saving'), function () {
      return xblockInfo.save(xblockData, options);
    });
  };
  /**
   * Returns the CSS class to represent the specified xblock visibility state.
   */


  getXBlockVisibilityClass = function getXBlockVisibilityClass(visibilityState) {
    if (visibilityState === VisibilityState.staffOnly) {
      return 'is-staff-only';
    }

    if (visibilityState === VisibilityState.gated) {
      return 'is-gated';
    }

    if (visibilityState === VisibilityState.live) {
      return 'is-live';
    }

    if (visibilityState === VisibilityState.ready) {
      return 'is-ready';
    }

    if (visibilityState === VisibilityState.needsAttention) {
      return 'has-warnings';
    }

    return '';
  };

  getXBlockListTypeClass = function getXBlockListTypeClass(xblockType) {
    var listType = 'list-unknown';

    if (xblockType === 'course') {
      listType = 'list-sections';
    } else if (xblockType === 'section') {
      listType = 'list-subsections';
    } else if (xblockType === 'subsection') {
      listType = 'list-units';
    }

    return listType;
  };

  getXBlockType = function getXBlockType(category, parentInfo, translate) {
    var xblockType = category;

    if (category === 'chapter') {
      xblockType = translate ? gettext('section') : 'section';
    } else if (category === 'sequential') {
      xblockType = translate ? gettext('subsection') : 'subsection';
    } else if (category === 'vertical' && (!parentInfo || parentInfo.get('category') === 'sequential')) {
      xblockType = translate ? gettext('unit') : 'unit';
    }

    return xblockType;
  };

  findXBlockInfo = function findXBlockInfo(xblockWrapperElement, defaultXBlockInfo) {
    var xblockInfo = defaultXBlockInfo,
        xblockElement,
        displayName,
        hasChildren;

    if (xblockWrapperElement.length > 0) {
      xblockElement = xblockWrapperElement.find('.xblock');
      displayName = xblockWrapperElement.find('.xblock-header .header-details .xblock-display-name').text().trim(); // If not found, try looking for the old unit page style rendering.
      // Only used now by static pages.

      if (!displayName) {
        displayName = xblockElement.find('.component-header').text().trim();
      }

      hasChildren = defaultXBlockInfo ? defaultXBlockInfo.get('has_children') : false;
      xblockInfo = new XBlockInfo({
        id: xblockWrapperElement.data('locator'),
        courseKey: xblockWrapperElement.data('course-key'),
        category: xblockElement.data('block-type'),
        display_name: displayName,
        has_children: hasChildren
      });
    }

    return xblockInfo;
  };

  return {
    VisibilityState: VisibilityState,
    addXBlock: addXBlock,
    moveXBlock: moveXBlock,
    duplicateXBlock: duplicateXBlock,
    deleteXBlock: deleteXBlock,
    updateXBlockField: updateXBlockField,
    getXBlockVisibilityClass: getXBlockVisibilityClass,
    getXBlockListTypeClass: getXBlockListTypeClass,
    updateXBlockFields: updateXBlockFields,
    getXBlockType: getXBlockType,
    findXBlockInfo: findXBlockInfo
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/video/transcripts/file_uploader.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(2), __webpack_require__(1), __webpack_require__("./cms/static/js/views/video/transcripts/utils.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, Backbone, _, TranscriptUtils, HtmlUtils) {
  'use strict';

  var FileUploader = Backbone.View.extend({
    invisibleClass: 'is-invisible',
    // Pre-defined list of supported file formats.
    validFileExtensions: ['srt'],
    events: {
      'change .file-input': 'changeHandler',
      'click .setting-upload': 'clickHandler'
    },
    uploadTpl: '#file-upload',
    initialize: function initialize(options) {
      _.bindAll(this, 'changeHandler', 'clickHandler', 'xhrResetProgressBar', 'xhrProgressHandler', 'xhrCompleteHandler', 'render');

      this.options = _.extend({}, options);
      this.file = false;
      this.render();
    },
    render: function render() {
      var tpl = $(this.uploadTpl).text(),
          tplContainer = this.$el.find('.transcripts-file-uploader');

      if (tplContainer.length) {
        if (!tpl) {
          console.error('Couldn\'t load Transcripts File Upload template');
          return;
        }

        this.template = HtmlUtils.template(tpl);
        HtmlUtils.setHtml(tplContainer, this.template({
          ext: this.validFileExtensions,
          component_locator: this.options.component_locator
        }));
        this.$form = this.$el.find('.file-chooser');
        this.$input = this.$form.find('.file-input');
        this.$progress = this.$el.find('.progress-fill');
      }
    },

    /**
    * @function
    *
    * Uploads file to the server. Get file from the `file` property.
    *
    */
    upload: function upload() {
      var data = {
        edx_video_id: TranscriptUtils.Storage.get('edx_video_id') || ''
      };

      if (!this.file) {
        return;
      }

      this.$form.ajaxSubmit({
        beforeSend: this.xhrResetProgressBar,
        uploadProgress: this.xhrProgressHandler,
        complete: this.xhrCompleteHandler,
        data: data
      });
    },

    /**
    * @function
    *
    * Handle click event on `upload` button.
    *
    * @param {object} event Event object.
    *
    */
    clickHandler: function clickHandler(event) {
      event.preventDefault();
      this.$input.val(null) // Show system upload window
      .trigger('click');
    },

    /**
    * @function
    *
    * Handle change event.
    *
    * @param {object} event Event object.
    *
    */
    changeHandler: function changeHandler(event) {
      event.preventDefault();
      this.options.messenger.hideError();
      this.file = this.$input.get(0).files[0]; // if file has valid file extension, than upload file.
      // Otherwise, show error message.

      if (this.checkExtValidity(this.file)) {
        this.upload();
      } else {
        this.options.messenger.showError(gettext('Please select a file in .srt format.'));
      }
    },

    /**
    * @function
    *
    * Checks that file has supported extension.
    *
    * @param {object} file Object with information about file.
    *
    * @returns {boolean} Indicate that file has supported or unsupported
    *                    extension.
    *
    */
    checkExtValidity: function checkExtValidity(file) {
      var fileExtension;

      if (!file.name) {
        return void 0;
      }

      fileExtension = file.name.split('.').pop().toLowerCase();

      if ($.inArray(fileExtension, this.validFileExtensions) !== -1) {
        return true;
      }

      return false;
    },

    /**
    * @function
    *
    * Resets progress bar.
    *
    */
    xhrResetProgressBar: function xhrResetProgressBar() {
      var percentVal = '0%';
      this.$progress.width(percentVal).text(percentVal).removeClass(this.invisibleClass);
    },

    /**
    * @function
    *
    * Callback function to be invoked with upload progress information
    * (if supported by the browser).
    *
    * @param {object} event Event object.
    *
    * @param {integer} position Amount of transmitted bytes.
    * *
    * @param {integer} total Total size of file.
    * *
    * @param {integer} percentComplete Object with information about file.
    *
    */
    xhrProgressHandler: function xhrProgressHandler(event, position, total, percentComplete) {
      var percentVal = percentComplete + '%';
      this.$progress.width(percentVal).text(percentVal);
    },

    /**
    * @function
    *
    * Handle complete uploading.
    *
    */
    xhrCompleteHandler: function xhrCompleteHandler(xhr) {
      var resp = JSON.parse(xhr.responseText),
          err = resp.status || gettext('Error: Uploading failed.'),
          edxVideoId = resp.edx_video_id;
      this.$progress.addClass(this.invisibleClass);

      if (xhr.status === 200) {
        this.options.messenger.render('uploaded', resp);
        Backbone.trigger('transcripts:basicTabUpdateEdxVideoId', edxVideoId);
      } else {
        this.options.messenger.showError(err);
      }
    }
  });
  return FileUploader;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/video/transcripts/message_manager.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(__webpack_provided_edx_dot_HtmlUtils) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(2), __webpack_require__(1), __webpack_require__("./cms/static/js/views/video/transcripts/utils.js"), __webpack_require__("./cms/static/js/views/video/transcripts/file_uploader.js"), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, Backbone, _, Utils, FileUploader, gettext) {
  var MessageManager = Backbone.View.extend({
    tagName: 'div',
    elClass: '.wrapper-transcripts-message',
    invisibleClass: 'is-invisible',
    events: {
      'click .setting-import': 'importHandler',
      'click .setting-replace': 'replaceHandler',
      'click .setting-choose': 'chooseHandler',
      'click .setting-use-existing': 'useExistingHandler'
    },
    // Pre-defined dict with anchors to status templates.
    templates: {
      not_found: '#transcripts-not-found',
      found: '#transcripts-found',
      "import": '#transcripts-import',
      replace: '#transcripts-replace',
      uploaded: '#transcripts-uploaded',
      use_existing: '#transcripts-use-existing',
      choose: '#transcripts-choose'
    },
    initialize: function initialize(options) {
      _.bindAll(this, 'importHandler', 'replaceHandler', 'chooseHandler', 'useExistingHandler', 'showError', 'hideError');

      this.options = _.extend({}, options);
      this.component_locator = this.$el.closest('[data-locator]').data('locator');
      this.fileUploader = new FileUploader({
        el: this.$el,
        messenger: this,
        component_locator: this.component_locator
      });
    },
    render: function render(template_id, params) {
      var tplHtml = $(this.templates[template_id]).text(),
          videoList = this.options.parent.getVideoObjectsList(),
          // Change list representation format to more convenient and group
      // them by video property.
      //                  Before:
      // [
      //      {mode: `html5`, type: `mp4`, video: `video_name_1`},
      //      {mode: `html5`, type: `webm`, video: `video_name_2`}
      // ]
      //                  After:
      // {
      //      `video_name_1`: [{mode: `html5`, type: `webm`, ...}],
      //      `video_name_2`: [{mode: `html5`, type: `mp4`, ...}]
      // }
      groupedList = _.groupBy(videoList, function (value) {
        return value.video;
      }),
          html5List = params ? params.html5_local : [],
          template;

      if (!tplHtml) {
        console.error('Couldn\'t load Transcripts status template');
        return this;
      }

      template = __webpack_provided_edx_dot_HtmlUtils.template(tplHtml);
      __webpack_provided_edx_dot_HtmlUtils.setHtml(this.$el.find('.transcripts-status').removeClass('is-invisible').find(this.elClass), template({
        component_locator: encodeURIComponent(this.component_locator),
        html5_list: html5List,
        grouped_list: groupedList,
        subs_id: params ? params.subs : ''
      }));
      this.fileUploader.render();
      return this;
    },

    /**
    * @function
    *
    * Shows error message.
    *
    * @param {string} err Error message that will be shown
    *
    * @param {boolean} hideButtons Hide buttons
    *
    */
    showError: function showError(err, hideButtons) {
      var $error = this.$el.find('.transcripts-error-message');

      if (err) {
        // Hide any other error messages.
        this.hideError();
        __webpack_provided_edx_dot_HtmlUtils.setHtml($error, gettext(err)).removeClass(this.invisibleClass);

        if (hideButtons) {
          this.$el.find('.wrapper-transcripts-buttons').addClass(this.invisibleClass);
        }
      }
    },

    /**
    * @function
    *
    * Hides error message.
    *
    */
    hideError: function hideError() {
      this.$el.find('.transcripts-error-message').addClass(this.invisibleClass);
      this.$el.find('.wrapper-transcripts-buttons').removeClass(this.invisibleClass);
    },

    /**
    * @function
    *
    * Handle import button.
    *
    * @params {object} event Event object.
    *
    */
    importHandler: function importHandler(event) {
      event.preventDefault();
      this.processCommand('replace', gettext('Error: Import failed.'));
    },

    /**
    * @function
    *
    * Handle replace button.
    *
    * @params {object} event Event object.
    *
    */
    replaceHandler: function replaceHandler(event) {
      event.preventDefault();
      this.processCommand('replace', gettext('Error: Replacing failed.'));
    },

    /**
    * @function
    *
    * Handle choose buttons.
    *
    * @params {object} event Event object.
    *
    */
    chooseHandler: function chooseHandler(event) {
      event.preventDefault();
      var videoId = $(event.currentTarget).data('video-id');
      this.processCommand('choose', gettext('Error: Choosing failed.'), videoId);
    },

    /**
    * @function
    *
    * Handle `use existing` button.
    *
    * @params {object} event Event object.
    *
    */
    useExistingHandler: function useExistingHandler(event) {
      event.preventDefault();
      this.processCommand('rename', gettext('Error: Choosing failed.'));
    },

    /**
    * @function
    *
    * Decorator for `command` function in the Utils.
    *
    * @params {string} action Action that will be invoked on server. Is a part
    *                         of url.
    *
    * @params {string} errorMessage Error massage that will be shown if any
    *                               connection error occurs
    *
    * @params {string} videoId Extra parameter that sometimes should be sent
    *                          to the server
    *
    */
    processCommand: function processCommand(action, errorMessage, videoId) {
      var self = this,
          component_locator = this.component_locator,
          videoList = this.options.parent.getVideoObjectsList(),
          extraParam,
          xhr;

      if (videoId) {
        extraParam = {
          html5_id: videoId
        };
      }

      xhr = Utils.command(action, component_locator, videoList, extraParam).done(function (resp) {
        var edxVideoID = resp.edx_video_id;
        self.render('found', resp);
        Backbone.trigger('transcripts:basicTabUpdateEdxVideoId', edxVideoID);
      }).fail(function (resp) {
        var message = resp.status || errorMessage;
        self.showError(message);
      });
      return xhr;
    }
  });
  return MessageManager;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js")))

/***/ }),

/***/ "./cms/static/js/views/video/transcripts/metadata_videolist.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(2), __webpack_require__(1), __webpack_require__("./cms/static/js/views/abstract_editor.js"), __webpack_require__("./cms/static/js/views/video/transcripts/utils.js"), __webpack_require__("./cms/static/js/views/video/transcripts/message_manager.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, Backbone, _, AbstractEditor, Utils, MessageManager) {
  'use strict';

  var VideoList = AbstractEditor.extend({
    // Time that we wait since the last time user typed.
    inputDelay: 300,
    events: {
      'click .setting-clear': 'clear',
      'keypress .setting-input': 'showClearButton',
      'click .collapse-setting': 'toggleExtraVideosBar'
    },
    templateName: 'metadata-videolist-entry',
    // Pre-defined dict of placeholders: "videoType - placeholder" pairs.
    placeholders: {
      webm: '.webm',
      mp4: 'http://somesite.com/video.mp4',
      youtube: 'http://youtube.com/'
    },
    initialize: function initialize(options) {
      // Initialize MessageManager that is responsible for
      // status messages and errors.
      this.options = _.extend({}, options);
      var Messenger = this.options.MessageManager || MessageManager;
      this.messenger = new Messenger({
        el: this.$el,
        parent: this
      }); // Call it after MessageManager. This is because
      // MessageManager is used in `render` method that
      // is called in `AbstractEditor.prototype.initialize`.

      AbstractEditor.prototype.initialize.apply(this, arguments);
      this.$el.on('input', '.videolist-settings-item input', _.debounce(_.bind(this.inputHandler, this), this.inputDelay));
      this.component_locator = this.$el.closest('[data-locator]').data('locator');
    },
    render: function render() {
      // Call inherited `render` method.
      AbstractEditor.prototype.render.apply(this, arguments);
      this.$extraVideosBar = this.$el.find('.videolist-extra-videos'); // Check current state of Timed Transcripts.

      Backbone.trigger('transcripts:basicTabFieldChanged');
    },
    updateOnCheckTranscriptSuccess: function updateOnCheckTranscriptSuccess(videoList, response) {
      var params = response,
          len = videoList.length,
          mode = len === 1 ? videoList[0].mode : false; // If there are more than 1 video or just html5 source is
      // passed, video sources box should expand

      if (len > 1 || mode === 'html5') {
        this.openExtraVideosBar();
      } else {
        this.closeExtraVideosBar();
      }

      this.messenger.render(response.command, params);
      this.checkIsUniqVideoTypes();
    },

    /**
     * Updates the message with error.
     */
    showServerError: function showServerError(response) {
      var errorMessage = gettext('Error: Connection with server failed.');

      if (response.responseJSON !== undefined) {
        errorMessage = response.responseJSON.status;
      }

      this.messenger.render('not_found').showError(errorMessage, true // hide buttons
      );
    },

    /**
     * Returns the values currently displayed in the editor/view.
     * @return {Array} List of non-empty values.
     */
    getValueFromEditor: function getValueFromEditor() {
      return _.map(this.$el.find('.input'), function (ele) {
        return ele.value.trim();
      }).filter(_.identity);
    },

    /**
     * Returns list of objects with information about the values currently
     * displayed in the editor/view.
     * @return {Array} List of objects.
     * @examples
     * this.getValueFromEditor(); // =>
     *     [
     *          'http://youtu.be/OEoXaMPEzfM',
     *          'video_name.mp4',
     *          'video_name.webm'
     *     ]
     *
     * this.getVideoObjectsList(); // =>
     *     [
     *       {mode: `youtube`, type: `youtube`, ...},
     *       {mode: `html5`, type: `mp4`, ...},
     *       {mode: `html5`, type: `webm`, ...}
     *     ]
     *
     */
    getVideoObjectsList: function getVideoObjectsList() {
      var links = this.getValueFromEditor();
      return Utils.getVideoList(links);
    },

    /**
     * Sets the values currently displayed in the editor/view.
     * @param {Array} value List of values.
     */
    setValueInEditor: function setValueInEditor(value) {
      var list = this.$el.find('.input'),
          val = value.filter(_.identity),
          placeholders = this.getPlaceholders(val);
      list.each(function (index) {
        $(this).val(val[index] || null).attr('placeholder', placeholders[index]);
      });
    },

    /**
     * Returns the placeholders for the values currently displayed in the
     * editor/view.
     * @return {Array} List of placeholders.
     */
    getPlaceholders: function getPlaceholders(value) {
      var parseLink = Utils.parseLink,
          placeholders = _.clone(this.placeholders); // Returned list should have the same size as a count of editors.


      return _.map(this.$el.find('.input'), function (element, index) {
        var linkInfo = parseLink(value[index]),
            type = linkInfo ? linkInfo.type : null,
            label; // If placeholder for current video type exist, retrieve it
        // and remove from cloned list.
        // Otherwise, we use the remaining placeholders.

        if (placeholders[type]) {
          label = placeholders[type];
          delete placeholders[type];
        } else {
          if (!$.isArray(placeholders)) {
            placeholders = _.values(placeholders);
          }

          label = placeholders.pop();
        }

        return label;
      });
    },

    /**
     * Opens video sources box.
     * @param {Object} event Event object.
     */
    openExtraVideosBar: function openExtraVideosBar(event) {
      if (event && event.preventDefault) {
        event.preventDefault();
      }

      this.$extraVideosBar.addClass('is-visible');
    },

    /**
     * Closes video sources box.
     * @param {Object} event Event object.
     */
    closeExtraVideosBar: function closeExtraVideosBar(event) {
      if (event && event.preventDefault) {
        event.preventDefault();
      }

      this.$extraVideosBar.removeClass('is-visible');
    },

    /**
     * Toggles video sources box.
     * @param {Object} event Event object.
     */
    toggleExtraVideosBar: function toggleExtraVideosBar(event) {
      if (event && event.preventDefault) {
        event.preventDefault();
      }

      if (this.$extraVideosBar.hasClass('is-visible')) {
        this.closeExtraVideosBar.apply(this, arguments);
      } else {
        this.openExtraVideosBar.apply(this, arguments);
      }
    },

    /**
     * Handle `input` event.
     * @param {Object} event Event object.
     */
    inputHandler: function inputHandler(event) {
      if (event && event.preventDefault) {
        event.preventDefault();
      }

      var $el = $(event.currentTarget),
          $inputs = this.$el.find('.input'),
          entry = $el.val(),
          data = Utils.parseLink(entry),
          isNotEmpty = Boolean(entry); // Empty value should not be validated

      if (this.checkValidity(data, isNotEmpty)) {
        var fieldsValue = this.getValueFromEditor(),
            modelValue = this.model.getValue();

        if (modelValue) {
          // Remove empty values
          modelValue = modelValue.filter(_.identity);
        } // When some correct value is adjusted (model is changed),
        // then field changes to incorrect value (no changes to model),
        // then back to previous correct value (that value is already
        // in model). In this case Backbone doesn't trigger 'change'
        // event on model. That's why render method will not be invoked
        // and we should hide error here.


        if (_.isEqual(fieldsValue, modelValue)) {
          this.messenger.hideError();
        } else {
          this.updateModel();
        } // Enable inputs.


        $inputs.prop('disabled', false).attr('aria-disabled', false).removeClass('is-disabled');
      } else {
        // If any error occurs, disable all inputs except the current.
        // User cannot change other inputs before putting valid value in
        // the current input.
        $inputs.not($el).prop('disabled', true).attr('aria-disabled', true).addClass('is-disabled'); // If error occurs in the main video input, just close video
        // sources box.

        if ($el.hasClass('videolist-url')) {
          this.closeExtraVideosBar();
        }
      }
    },

    /**
     * Checks the values currently displayed in the editor/view have unique
     * types (mp4 | webm | youtube).
     * @param {Object} videoList List of objects with information about the
     * @return {Boolean} Boolean value that indicate if video types are
     * unique.
     */
    isUniqVideoTypes: function isUniqVideoTypes(videoList) {
      // Extract a list of "type" property values.
      // => ex: ['webm', 'mp4', 'mp4']
      var arr = _.pluck(videoList, 'type').filter(function (item) {
        return item !== 'other';
      }),
          // Produces a duplicate-free version of the array.
      uniqArr = _.uniq(arr); // => ex: ['webm', 'mp4']


      return arr.length === uniqArr.length;
    },

    /**
     * Checks that links without file format are unique.
     * @param {Object} videoList List of objects with information about the
     * @return {Boolean} Boolean value that indicate if video types are
     * unique.
     */
    isUniqOtherVideos: function isUniqOtherVideos(videoList) {
      // Returns list of video objects with "type" equal "other" or
      // "youtube".
      var otherLinksList = videoList.filter(function (item) {
        return item.type === 'other';
      }),
          // Extract a list of "video" property values.
      namesList = _.pluck(otherLinksList, 'video'),
          // Produces a duplicate-free version of the array.
      uniqNamesList = _.uniq(namesList);

      return namesList.length === uniqNamesList.length;
    },

    /**
     * Validates video list using provided validator.
     * @param {Function} validator Function that validate provided list.
     * @param {Object} list List of objects with information about the
     * values currently displayed in the editor.
     * @param {String} message Error message.
     * @return {Boolean}
     */
    checkIsValid: function checkIsValid(validator, list, message) {
      var videoList = list || this.getVideoObjectsList(),
          isValid = true;

      if (!validator(videoList)) {
        this.messenger.showError(message, true);
        isValid = false;
      }

      return isValid;
    },

    /**
     * Validates if video types are unique.
     * @param {Object} list List of objects with information about the
     * values currently displayed in the editor.
     * @return {Boolean}
     */
    checkIsUniqVideoTypes: function checkIsUniqVideoTypes(list) {
      return this.checkIsValid(this.isUniqVideoTypes, list, gettext('Link types should be unique.'));
    },

    /**
     * Validates if other videos ids are unique.
     * editor/view have duplicate types.
     * @param {Object} list List of objects with information about the
     * values currently displayed in the editor.
     * @return {Boolean}
     */
    checkIsUniqOtherVideos: function checkIsUniqOtherVideos(list) {
      return this.checkIsValid(this.isUniqOtherVideos, list, gettext('Links should be unique.'));
    },

    /**
     * Checks if the values currently displayed in the editor/view have
     * valid values and show error messages.
     * @param {Object} data Objects with information about the  value
     * currently displayed in the editor/view
     * @param {Boolean} showErrorModeMessage Disable mode validation
     * @return {Boolean} Boolean value that indicate if value is valid.
     */
    checkValidity: function checkValidity(data, showErrorModeMessage) {
      var videoList = this.getVideoObjectsList(),
          isUniqTypes = this.checkIsUniqVideoTypes.bind(this),
          isUniqOtherVideos = this.checkIsUniqOtherVideos.bind(this);

      if (!isUniqTypes(videoList) || !isUniqOtherVideos(videoList)) {
        return false;
      }

      if (data.mode === 'incorrect' && showErrorModeMessage) {
        this.messenger.showError(gettext('Incorrect url format.'), true);
        return false;
      }

      return true;
    }
  });
  return VideoList;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/video/transcripts/utils.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/js/vendor/jquery.ajaxQueue.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($) {
  'use strict';

  return function () {
    var Storage = {};
    /**
     * Adds some data to the Storage object. If data with existent `data_id`
     * is added, nothing happens.
     * @function
     * @param {String} data_id Unique identifier for the data.
     * @param {Any} data Data that should be stored.
     * @return {Object} Object itself for chaining.
     */

    Storage.set = function (data_id, data) {
      Storage[data_id] = data;
      return this;
    };
    /**
     * Return data from the Storage object by identifier.
     * @function
     * @param {String} data_id Unique identifier of the data.
     * @return {Any} Stored data.
     */


    Storage.get = function (data_id) {
      return Storage[data_id];
    };
    /**
     * Deletes data from the Storage object by identifier.
     * @function
     * @param {String} data_id Unique identifier of the data.
     * @return {Boolean} Boolean value that indicate if data is removed.
     */


    Storage.remove = function (data_id) {
      return delete Storage[data_id];
    };
    /**
     * Returns model from collection by 'field_name' property.
     * @function
     * @param {Object} collection The model (CMS.Models.Metadata) information
     * about metadata setting editors.
     * @param {String} field_name Name of field that should be found.
     * @return {
     *    Object:        When model exist.
     *    Undefined:     When model doesn't exist.
     * }
     */


    var _getField = function _getField(collection, field_name) {
      var model;

      if (collection && field_name) {
        model = collection.findWhere({
          field_name: field_name
        });
      }

      return model;
    };
    /**
     * Parses Youtube link and return video id.
     * @function
     * These are the types of URLs supported:
     * http://www.youtube.com/watch?v=OEoXaMPEzfM&feature=feedrec_grec_index
     * http://www.youtube.com/user/IngridMichaelsonVEVO#p/a/u/1/OEoXaMPEzfM
     * http://www.youtube.com/v/OEoXaMPEzfM?fs=1&amp;hl=en_US&amp;rel=0
     * http://www.youtube.com/watch?v=OEoXaMPEzfM#t=0m10s
     * http://www.youtube.com/embed/OEoXaMPEzfM?rel=0
     * http://www.youtube.com/watch?v=OEoXaMPEzfM
     * http://youtu.be/OEoXaMPEzfM
     * @param {String} url Url that should be parsed.
     * @return {
     *    String:        Video Id.
     *    Undefined:     When url has incorrect format or argument is
     *                   non-string, video id's length is not equal 11.
     * }
     */


    var _youtubeParser = function () {
      var cache = {},
          regExp = /(?:http|https|)(?:\:\/\/|)(?:www.|)(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/ytscreeningroom\?v=|\/feeds\/api\/videos\/|\/user\S*[^\w\-\s]|\S*[^\w\-\s]))([\w\-]+)/i;
      return function (url) {
        if (typeof url !== 'string') {
          return void 0;
        }

        if (cache[url]) {
          return cache[url];
        }

        var match = url.match(regExp);
        cache[url] = match ? match[1] : void 0;
        return cache[url];
      };
    }();
    /**
     * Parses links with html5 video sources in mp4 or webm formats.
     * @function
     * @param {String} url Url that should be parsed.
     * @return {
     *    Object:        Object with information about the video
     *                   (file name, video type),
     *    Undefined:     when url has incorrect format or argument is
     *                   non-string.
     * }
     */


    var _videoLinkParser = function () {
      var cache = {};
      return function (url) {
        if (typeof url !== 'string') {
          return void 0;
        }

        if (cache[url]) {
          return cache[url];
        }

        var link = document.createElement('a'),
            match;
        link.href = url; // The regular expression try catches file name and file extension.
        // '[scheme://hostname/pathname/]filename.extension[?query#hash]'

        match = link.pathname.match(/\/{1}([^\/]+)\.([^\/]+)$/);

        if (match) {
          cache[url] = {
            video: match[1],
            type: match[2]
          };
        } else {
          // Links like http://goo.gl/pxxZrg
          // The regular expression try catches file name.
          // '[scheme://hostname/pathname/]filename[?query#hash]'
          match = link.pathname.match(/\/{1}([^\/\.]+)$/);

          if (match) {
            cache[url] = {
              video: match[1],
              type: 'other'
            };
          }
        }

        return cache[url];
      };
    }();
    /**
     * Facade function that parses html5 and youtube links.
     * @function
     * @param {String} url Url that should be parsed.
     * @return {
     *    object:        Object with information about the video:
     *                   {
     *                       mode: "youtube|html5|incorrect",
     *                       video: "file_name|youtube_id",
     *                       type: "youtube|mp4|webm|other"
     *                   },
     *    undefined:     when argument is non-string.
     * }
     */


    var _linkParser = function _linkParser(url) {
      var youtubeIdLength = 11,
          result;

      if (typeof url !== 'string') {
        return void 0;
      }

      if (_youtubeParser(url)) {
        if (_youtubeParser(url).length === youtubeIdLength) {
          result = {
            mode: 'youtube',
            video: _youtubeParser(url),
            type: 'youtube'
          };
        } else {
          result = {
            mode: 'incorrect'
          };
        }
      } else if (_videoLinkParser(url)) {
        result = $.extend({
          mode: 'html5'
        }, _videoLinkParser(url));
      } else {
        result = {
          mode: 'incorrect'
        };
      }

      return result;
    };
    /**
     * Returns short-hand youtube url.
     * @function
     * @param {String} video_id Youtube Video Id that will be added to the link.
     * @return {String} Short-hand Youtube url.
     * @examples
     * _getYoutubeLink('OEoXaMPEzfM'); => 'http://youtu.be/OEoXaMPEzfM'
     */


    var _getYoutubeLink = function _getYoutubeLink(video_id) {
      return 'http://youtu.be/' + video_id;
    };
    /**
     * Returns list of objects with information about the passed links.
     * @function
     * @param {Array} links List of links that will be processed.
     * @returns {Array} List of objects.
     * @examples
     * var links = [
     *      'http://youtu.be/OEoXaMPEzfM',
     *      'video_name.mp4',
     *      'video_name.webm'
     * ]
     *
     * _getVideoList(links); // =>
     *     [
     *       {mode: `youtube`, type: `youtube`, ...},
     *       {mode: `html5`, type: `mp4`, ...},
     *       {mode: `html5`, type: `webm`, ...}
     *     ]
     */


    var _getVideoList = function _getVideoList(links) {
      if ($.isArray(links)) {
        var arr = [],
            data;

        for (var i = 0, len = links.length; i < len; i += 1) {
          data = _linkParser(links[i]);

          if (data.mode !== 'incorrect') {
            arr.push(data);
          }
        }

        return arr;
      }
    };
    /**
     * Synchronizes 2 Backbone collections by 'field_name' property.
     * @function
     * @param {Object} fromCollection Collection with which synchronization will
     * happens.
     * @param {Object} toCollection Collection which will synchronized.
     */


    var _syncCollections = function _syncCollections(fromCollection, toCollection) {
      fromCollection.each(function (m) {
        var model = toCollection.findWhere({
          field_name: m.getFieldName()
        });

        if (model) {
          model.setValue(m.getDisplayValue());
        }
      });
    };
    /**
     * Sends Ajax requests in appropriate format.
     * @function
     * @param {String} action Action that will be invoked on server.
     * @param {String} component_locator the locator of component.
     * @param {Array} videoList List of object with information about inserted
     * urls.
     * @param {Object} extraParams Extra parameters that can be send to the
     * server.
     * @return {Object} XMLHttpRequest object. Using this object, we can
     * attach callbacks to AJAX request events (for example on 'done',
     * 'fail', etc.).
     */


    var _command = function () {
      // We will store the XMLHttpRequest object that $.ajax() function
      // returns, to abort an ongoing AJAX request (if necessary) upon
      // subsequent invocations of _command() function.
      //
      // A new AJAX request will be made on each invocation of the
      // _command() function.
      var xhr = null;
      return function (action, locator, videoList, extraParams) {
        var params, data;

        if (extraParams) {
          if ($.isPlainObject(extraParams)) {
            params = extraParams;
          } else {
            params = {
              params: extraParams
            };
          }
        }

        data = $.extend({
          locator: locator
        }, {
          videos: videoList
        }, params);
        xhr = $.ajaxQueue({
          url: '/transcripts/' + action,
          data: {
            data: JSON.stringify(data)
          },
          notifyOnError: false,
          type: 'get'
        });
        return xhr;
      };
    }();

    return {
      getField: _getField,
      parseYoutubeLink: _youtubeParser,
      parseHTML5Link: _videoLinkParser,
      parseLink: _linkParser,
      getYoutubeLink: _getYoutubeLink,
      syncCollections: _syncCollections,
      command: _command,
      getVideoList: _getVideoList,
      Storage: {
        set: Storage.set,
        get: Storage.get,
        remove: Storage.remove
      }
    };
  }();
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/video/translations_editor.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js"), __webpack_require__("./cms/static/js/views/video/transcripts/utils.js"), __webpack_require__("./cms/static/js/views/abstract_editor.js"), __webpack_require__("./common/static/common/js/components/utils/view_utils.js"), __webpack_require__("./cms/static/js/models/uploads.js"), __webpack_require__("./cms/static/js/views/uploads.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, HtmlUtils, TranscriptUtils, AbstractEditor, ViewUtils, FileUpload, UploadDialog) {
  'use strict';

  var VideoUploadDialog = UploadDialog.extend({
    error: function error() {
      this.model.set({
        uploading: false,
        uploadedBytes: 0,
        title: gettext('Sorry, there was an error parsing the subtitles that you uploaded. Please check the format and try again.')
      });
    }
  });
  var Translations = AbstractEditor.extend({
    events: {
      'click .create-setting': 'addEntry',
      'click .remove-setting': 'removeEntry',
      'click .upload-setting': 'upload',
      'change select': 'onChangeHandler'
    },
    templateName: 'metadata-translations-entry',
    templateItemName: 'metadata-translations-item',
    validFileFormats: ['srt'],
    initialize: function initialize() {
      var templateName = _.result(this, 'templateItemName'),
          tpl = document.getElementById(templateName).text,
          languageMap = {};

      if (!tpl) {
        console.error("Couldn't load template for item: " + templateName);
      }

      this.templateItem = _.template(tpl); // Initialize language map. This maps original language to the newly selected language.
      // Keys in this map represent language codes present on server, they don't change when
      // user selects a language while values represent currently selected language.
      // Initially, the map will look like {'ar': 'ar', 'zh': 'zh'} i.e {'original_lang': 'original_lang'}
      // and corresponding dropdowns will show language names Arabic and Chinese. If user changes
      // Chinese to Russian then map will become {'ar': 'ar', 'zh': 'ru'} i.e {'original_lang': 'new_lang'}

      _.each(this.model.getDisplayValue(), function (value, lang) {
        languageMap[lang] = lang;
      });

      TranscriptUtils.Storage.set('languageMap', languageMap);
      AbstractEditor.prototype.initialize.apply(this, arguments);
    },
    getDropdown: function () {
      var dropdown,
          disableOptions = function disableOptions(element, values) {
        var dropdown = $(element).clone();

        _.each(values, function (value, key) {
          // Note: IE may raise an exception if key is an empty string,
          // while other browsers return null as excepted. So coerce it
          // into null for browser consistency.
          if (key === '') {
            key = null;
          }

          var option = dropdown[0].options.namedItem(key);

          if (option) {
            option.disabled = true;
          }
        });

        return dropdown;
      };

      return function (values) {
        if (dropdown) {
          return disableOptions(dropdown, values);
        }

        dropdown = document.createElement('select');
        dropdown.options.add(new Option());

        _.each(this.model.get('languages'), function (lang, index) {
          var option = new Option();
          option.setAttribute('name', lang.code);
          option.value = lang.code;
          option.text = lang.label;
          dropdown.options.add(option);
        });

        return disableOptions(dropdown, values);
      };
    }(),
    getValueFromEditor: function getValueFromEditor() {
      var dict = {},
          items = this.$el.find('ol').find('.list-settings-item');

      _.each(items, function (element, index) {
        var key = $(element).find('select option:selected').val(),
            value = $(element).find('.input').val(); // Keys should be unique, so if our keys are duplicated and
        // second key is empty or key and value are empty just do
        // nothing. Otherwise, it'll be overwritten by the new value.

        if (value === '') {
          if (key === '' || key in dict) {
            return false;
          }
        }

        dict[key] = value;
      });

      return dict;
    },
    // @TODO: Use backbone render patterns.
    setValueInEditor: function setValueInEditor(values) {
      var self = this,
          frag = document.createDocumentFragment(),
          dropdown = self.getDropdown(values),
          languageMap = TranscriptUtils.Storage.get('languageMap');

      _.each(values, function (value, newLang) {
        var $html = $(self.templateItem({
          newLang: newLang,
          originalLang: _.findKey(languageMap, function (lang) {
            return lang === newLang;
          }) || '',
          value: value,
          url: self.model.get('urlRoot')
        }));
        HtmlUtils.prepend($html, HtmlUtils.HTML(dropdown.clone().val(newLang)));
        frag.appendChild($html[0]);
      });

      HtmlUtils.setHtml(this.$el.find('ol'), HtmlUtils.HTML([frag]));
    },
    addEntry: function addEntry(event) {
      event.preventDefault(); // We don't call updateModel here since it's bound to the
      // change event

      this.setValueInEditor(this.getAllLanguageDropdownElementsData(true));
      this.$el.find('.create-setting').addClass('is-disabled').attr('aria-disabled', true);
    },
    removeEntry: function removeEntry(event) {
      var self = this,
          $currentListItemEl = $(event.currentTarget).parent(),
          originalLang = $currentListItemEl.data('original-lang'),
          selectedLang = $currentListItemEl.find('select option:selected').val(),
          languageMap = TranscriptUtils.Storage.get('languageMap'),
          edxVideoIdField = TranscriptUtils.getField(self.model.collection, 'edx_video_id');
      event.preventDefault();
      /*
      There is a scenario when a user adds an empty video translation item and
      removes it. In such cases, omitting will have no harm on the model
      values or languages map.
      */

      if (originalLang) {
        ViewUtils.confirmThenRunOperation(gettext('Are you sure you want to remove this transcript?'), gettext('If you remove this transcript, the transcript will not be available for this component.'), gettext('Remove Transcript'), function () {
          ViewUtils.runOperationShowingMessage(gettext('Removing'), function () {
            return $.ajax({
              url: self.model.get('urlRoot'),
              type: 'DELETE',
              data: JSON.stringify({
                lang: originalLang,
                edx_video_id: edxVideoIdField.getValue()
              })
            }).done(function () {
              self.setValueInEditor(self.getAllLanguageDropdownElementsData(false, selectedLang));
              TranscriptUtils.Storage.set('languageMap', _.omit(languageMap, originalLang));
            });
          });
        });
      } else {
        this.setValueInEditor(this.getAllLanguageDropdownElementsData(false, selectedLang));
      }

      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    upload: function upload(event) {
      var self = this,
          $target = $(event.currentTarget),
          $listItem = $target.parents('li.list-settings-item'),
          originalLang = $listItem.data('original-lang'),
          newLang = $listItem.find(':selected').val(),
          edxVideoIdField = TranscriptUtils.getField(self.model.collection, 'edx_video_id'),
          fileUploadModel,
          uploadData,
          videoUploadDialog;
      event.preventDefault(); // That's the case when an author is
      // uploading a new transcript.

      if (!originalLang) {
        originalLang = newLang;
      } // Transcript data payload


      uploadData = {
        edx_video_id: edxVideoIdField.getValue(),
        language_code: originalLang,
        new_language_code: newLang
      };
      fileUploadModel = new FileUpload({
        title: gettext('Upload translation'),
        fileFormats: this.validFileFormats
      });
      videoUploadDialog = new VideoUploadDialog({
        model: fileUploadModel,
        url: this.model.get('urlRoot'),
        parentElement: $target.closest('.xblock-editor'),
        uploadData: uploadData,
        onSuccess: function onSuccess(response) {
          var languageMap = TranscriptUtils.Storage.get('languageMap'),
              newLangObject = {}; // new language entry to be added to languageMap

          newLangObject[newLang] = newLang; // Update edx-video-id

          edxVideoIdField.setValue(response.edx_video_id); // Update language map by omitting original lang and adding new lang
          // if languageMap is empty then newLang will be added
          // if an original lang is replaced with new lang then omit the original lang and the add new lang

          languageMap = _.extend(_.omit(languageMap, originalLang), newLangObject);
          TranscriptUtils.Storage.set('languageMap', languageMap); // re-render the whole view

          self.setValueInEditor(self.getAllLanguageDropdownElementsData());
        }
      });
      videoUploadDialog.show();
    },
    enableAdd: function enableAdd() {
      this.$el.find('.create-setting').removeClass('is-disabled').attr('aria-disabled', false);
    },
    onChangeHandler: function onChangeHandler(event) {
      var $target = $(event.currentTarget),
          $listItem = $target.parents('li.list-settings-item'),
          originalLang = $listItem.data('original-lang'),
          newLang = $listItem.find('select option:selected').val(),
          languageMap = TranscriptUtils.Storage.get('languageMap'); // To protect against any new/unsaved language code in the map.

      if (originalLang in languageMap) {
        languageMap[originalLang] = newLang;
        TranscriptUtils.Storage.set('languageMap', languageMap); // an existing saved lang is changed, no need to re-render the whole view

        return;
      }

      this.enableAdd();
      this.setValueInEditor(this.getAllLanguageDropdownElementsData());
    },

    /**
     * Constructs data extracted from each dropdown. This will be used to re-render the whole view.
     */
    getAllLanguageDropdownElementsData: function getAllLanguageDropdownElementsData(isNew, omittedLanguage) {
      var data = {},
          languageDropdownElements = this.$el.find('select'),
          languageMap = TranscriptUtils.Storage.get('languageMap'); // data object will mirror the languageMap. `data` will contain lang to lang map as explained below
      // {originalLang: originalLang};            original lang not changed
      // {newLang: originalLang};                 original lang changed to a new lang
      // {selectedLang: ''};                      new lang to be added, no entry in languageMap

      _.each(languageDropdownElements, function (languageDropdown) {
        var language = $(languageDropdown).find(':selected').val();
        data[language] = _.findKey(languageMap, function (lang) {
          return lang === language;
        }) || '';
      }); // This is needed to render an empty item that
      // will be further used to upload a transcript.


      if (isNew) {
        data[''] = '';
      } // This Omits a language from the dropdown's data. It is
      // needed when an item is going to be removed.


      if (typeof omittedLanguage !== 'undefined') {
        data = _.omit(data, omittedLanguage);
      }

      return data;
    }
  });
  return Translations;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./cms/static/js/views/xblock.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/common/js/components/utils/view_utils.js"), __webpack_require__("./cms/static/js/views/baseview.js"), __webpack_require__("./common/static/common/js/xblock/runtime.v1.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, ViewUtils, BaseView, XBlock, HtmlUtils) {
  'use strict';

  var XBlockView = BaseView.extend({
    // takes XBlockInfo as a model
    events: {
      'click .notification-action-button': 'fireNotificationActionEvent'
    },
    initialize: function initialize() {
      BaseView.prototype.initialize.call(this);
      this.view = this.options.view;
    },
    render: function render(options) {
      var self = this,
          view = this.view,
          xblockInfo = this.model,
          xblockUrl = xblockInfo.url();
      return $.ajax({
        url: decodeURIComponent(xblockUrl) + '/' + view,
        type: 'GET',
        cache: false,
        headers: {
          Accept: 'application/json'
        },
        success: function success(fragment) {
          self.handleXBlockFragment(fragment, options);
        }
      });
    },
    initRuntimeData: function initRuntimeData(xblock, options) {
      if (options && options.initRuntimeData && xblock && xblock.runtime && !xblock.runtime.page) {
        xblock.runtime.page = options.initRuntimeData;
      }

      return xblock;
    },
    handleXBlockFragment: function handleXBlockFragment(fragment, options) {
      var self = this,
          wrapper = this.$el,
          xblockElement,
          successCallback = options ? options.success || options.done : null,
          errorCallback = options ? options.error || options.done : null,
          xblock,
          fragmentsRendered,
          aside;
      fragmentsRendered = this.renderXBlockFragment(fragment, wrapper);
      fragmentsRendered.always(function () {
        xblockElement = self.$('.xblock').first();

        try {
          xblock = XBlock.initializeBlock(xblockElement);
          self.xblock = self.initRuntimeData(xblock, options);
          self.xblockReady(self.xblock);
          self.$('.xblock_asides-v1').each(function () {
            if (!$(this).hasClass('xblock-initialized')) {
              aside = XBlock.initializeBlock($(this));
              self.initRuntimeData(aside, options);
            }
          });

          if (successCallback) {
            successCallback(xblock);
          }
        } catch (e) {
          console.error(e, e.stack); // Add 'xblock-initialization-failed' class to every xblock

          self.$('.xblock').addClass('xblock-initialization-failed'); // If the xblock was rendered but failed then still call xblockReady to allow
          // drag-and-drop to be initialized.

          if (xblockElement) {
            self.xblockReady(null);
          }

          if (errorCallback) {
            errorCallback();
          }
        }
      });
    },

    /**
     * Sends a notification event to the runtime, if one is available. Note that the runtime
     * is only available once the xblock has been rendered and successfully initialized.
     * @param eventName The name of the event to be fired.
     * @param data The data to be passed to any listener's of the event.
     */
    notifyRuntime: function notifyRuntime(eventName, data) {
      var runtime = this.xblock && this.xblock.runtime,
          xblockChildren;

      if (runtime) {
        runtime.notify(eventName, data);
      } else if (this.xblock) {
        xblockChildren = this.xblock.element && $(this.xblock.element).prop('xblock_children');

        if (xblockChildren) {
          $(xblockChildren).each(function () {
            if (this.runtime) {
              this.runtime.notify(eventName, data);
            }
          });
        }
      }
    },

    /**
     * This method is called upon successful rendering of an xblock. Note that the xblock
     * may have thrown JavaScript errors after rendering in which case the xblock parameter
     * will be null.
     */
    xblockReady: function xblockReady(xblock) {// eslint-disable-line no-unused-vars
      // Do nothing
    },

    /**
     * Renders an xblock fragment into the specified element. The fragment has two attributes:
     *   html: the HTML to be rendered
     *   resources: any JavaScript or CSS resources that the HTML depends upon
     * Note that the XBlock is rendered asynchronously, and so a promise is returned that
     * represents this process.
     * @param fragment The fragment returned from the xblock_handler
     * @param element The element into which to render the fragment (defaults to this.$el)
     * @returns {Promise} A promise representing the rendering process
     */
    renderXBlockFragment: function renderXBlockFragment(fragment, element) {
      var html = fragment.html,
          resources = fragment.resources,
          blockView = this;

      if (!element) {
        element = this.$el;
      } // Render the HTML first as the scripts might depend upon it, and then
      // asynchronously add the resources to the page. Any errors that are thrown
      // by included scripts are logged to the console but are then ignored assuming
      // that at least the rendered HTML will be in place.


      try {
        return this.addXBlockFragmentResources(resources).done(function () {
          console.log('Updating HTML');

          try {
            blockView.updateHtml(element, html);
          } catch (e) {
            console.error(e, e.stack);
          }
        });
      } catch (e) {
        console.error(e, e.stack);
        return $.Deferred().resolve();
      }
    },

    /**
     * Updates an element to have the specified HTML. The default method sets the HTML
     * as child content, but this can be overridden.
     * @param element The element to be updated
     * @param html The desired HTML.
     */
    updateHtml: function updateHtml(element, html) {
      HtmlUtils.setHtml(element, HtmlUtils.HTML(html));
    },

    /**
     * Dynamically loads all of an XBlock's dependent resources. This is an asynchronous
     * process so a promise is returned.
     * @param resources The resources to be rendered
     * @returns {Promise} A promise representing the rendering process
     */
    addXBlockFragmentResources: function addXBlockFragmentResources(resources) {
      var self = this,
          _applyResource,
          numResources,
          deferred;

      numResources = resources.length;
      deferred = $.Deferred();

      _applyResource = function applyResource(index) {
        var hash, resource, value, promise;

        if (index >= numResources) {
          deferred.resolve();
          return;
        }

        value = resources[index];
        hash = value[0];

        if (!window.loadedXBlockResources) {
          window.loadedXBlockResources = [];
        }

        if (_.indexOf(window.loadedXBlockResources, hash) < 0) {
          resource = value[1];
          promise = self.loadResource(resource);
          window.loadedXBlockResources.push(hash);
          promise.done(function () {
            _applyResource(index + 1);
          }).fail(function () {
            deferred.reject();
          });
        } else {
          _applyResource(index + 1);
        }
      };

      _applyResource(0);

      return deferred.promise();
    },

    /**
     * Loads the specified resource into the page.
     * @param resource The resource to be loaded.
     * @returns {Promise} A promise representing the loading of the resource.
     */
    loadResource: function loadResource(resource) {
      var $head = $('head'),
          mimetype = resource.mimetype,
          kind = resource.kind,
          placement = resource.placement,
          data = resource.data;

      if (mimetype === 'text/css') {
        if (kind === 'text') {
          // xss-lint: disable=javascript-jquery-append,javascript-concat-html
          $head.append('<style type="text/css">' + data + '</style>');
        } else if (kind === 'url') {
          // xss-lint: disable=javascript-jquery-append,javascript-concat-html
          $head.append('<link rel="stylesheet" href="' + data + '" type="text/css">');
        }
      } else if (mimetype === 'application/javascript') {
        if (kind === 'text') {
          // xss-lint: disable=javascript-jquery-append,javascript-concat-html
          $head.append('<script>' + data + '</script>');
        } else if (kind === 'url') {
          return ViewUtils.loadJavaScript(data);
        }
      } else if (mimetype === 'text/html') {
        if (placement === 'head') {
          HtmlUtils.append($head, HtmlUtils.HTML(data));
        }
      } // Return an already resolved promise for synchronous updates


      return $.Deferred().resolve().promise();
    },
    fireNotificationActionEvent: function fireNotificationActionEvent(event) {
      var eventName = $(event.currentTarget).data('notification-action');

      if (eventName) {
        event.preventDefault();
        this.notifyRuntime(eventName, this.model.get('id'));
      }
    }
  });
  return XBlockView;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end define();

/***/ }),

/***/ "./cms/static/js/views/xblock_editor.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * XBlockEditorView displays the authoring view of an xblock, and allows the user to switch between
 * the available modes.
 */
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./cms/static/js/views/baseview.js"), __webpack_require__("./cms/static/js/views/xblock.js"), __webpack_require__("./cms/static/js/views/metadata.js"), __webpack_require__("./cms/static/js/collections/metadata.js"), __webpack_require__("./common/static/js/vendor/html5-input-polyfills/number-polyfill.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, BaseView, XBlockView, MetadataView, MetadataCollection) {
  var XBlockEditorView = XBlockView.extend({
    // takes XBlockInfo as a model
    options: $.extend({}, XBlockView.prototype.options, {
      view: 'studio_view'
    }),
    initialize: function initialize() {
      XBlockView.prototype.initialize.call(this);
      this.view = this.options.view;
    },
    xblockReady: function xblockReady(xblock) {
      XBlockView.prototype.xblockReady.call(this, xblock);
      this.initializeEditors();
    },
    initializeEditors: function initializeEditors() {
      var metadataEditor,
          pluginEl,
          defaultMode = 'editor';
      metadataEditor = this.createMetadataEditor();
      this.metadataEditor = metadataEditor;

      if (!this.hasCustomTabs()) {
        if (this.getDataEditor()) {
          defaultMode = 'editor';
        } else if (metadataEditor) {
          defaultMode = 'settings';
        }

        this.selectMode(defaultMode);
      }

      pluginEl = this.$('.wrapper-comp-plugins');

      if (pluginEl.length > 0) {
        this.pluginEditor = new BaseView({
          el: pluginEl
        });
      }
    },
    getDefaultModes: function getDefaultModes() {
      return [{
        id: 'editor',
        name: gettext('Editor')
      }, {
        id: 'settings',
        name: gettext('Settings')
      }];
    },
    hasCustomTabs: function hasCustomTabs() {
      return this.$('.editor-with-tabs').length > 0;
    },
    hasCustomButtons: function hasCustomButtons() {
      return this.$('.editor-with-buttons').length > 0;
    },
    createMetadataEditor: function createMetadataEditor() {
      var metadataEditor,
          metadataData,
          models = [],
          key,
          xblock = this.xblock,
          metadataView = null;
      metadataEditor = this.$('.metadata_edit');

      if (metadataEditor.length === 1) {
        metadataData = metadataEditor.data('metadata');

        for (key in metadataData) {
          if (metadataData.hasOwnProperty(key)) {
            models.push(metadataData[key]);
          }
        }

        metadataView = new MetadataView.Editor({
          el: metadataEditor,
          collection: new MetadataCollection(models)
        });

        if (xblock.setMetadataEditor) {
          xblock.setMetadataEditor(metadataView);
        }
      }

      return metadataView;
    },
    getDataEditor: function getDataEditor() {
      var editor = this.$('.wrapper-comp-editor');
      return editor.length === 1 ? editor : null;
    },
    getMetadataEditor: function getMetadataEditor() {
      return this.metadataEditor;
    },
    getPluginEditor: function getPluginEditor() {
      return this.pluginEditor;
    },

    /**
     * Returns the updated field data for the xblock. Note that this works for all
     * XModules as well as for XBlocks that provide a 'collectFieldData' API.
     */
    getXBlockFieldData: function getXBlockFieldData() {
      var xblock = this.xblock,
          metadataEditor = this.getMetadataEditor(),
          data = null; // If the xblock supports returning its field data then collect it

      if (xblock.collectFieldData) {
        data = xblock.collectFieldData(); // ... else if this is an XModule then call its save method
      } else if (xblock.save) {
        data = xblock.save();

        if (metadataEditor) {
          data.metadata = _.extend(data.metadata || {}, this.getChangedMetadata());
        } // ... else log an error

      } else {
        console.error('Cannot save xblock as it has no save method');
      }

      return data;
    },

    /**
     * Returns the metadata that has changed in the editor. This is a combination of the metadata
     * modified in the "Settings" editor, as well as any custom metadata provided by the component.
     */
    getChangedMetadata: function getChangedMetadata() {
      var metadataEditor = this.getMetadataEditor();
      return _.extend(metadataEditor.getModifiedMetadataValues(), this.getCustomMetadata());
    },

    /**
     * Returns custom metadata defined by a particular xmodule that aren't part of the metadata editor.
     * In particular, this is used for LaTeX high level source.
     */
    getCustomMetadata: function getCustomMetadata() {
      // Walk through the set of elements which have the 'data-metadata_name' attribute and
      // build up an object to pass back to the server on the subsequent POST.
      // Note that these values will always be sent back on POST, even if they did not actually change.
      var metadata, metadataNameElements, i, element, metadataName;
      metadata = {};
      metadataNameElements = this.$('[data-metadata-name]');

      for (i = 0; i < metadataNameElements.length; i++) {
        element = metadataNameElements[i];
        metadataName = $(element).data('metadata-name');
        metadata[metadataName] = element.value;
      }

      return metadata;
    },
    getMode: function getMode() {
      return this.mode;
    },
    selectMode: function selectMode(mode) {
      var dataEditor = this.getDataEditor(),
          metadataEditor = this.getMetadataEditor(),
          pluginEditor = this.getPluginEditor();

      if (dataEditor) {
        this.setEditorActivation(dataEditor, mode === 'editor');
      }

      if (metadataEditor) {
        this.setEditorActivation(metadataEditor.$el, mode === 'settings');
      }

      if (pluginEditor) {
        this.setEditorActivation(pluginEditor.$el, mode === 'plugins');
      }

      this.mode = mode;
    },
    setEditorActivation: function setEditorActivation(editor, isActive) {
      editor.removeClass('is-active').removeClass('is-inactive');
      editor.addClass(isActive ? 'is-active' : 'is-inactive');
    }
  });
  return XBlockEditorView;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end define();

/***/ }),

/***/ "./cms/templates/js/license-selector.underscore":
/***/ (function(module, exports) {

module.exports = "<div class=\"wrapper-license\">\n    <h3 class=\"label setting-label\">\n        <%- gettext(\"License Type\") %>\n    </h3>\n    <ul class=\"license-types\">\n        <% var link_start_tpl = '<a href=\"{url}\" rel=\"noopener\" target=\"_blank\">'; %>\n        <% _.each(licenseInfo, function(license, licenseType) { %>\n            <li class=\"license-type\" data-license=\"<%- licenseType %>\">\n                <button name=\"license-<%- licenseType %>\"\n                        class=\"action license-button <% if(model.type === licenseType) { print(\"is-selected\"); } %>\"\n                        aria-pressed=\"<%- (model.type === licenseType).toString() %>\"\n                        <% if (license.tooltip) { %>data-tooltip=\"<%- license.tooltip %>\"<% } %>>\n                    <%- license.name %>\n                </button>\n                <p class=\"tip\">\n                    <% if(license.url) { %>\n                        <a href=\"<%- license.url %>\" rel=\"noopener\" target=\"_blank\">\n                            <%- gettext(\"Learn more about {license_name}\")\n                                        .replace(\"{license_name}\", license.name)\n                            %>\n                        </a>\n                    <% } else { %>\n                        &nbsp;\n                    <% } %>\n                </p>\n            </li>\n        <% }) %>\n    </ul>\n\n<% var license = licenseInfo[model.type]; %>\n<% if(license && !_.isEmpty(license.options)) { %>\n    <div class=\"wrapper-license-options\">\n        <h4 class=\"label setting-label\">\n            <%- gettext(\"Options for {license_name}\").replace(\"{license_name}\", license.name) %>\n        </h4>\n        <p class='tip tip-inline'>\n            <%- gettext(\"The following options are available for the {license_name} license.\")\n                        .replace(\"{license_name}\", license.name) %>\n        </p>\n        <ul class=\"license-options\">\n            <% _.each(license.option_order, function(optionKey) { %>\n                <% var optionInfo = license.options[optionKey]; %>\n                <% if (optionInfo.type == \"boolean\") { %>\n                    <% var optionSelected = model.options[optionKey]; %>\n                    <% var optionDisabled = optionInfo.disabled %>\n                    <li data-option=\"<%- optionKey %>\"\n                        class=\"action-item license-option\n                               <% if (optionSelected) { print(\"is-selected\"); } %>\n                               <% if (optionDisabled) { print(\"is-disabled\"); } else { print(\"is-clickable\"); } %>\"\n                    >\n                        <input type=\"checkbox\"\n                               id=\"<%- model.type %>-<%- optionKey %>\"\n                               name=\"<%- model.type %>-<%- optionKey %>\"\n                               aria-describedby=\"<%- optionKey %>-explanation\"\n                               <% if(optionSelected) { print('checked=\"checked\"'); } %>\n                               <% if(optionDisabled) { print('disabled=\"disabled\"'); } %>\n                        />\n                        <label for=\"<%- model.type %>-<%- optionKey %>\" class=\"option-name\">\n                            <%- optionInfo.name %>\n                        </label>\n                        <div id=\"<%- optionKey %>-explanation\" class=\"explanation\">\n                            <%- optionInfo.help %>\n                        </div>\n                    </li>\n                <% } // could implement other types here %>\n            <% }) %>\n        </ul>\n    </div>\n<% } %>\n\n<% if (showPreview) { %>\n    <div class=\"wrapper-license-preview\">\n        <h4 class=\"label setting-label\">\n            <%- gettext(\"License Display\") %>\n        </h4>\n        <p class=\"tip\">\n            <%- gettext(\"The following message will be displayed at the bottom of the courseware pages within your course:\") %>\n        </p>\n        <div class=\"license-preview\">\n        <% // keep this synchronized with the contents of common/templates/license.html %>\n        <% if (model.type === \"all-rights-reserved\") { %>\n            © <span class=\"license-text\"><%- gettext(\"All Rights Reserved\") %></span>\n        <% } else if (model.type === \"creative-commons\") {\n             var possible = [\"by\", \"nc\", \"nd\", \"sa\"];\n             var enabled = _.filter(possible, function(option) {\n                 return model.options[option] === true || model.options[option.toUpperCase()] === true;\n             });\n             var version = model.options.ver || \"4.0\";\n             if (_.isEmpty(enabled)) {\n                    enabled = [\"zero\"];\n                    version = model.options.ver || \"1.0\";\n             }\n        %>\n            <a rel=\"license\" href=\"https://creativecommons.org/licenses/<%- enabled.join(\"-\") %>/<%- version %>/\">\n            <% if (previewButton) { %>\n                <img src=\"https://licensebuttons.net/l/<%- enabled.join(\"-\") %>/<%- version %>/<%- typeof buttonSize == \"string\" ? buttonSize : \"88x31\" %>.png\"\n                    alt=\"<%- typeof licenseString == \"string\" ? licenseString : \"\" %>\"\n                    />\n            <% } else { %>\n\t        <% //<span> must come before <i> icon or else spacing gets messed up %>\n                <span class=\"sr\"><%- gettext(\"Creative Commons licensed content, with terms as follow:\") %>&nbsp;</span><span aria-hidden=\"true\" class=\"icon-cc\"></span>\n                <% _.each(enabled, function(option) { %>\n                        <span class=\"sr\"><%- license.options[option.toUpperCase()].name %>&nbsp;</span><span aria-hidden=\"true\" class=\"icon-cc-<%- option %>\"></span>\n                <% }); %>\n                <span class=\"license-text\"><%- gettext(\"Some Rights Reserved\") %></span>\n            <% } %>\n        <% } else { %>\n            <%- typeof licenseString == \"string\" ? licenseString : \"\" %>\n            <% // Default to ARR license %>\n            © <span class=\"license-text\"><%- gettext(\"All Rights Reserved\") %></span>\n        <% } %>\n        </a>\n    </div>\n<% } %>\n</div>\n"

/***/ }),

/***/ "./common/static/common/js/components/utils/view_utils.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Provides useful utilities for views.
 */

/* RequireJS
define(['jquery', 'underscore', 'gettext', 'common/js/components/views/feedback_notification',
    'common/js/components/views/feedback_prompt', 'edx-ui-toolkit/js/utils/html-utils'],
    function($, _, gettext, NotificationView, PromptView, HtmlUtils) {
/* End RequireJS */

/* Webpack */

!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__(3), __webpack_require__("./common/static/common/js/components/views/feedback_notification.js"), __webpack_require__("./common/static/common/js/components/views/feedback_prompt.js"), __webpack_require__("./node_modules/scriptjs/dist/script.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, gettext, NotificationView, PromptView, $script) {
  /* End Webpack */
  var toggleExpandCollapse, showLoadingIndicator, hideLoadingIndicator, confirmThenRunOperation, runOperationShowingMessage, showErrorMeassage, withDisabledElement, disableElementWhileRunning, getScrollOffset, setScrollOffset, setScrollTop, redirect, reload, hasChangedAttributes, deleteNotificationHandler, validateRequiredField, validateURLItemEncoding, validateTotalKeyLength, checkTotalKeyLengthViolations, loadJavaScript; // see https://openedx.atlassian.net/browse/TNL-889 for what is it and why it's 65

  var MAX_SUM_KEY_LENGTH = 65;
  /**
   * Toggles the expanded state of the current element.
   */

  toggleExpandCollapse = function toggleExpandCollapse(target, collapsedClass) {
    // Support the old 'collapsed' option until fully switched over to is-collapsed
    var collapsed = collapsedClass || 'collapsed';
    target.closest('.expand-collapse').toggleClass('expand collapse');
    target.closest('.is-collapsible, .window').toggleClass(collapsed);
    target.closest('.is-collapsible').children('article').slideToggle();
  };
  /**
   * Show the page's loading indicator.
   */


  showLoadingIndicator = function showLoadingIndicator() {
    $('.ui-loading').show();
  };
  /**
   * Hide the page's loading indicator.
   */


  hideLoadingIndicator = function hideLoadingIndicator() {
    $('.ui-loading').hide();
  };
  /**
   * Confirms with the user whether to run an operation or not, and then runs it if desired.
   */


  confirmThenRunOperation = function confirmThenRunOperation(title, message, actionLabel, operation, onCancelCallback) {
    return new PromptView.Warning({
      title: title,
      message: message,
      actions: {
        primary: {
          text: actionLabel,
          click: function click(prompt) {
            prompt.hide();
            operation();
          }
        },
        secondary: {
          text: gettext('Cancel'),
          click: function click(prompt) {
            if (onCancelCallback) {
              onCancelCallback();
            }

            return prompt.hide();
          }
        }
      }
    }).show();
  };
  /**
   * Shows a progress message for the duration of an asynchronous operation.
   * Note: this does not remove the notification upon failure because an error
   * will be shown that shouldn't be removed.
   * @param message The message to show.
   * @param operation A function that returns a promise representing the operation.
   */


  runOperationShowingMessage = function runOperationShowingMessage(message, operation) {
    var notificationView;
    notificationView = new NotificationView.Mini({
      title: gettext(message)
    });
    notificationView.show();
    return operation().done(function () {
      notificationView.hide();
    });
  };
  /**
   * Shows an error notification message for a specifc period of time.
   * @param heading The heading of notification.
   * @param message The message to show.
   * @param timeInterval The time interval to hide the notification.
   */


  showErrorMeassage = function showErrorMeassage(heading, message, timeInterval) {
    var errorNotificationView = new NotificationView.Error({
      title: gettext(heading),
      message: gettext(message)
    });
    errorNotificationView.show();
    setTimeout(function () {
      errorNotificationView.hide();
    }, timeInterval);
  };
  /**
   * Wraps a Backbone event callback to disable the event's target element.
   *
   * This paradigm is designed to be used in Backbone event maps where
   * multiple events firing simultaneously is not desired.
   *
   * @param functionName the function to execute, as a string.
   * The function must return a jQuery promise and be able to take an event
   */


  withDisabledElement = function withDisabledElement(functionName) {
    return function (event) {
      var view = this;
      disableElementWhileRunning($(event.currentTarget), function () {
        // call view.functionName(event), with view as the current this
        return view[functionName].apply(view, [event]);
      });
    };
  };
  /**
   * Disables a given element when a given operation is running.
   * @param {jQuery} element the element to be disabled.
   * @param operation the operation during whose duration the
   * element should be disabled. The operation should return
   * a JQuery promise.
   */


  disableElementWhileRunning = function disableElementWhileRunning(element, operation) {
    element.addClass('is-disabled').attr('aria-disabled', true);
    return operation().always(function () {
      element.removeClass('is-disabled').attr('aria-disabled', false);
    });
  };
  /**
   * Returns a handler that removes a notification, both dismissing it and deleting it from the database.
   * @param callback function to call when deletion succeeds
   */


  deleteNotificationHandler = function deleteNotificationHandler(callback) {
    return function (event) {
      event.preventDefault();
      $.ajax({
        url: $(this).data('dismiss-link'),
        type: 'DELETE',
        success: callback
      });
    };
  };
  /**
   * Performs an animated scroll so that the window has the specified scroll top.
   * @param scrollTop The desired scroll top for the window.
   */


  setScrollTop = function setScrollTop(scrollTop) {
    $('html, body').animate({
      scrollTop: scrollTop
    }, 500);
  };
  /**
   * Returns the relative position that the element is scrolled from the top of the view port.
   * @param element The element in question.
   */


  getScrollOffset = function getScrollOffset(element) {
    var elementTop = element.offset().top;
    return elementTop - $(window).scrollTop();
  };
  /**
   * Scrolls the window so that the element is scrolled down to the specified relative position
   * from the top of the view port.
   * @param element The element in question.
   * @param offset The amount by which the element should be scrolled from the top of the view port.
   */


  setScrollOffset = function setScrollOffset(element, offset) {
    var elementTop = element.offset().top,
        newScrollTop = elementTop - offset;
    setScrollTop(newScrollTop);
  };
  /**
   * Redirects to the specified URL. This is broken out as its own function for unit testing.
   */


  redirect = function redirect(url) {
    window.location = url;
  };
  /**
   * Reloads the page. This is broken out as its own function for unit testing.
   */


  reload = function reload() {
    window.location.reload();
  };
  /**
   * Returns true if a model has changes to at least one of the specified attributes.
   * @param model The model in question.
   * @param attributes The list of attributes to be compared.
   * @returns {boolean} Returns true if attribute changes are found.
   */


  hasChangedAttributes = function hasChangedAttributes(model, attributes) {
    var i,
        changedAttributes = model.changedAttributes();

    if (!changedAttributes) {
      return false;
    }

    for (i = 0; i < attributes.length; i++) {
      if (_.has(changedAttributes, attributes[i])) {
        return true;
      }
    }

    return false;
  };
  /**
   * Helper method for course/library creation - verifies a required field is not blank.
   */


  validateRequiredField = function validateRequiredField(msg) {
    return msg.length === 0 ? gettext('Required field.') : '';
  };
  /**
   * Helper method for course/library creation.
   * Check that a course (org, number, run) doesn't use any special characters
   */


  validateURLItemEncoding = function validateURLItemEncoding(item, allowUnicode) {
    var required = validateRequiredField(item);

    if (required) {
      return required;
    }

    if (allowUnicode) {
      if (/\s/g.test(item)) {
        return gettext('Please do not use any spaces in this field.');
      }
    } else {
      if (item !== encodeURIComponent(item) || item.match(/[!'()*]/)) {
        return gettext('Please do not use any spaces or special characters in this field.');
      }
    }

    return '';
  }; // Ensure that sum length of key field values <= ${MAX_SUM_KEY_LENGTH} chars.


  validateTotalKeyLength = function validateTotalKeyLength(keyFieldSelectors) {
    var totalLength = _.reduce(keyFieldSelectors, function (sum, ele) {
      return sum + $(ele).val().length;
    }, 0);

    return totalLength <= MAX_SUM_KEY_LENGTH;
  };

  checkTotalKeyLengthViolations = function checkTotalKeyLengthViolations(selectors, classes, keyFieldSelectors, messageTpl) {
    var tempHtml;

    if (!validateTotalKeyLength(keyFieldSelectors)) {
      $(selectors.errorWrapper).addClass(classes.shown).removeClass(classes.hiding);
      tempHtml = HtmlUtils.joinHtml(HtmlUtils.HTML('<p>'), HtmlUtils.template(messageTpl)({
        limit: MAX_SUM_KEY_LENGTH
      }), HtmlUtils.HTML('</p>'));
      HtmlUtils.setHtml($(selectors.errorMessage), tempHtml);
      $(selectors.save).addClass(classes.disabled);
    } else {
      $(selectors.errorWrapper).removeClass(classes.shown).addClass(classes.hiding);
    }
  };
  /**
   * Dynamically loads the specified JavaScript file.
   * @param url The URL to a JavaScript file.
   * @returns {Promise} A promise indicating when the URL has been loaded.
   */


  loadJavaScript = function loadJavaScript(url) {
    var deferred = $.Deferred();
    /* RequireJS
    require([url],
        function() {
            deferred.resolve();
        },
        function() {
            deferred.reject();
        });
    /* End RequireJS */

    /* Webpack */

    $script(url, url, function () {
      deferred.resolve();
    });
    /* End Webpack */

    return deferred.promise();
  };

  return {
    toggleExpandCollapse: toggleExpandCollapse,
    showLoadingIndicator: showLoadingIndicator,
    hideLoadingIndicator: hideLoadingIndicator,
    confirmThenRunOperation: confirmThenRunOperation,
    runOperationShowingMessage: runOperationShowingMessage,
    showErrorMeassage: showErrorMeassage,
    withDisabledElement: withDisabledElement,
    disableElementWhileRunning: disableElementWhileRunning,
    deleteNotificationHandler: deleteNotificationHandler,
    setScrollTop: setScrollTop,
    getScrollOffset: getScrollOffset,
    setScrollOffset: setScrollOffset,
    redirect: redirect,
    reload: reload,
    hasChangedAttributes: hasChangedAttributes,
    validateRequiredField: validateRequiredField,
    validateURLItemEncoding: validateURLItemEncoding,
    validateTotalKeyLength: validateTotalKeyLength,
    checkTotalKeyLengthViolations: checkTotalKeyLengthViolations,
    loadJavaScript: loadJavaScript
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./common/static/common/js/components/views/feedback.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;

!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/common/js/vendor/underscore.string.js"), __webpack_require__(2), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js"), __webpack_require__("./common/static/common/templates/components/system-feedback.underscore")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, str, Backbone, HtmlUtils, systemFeedbackTemplate) {
  var tabbableElements = ["a[href]:not([tabindex='-1'])", "area[href]:not([tabindex='-1'])", "input:not([disabled]):not([tabindex='-1'])", "select:not([disabled]):not([tabindex='-1'])", "textarea:not([disabled]):not([tabindex='-1'])", "button:not([disabled]):not([tabindex='-1'])", "iframe:not([tabindex='-1'])", "[tabindex]:not([tabindex='-1'])", "[contentEditable=true]:not([tabindex='-1'])"];
  var SystemFeedback = Backbone.View.extend({
    options: {
      title: '',
      message: '',
      intent: null,
      // "warning", "confirmation", "error", "announcement", "step-required", etc
      type: null,
      // "alert", "notification", or "prompt": set by subclass
      shown: true,
      // is this view currently being shown?
      icon: true,
      // should we render an icon related to the message intent?
      closeIcon: true,
      // should we render a close button in the top right corner?
      minShown: 0,
      // ms after this view has been shown before it can be hidden
      maxShown: Infinity,
      // ms after this view has been shown before it will be automatically hidden
      outFocusElement: null // element to send focus to on hide

      /* Could also have an "actions" hash: here is an example demonstrating
          the expected structure. For each action, by default the framework
          will call preventDefault on the click event before the function is
          run; to make it not do that, just pass `preventDefault: false` in
          the action object.
       actions: {
          primary: {
              "text": "Save",
              "class": "action-save",
              "click": function(view) {
                  // do something when Save is clicked
              }
          },
          secondary: [
              {
                  "text": "Cancel",
                  "class": "action-cancel",
                  "click": function(view) {}
              }, {
                  "text": "Discard Changes",
                  "class": "action-discard",
                  "click": function(view) {}
              }
          ]
      }
      */

    },
    initialize: function initialize(options) {
      this.options = _.extend({}, this.options, options);

      if (!this.options.type) {
        throw 'SystemFeedback: type required (given ' + // eslint-disable-line no-throw-literal
        JSON.stringify(this.options) + ')';
      }

      if (!this.options.intent) {
        throw 'SystemFeedback: intent required (given ' + // eslint-disable-line no-throw-literal
        JSON.stringify(this.options) + ')';
      }

      this.setElement($('#page-' + this.options.type)); // handle single "secondary" action

      if (this.options.actions && this.options.actions.secondary && !_.isArray(this.options.actions.secondary)) {
        this.options.actions.secondary = [this.options.actions.secondary];
      }

      return this;
    },
    inFocus: function inFocus(wrapperElementSelector) {
      var wrapper = wrapperElementSelector || '.wrapper',
          tabbables;
      this.options.outFocusElement = this.options.outFocusElement || document.activeElement; // Set focus to the container.

      this.$(wrapper).first().focus(); // Make tabs within the prompt loop rather than setting focus
      // back to the main content of the page.

      tabbables = this.$(tabbableElements.join());
      tabbables.on('keydown', function (event) {
        // On tab backward from the first tabbable item in the prompt
        if (event.which === 9 && event.shiftKey && event.target === tabbables.first()[0]) {
          event.preventDefault();
          tabbables.last().focus();
        } else if (event.which === 9 && !event.shiftKey && event.target === tabbables.last()[0]) {
          // On tab forward from the last tabbable item in the prompt
          event.preventDefault();
          tabbables.first().focus();
        }
      });
      return this;
    },
    outFocus: function outFocus() {
      this.$(tabbableElements.join()).off('keydown');

      if (this.options.outFocusElement) {
        this.options.outFocusElement.focus();
      }

      return this;
    },
    // public API: show() and hide()
    show: function show() {
      clearTimeout(this.hideTimeout);
      this.options.shown = true;
      this.shownAt = new Date();
      this.render();

      if ($.isNumeric(this.options.maxShown)) {
        this.hideTimeout = setTimeout(_.bind(this.hide, this), this.options.maxShown);
      }

      return this;
    },
    hide: function hide() {
      if (this.shownAt && $.isNumeric(this.options.minShown) && this.options.minShown > new Date() - this.shownAt) {
        clearTimeout(this.hideTimeout);
        this.hideTimeout = setTimeout(_.bind(this.hide, this), this.options.minShown - (new Date() - this.shownAt));
      } else {
        this.options.shown = false;
        delete this.shownAt;
        this.render();
      }

      return this;
    },
    // the rest of the API should be considered semi-private
    events: {
      'click .action-close': 'hide',
      'click .action-primary': 'primaryClick',
      'click .action-secondary': 'secondaryClick'
    },
    render: function render() {
      // there can be only one active view of a given type at a time: only
      // one alert, only one notification, only one prompt. Therefore, we'll
      // use a singleton approach.
      var singleton = SystemFeedback['active_' + this.options.type];

      if (singleton && singleton !== this) {
        singleton.stopListening();
        singleton.undelegateEvents();
      }

      HtmlUtils.setHtml(this.$el, HtmlUtils.template(systemFeedbackTemplate)(this.options));
      SystemFeedback['active_' + this.options.type] = this;
      return this;
    },
    primaryClick: function primaryClick(event) {
      var actions, primary;
      actions = this.options.actions;

      if (!actions) {
        return;
      }

      primary = actions.primary;

      if (!primary) {
        return;
      }

      if (primary.preventDefault !== false) {
        event.preventDefault();
      }

      if (primary.click) {
        primary.click.call(event.target, this, event);
      }
    },
    secondaryClick: function secondaryClick(event) {
      var actions, secondaryList, secondary, i;
      actions = this.options.actions;

      if (!actions) {
        return;
      }

      secondaryList = actions.secondary;

      if (!secondaryList) {
        return;
      } // which secondary action was clicked?


      i = 0; // default to the first secondary action (easier for testing)

      if (event && event.target) {
        i = _.indexOf(this.$('.action-secondary'), event.target);
      }

      secondary = secondaryList[i];

      if (secondary.preventDefault !== false) {
        event.preventDefault();
      }

      if (secondary.click) {
        secondary.click.call(event.target, this, event);
      }
    }
  });
  return SystemFeedback;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./common/static/common/js/components/views/feedback_notification.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;

!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/common/js/vendor/underscore.string.js"), __webpack_require__("./common/static/common/js/components/views/feedback.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, str, SystemFeedbackView) {
  var Notification = SystemFeedbackView.extend({
    options: $.extend({}, SystemFeedbackView.prototype.options, {
      type: 'notification',
      closeIcon: false
    })
  }); // create Notification.Warning, Notification.Confirmation, etc

  var capitalCamel, intents, miniOptions;
  capitalCamel = _.compose(str.capitalize, str.camelize);
  intents = ['warning', 'error', 'confirmation', 'announcement', 'step-required', 'help', 'mini'];

  _.each(intents, function (intent) {
    var subclass;
    subclass = Notification.extend({
      options: $.extend({}, Notification.prototype.options, {
        intent: intent
      })
    });
    Notification[capitalCamel(intent)] = subclass;
  }); // set more sensible defaults for Notification.Mini views


  miniOptions = Notification.Mini.prototype.options;
  miniOptions.minShown = 1250;
  miniOptions.closeIcon = false;
  return Notification;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./common/static/common/js/components/views/feedback_prompt.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;

!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(1), __webpack_require__("./common/static/common/js/vendor/underscore.string.js"), __webpack_require__("./common/static/common/js/components/views/feedback.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, _, str, SystemFeedbackView) {
  var Prompt = SystemFeedbackView.extend({
    options: $.extend({}, SystemFeedbackView.prototype.options, {
      type: 'prompt',
      closeIcon: false,
      icon: false
    }),
    render: function render() {
      if (!window.$body) {
        window.$body = $(document.body);
      }

      if (this.options.shown) {
        $body.addClass('prompt-is-shown');
      } else {
        $body.removeClass('prompt-is-shown');
      } // super() in Javascript has awkward syntax :(


      return SystemFeedbackView.prototype.render.apply(this, arguments);
    },
    show: function show() {
      SystemFeedbackView.prototype.show.apply(this, arguments);
      return this.inFocus();
    },
    hide: function hide() {
      SystemFeedbackView.prototype.hide.apply(this, arguments);
      return this.outFocus();
    }
  }); // create Prompt.Warning, Prompt.Confirmation, etc

  var capitalCamel, intents;
  capitalCamel = _.compose(str.capitalize, str.camelize);
  intents = ['warning', 'error', 'confirmation', 'announcement', 'step-required', 'help', 'mini'];

  _.each(intents, function (intent) {
    var subclass;
    subclass = Prompt.extend({
      options: $.extend({}, Prompt.prototype.options, {
        intent: intent
      })
    });
    Prompt[capitalCamel(intent)] = subclass;
  });

  return Prompt;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./common/static/common/js/vendor/jquery.scrollTo.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*!
 * jQuery.scrollTo
 * Copyright (c) 2007-2015 Ariel Flesler - aflesler<a>gmail<d>com | http://flesler.blogspot.com
 * Licensed under MIT
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @projectDescription Lightweight, cross-browser and highly customizable animated scrolling with jQuery
 * @author Ariel Flesler
 * @version 2.1.2
 */
;

(function (factory) {
  'use strict';

  if (true) {
    // AMD
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else if (typeof module !== 'undefined' && module.exports) {
    // CommonJS
    module.exports = factory(require('jquery'));
  } else {
    // Global
    factory(jQuery);
  }
})(function ($) {
  'use strict';

  var $scrollTo = $.scrollTo = function (target, duration, settings) {
    return $(window).scrollTo(target, duration, settings);
  };

  $scrollTo.defaults = {
    axis: 'xy',
    duration: 0,
    limit: true
  };

  function isWin(elem) {
    return !elem.nodeName || $.inArray(elem.nodeName.toLowerCase(), ['iframe', '#document', 'html', 'body']) !== -1;
  }

  $.fn.scrollTo = function (target, duration, settings) {
    if (_typeof(duration) === 'object') {
      settings = duration;
      duration = 0;
    }

    if (typeof settings === 'function') {
      settings = {
        onAfter: settings
      };
    }

    if (target === 'max') {
      target = 9e9;
    }

    settings = $.extend({}, $scrollTo.defaults, settings); // Speed is still recognized for backwards compatibility

    duration = duration || settings.duration; // Make sure the settings are given right

    var queue = settings.queue && settings.axis.length > 1;

    if (queue) {
      // Let's keep the overall duration
      duration /= 2;
    }

    settings.offset = both(settings.offset);
    settings.over = both(settings.over);
    return this.each(function () {
      // Null target yields nothing, just like jQuery does
      if (target === null) return;
      var win = isWin(this),
          elem = win ? this.contentWindow || window : this,
          $elem = $(elem),
          targ = target,
          attr = {},
          toff;

      switch (_typeof(targ)) {
        // A number will pass the regex
        case 'number':
        case 'string':
          if (/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)) {
            targ = both(targ); // We are done

            break;
          } // Relative/Absolute selector


          targ = win ? $(targ) : $(targ, elem);

        /* falls through */

        case 'object':
          if (targ.length === 0) return; // DOMElement / jQuery

          if (targ.is || targ.style) {
            // Get the real position of the target
            toff = (targ = $(targ)).offset();
          }

      }

      var offset = $.isFunction(settings.offset) && settings.offset(elem, targ) || settings.offset;
      $.each(settings.axis.split(''), function (i, axis) {
        var Pos = axis === 'x' ? 'Left' : 'Top',
            pos = Pos.toLowerCase(),
            key = 'scroll' + Pos,
            prev = $elem[key](),
            max = $scrollTo.max(elem, axis);

        if (toff) {
          // jQuery / DOMElement
          attr[key] = toff[pos] + (win ? 0 : prev - $elem.offset()[pos]); // If it's a dom element, reduce the margin

          if (settings.margin) {
            attr[key] -= parseInt(targ.css('margin' + Pos), 10) || 0;
            attr[key] -= parseInt(targ.css('border' + Pos + 'Width'), 10) || 0;
          }

          attr[key] += offset[pos] || 0;

          if (settings.over[pos]) {
            // Scroll to a fraction of its width/height
            attr[key] += targ[axis === 'x' ? 'width' : 'height']() * settings.over[pos];
          }
        } else {
          var val = targ[pos]; // Handle percentage values

          attr[key] = val.slice && val.slice(-1) === '%' ? parseFloat(val) / 100 * max : val;
        } // Number or 'number'


        if (settings.limit && /^\d+$/.test(attr[key])) {
          // Check the limits
          attr[key] = attr[key] <= 0 ? 0 : Math.min(attr[key], max);
        } // Don't waste time animating, if there's no need.


        if (!i && settings.axis.length > 1) {
          if (prev === attr[key]) {
            // No animation needed
            attr = {};
          } else if (queue) {
            // Intermediate animation
            animate(settings.onAfterFirst); // Don't animate this axis again in the next iteration.

            attr = {};
          }
        }
      });
      animate(settings.onAfter);

      function animate(callback) {
        var opts = $.extend({}, settings, {
          // The queue setting conflicts with animate()
          // Force it to always be true
          queue: true,
          duration: duration,
          complete: callback && function () {
            callback.call(elem, targ, settings);
          }
        });
        $elem.animate(attr, opts);
      }
    });
  }; // Max scrolling position, works on quirks mode
  // It only fails (not too badly) on IE, quirks mode.


  $scrollTo.max = function (elem, axis) {
    var Dim = axis === 'x' ? 'Width' : 'Height',
        scroll = 'scroll' + Dim;
    if (!isWin(elem)) return elem[scroll] - $(elem)[Dim.toLowerCase()]();
    var size = 'client' + Dim,
        doc = elem.ownerDocument || elem.document,
        html = doc.documentElement,
        body = doc.body;
    return Math.max(html[scroll], body[scroll]) - Math.min(html[size], body[size]);
  };

  function both(val) {
    return $.isFunction(val) || $.isPlainObject(val) ? val : {
      top: val,
      left: val
    };
  } // Add special hooks so that window scroll properties can be animated


  $.Tween.propHooks.scrollLeft = $.Tween.propHooks.scrollTop = {
    get: function get(t) {
      return $(t.elem)[t.prop]();
    },
    set: function set(t) {
      var curr = this.get(t); // If interrupt is true and user scrolled, stop animating

      if (t.options.interrupt && t._last && t._last !== curr) {
        return $(t.elem).stop();
      }

      var next = Math.round(t.now); // Don't waste CPU
      // Browsers don't render floating point scroll

      if (curr !== next) {
        $(t.elem)[t.prop](next);
        t._last = this.get(t);
      }
    }
  }; // AMD requirement

  return $scrollTo;
});

/***/ }),

/***/ "./common/static/common/js/vendor/underscore.string.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var require;var require;function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*
* Underscore.string
* (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
* Underscore.string is freely distributable under the terms of the MIT license.
* Documentation: https://github.com/epeli/underscore.string
* Some code is borrowed from MooTools and Alexandru Marasteanu.
* Version '3.3.4'
* @preserve
*/
(function (f) {
  if (( false ? "undefined" : _typeof(exports)) === "object" && typeof module !== "undefined") {
    module.exports = f();
  } else if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (f),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {
    var g;

    if (typeof window !== "undefined") {
      g = window;
    } else if (typeof global !== "undefined") {
      g = global;
    } else if (typeof self !== "undefined") {
      g = self;
    } else {
      g = this;
    }

    g.s = f();
  }
})(function () {
  var define, module, exports;
  return function e(t, n, r) {
    function s(o, u) {
      if (!n[o]) {
        if (!t[o]) {
          var a = typeof require == "function" && require;
          if (!u && a) return require(o, !0);
          if (i) return i(o, !0);
          var f = new Error("Cannot find module '" + o + "'");
          throw f.code = "MODULE_NOT_FOUND", f;
        }

        var l = n[o] = {
          exports: {}
        };
        t[o][0].call(l.exports, function (e) {
          var n = t[o][1][e];
          return s(n ? n : e);
        }, l, l.exports, e, t, n, r);
      }

      return n[o].exports;
    }

    var i = typeof require == "function" && require;

    for (var o = 0; o < r.length; o++) {
      s(r[o]);
    }

    return s;
  }({
    1: [function (require, module, exports) {
      var trim = require('./trim');

      var decap = require('./decapitalize');

      module.exports = function camelize(str, decapitalize) {
        str = trim(str).replace(/[-_\s]+(.)?/g, function (match, c) {
          return c ? c.toUpperCase() : '';
        });

        if (decapitalize === true) {
          return decap(str);
        } else {
          return str;
        }
      };
    }, {
      "./decapitalize": 10,
      "./trim": 65
    }],
    2: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function capitalize(str, lowercaseRest) {
        str = makeString(str);
        var remainingChars = !lowercaseRest ? str.slice(1) : str.slice(1).toLowerCase();
        return str.charAt(0).toUpperCase() + remainingChars;
      };
    }, {
      "./helper/makeString": 20
    }],
    3: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function chars(str) {
        return makeString(str).split('');
      };
    }, {
      "./helper/makeString": 20
    }],
    4: [function (require, module, exports) {
      module.exports = function chop(str, step) {
        if (str == null) return [];
        str = String(str);
        step = ~~step;
        return step > 0 ? str.match(new RegExp('.{1,' + step + '}', 'g')) : [str];
      };
    }, {}],
    5: [function (require, module, exports) {
      var capitalize = require('./capitalize');

      var camelize = require('./camelize');

      var makeString = require('./helper/makeString');

      module.exports = function classify(str) {
        str = makeString(str);
        return capitalize(camelize(str.replace(/[\W_]/g, ' ')).replace(/\s/g, ''));
      };
    }, {
      "./camelize": 1,
      "./capitalize": 2,
      "./helper/makeString": 20
    }],
    6: [function (require, module, exports) {
      var trim = require('./trim');

      module.exports = function clean(str) {
        return trim(str).replace(/\s\s+/g, ' ');
      };
    }, {
      "./trim": 65
    }],
    7: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var from = 'ąàáäâãåæăćčĉęèéëêĝĥìíïîĵłľńňòóöőôõðøśșşšŝťțţŭùúüűûñÿýçżźž',
          to = 'aaaaaaaaaccceeeeeghiiiijllnnoooooooossssstttuuuuuunyyczzz';
      from += from.toUpperCase();
      to += to.toUpperCase();
      to = to.split(''); // for tokens requireing multitoken output

      from += 'ß';
      to.push('ss');

      module.exports = function cleanDiacritics(str) {
        return makeString(str).replace(/.{1}/g, function (c) {
          var index = from.indexOf(c);
          return index === -1 ? c : to[index];
        });
      };
    }, {
      "./helper/makeString": 20
    }],
    8: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function (str, substr) {
        str = makeString(str);
        substr = makeString(substr);
        if (str.length === 0 || substr.length === 0) return 0;
        return str.split(substr).length - 1;
      };
    }, {
      "./helper/makeString": 20
    }],
    9: [function (require, module, exports) {
      var trim = require('./trim');

      module.exports = function dasherize(str) {
        return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\s]+/g, '-').toLowerCase();
      };
    }, {
      "./trim": 65
    }],
    10: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function decapitalize(str) {
        str = makeString(str);
        return str.charAt(0).toLowerCase() + str.slice(1);
      };
    }, {
      "./helper/makeString": 20
    }],
    11: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      function getIndent(str) {
        var matches = str.match(/^[\s\\t]*/gm);
        var indent = matches[0].length;

        for (var i = 1; i < matches.length; i++) {
          indent = Math.min(matches[i].length, indent);
        }

        return indent;
      }

      module.exports = function dedent(str, pattern) {
        str = makeString(str);
        var indent = getIndent(str);
        var reg;
        if (indent === 0) return str;

        if (typeof pattern === 'string') {
          reg = new RegExp('^' + pattern, 'gm');
        } else {
          reg = new RegExp('^[ \\t]{' + indent + '}', 'gm');
        }

        return str.replace(reg, '');
      };
    }, {
      "./helper/makeString": 20
    }],
    12: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var toPositive = require('./helper/toPositive');

      module.exports = function endsWith(str, ends, position) {
        str = makeString(str);
        ends = '' + ends;

        if (typeof position == 'undefined') {
          position = str.length - ends.length;
        } else {
          position = Math.min(toPositive(position), str.length) - ends.length;
        }

        return position >= 0 && str.indexOf(ends, position) === position;
      };
    }, {
      "./helper/makeString": 20,
      "./helper/toPositive": 22
    }],
    13: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var escapeChars = require('./helper/escapeChars');

      var regexString = '[';

      for (var key in escapeChars) {
        regexString += key;
      }

      regexString += ']';
      var regex = new RegExp(regexString, 'g');

      module.exports = function escapeHTML(str) {
        return makeString(str).replace(regex, function (m) {
          return '&' + escapeChars[m] + ';';
        });
      };
    }, {
      "./helper/escapeChars": 17,
      "./helper/makeString": 20
    }],
    14: [function (require, module, exports) {
      module.exports = function () {
        var result = {};

        for (var prop in this) {
          if (!this.hasOwnProperty(prop) || prop.match(/^(?:include|contains|reverse|join|map|wrap)$/)) continue;
          result[prop] = this[prop];
        }

        return result;
      };
    }, {}],
    15: [function (require, module, exports) {
      var makeString = require('./makeString');

      module.exports = function adjacent(str, direction) {
        str = makeString(str);

        if (str.length === 0) {
          return '';
        }

        return str.slice(0, -1) + String.fromCharCode(str.charCodeAt(str.length - 1) + direction);
      };
    }, {
      "./makeString": 20
    }],
    16: [function (require, module, exports) {
      var escapeRegExp = require('./escapeRegExp');

      module.exports = function defaultToWhiteSpace(characters) {
        if (characters == null) return '\\s';else if (characters.source) return characters.source;else return '[' + escapeRegExp(characters) + ']';
      };
    }, {
      "./escapeRegExp": 18
    }],
    17: [function (require, module, exports) {
      /* We're explicitly defining the list of entities we want to escape.
      nbsp is an HTML entity, but we don't want to escape all space characters in a string, hence its omission in this map.
      
      */
      var escapeChars = {
        '¢': 'cent',
        '£': 'pound',
        '¥': 'yen',
        '€': 'euro',
        '©': 'copy',
        '®': 'reg',
        '<': 'lt',
        '>': 'gt',
        '"': 'quot',
        '&': 'amp',
        '\'': '#39'
      };
      module.exports = escapeChars;
    }, {}],
    18: [function (require, module, exports) {
      var makeString = require('./makeString');

      module.exports = function escapeRegExp(str) {
        return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');
      };
    }, {
      "./makeString": 20
    }],
    19: [function (require, module, exports) {
      /*
      We're explicitly defining the list of entities that might see in escape HTML strings
      */
      var htmlEntities = {
        nbsp: ' ',
        cent: '¢',
        pound: '£',
        yen: '¥',
        euro: '€',
        copy: '©',
        reg: '®',
        lt: '<',
        gt: '>',
        quot: '"',
        amp: '&',
        apos: '\''
      };
      module.exports = htmlEntities;
    }, {}],
    20: [function (require, module, exports) {
      /**
       * Ensure some object is a coerced to a string
       **/
      module.exports = function makeString(object) {
        if (object == null) return '';
        return '' + object;
      };
    }, {}],
    21: [function (require, module, exports) {
      module.exports = function strRepeat(str, qty) {
        if (qty < 1) return '';
        var result = '';

        while (qty > 0) {
          if (qty & 1) result += str;
          qty >>= 1, str += str;
        }

        return result;
      };
    }, {}],
    22: [function (require, module, exports) {
      module.exports = function toPositive(number) {
        return number < 0 ? 0 : +number || 0;
      };
    }, {}],
    23: [function (require, module, exports) {
      var capitalize = require('./capitalize');

      var underscored = require('./underscored');

      var trim = require('./trim');

      module.exports = function humanize(str) {
        return capitalize(trim(underscored(str).replace(/_id$/, '').replace(/_/g, ' ')));
      };
    }, {
      "./capitalize": 2,
      "./trim": 65,
      "./underscored": 67
    }],
    24: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function include(str, needle) {
        if (needle === '') return true;
        return makeString(str).indexOf(needle) !== -1;
      };
    }, {
      "./helper/makeString": 20
    }],
    25: [function (require, module, exports) {
      /*
      * Underscore.string
      * (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
      * Underscore.string is freely distributable under the terms of the MIT license.
      * Documentation: https://github.com/epeli/underscore.string
      * Some code is borrowed from MooTools and Alexandru Marasteanu.
      * Version '3.3.4'
      * @preserve
      */
      'use strict';

      function s(value) {
        /* jshint validthis: true */
        if (!(this instanceof s)) return new s(value);
        this._wrapped = value;
      }

      s.VERSION = '3.3.4';
      s.isBlank = require('./isBlank');
      s.stripTags = require('./stripTags');
      s.capitalize = require('./capitalize');
      s.decapitalize = require('./decapitalize');
      s.chop = require('./chop');
      s.trim = require('./trim');
      s.clean = require('./clean');
      s.cleanDiacritics = require('./cleanDiacritics');
      s.count = require('./count');
      s.chars = require('./chars');
      s.swapCase = require('./swapCase');
      s.escapeHTML = require('./escapeHTML');
      s.unescapeHTML = require('./unescapeHTML');
      s.splice = require('./splice');
      s.insert = require('./insert');
      s.replaceAll = require('./replaceAll');
      s.include = require('./include');
      s.join = require('./join');
      s.lines = require('./lines');
      s.dedent = require('./dedent');
      s.reverse = require('./reverse');
      s.startsWith = require('./startsWith');
      s.endsWith = require('./endsWith');
      s.pred = require('./pred');
      s.succ = require('./succ');
      s.titleize = require('./titleize');
      s.camelize = require('./camelize');
      s.underscored = require('./underscored');
      s.dasherize = require('./dasherize');
      s.classify = require('./classify');
      s.humanize = require('./humanize');
      s.ltrim = require('./ltrim');
      s.rtrim = require('./rtrim');
      s.truncate = require('./truncate');
      s.prune = require('./prune');
      s.words = require('./words');
      s.pad = require('./pad');
      s.lpad = require('./lpad');
      s.rpad = require('./rpad');
      s.lrpad = require('./lrpad');
      s.sprintf = require('./sprintf');
      s.vsprintf = require('./vsprintf');
      s.toNumber = require('./toNumber');
      s.numberFormat = require('./numberFormat');
      s.strRight = require('./strRight');
      s.strRightBack = require('./strRightBack');
      s.strLeft = require('./strLeft');
      s.strLeftBack = require('./strLeftBack');
      s.toSentence = require('./toSentence');
      s.toSentenceSerial = require('./toSentenceSerial');
      s.slugify = require('./slugify');
      s.surround = require('./surround');
      s.quote = require('./quote');
      s.unquote = require('./unquote');
      s.repeat = require('./repeat');
      s.naturalCmp = require('./naturalCmp');
      s.levenshtein = require('./levenshtein');
      s.toBoolean = require('./toBoolean');
      s.exports = require('./exports');
      s.escapeRegExp = require('./helper/escapeRegExp');
      s.wrap = require('./wrap');
      s.map = require('./map'); // Aliases

      s.strip = s.trim;
      s.lstrip = s.ltrim;
      s.rstrip = s.rtrim;
      s.center = s.lrpad;
      s.rjust = s.lpad;
      s.ljust = s.rpad;
      s.contains = s.include;
      s.q = s.quote;
      s.toBool = s.toBoolean;
      s.camelcase = s.camelize;
      s.mapChars = s.map; // Implement chaining

      s.prototype = {
        value: function value() {
          return this._wrapped;
        }
      };

      function fn2method(key, fn) {
        if (typeof fn !== 'function') return;

        s.prototype[key] = function () {
          var args = [this._wrapped].concat(Array.prototype.slice.call(arguments));
          var res = fn.apply(null, args); // if the result is non-string stop the chain and return the value

          return typeof res === 'string' ? new s(res) : res;
        };
      } // Copy functions to instance methods for chaining


      for (var key in s) {
        fn2method(key, s[key]);
      }

      fn2method('tap', function tap(string, fn) {
        return fn(string);
      });

      function prototype2method(methodName) {
        fn2method(methodName, function (context) {
          var args = Array.prototype.slice.call(arguments, 1);
          return String.prototype[methodName].apply(context, args);
        });
      }

      var prototypeMethods = ['toUpperCase', 'toLowerCase', 'split', 'replace', 'slice', 'substring', 'substr', 'concat'];

      for (var method in prototypeMethods) {
        prototype2method(prototypeMethods[method]);
      }

      module.exports = s;
    }, {
      "./camelize": 1,
      "./capitalize": 2,
      "./chars": 3,
      "./chop": 4,
      "./classify": 5,
      "./clean": 6,
      "./cleanDiacritics": 7,
      "./count": 8,
      "./dasherize": 9,
      "./decapitalize": 10,
      "./dedent": 11,
      "./endsWith": 12,
      "./escapeHTML": 13,
      "./exports": 14,
      "./helper/escapeRegExp": 18,
      "./humanize": 23,
      "./include": 24,
      "./insert": 26,
      "./isBlank": 27,
      "./join": 28,
      "./levenshtein": 29,
      "./lines": 30,
      "./lpad": 31,
      "./lrpad": 32,
      "./ltrim": 33,
      "./map": 34,
      "./naturalCmp": 35,
      "./numberFormat": 38,
      "./pad": 39,
      "./pred": 40,
      "./prune": 41,
      "./quote": 42,
      "./repeat": 43,
      "./replaceAll": 44,
      "./reverse": 45,
      "./rpad": 46,
      "./rtrim": 47,
      "./slugify": 48,
      "./splice": 49,
      "./sprintf": 50,
      "./startsWith": 51,
      "./strLeft": 52,
      "./strLeftBack": 53,
      "./strRight": 54,
      "./strRightBack": 55,
      "./stripTags": 56,
      "./succ": 57,
      "./surround": 58,
      "./swapCase": 59,
      "./titleize": 60,
      "./toBoolean": 61,
      "./toNumber": 62,
      "./toSentence": 63,
      "./toSentenceSerial": 64,
      "./trim": 65,
      "./truncate": 66,
      "./underscored": 67,
      "./unescapeHTML": 68,
      "./unquote": 69,
      "./vsprintf": 70,
      "./words": 71,
      "./wrap": 72
    }],
    26: [function (require, module, exports) {
      var splice = require('./splice');

      module.exports = function insert(str, i, substr) {
        return splice(str, i, 0, substr);
      };
    }, {
      "./splice": 49
    }],
    27: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function isBlank(str) {
        return /^\s*$/.test(makeString(str));
      };
    }, {
      "./helper/makeString": 20
    }],
    28: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var slice = [].slice;

      module.exports = function join() {
        var args = slice.call(arguments),
            separator = args.shift();
        return args.join(makeString(separator));
      };
    }, {
      "./helper/makeString": 20
    }],
    29: [function (require, module, exports) {
      var makeString = require('./helper/makeString');
      /**
       * Based on the implementation here: https://github.com/hiddentao/fast-levenshtein
       */


      module.exports = function levenshtein(str1, str2) {
        'use strict';

        str1 = makeString(str1);
        str2 = makeString(str2); // Short cut cases  

        if (str1 === str2) return 0;
        if (!str1 || !str2) return Math.max(str1.length, str2.length); // two rows

        var prevRow = new Array(str2.length + 1); // initialise previous row

        for (var i = 0; i < prevRow.length; ++i) {
          prevRow[i] = i;
        } // calculate current row distance from previous row


        for (i = 0; i < str1.length; ++i) {
          var nextCol = i + 1;

          for (var j = 0; j < str2.length; ++j) {
            var curCol = nextCol; // substution

            nextCol = prevRow[j] + (str1.charAt(i) === str2.charAt(j) ? 0 : 1); // insertion

            var tmp = curCol + 1;

            if (nextCol > tmp) {
              nextCol = tmp;
            } // deletion


            tmp = prevRow[j + 1] + 1;

            if (nextCol > tmp) {
              nextCol = tmp;
            } // copy current col value into previous (in preparation for next iteration)


            prevRow[j] = curCol;
          } // copy last col value into previous (in preparation for next iteration)


          prevRow[j] = nextCol;
        }

        return nextCol;
      };
    }, {
      "./helper/makeString": 20
    }],
    30: [function (require, module, exports) {
      module.exports = function lines(str) {
        if (str == null) return [];
        return String(str).split(/\r\n?|\n/);
      };
    }, {}],
    31: [function (require, module, exports) {
      var pad = require('./pad');

      module.exports = function lpad(str, length, padStr) {
        return pad(str, length, padStr);
      };
    }, {
      "./pad": 39
    }],
    32: [function (require, module, exports) {
      var pad = require('./pad');

      module.exports = function lrpad(str, length, padStr) {
        return pad(str, length, padStr, 'both');
      };
    }, {
      "./pad": 39
    }],
    33: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');

      var nativeTrimLeft = String.prototype.trimLeft;

      module.exports = function ltrim(str, characters) {
        str = makeString(str);
        if (!characters && nativeTrimLeft) return nativeTrimLeft.call(str);
        characters = defaultToWhiteSpace(characters);
        return str.replace(new RegExp('^' + characters + '+'), '');
      };
    }, {
      "./helper/defaultToWhiteSpace": 16,
      "./helper/makeString": 20
    }],
    34: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function (str, callback) {
        str = makeString(str);
        if (str.length === 0 || typeof callback !== 'function') return str;
        return str.replace(/./g, callback);
      };
    }, {
      "./helper/makeString": 20
    }],
    35: [function (require, module, exports) {
      module.exports = function naturalCmp(str1, str2) {
        if (str1 == str2) return 0;
        if (!str1) return -1;
        if (!str2) return 1;
        var cmpRegex = /(\.\d+|\d+|\D+)/g,
            tokens1 = String(str1).match(cmpRegex),
            tokens2 = String(str2).match(cmpRegex),
            count = Math.min(tokens1.length, tokens2.length);

        for (var i = 0; i < count; i++) {
          var a = tokens1[i],
              b = tokens2[i];

          if (a !== b) {
            var num1 = +a;
            var num2 = +b;

            if (num1 === num1 && num2 === num2) {
              return num1 > num2 ? 1 : -1;
            }

            return a < b ? -1 : 1;
          }
        }

        if (tokens1.length != tokens2.length) return tokens1.length - tokens2.length;
        return str1 < str2 ? -1 : 1;
      };
    }, {}],
    36: [function (require, module, exports) {
      (function (window) {
        var re = {
          not_string: /[^s]/,
          number: /[diefg]/,
          json: /[j]/,
          not_json: /[^j]/,
          text: /^[^\x25]+/,
          modulo: /^\x25{2}/,
          placeholder: /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,
          key: /^([a-z_][a-z_\d]*)/i,
          key_access: /^\.([a-z_][a-z_\d]*)/i,
          index_access: /^\[(\d+)\]/,
          sign: /^[\+\-]/
        };

        function sprintf() {
          var key = arguments[0],
              cache = sprintf.cache;

          if (!(cache[key] && cache.hasOwnProperty(key))) {
            cache[key] = sprintf.parse(key);
          }

          return sprintf.format.call(null, cache[key], arguments);
        }

        sprintf.format = function (parse_tree, argv) {
          var cursor = 1,
              tree_length = parse_tree.length,
              node_type = "",
              arg,
              output = [],
              i,
              k,
              match,
              pad,
              pad_character,
              pad_length,
              is_positive = true,
              sign = "";

          for (i = 0; i < tree_length; i++) {
            node_type = get_type(parse_tree[i]);

            if (node_type === "string") {
              output[output.length] = parse_tree[i];
            } else if (node_type === "array") {
              match = parse_tree[i]; // convenience purposes only

              if (match[2]) {
                // keyword argument
                arg = argv[cursor];

                for (k = 0; k < match[2].length; k++) {
                  if (!arg.hasOwnProperty(match[2][k])) {
                    throw new Error(sprintf("[sprintf] property '%s' does not exist", match[2][k]));
                  }

                  arg = arg[match[2][k]];
                }
              } else if (match[1]) {
                // positional argument (explicit)
                arg = argv[match[1]];
              } else {
                // positional argument (implicit)
                arg = argv[cursor++];
              }

              if (get_type(arg) == "function") {
                arg = arg();
              }

              if (re.not_string.test(match[8]) && re.not_json.test(match[8]) && get_type(arg) != "number" && isNaN(arg)) {
                throw new TypeError(sprintf("[sprintf] expecting number but found %s", get_type(arg)));
              }

              if (re.number.test(match[8])) {
                is_positive = arg >= 0;
              }

              switch (match[8]) {
                case "b":
                  arg = arg.toString(2);
                  break;

                case "c":
                  arg = String.fromCharCode(arg);
                  break;

                case "d":
                case "i":
                  arg = parseInt(arg, 10);
                  break;

                case "j":
                  arg = JSON.stringify(arg, null, match[6] ? parseInt(match[6]) : 0);
                  break;

                case "e":
                  arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential();
                  break;

                case "f":
                  arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg);
                  break;

                case "g":
                  arg = match[7] ? parseFloat(arg).toPrecision(match[7]) : parseFloat(arg);
                  break;

                case "o":
                  arg = arg.toString(8);
                  break;

                case "s":
                  arg = (arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg;
                  break;

                case "u":
                  arg = arg >>> 0;
                  break;

                case "x":
                  arg = arg.toString(16);
                  break;

                case "X":
                  arg = arg.toString(16).toUpperCase();
                  break;
              }

              if (re.json.test(match[8])) {
                output[output.length] = arg;
              } else {
                if (re.number.test(match[8]) && (!is_positive || match[3])) {
                  sign = is_positive ? "+" : "-";
                  arg = arg.toString().replace(re.sign, "");
                } else {
                  sign = "";
                }

                pad_character = match[4] ? match[4] === "0" ? "0" : match[4].charAt(1) : " ";
                pad_length = match[6] - (sign + arg).length;
                pad = match[6] ? pad_length > 0 ? str_repeat(pad_character, pad_length) : "" : "";
                output[output.length] = match[5] ? sign + arg + pad : pad_character === "0" ? sign + pad + arg : pad + sign + arg;
              }
            }
          }

          return output.join("");
        };

        sprintf.cache = {};

        sprintf.parse = function (fmt) {
          var _fmt = fmt,
              match = [],
              parse_tree = [],
              arg_names = 0;

          while (_fmt) {
            if ((match = re.text.exec(_fmt)) !== null) {
              parse_tree[parse_tree.length] = match[0];
            } else if ((match = re.modulo.exec(_fmt)) !== null) {
              parse_tree[parse_tree.length] = "%";
            } else if ((match = re.placeholder.exec(_fmt)) !== null) {
              if (match[2]) {
                arg_names |= 1;
                var field_list = [],
                    replacement_field = match[2],
                    field_match = [];

                if ((field_match = re.key.exec(replacement_field)) !== null) {
                  field_list[field_list.length] = field_match[1];

                  while ((replacement_field = replacement_field.substring(field_match[0].length)) !== "") {
                    if ((field_match = re.key_access.exec(replacement_field)) !== null) {
                      field_list[field_list.length] = field_match[1];
                    } else if ((field_match = re.index_access.exec(replacement_field)) !== null) {
                      field_list[field_list.length] = field_match[1];
                    } else {
                      throw new SyntaxError("[sprintf] failed to parse named argument key");
                    }
                  }
                } else {
                  throw new SyntaxError("[sprintf] failed to parse named argument key");
                }

                match[2] = field_list;
              } else {
                arg_names |= 2;
              }

              if (arg_names === 3) {
                throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");
              }

              parse_tree[parse_tree.length] = match;
            } else {
              throw new SyntaxError("[sprintf] unexpected placeholder");
            }

            _fmt = _fmt.substring(match[0].length);
          }

          return parse_tree;
        };

        var vsprintf = function vsprintf(fmt, argv, _argv) {
          _argv = (argv || []).slice(0);

          _argv.splice(0, 0, fmt);

          return sprintf.apply(null, _argv);
        };
        /**
         * helpers
         */


        function get_type(variable) {
          return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase();
        }

        function str_repeat(input, multiplier) {
          return Array(multiplier + 1).join(input);
        }
        /**
         * export to either browser or node.js
         */


        if (typeof exports !== "undefined") {
          exports.sprintf = sprintf;
          exports.vsprintf = vsprintf;
        } else {
          window.sprintf = sprintf;
          window.vsprintf = vsprintf;

          if (typeof define === "function" && define.amd) {
            define(function () {
              return {
                sprintf: sprintf,
                vsprintf: vsprintf
              };
            });
          }
        }
      })(typeof window === "undefined" ? this : window);
    }, {}],
    37: [function (require, module, exports) {
      (function (global) {
        /**
         * Module exports.
         */
        module.exports = deprecate;
        /**
         * Mark that a method should not be used.
         * Returns a modified function which warns once by default.
         *
         * If `localStorage.noDeprecation = true` is set, then it is a no-op.
         *
         * If `localStorage.throwDeprecation = true` is set, then deprecated functions
         * will throw an Error when invoked.
         *
         * If `localStorage.traceDeprecation = true` is set, then deprecated functions
         * will invoke `console.trace()` instead of `console.error()`.
         *
         * @param {Function} fn - the function to deprecate
         * @param {String} msg - the string to print to the console when `fn` is invoked
         * @returns {Function} a new "deprecated" version of `fn`
         * @api public
         */

        function deprecate(fn, msg) {
          if (config('noDeprecation')) {
            return fn;
          }

          var warned = false;

          function deprecated() {
            if (!warned) {
              if (config('throwDeprecation')) {
                throw new Error(msg);
              } else if (config('traceDeprecation')) {
                console.trace(msg);
              } else {
                console.warn(msg);
              }

              warned = true;
            }

            return fn.apply(this, arguments);
          }

          return deprecated;
        }
        /**
         * Checks `localStorage` for boolean values for the given `name`.
         *
         * @param {String} name
         * @returns {Boolean}
         * @api private
         */


        function config(name) {
          // accessing global.localStorage can trigger a DOMException in sandboxed iframes
          try {
            if (!global.localStorage) return false;
          } catch (_) {
            return false;
          }

          var val = global.localStorage[name];
          if (null == val) return false;
          return String(val).toLowerCase() === 'true';
        }
      }).call(this, typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
    }, {}],
    38: [function (require, module, exports) {
      module.exports = function numberFormat(number, dec, dsep, tsep) {
        if (isNaN(number) || number == null) return '';
        number = number.toFixed(~~dec);
        tsep = typeof tsep == 'string' ? tsep : ',';
        var parts = number.split('.'),
            fnums = parts[0],
            decimals = parts[1] ? (dsep || '.') + parts[1] : '';
        return fnums.replace(/(\d)(?=(?:\d{3})+$)/g, '$1' + tsep) + decimals;
      };
    }, {}],
    39: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var strRepeat = require('./helper/strRepeat');

      module.exports = function pad(str, length, padStr, type) {
        str = makeString(str);
        length = ~~length;
        var padlen = 0;
        if (!padStr) padStr = ' ';else if (padStr.length > 1) padStr = padStr.charAt(0);

        switch (type) {
          case 'right':
            padlen = length - str.length;
            return str + strRepeat(padStr, padlen);

          case 'both':
            padlen = length - str.length;
            return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));

          default:
            // 'left'
            padlen = length - str.length;
            return strRepeat(padStr, padlen) + str;
        }
      };
    }, {
      "./helper/makeString": 20,
      "./helper/strRepeat": 21
    }],
    40: [function (require, module, exports) {
      var adjacent = require('./helper/adjacent');

      module.exports = function succ(str) {
        return adjacent(str, -1);
      };
    }, {
      "./helper/adjacent": 15
    }],
    41: [function (require, module, exports) {
      /**
       * _s.prune: a more elegant version of truncate
       * prune extra chars, never leaving a half-chopped word.
       * @author github.com/rwz
       */
      var makeString = require('./helper/makeString');

      var rtrim = require('./rtrim');

      module.exports = function prune(str, length, pruneStr) {
        str = makeString(str);
        length = ~~length;
        pruneStr = pruneStr != null ? String(pruneStr) : '...';
        if (str.length <= length) return str;

        var tmpl = function tmpl(c) {
          return c.toUpperCase() !== c.toLowerCase() ? 'A' : ' ';
        },
            template = str.slice(0, length + 1).replace(/.(?=\W*\w*$)/g, tmpl); // 'Hello, world' -> 'HellAA AAAAA'


        if (template.slice(template.length - 2).match(/\w\w/)) template = template.replace(/\s*\S+$/, '');else template = rtrim(template.slice(0, template.length - 1));
        return (template + pruneStr).length > str.length ? str : str.slice(0, template.length) + pruneStr;
      };
    }, {
      "./helper/makeString": 20,
      "./rtrim": 47
    }],
    42: [function (require, module, exports) {
      var surround = require('./surround');

      module.exports = function quote(str, quoteChar) {
        return surround(str, quoteChar || '"');
      };
    }, {
      "./surround": 58
    }],
    43: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var strRepeat = require('./helper/strRepeat');

      module.exports = function repeat(str, qty, separator) {
        str = makeString(str);
        qty = ~~qty; // using faster implementation if separator is not needed;

        if (separator == null) return strRepeat(str, qty); // this one is about 300x slower in Google Chrome

        /*eslint no-empty: 0*/

        for (var repeat = []; qty > 0; repeat[--qty] = str) {}

        return repeat.join(separator);
      };
    }, {
      "./helper/makeString": 20,
      "./helper/strRepeat": 21
    }],
    44: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function replaceAll(str, find, replace, ignorecase) {
        var flags = ignorecase === true ? 'gi' : 'g';
        var reg = new RegExp(find, flags);
        return makeString(str).replace(reg, replace);
      };
    }, {
      "./helper/makeString": 20
    }],
    45: [function (require, module, exports) {
      var chars = require('./chars');

      module.exports = function reverse(str) {
        return chars(str).reverse().join('');
      };
    }, {
      "./chars": 3
    }],
    46: [function (require, module, exports) {
      var pad = require('./pad');

      module.exports = function rpad(str, length, padStr) {
        return pad(str, length, padStr, 'right');
      };
    }, {
      "./pad": 39
    }],
    47: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');

      var nativeTrimRight = String.prototype.trimRight;

      module.exports = function rtrim(str, characters) {
        str = makeString(str);
        if (!characters && nativeTrimRight) return nativeTrimRight.call(str);
        characters = defaultToWhiteSpace(characters);
        return str.replace(new RegExp(characters + '+$'), '');
      };
    }, {
      "./helper/defaultToWhiteSpace": 16,
      "./helper/makeString": 20
    }],
    48: [function (require, module, exports) {
      var trim = require('./trim');

      var dasherize = require('./dasherize');

      var cleanDiacritics = require('./cleanDiacritics');

      module.exports = function slugify(str) {
        return trim(dasherize(cleanDiacritics(str).replace(/[^\w\s-]/g, '-').toLowerCase()), '-');
      };
    }, {
      "./cleanDiacritics": 7,
      "./dasherize": 9,
      "./trim": 65
    }],
    49: [function (require, module, exports) {
      var chars = require('./chars');

      module.exports = function splice(str, i, howmany, substr) {
        var arr = chars(str);
        arr.splice(~~i, ~~howmany, substr);
        return arr.join('');
      };
    }, {
      "./chars": 3
    }],
    50: [function (require, module, exports) {
      var deprecate = require('util-deprecate');

      module.exports = deprecate(require('sprintf-js').sprintf, 'sprintf() will be removed in the next major release, use the sprintf-js package instead.');
    }, {
      "sprintf-js": 36,
      "util-deprecate": 37
    }],
    51: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var toPositive = require('./helper/toPositive');

      module.exports = function startsWith(str, starts, position) {
        str = makeString(str);
        starts = '' + starts;
        position = position == null ? 0 : Math.min(toPositive(position), str.length);
        return str.lastIndexOf(starts, position) === position;
      };
    }, {
      "./helper/makeString": 20,
      "./helper/toPositive": 22
    }],
    52: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function strLeft(str, sep) {
        str = makeString(str);
        sep = makeString(sep);
        var pos = !sep ? -1 : str.indexOf(sep);
        return ~pos ? str.slice(0, pos) : str;
      };
    }, {
      "./helper/makeString": 20
    }],
    53: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function strLeftBack(str, sep) {
        str = makeString(str);
        sep = makeString(sep);
        var pos = str.lastIndexOf(sep);
        return ~pos ? str.slice(0, pos) : str;
      };
    }, {
      "./helper/makeString": 20
    }],
    54: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function strRight(str, sep) {
        str = makeString(str);
        sep = makeString(sep);
        var pos = !sep ? -1 : str.indexOf(sep);
        return ~pos ? str.slice(pos + sep.length, str.length) : str;
      };
    }, {
      "./helper/makeString": 20
    }],
    55: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function strRightBack(str, sep) {
        str = makeString(str);
        sep = makeString(sep);
        var pos = !sep ? -1 : str.lastIndexOf(sep);
        return ~pos ? str.slice(pos + sep.length, str.length) : str;
      };
    }, {
      "./helper/makeString": 20
    }],
    56: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function stripTags(str) {
        return makeString(str).replace(/<\/?[^>]+>/g, '');
      };
    }, {
      "./helper/makeString": 20
    }],
    57: [function (require, module, exports) {
      var adjacent = require('./helper/adjacent');

      module.exports = function succ(str) {
        return adjacent(str, 1);
      };
    }, {
      "./helper/adjacent": 15
    }],
    58: [function (require, module, exports) {
      module.exports = function surround(str, wrapper) {
        return [wrapper, str, wrapper].join('');
      };
    }, {}],
    59: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function swapCase(str) {
        return makeString(str).replace(/\S/g, function (c) {
          return c === c.toUpperCase() ? c.toLowerCase() : c.toUpperCase();
        });
      };
    }, {
      "./helper/makeString": 20
    }],
    60: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function titleize(str) {
        return makeString(str).toLowerCase().replace(/(?:^|\s|-)\S/g, function (c) {
          return c.toUpperCase();
        });
      };
    }, {
      "./helper/makeString": 20
    }],
    61: [function (require, module, exports) {
      var trim = require('./trim');

      function boolMatch(s, matchers) {
        var i,
            matcher,
            down = s.toLowerCase();
        matchers = [].concat(matchers);

        for (i = 0; i < matchers.length; i += 1) {
          matcher = matchers[i];
          if (!matcher) continue;
          if (matcher.test && matcher.test(s)) return true;
          if (matcher.toLowerCase() === down) return true;
        }
      }

      module.exports = function toBoolean(str, trueValues, falseValues) {
        if (typeof str === 'number') str = '' + str;
        if (typeof str !== 'string') return !!str;
        str = trim(str);
        if (boolMatch(str, trueValues || ['true', '1'])) return true;
        if (boolMatch(str, falseValues || ['false', '0'])) return false;
      };
    }, {
      "./trim": 65
    }],
    62: [function (require, module, exports) {
      module.exports = function toNumber(num, precision) {
        if (num == null) return 0;
        var factor = Math.pow(10, isFinite(precision) ? precision : 0);
        return Math.round(num * factor) / factor;
      };
    }, {}],
    63: [function (require, module, exports) {
      var rtrim = require('./rtrim');

      module.exports = function toSentence(array, separator, lastSeparator, serial) {
        separator = separator || ', ';
        lastSeparator = lastSeparator || ' and ';
        var a = array.slice(),
            lastMember = a.pop();
        if (array.length > 2 && serial) lastSeparator = rtrim(separator) + lastSeparator;
        return a.length ? a.join(separator) + lastSeparator + lastMember : lastMember;
      };
    }, {
      "./rtrim": 47
    }],
    64: [function (require, module, exports) {
      var toSentence = require('./toSentence');

      module.exports = function toSentenceSerial(array, sep, lastSep) {
        return toSentence(array, sep, lastSep, true);
      };
    }, {
      "./toSentence": 63
    }],
    65: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');

      var nativeTrim = String.prototype.trim;

      module.exports = function trim(str, characters) {
        str = makeString(str);
        if (!characters && nativeTrim) return nativeTrim.call(str);
        characters = defaultToWhiteSpace(characters);
        return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');
      };
    }, {
      "./helper/defaultToWhiteSpace": 16,
      "./helper/makeString": 20
    }],
    66: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      module.exports = function truncate(str, length, truncateStr) {
        str = makeString(str);
        truncateStr = truncateStr || '...';
        length = ~~length;
        return str.length > length ? str.slice(0, length) + truncateStr : str;
      };
    }, {
      "./helper/makeString": 20
    }],
    67: [function (require, module, exports) {
      var trim = require('./trim');

      module.exports = function underscored(str) {
        return trim(str).replace(/([a-z\d])([A-Z]+)/g, '$1_$2').replace(/[-\s]+/g, '_').toLowerCase();
      };
    }, {
      "./trim": 65
    }],
    68: [function (require, module, exports) {
      var makeString = require('./helper/makeString');

      var htmlEntities = require('./helper/htmlEntities');

      module.exports = function unescapeHTML(str) {
        return makeString(str).replace(/\&([^;]+);/g, function (entity, entityCode) {
          var match;

          if (entityCode in htmlEntities) {
            return htmlEntities[entityCode];
            /*eslint no-cond-assign: 0*/
          } else if (match = entityCode.match(/^#x([\da-fA-F]+)$/)) {
            return String.fromCharCode(parseInt(match[1], 16));
            /*eslint no-cond-assign: 0*/
          } else if (match = entityCode.match(/^#(\d+)$/)) {
            return String.fromCharCode(~~match[1]);
          } else {
            return entity;
          }
        });
      };
    }, {
      "./helper/htmlEntities": 19,
      "./helper/makeString": 20
    }],
    69: [function (require, module, exports) {
      module.exports = function unquote(str, quoteChar) {
        quoteChar = quoteChar || '"';
        if (str[0] === quoteChar && str[str.length - 1] === quoteChar) return str.slice(1, str.length - 1);else return str;
      };
    }, {}],
    70: [function (require, module, exports) {
      var deprecate = require('util-deprecate');

      module.exports = deprecate(require('sprintf-js').vsprintf, 'vsprintf() will be removed in the next major release, use the sprintf-js package instead.');
    }, {
      "sprintf-js": 36,
      "util-deprecate": 37
    }],
    71: [function (require, module, exports) {
      var isBlank = require('./isBlank');

      var trim = require('./trim');

      module.exports = function words(str, delimiter) {
        if (isBlank(str)) return [];
        return trim(str, delimiter).split(delimiter || /\s+/);
      };
    }, {
      "./isBlank": 27,
      "./trim": 65
    }],
    72: [function (require, module, exports) {
      // Wrap
      // wraps a string by a certain width
      var makeString = require('./helper/makeString');

      module.exports = function wrap(str, options) {
        str = makeString(str);
        options = options || {};
        var width = options.width || 75;
        var seperator = options.seperator || '\n';
        var cut = options.cut || false;
        var preserveSpaces = options.preserveSpaces || false;
        var trailingSpaces = options.trailingSpaces || false;
        var result;

        if (width <= 0) {
          return str;
        } else if (!cut) {
          var words = str.split(' ');
          var current_column = 0;
          result = '';

          while (words.length > 0) {
            // if adding a space and the next word would cause this line to be longer than width...
            if (1 + words[0].length + current_column > width) {
              //start a new line if this line is not already empty
              if (current_column > 0) {
                // add a space at the end of the line is preserveSpaces is true
                if (preserveSpaces) {
                  result += ' ';
                  current_column++;
                } // fill the rest of the line with spaces if trailingSpaces option is true
                else if (trailingSpaces) {
                  while (current_column < width) {
                    result += ' ';
                    current_column++;
                  }
                } //start new line


                result += seperator;
                current_column = 0;
              }
            } // if not at the begining of the line, add a space in front of the word


            if (current_column > 0) {
              result += ' ';
              current_column++;
            } // tack on the next word, update current column, a pop words array


            result += words[0];
            current_column += words[0].length;
            words.shift();
          } // fill the rest of the line with spaces if trailingSpaces option is true


          if (trailingSpaces) {
            while (current_column < width) {
              result += ' ';
              current_column++;
            }
          }

          return result;
        } else {
          var index = 0;
          result = ''; // walk through each character and add seperators where appropriate

          while (index < str.length) {
            if (index % width == 0 && index > 0) {
              result += seperator;
            }

            result += str.charAt(index);
            index++;
          } // fill the rest of the line with spaces if trailingSpaces option is true


          if (trailingSpaces) {
            while (index % width > 0) {
              result += ' ';
              index++;
            }
          }

          return result;
        }
      };
    }, {
      "./helper/makeString": 20
    }]
  }, {}, [25])(25);
});
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__("./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./common/static/common/js/xblock/core.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {/*** IMPORTS FROM imports-loader ***/
var jquery = __webpack_require__(0);

var jquery = jquery || {};
jquery.immediateDescendents = __webpack_require__("./common/static/js/src/jquery.immediateDescendents.js");
(function () {
  (function ($, JSON) {
    'use strict';

    var XBlock;

    function initializeBlockLikes(blockClass, initializer, element, requestToken) {
      var selector;
      requestToken = requestToken || $(element).data('request-token');

      if (requestToken) {
        selector = '.' + blockClass + '[data-request-token="' + requestToken + '"]';
      } else {
        selector = '.' + blockClass;
      } // After an element is initialized, a class is added to it. To avoid repeat initialization, no
      // elements with that class should be selected.


      selector += ':not(.xblock-initialized)';
      return $(element).immediateDescendents(selector).map(function (idx, elem) {
        return initializer(elem, requestToken);
      }).toArray();
    }

    function elementRuntime(element) {
      var $element = $(element),
          runtime = $element.data('runtime-class'),
          version = $element.data('runtime-version'),
          initFnName = $element.data('init');

      if (runtime && version && initFnName) {
        return new window[runtime]['v' + version]();
      } else {
        if (runtime || version || initFnName) {
          console.log('Block ' + $element.outerHTML + ' is missing data-runtime, data-runtime-version or data-init, ' + 'and can\'t be initialized');
        } // else this XBlock doesn't have a JS init function.


        return null;
      }
    }

    function initArgs(element) {
      var initargs = $(element).children('.xblock-json-init-args').remove().text();
      return initargs ? JSON.parse(initargs) : {};
    }
    /**
     * Construct an XBlock family object from an element. The constructor
     * function is loaded from the 'data-init' attribute of the element.
     * The constructor is called with the arguments 'runtime', 'element',
     * and then all of 'block_args'.
     */


    function constructBlock(element, blockArgs) {
      var block;
      var $element = $(element);
      var runtime = elementRuntime(element);
      blockArgs.unshift(element);
      blockArgs.unshift(runtime);

      if (runtime) {
        block = function () {
          var initFn = window[$element.data('init')]; // This create a new constructor that can then apply() the block_args
          // to the initFn.

          function Block() {
            return initFn.apply(this, blockArgs);
          }

          Block.prototype = initFn.prototype;
          return new Block();
        }();

        block.runtime = runtime;
      } else {
        block = {};
      }

      block.element = element;
      block.name = $element.data('name');
      block.type = $element.data('block-type');
      $element.trigger('xblock-initialized');
      $element.data('initialized', true);
      $element.addClass('xblock-initialized');
      return block;
    }

    XBlock = {
      Runtime: {},

      /**
       * Initialize the javascript for a single xblock element, and for all of it's
       * xblock children that match requestToken. If requestToken is omitted, use the
       * data-request-token attribute from element, or use the request-tokens specified on
       * the children themselves.
       */
      initializeBlock: function initializeBlock(element, requestToken) {
        var $element = $(element),
            children,
            asides;
        requestToken = requestToken || $element.data('request-token');
        children = XBlock.initializeXBlocks($element, requestToken);
        asides = XBlock.initializeXBlockAsides($element, requestToken);

        if (asides) {
          children = children.concat(asides);
        }

        $element.prop('xblock_children', children);
        return constructBlock(element, [initArgs(element)]);
      },

      /**
       * Initialize the javascript for a single xblock aside element that matches requestToken.
       * If requestToken is omitted, use the data-request-token attribute from element, or use
       * the request-tokens specified on the children themselves.
       */
      initializeAside: function initializeAside(element) {
        var blockUsageId = $(element).data('block-id');
        var blockElement = $(element).siblings('[data-usage-id="' + blockUsageId + '"]')[0];
        return constructBlock(element, [blockElement, initArgs(element)]);
      },

      /**
       * Initialize all XBlocks inside element that were rendered with requestToken.
       * If requestToken is omitted, and element has a 'data-request-token' attribute, use that.
       * If neither is available, then use the request tokens of the immediateDescendent xblocks.
       */
      initializeXBlocks: function initializeXBlocks(element, requestToken) {
        return initializeBlockLikes('xblock', XBlock.initializeBlock, element, requestToken);
      },

      /**
       * Initialize all XBlockAsides inside element that were rendered with requestToken.
       * If requestToken is omitted, and element has a 'data-request-token' attribute, use that.
       * If neither is available, then use the request tokens of the immediateDescendent xblocks.
       */
      initializeXBlockAsides: function initializeXBlockAsides(element, requestToken) {
        return initializeBlockLikes('xblock_asides-v1', XBlock.initializeAside, element, requestToken);
      },

      /**
       * Initialize all XBlock-family blocks inside element that were rendered with requestToken.
       * If requestToken is omitted, and element has a 'data-request-token' attribute, use that.
       * If neither is available, then use the request tokens of the immediateDescendent xblocks.
       */
      initializeBlocks: function initializeBlocks(element, requestToken) {
        var asides = XBlock.initializeXBlockAsides(element, requestToken);
        var xblocks = XBlock.initializeXBlocks(element, requestToken);

        if (asides) {
          xblocks = xblocks.concat(asides);
        }

        return xblocks;
      }
    };
    this.XBlock = XBlock;
  }).call(this, $, JSON);
}).call(window);
/*** EXPORTS FROM exports-loader ***/

module.exports = window.XBlock;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/common/js/xblock/runtime.v1.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {/*** IMPORTS FROM imports-loader ***/
var XBlock = __webpack_require__("./common/static/common/js/xblock/core.js");

(function () {
  (function () {
    'use strict';

    this.XBlock.Runtime.v1 = function () {
      function v1() {
        var block = this;

        this.childMap = function () {
          return v1.prototype.childMap.apply(block, arguments);
        };

        this.children = function () {
          return v1.prototype.children.apply(block, arguments);
        };
      }

      v1.prototype.children = function (block) {
        return $(block).prop('xblock_children');
      };

      v1.prototype.childMap = function (block, childName) {
        var child, idx, len, ref;
        ref = this.children(block);

        for (idx = 0, len = ref.length; idx < len; idx++) {
          child = ref[idx];

          if (child.name === childName) {
            return child;
          }
        }

        return null;
      };
      /**
       * Notify the client-side runtime that an event has occurred.
       *
       * This allows the runtime to update the UI in a consistent way
       * for different XBlocks.
       * `name` is an arbitrary string (for example, "save")
       * `data` is an object (for example, {state: 'starting'})
       * The default implementation is a no-op.
       *
       * WARNING: This is an interim solution and not officially supported!
       */


      v1.prototype.notify = function () {// Do nothing
      };

      return v1;
    }();
  }).call(this);
}).call(window);
/*** EXPORTS FROM exports-loader ***/

module.exports = window.XBlock;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/common/templates/components/system-feedback.underscore":
/***/ (function(module, exports) {

module.exports = "<div class=\"wrapper wrapper-<%- type %> wrapper-<%- type %>-<%- intent %>\n            <% if(obj.shown) { %>is-shown<% } else { %>is-hiding<% } %>\n            <% if(_.contains(['help', 'mini'], intent)) { %>wrapper-<%- type %>-status<% } %>\"\n     id=\"<%- type %>-<%- intent %>\"\n     aria-hidden=\"<% if(obj.shown) { %>false<% } else { %>true<% } %>\"\n     aria-labelledby=\"<%- type %>-<%- intent %>-title\"\n     tabindex=\"-1\"\n     <% if (obj.message) { %>aria-describedby=\"<%- type %>-<%- intent %>-description\" <% } %>\n     <% if (obj.actions) { %>role=\"dialog\"<% } %>\n  >\n  <div class=\"<%- type %> <%- intent %> <% if(obj.actions) { %>has-actions<% } %>\">\n    <% if(obj.icon) { %>\n      <% var iconClass = {\"warning\": \"warning\", \"confirmation\": \"check\", \"error\": \"warning\", \"announcement\": \"bullhorn\", \"step-required\": \"exclamation-circle\", \"help\": \"question\", \"mini\": \"cog\"} %>\n      <span class=\"feedback-symbol fa fa-<%- iconClass[intent] %>\" aria-hidden=\"true\"></span>\n    <% } %>\n\n    <div class=\"copy\">\n      <h2 class=\"title title-3\" id=\"<%- type %>-<%- intent %>-title\"><%- title %></h2>\n      <% if(obj.message) { %><p class=\"message\" id=\"<%- type %>-<%- intent %>-description\"><%- message %></p><% } %>\n    </div>\n\n    <% if(obj.actions) { %>\n    <nav class=\"nav-actions\">\n      <ul>\n        <% if(actions.primary) { %>\n        <li class=\"nav-item\">\n          <button class=\"action-primary <%- actions.primary.class %>\"><%- actions.primary.text %></button>\n        </li>\n        <% } %>\n        <% if(actions.secondary) {\n             _.each(actions.secondary, function(secondary) { %>\n        <li class=\"nav-item\">\n          <button class=\"action-secondary <%- secondary.class %>\"><%- secondary.text %></button>\n        </li>\n        <%   });\n           } %>\n      </ul>\n    </nav>\n    <% } %>\n\n    <% if(obj.closeIcon) { %>\n    <a href=\"#\" rel=\"view\" class=\"action action-close action-<%- type %>-close\">\n      <span class=\"icon fa fa-times-circle\" aria-hidden=\"true\"></span>\n      <span class=\"label\">close <%- type %></span>\n    </a>\n    <% } %>\n  </div>\n</div>\n"

/***/ }),

/***/ "./common/static/js/src/accessibility_tools.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($, __webpack_provided_edx_dot_HtmlUtils) {/*

============================================
License for Application
============================================

This license is governed by United States copyright law, and with respect to matters
of tort, contract, and other causes of action it is governed by North Carolina law,
without regard to North Carolina choice of law provisions.  The forum for any dispute
resolution shall be in Wake County, North Carolina.

Redistribution and use in source and binary forms, with or without modification, are
permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list
   of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice, this
   list of conditions and the following disclaimer in the documentation and/or other
   materials provided with the distribution.

3. The name of the author may not be used to endorse or promote products derived from
   this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/
var $focusedElementBeforeModal,
    focusableElementsString = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]';

var reassignTabIndexesAndAriaHidden = function reassignTabIndexesAndAriaHidden(focusableElementsFilterString, closeButtonId, modalId, mainPageId) {
  // Sets appropriate elements to tab indexable and properly sets aria_hidden on content outside of modal
  // "focusableElementsFilterString" is a string that indicates all elements that should be focusable
  // "closeButtonId" is the selector for the button that closes out the modal.
  // "modalId" is the selector for the modal being managed
  // "mainPageId" is the selector for the main part of the page
  // Returns a list of focusableItems
  var focusableItems;
  $(mainPageId).attr('aria-hidden', 'true');
  $(modalId).attr('aria-hidden', 'false');
  focusableItems = $(modalId).find('*').filter(focusableElementsFilterString).filter(':visible');
  focusableItems.attr('tabindex', '2');
  $(closeButtonId).attr('tabindex', '1').focus();
  return focusableItems;
};

var trapTabFocus = function trapTabFocus(focusableItems, closeButtonId) {
  // Determines last element in modal and traps focus by causing tab
  // to focus on the first modal element (close button)
  // "focusableItems" all elements in the modal that are focusable
  // "closeButtonId" is the selector for the button that closes out the modal.
  // returns the last focusable element in the modal.
  var $last;

  if (focusableItems.length !== 0) {
    $last = focusableItems.last();
  } else {
    $last = $(closeButtonId);
  } // tab on last element in modal returns to the first one


  $last.on('keydown', function (e) {
    var keyCode = e.keyCode || e.which; // 9 is the js keycode for tab

    if (!e.shiftKey && keyCode === 9) {
      e.preventDefault();
      $(closeButtonId).focus();
    }
  });
  return $last;
};

var trapShiftTabFocus = function trapShiftTabFocus($last, closeButtonId) {
  $(closeButtonId).on('keydown', function (e) {
    var keyCode = e.keyCode || e.which; // 9 is the js keycode for tab

    if (e.shiftKey && keyCode === 9) {
      e.preventDefault();
      $last.focus();
    }
  });
};

var bindReturnFocusListener = function bindReturnFocusListener($previouslyFocusedElement, closeButtonId, modalId, mainPageId) {
  // Ensures that on modal close, focus is returned to the element
  // that had focus before the modal was opened.
  $('#lean_overlay, ' + closeButtonId).click(function () {
    $(mainPageId).attr('aria-hidden', 'false');
    $(modalId).attr('aria-hidden', 'true');
    $previouslyFocusedElement.focus();
  });
};

var bindEscapeKeyListener = function bindEscapeKeyListener(modalId, closeButtonId) {
  $(modalId).on('keydown', function (e) {
    var keyCode = e.keyCode || e.which; // 27 is the javascript keycode for the ESC key

    if (keyCode === 27) {
      e.preventDefault();
      $(closeButtonId).click();
    }
  });
};

var trapFocusForAccessibleModal = function trapFocusForAccessibleModal($previouslyFocusedElement, focusableElementsFilterString, closeButtonId, modalId, mainPageId) {
  // Re assess the page for which items internal to the modal should be focusable,
  // Should be called after the content of the accessible_modal is changed in order
  // to ensure that the correct elements are accessible.
  var focusableItems, $last;
  focusableItems = reassignTabIndexesAndAriaHidden(focusableElementsFilterString, closeButtonId, modalId, mainPageId);
  $last = trapTabFocus(focusableItems, closeButtonId);
  trapShiftTabFocus($last, closeButtonId);
  bindReturnFocusListener($previouslyFocusedElement, closeButtonId, modalId, mainPageId);
  bindEscapeKeyListener(modalId, closeButtonId);
};

var accessible_modal = function accessible_modal(trigger, closeButtonId, modalId, mainPageId) {
  // Modifies a lean modal to optimize focus management.
  // "trigger" is the selector for the link element that triggers the modal.
  // "closeButtonId" is the selector for the button that closes out the modal.
  // "modalId" is the selector for the modal being managed
  // "mainPageId" is the selector for the main part of the page
  //
  // based on http://accessibility.oit.ncsu.edu/training/aria/modal-window/modal-window.js
  //
  // see http://accessibility.oit.ncsu.edu/blog/2013/09/13/the-incredible-accessible-modal-dialog/
  // for more information on managing modals
  //
  var initialFocus;
  $(trigger).click(function () {
    $focusedElementBeforeModal = $(trigger);
    trapFocusForAccessibleModal($focusedElementBeforeModal, focusableElementsString, closeButtonId, modalId, mainPageId); // In IE, focus shifts to iframes when they load.
    // These lines ensure that focus is shifted back to the close button
    // in the case that a modal that contains an iframe is opened in IE.
    // see http://stackoverflow.com/questions/15792620/

    initialFocus = true;
    $(modalId).find('iframe').on('focus', function () {
      if (initialFocus) {
        $(closeButtonId).focus();
        initialFocus = false;
      }
    });
  });
}; // NOTE: This is a gross hack to make the skip links work for Webkit browsers
// see http://stackoverflow.com/questions/6280399/skip-links-not-working-in-chrome/12720183#12720183
// handle things properly for clicks


$('.nav-skip').click(function () {
  var href = $(this).attr('href');

  if (href) {
    $(href).attr('tabIndex', -1).focus();
  }
}); // and for the enter key

$('.nav-skip').keypress(function (e) {
  var href;

  if (e.which === 13) {
    href = $(this).attr('href');

    if (href) {
      $(href).attr('tabIndex', -1).focus();
    }
  }
}); // Creates a window level SR object that can be used for giving audible feedback to screen readers.

$(function () {
  var SRAlert;

  SRAlert = function () {
    function SRAlert() {
      // This initialization sometimes gets done twice, so take to only create a single reader-feedback div.
      var readerFeedbackID = 'reader-feedback',
          $readerFeedbackSelector = $('#' + readerFeedbackID);

      if ($readerFeedbackSelector.length === 0) {
        __webpack_provided_edx_dot_HtmlUtils.append($('body'), __webpack_provided_edx_dot_HtmlUtils.interpolateHtml(__webpack_provided_edx_dot_HtmlUtils.HTML('<div id="{readerFeedbackID}" class="sr" aria-live="polite"></div>'), {
          readerFeedbackID: readerFeedbackID
        }));
      }

      this.el = $('#' + readerFeedbackID);
    }

    SRAlert.prototype.clear = function () {
      __webpack_provided_edx_dot_HtmlUtils.setHtml(this.el, '');
    };

    SRAlert.prototype.readElts = function (elts) {
      var texts = [];
      $.each(elts, function (idx, value) {
        texts.push($(value).html());
      });
      return this.readTexts(texts);
    };

    SRAlert.prototype.readText = function (text) {
      return this.readTexts([text]);
    };

    SRAlert.prototype.readTexts = function (texts) {
      var htmlFeedback = __webpack_provided_edx_dot_HtmlUtils.HTML('');
      $.each(texts, function (idx, value) {
        htmlFeedback = __webpack_provided_edx_dot_HtmlUtils.interpolateHtml(__webpack_provided_edx_dot_HtmlUtils.HTML('{previous_feedback}<p>{value}</p>\n'), // "value" may be HTML, if an element is being passed
        {
          previous_feedback: htmlFeedback,
          value: __webpack_provided_edx_dot_HtmlUtils.HTML(value)
        });
      });
      __webpack_provided_edx_dot_HtmlUtils.setHtml(this.el, htmlFeedback);
    };

    return SRAlert;
  }();

  window.SR = new SRAlert();
});
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/html-utils.js")))

/***/ }),

/***/ "./common/static/js/src/ajax_prefix.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {// Once generated by CoffeeScript 1.9.3, but now lives as pure JS

/* eslint-disable */
(function () {
  this.AjaxPrefix = {
    addAjaxPrefix: function addAjaxPrefix(jQuery, prefix) {
      jQuery.postWithPrefix = function (url, data, callback, type) {
        return $.post("" + prefix() + url, data, callback, type);
      };

      jQuery.getWithPrefix = function (url, data, callback, type) {
        return $.get("" + prefix() + url, data, callback, type);
      };

      return jQuery.ajaxWithPrefix = function (url, settings) {
        if (settings != null) {
          return $.ajax("" + prefix() + url, settings);
        } else {
          settings = url;
          settings.url = "" + prefix() + settings.url;
          return $.ajax(settings);
        }
      };
    }
  };
}).call(this);
/*** EXPORTS FROM exports-loader ***/

module.exports = this.AjaxPrefix;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/src/ie_shim.js":
/***/ (function(module, exports) {

/*
 * This file is used for keeping compatibility with Internet Explorer.
 * As starting with IE10, the conditional comments are not supported, this file
 * will always be loaded whether the browser is IE or not. Therefore, the code
 * here should not make any assumption and should always detect the execution
 * conditions itself.
 */
// Shim name: Create the attribute of 'window.location.origin'
// IE version: 11 or earlier, 12 or later not tested
// Internet Explorer does not have built-in property 'window.location.origin',
// we need to create one here as some vendor code such as TinyMCE uses this.
if (!window.location.origin) {
  window.location.origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');
}

/***/ }),

/***/ "./common/static/js/src/jquery.immediateDescendents.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {// Once generated by CoffeeScript 1.9.3, but now lives as pure JS

/* eslint-disable */

/*
Find all the children of an element that match the selector, but only
the first instance found down any path.  For example, we'll find all
the ".xblock" elements below us, but not the ones that are themselves
contained somewhere inside ".xblock" elements.
 */
(function () {
  jQuery.fn.immediateDescendents = function (selector) {
    return this.children().map(function () {
      var elem;
      elem = jQuery(this);

      if (elem.is(selector)) {
        return this;
      } else {
        return elem.immediateDescendents(selector).get();
      }
    });
  };
}).call(this);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/src/jquery_extend_patch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*

`extend` function of jquery (jQuery < 3.4.0) is known to have Prototype Pollution vulnerability.
This IIFE is used to rebind `extend` function with its patched implementation.

TODO: Remove this file and all its uses after upgrading to version >= 3.4.0

*/
(function () {
  jQuery.extend = jQuery.fn.extend = function () {
    var options,
        name,
        src,
        copy,
        copyIsArray,
        clone,
        target = arguments[0] || {},
        i = 1,
        length = arguments.length,
        deep = false; // Handle a deep copy situation

    if (typeof target === "boolean") {
      deep = target; // Skip the boolean and the target

      target = arguments[i] || {};
      i++;
    } // Handle case when target is a string or something (possible in deep copy)


    if (_typeof(target) !== "object" && !jQuery.isFunction(target)) {
      target = {};
    } // Extend jQuery itself if only one argument is passed


    if (i === length) {
      target = this;
      i--;
    }

    for (; i < length; i++) {
      // Only deal with non-null/undefined values
      if ((options = arguments[i]) != null) {
        // Extend the base object
        for (name in options) {
          copy = options[name]; // Prevent Object.prototype pollution
          // Prevent never-ending loop

          if (name === "__proto__" || target === copy) {
            continue;
          } // Recurse if we're merging plain objects or arrays


          if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) {
            src = target[name]; // Ensure proper type for the source value

            if (copyIsArray && !Array.isArray(src)) {
              clone = [];
            } else if (!copyIsArray && !jQuery.isPlainObject(src)) {
              clone = {};
            } else {
              clone = src;
            }

            copyIsArray = false; // Never move original objects, clone them

            target[name] = jQuery.extend(deep, clone, copy); // Don't bring in undefined values
          } else if (copy !== undefined) {
            target[name] = copy;
          }
        }
      }
    } // Return the modified object


    return target;
  };
})();
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/src/lang_edx.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {var Language = function () {
  'use strict';

  var $settings_language_selector,
      self = null;
  return {
    init: function init() {
      $settings_language_selector = $('#settings-language-value');
      self = this;
      this.listenForLanguagePreferenceChange();
    },

    /**
     * Listener on changing language from selector.
     * Send an ajax request to save user language preferences.
     */
    listenForLanguagePreferenceChange: function listenForLanguagePreferenceChange() {
      $settings_language_selector.change(function (event) {
        var language = this.value,
            url = $('.url-endpoint').val(),
            is_user_authenticated = JSON.parse($('.url-endpoint').data('user-is-authenticated'));
        event.preventDefault();
        self.submitAjaxRequest(language, url, function () {
          if (is_user_authenticated) {
            // User language preference has been set successfully
            // Now submit the form in success callback.
            $('#language-settings-form').submit();
          } else {
            self.refresh();
          }
        });
      });
    },

    /**
     * Send an ajax request to set user language preferences.
     */
    submitAjaxRequest: function submitAjaxRequest(language, url, callback) {
      $.ajax({
        type: 'PATCH',
        data: JSON.stringify({
          'pref-lang': language
        }),
        url: url,
        dataType: 'json',
        contentType: 'application/merge-patch+json',
        notifyOnError: false,
        beforeSend: function beforeSend(xhr) {
          xhr.setRequestHeader('X-CSRFToken', $.cookie('csrftoken'));
        }
      }).done(function () {
        callback();
      }).fail(function () {
        self.refresh();
      });
    },

    /**
     * refresh the page.
     */
    refresh: function refresh() {
      // reloading the page so we can get the latest state of released languages from model
      location.reload();
    }
  };
}();

$(document).ready(function () {
  'use strict';

  Language.init();
});
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/src/logger.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {/*** IMPORTS FROM imports-loader ***/
(function () {
  (function () {
    'use strict';

    var Logger = function () {
      // listeners[event_type][element] -> list of callbacks
      var listeners = {},
          sendRequest,
          has;

      sendRequest = function sendRequest(data, options) {
        var request = $.ajaxWithPrefix ? $.ajaxWithPrefix : $.ajax;
        options = $.extend(true, {
          url: '/event',
          type: 'POST',
          data: data,
          async: true
        }, options);
        return request(options);
      };

      has = function has(object, propertyName) {
        return {}.hasOwnProperty.call(object, propertyName);
      };

      return {
        /**
         * Emits an event.
         *
         * Note that this method is used by external XBlocks, and the API cannot change without
         * proper deprecation and notification for external authors.
         */
        log: function log(eventType, data, element, requestOptions) {
          var callbacks;

          if (!element) {
            // null element in the listener dictionary means any element will do.
            // null element in the Logger.log call means we don't know the element name.
            element = null;
          } // Check to see if we're listening for the event type.


          if (has(listeners, eventType)) {
            if (has(listeners[eventType], element)) {
              // Make the callbacks.
              callbacks = listeners[eventType][element];
              $.each(callbacks, function (index, callback) {
                try {
                  callback(eventType, data, element);
                } catch (err) {
                  console.error({
                    eventType: eventType,
                    data: data,
                    element: element,
                    error: err
                  });
                }
              });
            }
          } // Regardless of whether any callbacks were made, log this event.


          return sendRequest({
            event_type: eventType,
            event: JSON.stringify(data),
            courserun_key: typeof $$course_id !== 'undefined' ? $$course_id : null,
            page: window.location.href
          }, requestOptions);
        },

        /**
         * Adds a listener. If you want any element to trigger this listener,
         * do element = null.
         *
         * Note that this method is used by external XBlocks, and the API cannot change without
         * proper deprecation and notification for external authors.
         */
        listen: function listen(eventType, element, callback) {
          listeners[eventType] = listeners[eventType] || {};
          listeners[eventType][element] = listeners[eventType][element] || [];
          listeners[eventType][element].push(callback);
        },

        /**
         * Binds `page_close` event.
         *
         * Note that this method is used by external XBlocks, and the API cannot change without
         * proper deprecation and notification for external authors.
         */
        bind: function bind() {
          window.onunload = function () {
            sendRequest({
              event_type: 'page_close',
              event: '',
              page: window.location.href
            }, {
              type: 'GET',
              async: false
            });
          };
        }
      };
    }();

    this.Logger = Logger; // log_event exists for compatibility reasons and will soon be deprecated.

    this.log_event = Logger.log;
  }).call(this);
}).call(window);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/src/tooltip_manager.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($, _) {(function () {
  'use strict';

  var TooltipManager = function TooltipManager(element) {
    this.element = $(element); // If tooltip container already exist, use it.

    this.tooltip = $('div.' + this.className.split(/\s+/).join('.')); // Otherwise, create new one.

    if (!this.tooltip.length) {
      this.tooltip = $('<div />', {
        "class": this.className
      }).appendTo(this.element); // xss-lint: disable=javascript-jquery-insert-into-target
    }

    this.hide();

    _.bindAll(this, 'show', 'hide', 'showTooltip', 'moveTooltip', 'hideTooltip', 'click');

    this.bindEvents();
  };

  TooltipManager.prototype = {
    // Space separated list of class names for the tooltip container.
    className: 'tooltip',
    SELECTOR: '[data-tooltip]',
    bindEvents: function bindEvents() {
      this.element.on({
        'mouseover.TooltipManager': this.showTooltip,
        'mousemove.TooltipManager': this.moveTooltip,
        'mouseout.TooltipManager': this.hideTooltip,
        'click.TooltipManager': this.click
      }, this.SELECTOR);
    },
    getCoords: function getCoords(pageX, pageY) {
      return {
        left: pageX - 0.5 * this.tooltip.outerWidth(),
        top: pageY - (this.tooltip.outerHeight() + 15)
      };
    },
    show: function show() {
      this.tooltip.show().css('opacity', 1);
    },
    hide: function hide() {
      this.tooltip.hide().css('opacity', 0);
    },
    showTooltip: function showTooltip(event) {
      this.prepareTooltip(event.currentTarget, event.pageX, event.pageY);

      if (this.tooltipTimer) {
        clearTimeout(this.tooltipTimer);
      }

      this.tooltipTimer = setTimeout(this.show, 500);
    },
    prepareTooltip: function prepareTooltip(element, pageX, pageY) {
      pageX = typeof pageX !== 'undefined' ? pageX : element.offset().left + element.width() / 2;
      pageY = typeof pageY !== 'undefined' ? pageY : element.offset().top + element.height() / 2;
      var tooltipText = $(element).attr('data-tooltip');
      this.tooltip.text(tooltipText).css(this.getCoords(pageX, pageY));
    },
    // To manually trigger a tooltip to reveal, other than through user mouse movement:
    openTooltip: function openTooltip(element) {
      this.prepareTooltip(element);
      this.show();

      if (this.tooltipTimer) {
        clearTimeout(this.tooltipTimer);
      }
    },
    moveTooltip: function moveTooltip(event) {
      this.tooltip.css(this.getCoords(event.pageX, event.pageY));
    },
    hideTooltip: function hideTooltip() {
      clearTimeout(this.tooltipTimer); // Wait for a 50ms before hiding the tooltip to avoid blinking when
      // the item contains nested elements.

      this.tooltipTimer = setTimeout(this.hide, 50);
    },
    click: function click(event) {
      var showOnClick = !!$(event.currentTarget).data('tooltip-show-on-click'); // Default is false

      if (showOnClick) {
        this.show();

        if (this.tooltipTimer) {
          clearTimeout(this.tooltipTimer);
        }
      } else {
        this.hideTooltip(event);
      }
    },
    destroy: function destroy() {
      this.tooltip.remove(); // Unbind all delegated event handlers in the ".TooltipManager"
      // namespace.

      this.element.off('.TooltipManager', this.SELECTOR);
    }
  };
  window.TooltipManager = TooltipManager;
  $(document).ready(function () {
    window.globalTooltipManager = new TooltipManager(document.body);
  });
})();
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0), __webpack_require__(1)))

/***/ }),

/***/ "./common/static/js/src/utility.js":
/***/ (function(module, exports) {

// checks whether or not the url is external to the local site.
// generously provided by StackOverflow: http://stackoverflow.com/questions/6238351/fastest-way-to-detect-external-urls
window.isExternal = function (url) {
  // parse the url into protocol, host, path, query, and fragment. More information can be found here: http://tools.ietf.org/html/rfc3986#appendix-B
  var match = url.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/); // match[1] matches a protocol if one exists in the url
  // if the protocol in the url does not match the protocol in the window's location, this url is considered external

  if (typeof match[1] === 'string' && match[1].length > 0 && match[1].toLowerCase() !== location.protocol) {
    return true;
  } // match[2] matches the host if one exists in the url
  // if the host in the url does not match the host of the window location, this url is considered external


  if (typeof match[2] === 'string' && match[2].length > 0 && // this regex removes the port number if it patches the current location's protocol
  match[2].replace(new RegExp(':(' + {
    'http:': 80,
    'https:': 443
  }[location.protocol] + ')?$'), '') !== location.host) {
    return true;
  }

  return false;
}; // Utility method for replacing a portion of a string.


window.rewriteStaticLinks = function (content, from, to) {
  if (from === null || to === null) {
    return content;
  } // replace only relative urls


  function replacer(match) {
    if (match === from) {
      return to;
    } else {
      return match;
    }
  } // change all relative urls only which may be embedded inside other tags in content.
  // handle http and https
  // escape all regex interpretable chars


  fromRe = from.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
  var regex = new RegExp('(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}([-a-zA-Z0-9@:%_\+.~#?&//=]*))?' + fromRe, 'g');
  return content.replace(regex, replacer);
};

/***/ }),

/***/ "./common/static/js/vendor/date.js":
/***/ (function(module, exports) {

/**
 * @version: 1.0 Alpha-1
 * @author: Coolite Inc. http://www.coolite.com/
 * @date: 2008-05-13
 * @copyright: Copyright (c) 2006-2008, Coolite Inc. (http://www.coolite.com/). All rights reserved.
 * @license: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/.
 * @website: http://www.datejs.com/
 */
Date.CultureInfo = {
  name: "en-US",
  englishName: "English (United States)",
  nativeName: "English (United States)",
  dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
  abbreviatedDayNames: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
  shortestDayNames: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
  firstLetterDayNames: ["S", "M", "T", "W", "T", "F", "S"],
  monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
  abbreviatedMonthNames: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  amDesignator: "AM",
  pmDesignator: "PM",
  firstDayOfWeek: 0,
  twoDigitYearMax: 2029,
  dateElementOrder: "mdy",
  formatPatterns: {
    shortDate: "M/d/yyyy",
    longDate: "dddd, MMMM dd, yyyy",
    shortTime: "h:mm tt",
    longTime: "h:mm:ss tt",
    fullDateTime: "dddd, MMMM dd, yyyy h:mm:ss tt",
    sortableDateTime: "yyyy-MM-ddTHH:mm:ss",
    universalSortableDateTime: "yyyy-MM-dd HH:mm:ssZ",
    rfc1123: "ddd, dd MMM yyyy HH:mm:ss GMT",
    monthDay: "MMMM dd",
    yearMonth: "MMMM, yyyy"
  },
  regexPatterns: {
    jan: /^jan(uary)?/i,
    feb: /^feb(ruary)?/i,
    mar: /^mar(ch)?/i,
    apr: /^apr(il)?/i,
    may: /^may/i,
    jun: /^jun(e)?/i,
    jul: /^jul(y)?/i,
    aug: /^aug(ust)?/i,
    sep: /^sep(t(ember)?)?/i,
    oct: /^oct(ober)?/i,
    nov: /^nov(ember)?/i,
    dec: /^dec(ember)?/i,
    sun: /^su(n(day)?)?/i,
    mon: /^mo(n(day)?)?/i,
    tue: /^tu(e(s(day)?)?)?/i,
    wed: /^we(d(nesday)?)?/i,
    thu: /^th(u(r(s(day)?)?)?)?/i,
    fri: /^fr(i(day)?)?/i,
    sat: /^sa(t(urday)?)?/i,
    future: /^next/i,
    past: /^last|past|prev(ious)?/i,
    add: /^(\+|aft(er)?|from|hence)/i,
    subtract: /^(\-|bef(ore)?|ago)/i,
    yesterday: /^yes(terday)?/i,
    today: /^t(od(ay)?)?/i,
    tomorrow: /^tom(orrow)?/i,
    now: /^n(ow)?/i,
    millisecond: /^ms|milli(second)?s?/i,
    second: /^sec(ond)?s?/i,
    minute: /^mn|min(ute)?s?/i,
    hour: /^h(our)?s?/i,
    week: /^w(eek)?s?/i,
    month: /^m(onth)?s?/i,
    day: /^d(ay)?s?/i,
    year: /^y(ear)?s?/i,
    shortMeridian: /^(a|p)/i,
    longMeridian: /^(a\.?m?\.?|p\.?m?\.?)/i,
    timezone: /^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,
    ordinalSuffix: /^\s*(st|nd|rd|th)/i,
    timeContext: /^\s*(\:|a(?!u|p)|p)/i
  },
  timezones: [{
    name: "UTC",
    offset: "-000"
  }, {
    name: "GMT",
    offset: "-000"
  }, {
    name: "EST",
    offset: "-0500"
  }, {
    name: "EDT",
    offset: "-0400"
  }, {
    name: "CST",
    offset: "-0600"
  }, {
    name: "CDT",
    offset: "-0500"
  }, {
    name: "MST",
    offset: "-0700"
  }, {
    name: "MDT",
    offset: "-0600"
  }, {
    name: "PST",
    offset: "-0800"
  }, {
    name: "PDT",
    offset: "-0700"
  }]
};

(function () {
  var $D = Date,
      $P = $D.prototype,
      $C = $D.CultureInfo,
      p = function p(s, l) {
    if (!l) {
      l = 2;
    }

    return ("000" + s).slice(l * -1);
  };

  $P.clearTime = function () {
    this.setHours(0);
    this.setMinutes(0);
    this.setSeconds(0);
    this.setMilliseconds(0);
    return this;
  };

  $P.setTimeToNow = function () {
    var n = new Date();
    this.setHours(n.getHours());
    this.setMinutes(n.getMinutes());
    this.setSeconds(n.getSeconds());
    this.setMilliseconds(n.getMilliseconds());
    return this;
  };

  $D.today = function () {
    return new Date().clearTime();
  };

  $D.compare = function (date1, date2) {
    if (isNaN(date1) || isNaN(date2)) {
      throw new Error(date1 + " - " + date2);
    } else if (date1 instanceof Date && date2 instanceof Date) {
      return date1 < date2 ? -1 : date1 > date2 ? 1 : 0;
    } else {
      throw new TypeError(date1 + " - " + date2);
    }
  };

  $D.equals = function (date1, date2) {
    return date1.compareTo(date2) === 0;
  };

  $D.getDayNumberFromName = function (name) {
    var n = $C.dayNames,
        m = $C.abbreviatedDayNames,
        o = $C.shortestDayNames,
        s = name.toLowerCase();

    for (var i = 0; i < n.length; i++) {
      if (n[i].toLowerCase() == s || m[i].toLowerCase() == s || o[i].toLowerCase() == s) {
        return i;
      }
    }

    return -1;
  };

  $D.getMonthNumberFromName = function (name) {
    var n = $C.monthNames,
        m = $C.abbreviatedMonthNames,
        s = name.toLowerCase();

    for (var i = 0; i < n.length; i++) {
      if (n[i].toLowerCase() == s || m[i].toLowerCase() == s) {
        return i;
      }
    }

    return -1;
  };

  $D.isLeapYear = function (year) {
    return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
  };

  $D.getDaysInMonth = function (year, month) {
    return [31, $D.isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
  };

  $D.getTimezoneAbbreviation = function (offset) {
    var z = $C.timezones,
        p;

    for (var i = 0; i < z.length; i++) {
      if (z[i].offset === offset) {
        return z[i].name;
      }
    }

    return null;
  };

  $D.getTimezoneOffset = function (name) {
    var z = $C.timezones,
        p;

    for (var i = 0; i < z.length; i++) {
      if (z[i].name === name.toUpperCase()) {
        return z[i].offset;
      }
    }

    return null;
  };

  $P.clone = function () {
    return new Date(this.getTime());
  };

  $P.compareTo = function (date) {
    return Date.compare(this, date);
  };

  $P.equals = function (date) {
    return Date.equals(this, date || new Date());
  };

  $P.between = function (start, end) {
    return this.getTime() >= start.getTime() && this.getTime() <= end.getTime();
  };

  $P.isAfter = function (date) {
    return this.compareTo(date || new Date()) === 1;
  };

  $P.isBefore = function (date) {
    return this.compareTo(date || new Date()) === -1;
  };

  $P.isToday = function () {
    return this.isSameDay(new Date());
  };

  $P.isSameDay = function (date) {
    return this.clone().clearTime().equals(date.clone().clearTime());
  };

  $P.addMilliseconds = function (value) {
    this.setMilliseconds(this.getMilliseconds() + value);
    return this;
  };

  $P.addSeconds = function (value) {
    return this.addMilliseconds(value * 1000);
  };

  $P.addMinutes = function (value) {
    return this.addMilliseconds(value * 60000);
  };

  $P.addHours = function (value) {
    return this.addMilliseconds(value * 3600000);
  };

  $P.addDays = function (value) {
    this.setDate(this.getDate() + value);
    return this;
  };

  $P.addWeeks = function (value) {
    return this.addDays(value * 7);
  };

  $P.addMonths = function (value) {
    var n = this.getDate();
    this.setDate(1);
    this.setMonth(this.getMonth() + value);
    this.setDate(Math.min(n, $D.getDaysInMonth(this.getFullYear(), this.getMonth())));
    return this;
  };

  $P.addYears = function (value) {
    return this.addMonths(value * 12);
  };

  $P.add = function (config) {
    if (typeof config == "number") {
      this._orient = config;
      return this;
    }

    var x = config;

    if (x.milliseconds) {
      this.addMilliseconds(x.milliseconds);
    }

    if (x.seconds) {
      this.addSeconds(x.seconds);
    }

    if (x.minutes) {
      this.addMinutes(x.minutes);
    }

    if (x.hours) {
      this.addHours(x.hours);
    }

    if (x.weeks) {
      this.addWeeks(x.weeks);
    }

    if (x.months) {
      this.addMonths(x.months);
    }

    if (x.years) {
      this.addYears(x.years);
    }

    if (x.days) {
      this.addDays(x.days);
    }

    return this;
  };

  var $y, $m, $d;

  $P.getWeek = function () {
    var a, b, c, d, e, f, g, n, s, w;
    $y = !$y ? this.getFullYear() : $y;
    $m = !$m ? this.getMonth() + 1 : $m;
    $d = !$d ? this.getDate() : $d;

    if ($m <= 2) {
      a = $y - 1;
      b = (a / 4 | 0) - (a / 100 | 0) + (a / 400 | 0);
      c = ((a - 1) / 4 | 0) - ((a - 1) / 100 | 0) + ((a - 1) / 400 | 0);
      s = b - c;
      e = 0;
      f = $d - 1 + 31 * ($m - 1);
    } else {
      a = $y;
      b = (a / 4 | 0) - (a / 100 | 0) + (a / 400 | 0);
      c = ((a - 1) / 4 | 0) - ((a - 1) / 100 | 0) + ((a - 1) / 400 | 0);
      s = b - c;
      e = s + 1;
      f = $d + (153 * ($m - 3) + 2) / 5 + 58 + s;
    }

    g = (a + b) % 7;
    d = (f + g - e) % 7;
    n = f + 3 - d | 0;

    if (n < 0) {
      w = 53 - ((g - s) / 5 | 0);
    } else if (n > 364 + s) {
      w = 1;
    } else {
      w = (n / 7 | 0) + 1;
    }

    $y = $m = $d = null;
    return w;
  };

  $P.getISOWeek = function () {
    $y = this.getUTCFullYear();
    $m = this.getUTCMonth() + 1;
    $d = this.getUTCDate();
    return p(this.getWeek());
  };

  $P.setWeek = function (n) {
    return this.moveToDayOfWeek(1).addWeeks(n - this.getWeek());
  };

  $D._validate = function (n, min, max, name) {
    if (typeof n == "undefined") {
      return false;
    } else if (typeof n != "number") {
      throw new TypeError(n + " is not a Number.");
    } else if (n < min || n > max) {
      throw new RangeError(n + " is not a valid value for " + name + ".");
    }

    return true;
  };

  $D.validateMillisecond = function (value) {
    return $D._validate(value, 0, 999, "millisecond");
  };

  $D.validateSecond = function (value) {
    return $D._validate(value, 0, 59, "second");
  };

  $D.validateMinute = function (value) {
    return $D._validate(value, 0, 59, "minute");
  };

  $D.validateHour = function (value) {
    return $D._validate(value, 0, 23, "hour");
  };

  $D.validateDay = function (value, year, month) {
    return $D._validate(value, 1, $D.getDaysInMonth(year, month), "day");
  };

  $D.validateMonth = function (value) {
    return $D._validate(value, 0, 11, "month");
  };

  $D.validateYear = function (value) {
    return $D._validate(value, 0, 9999, "year");
  };

  $P.set = function (config) {
    if ($D.validateMillisecond(config.millisecond)) {
      this.addMilliseconds(config.millisecond - this.getMilliseconds());
    }

    if ($D.validateSecond(config.second)) {
      this.addSeconds(config.second - this.getSeconds());
    }

    if ($D.validateMinute(config.minute)) {
      this.addMinutes(config.minute - this.getMinutes());
    }

    if ($D.validateHour(config.hour)) {
      this.addHours(config.hour - this.getHours());
    }

    if ($D.validateMonth(config.month)) {
      this.addMonths(config.month - this.getMonth());
    }

    if ($D.validateYear(config.year)) {
      this.addYears(config.year - this.getFullYear());
    }

    if ($D.validateDay(config.day, this.getFullYear(), this.getMonth())) {
      this.addDays(config.day - this.getDate());
    }

    if (config.timezone) {
      this.setTimezone(config.timezone);
    }

    if (config.timezoneOffset) {
      this.setTimezoneOffset(config.timezoneOffset);
    }

    if (config.week && $D._validate(config.week, 0, 53, "week")) {
      this.setWeek(config.week);
    }

    return this;
  };

  $P.moveToFirstDayOfMonth = function () {
    return this.set({
      day: 1
    });
  };

  $P.moveToLastDayOfMonth = function () {
    return this.set({
      day: $D.getDaysInMonth(this.getFullYear(), this.getMonth())
    });
  };

  $P.moveToNthOccurrence = function (dayOfWeek, occurrence) {
    var shift = 0;

    if (occurrence > 0) {
      shift = occurrence - 1;
    } else if (occurrence === -1) {
      this.moveToLastDayOfMonth();

      if (this.getDay() !== dayOfWeek) {
        this.moveToDayOfWeek(dayOfWeek, -1);
      }

      return this;
    }

    return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(dayOfWeek, +1).addWeeks(shift);
  };

  $P.moveToDayOfWeek = function (dayOfWeek, orient) {
    var diff = (dayOfWeek - this.getDay() + 7 * (orient || +1)) % 7;
    return this.addDays(diff === 0 ? diff += 7 * (orient || +1) : diff);
  };

  $P.moveToMonth = function (month, orient) {
    var diff = (month - this.getMonth() + 12 * (orient || +1)) % 12;
    return this.addMonths(diff === 0 ? diff += 12 * (orient || +1) : diff);
  };

  $P.getOrdinalNumber = function () {
    return Math.ceil((this.clone().clearTime() - new Date(this.getFullYear(), 0, 1)) / 86400000) + 1;
  };

  $P.getTimezone = function () {
    return $D.getTimezoneAbbreviation(this.getUTCOffset());
  };

  $P.setTimezoneOffset = function (offset) {
    var here = this.getTimezoneOffset(),
        there = Number(offset) * -6 / 10;
    return this.addMinutes(there - here);
  };

  $P.setTimezone = function (offset) {
    return this.setTimezoneOffset($D.getTimezoneOffset(offset));
  };

  $P.hasDaylightSavingTime = function () {
    return Date.today().set({
      month: 0,
      day: 1
    }).getTimezoneOffset() !== Date.today().set({
      month: 6,
      day: 1
    }).getTimezoneOffset();
  };

  $P.isDaylightSavingTime = function () {
    return this.hasDaylightSavingTime() && new Date().getTimezoneOffset() === Date.today().set({
      month: 6,
      day: 1
    }).getTimezoneOffset();
  };

  $P.getUTCOffset = function () {
    var n = this.getTimezoneOffset() * -10 / 6,
        r;

    if (n < 0) {
      r = (n - 10000).toString();
      return r.charAt(0) + r.substr(2);
    } else {
      r = (n + 10000).toString();
      return "+" + r.substr(1);
    }
  };

  $P.getElapsed = function (date) {
    return (date || new Date()) - this;
  };

  if (!$P.toISOString) {
    $P.toISOString = function () {
      function f(n) {
        return n < 10 ? '0' + n : n;
      }

      return '"' + this.getUTCFullYear() + '-' + f(this.getUTCMonth() + 1) + '-' + f(this.getUTCDate()) + 'T' + f(this.getUTCHours()) + ':' + f(this.getUTCMinutes()) + ':' + f(this.getUTCSeconds()) + 'Z"';
    };
  }

  if (typeof $P._toString === 'undefined') {
    $P._toString = $P.toString;
  }

  $P.toString = function (format) {
    var x = this;

    if (format && format.length == 1) {
      var c = $C.formatPatterns;
      x.t = x.toString;

      switch (format) {
        case "d":
          return x.t(c.shortDate);

        case "D":
          return x.t(c.longDate);

        case "F":
          return x.t(c.fullDateTime);

        case "m":
          return x.t(c.monthDay);

        case "r":
          return x.t(c.rfc1123);

        case "s":
          return x.t(c.sortableDateTime);

        case "t":
          return x.t(c.shortTime);

        case "T":
          return x.t(c.longTime);

        case "u":
          return x.t(c.universalSortableDateTime);

        case "y":
          return x.t(c.yearMonth);
      }
    }

    var ord = function ord(n) {
      switch (n * 1) {
        case 1:
        case 21:
        case 31:
          return "st";

        case 2:
        case 22:
          return "nd";

        case 3:
        case 23:
          return "rd";

        default:
          return "th";
      }
    };

    return format ? format.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g, function (m) {
      if (m.charAt(0) === "\\") {
        return m.replace("\\", "");
      }

      x.h = x.getHours;

      switch (m) {
        case "hh":
          return p(x.h() < 13 ? x.h() === 0 ? 12 : x.h() : x.h() - 12);

        case "h":
          return x.h() < 13 ? x.h() === 0 ? 12 : x.h() : x.h() - 12;

        case "HH":
          return p(x.h());

        case "H":
          return x.h();

        case "mm":
          return p(x.getMinutes());

        case "m":
          return x.getMinutes();

        case "ss":
          return p(x.getSeconds());

        case "s":
          return x.getSeconds();

        case "yyyy":
          return p(x.getFullYear(), 4);

        case "yy":
          return p(x.getFullYear());

        case "dddd":
          return $C.dayNames[x.getDay()];

        case "ddd":
          return $C.abbreviatedDayNames[x.getDay()];

        case "dd":
          return p(x.getDate());

        case "d":
          return x.getDate();

        case "MMMM":
          return $C.monthNames[x.getMonth()];

        case "MMM":
          return $C.abbreviatedMonthNames[x.getMonth()];

        case "MM":
          return p(x.getMonth() + 1);

        case "M":
          return x.getMonth() + 1;

        case "t":
          return x.h() < 12 ? $C.amDesignator.substring(0, 1) : $C.pmDesignator.substring(0, 1);

        case "tt":
          return x.h() < 12 ? $C.amDesignator : $C.pmDesignator;

        case "S":
          return ord(x.getDate());

        default:
          return m;
      }
    }) : this._toString();
  };
})();

(function () {
  var $D = Date,
      $P = $D.prototype,
      $C = $D.CultureInfo,
      $N = Number.prototype;
  $P._orient = +1;
  $P._nth = null;
  $P._is = false;
  $P._same = false;
  $P._isSecond = false;
  $N._dateElement = "day";

  $P.next = function () {
    this._orient = +1;
    return this;
  };

  $D.next = function () {
    return $D.today().next();
  };

  $P.last = $P.prev = $P.previous = function () {
    this._orient = -1;
    return this;
  };

  $D.last = $D.prev = $D.previous = function () {
    return $D.today().last();
  };

  $P.is = function () {
    this._is = true;
    return this;
  };

  $P.same = function () {
    this._same = true;
    this._isSecond = false;
    return this;
  };

  $P.today = function () {
    return this.same().day();
  };

  $P.weekday = function () {
    if (this._is) {
      this._is = false;
      return !this.is().sat() && !this.is().sun();
    }

    return false;
  };

  $P.at = function (time) {
    return typeof time === "string" ? $D.parse(this.toString("d") + " " + time) : this.set(time);
  };

  $N.fromNow = $N.after = function (date) {
    var c = {};
    c[this._dateElement] = this;
    return (!date ? new Date() : date.clone()).add(c);
  };

  $N.ago = $N.before = function (date) {
    var c = {};
    c[this._dateElement] = this * -1;
    return (!date ? new Date() : date.clone()).add(c);
  };

  var dx = "sunday monday tuesday wednesday thursday friday saturday".split(/\s/),
      mx = "january february march april may june july august september october november december".split(/\s/),
      px = "Millisecond Second Minute Hour Day Week Month Year".split(/\s/),
      pxf = "Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),
      nth = "final first second third fourth fifth".split(/\s/),
      de;

  $P.toObject = function () {
    var o = {};

    for (var i = 0; i < px.length; i++) {
      o[px[i].toLowerCase()] = this["get" + pxf[i]]();
    }

    return o;
  };

  $D.fromObject = function (config) {
    config.week = null;
    return Date.today().set(config);
  };

  var df = function df(n) {
    return function () {
      if (this._is) {
        this._is = false;
        return this.getDay() == n;
      }

      if (this._nth !== null) {
        if (this._isSecond) {
          this.addSeconds(this._orient * -1);
        }

        this._isSecond = false;
        var ntemp = this._nth;
        this._nth = null;
        var temp = this.clone().moveToLastDayOfMonth();
        this.moveToNthOccurrence(n, ntemp);

        if (this > temp) {
          throw new RangeError($D.getDayName(n) + " does not occur " + ntemp + " times in the month of " + $D.getMonthName(temp.getMonth()) + " " + temp.getFullYear() + ".");
        }

        return this;
      }

      return this.moveToDayOfWeek(n, this._orient);
    };
  };

  var sdf = function sdf(n) {
    return function () {
      var t = $D.today(),
          shift = n - t.getDay();

      if (n === 0 && $C.firstDayOfWeek === 1 && t.getDay() !== 0) {
        shift = shift + 7;
      }

      return t.addDays(shift);
    };
  };

  for (var i = 0; i < dx.length; i++) {
    $D[dx[i].toUpperCase()] = $D[dx[i].toUpperCase().substring(0, 3)] = i;
    $D[dx[i]] = $D[dx[i].substring(0, 3)] = sdf(i);
    $P[dx[i]] = $P[dx[i].substring(0, 3)] = df(i);
  }

  var mf = function mf(n) {
    return function () {
      if (this._is) {
        this._is = false;
        return this.getMonth() === n;
      }

      return this.moveToMonth(n, this._orient);
    };
  };

  var smf = function smf(n) {
    return function () {
      return $D.today().set({
        month: n,
        day: 1
      });
    };
  };

  for (var j = 0; j < mx.length; j++) {
    $D[mx[j].toUpperCase()] = $D[mx[j].toUpperCase().substring(0, 3)] = j;
    $D[mx[j]] = $D[mx[j].substring(0, 3)] = smf(j);
    $P[mx[j]] = $P[mx[j].substring(0, 3)] = mf(j);
  }

  var ef = function ef(j) {
    return function () {
      if (this._isSecond) {
        this._isSecond = false;
        return this;
      }

      if (this._same) {
        this._same = this._is = false;
        var o1 = this.toObject(),
            o2 = (arguments[0] || new Date()).toObject(),
            v = "",
            k = j.toLowerCase();

        for (var m = px.length - 1; m > -1; m--) {
          v = px[m].toLowerCase();

          if (o1[v] != o2[v]) {
            return false;
          }

          if (k == v) {
            break;
          }
        }

        return true;
      }

      if (j.substring(j.length - 1) != "s") {
        j += "s";
      }

      return this["add" + j](this._orient);
    };
  };

  var nf = function nf(n) {
    return function () {
      this._dateElement = n;
      return this;
    };
  };

  for (var k = 0; k < px.length; k++) {
    de = px[k].toLowerCase();
    $P[de] = $P[de + "s"] = ef(px[k]);
    $N[de] = $N[de + "s"] = nf(de);
  }

  $P._ss = ef("Second");

  var nthfn = function nthfn(n) {
    return function (dayOfWeek) {
      if (this._same) {
        return this._ss(arguments[0]);
      }

      if (dayOfWeek || dayOfWeek === 0) {
        return this.moveToNthOccurrence(dayOfWeek, n);
      }

      this._nth = n;

      if (n === 2 && (dayOfWeek === undefined || dayOfWeek === null)) {
        this._isSecond = true;
        return this.addSeconds(this._orient);
      }

      return this;
    };
  };

  for (var l = 0; l < nth.length; l++) {
    $P[nth[l]] = l === 0 ? nthfn(-1) : nthfn(l);
  }
})();

(function () {
  Date.Parsing = {
    Exception: function Exception(s) {
      this.message = "Parse error at '" + s.substring(0, 10) + " ...'";
    }
  };
  var $P = Date.Parsing;

  var _ = $P.Operators = {
    rtoken: function rtoken(r) {
      return function (s) {
        var mx = s.match(r);

        if (mx) {
          return [mx[0], s.substring(mx[0].length)];
        } else {
          throw new $P.Exception(s);
        }
      };
    },
    token: function token(s) {
      return function (s) {
        return _.rtoken(new RegExp("^\s*" + s + "\s*"))(s);
      };
    },
    stoken: function stoken(s) {
      return _.rtoken(new RegExp("^" + s));
    },
    until: function until(p) {
      return function (s) {
        var qx = [],
            rx = null;

        while (s.length) {
          try {
            rx = p.call(this, s);
          } catch (e) {
            qx.push(rx[0]);
            s = rx[1];
            continue;
          }

          break;
        }

        return [qx, s];
      };
    },
    many: function many(p) {
      return function (s) {
        var rx = [],
            r = null;

        while (s.length) {
          try {
            r = p.call(this, s);
          } catch (e) {
            return [rx, s];
          }

          rx.push(r[0]);
          s = r[1];
        }

        return [rx, s];
      };
    },
    optional: function optional(p) {
      return function (s) {
        var r = null;

        try {
          r = p.call(this, s);
        } catch (e) {
          return [null, s];
        }

        return [r[0], r[1]];
      };
    },
    not: function not(p) {
      return function (s) {
        try {
          p.call(this, s);
        } catch (e) {
          return [null, s];
        }

        throw new $P.Exception(s);
      };
    },
    ignore: function ignore(p) {
      return p ? function (s) {
        var r = null;
        r = p.call(this, s);
        return [null, r[1]];
      } : null;
    },
    product: function product() {
      var px = arguments[0],
          qx = Array.prototype.slice.call(arguments, 1),
          rx = [];

      for (var i = 0; i < px.length; i++) {
        rx.push(_.each(px[i], qx));
      }

      return rx;
    },
    cache: function cache(rule) {
      var cache = {},
          r = null;
      return function (s) {
        try {
          r = cache[s] = cache[s] || rule.call(this, s);
        } catch (e) {
          r = cache[s] = e;
        }

        if (r instanceof $P.Exception) {
          throw r;
        } else {
          return r;
        }
      };
    },
    any: function any() {
      var px = arguments;
      return function (s) {
        var r = null;

        for (var i = 0; i < px.length; i++) {
          if (px[i] == null) {
            continue;
          }

          try {
            r = px[i].call(this, s);
          } catch (e) {
            r = null;
          }

          if (r) {
            return r;
          }
        }

        throw new $P.Exception(s);
      };
    },
    each: function each() {
      var px = arguments;
      return function (s) {
        var rx = [],
            r = null;

        for (var i = 0; i < px.length; i++) {
          if (px[i] == null) {
            continue;
          }

          try {
            r = px[i].call(this, s);
          } catch (e) {
            throw new $P.Exception(s);
          }

          rx.push(r[0]);
          s = r[1];
        }

        return [rx, s];
      };
    },
    all: function all() {
      var px = arguments,
          _ = _;
      return _.each(_.optional(px));
    },
    sequence: function sequence(px, d, c) {
      d = d || _.rtoken(/^\s*/);
      c = c || null;

      if (px.length == 1) {
        return px[0];
      }

      return function (s) {
        var r = null,
            q = null;
        var rx = [];

        for (var i = 0; i < px.length; i++) {
          try {
            r = px[i].call(this, s);
          } catch (e) {
            break;
          }

          rx.push(r[0]);

          try {
            q = d.call(this, r[1]);
          } catch (ex) {
            q = null;
            break;
          }

          s = q[1];
        }

        if (!r) {
          throw new $P.Exception(s);
        }

        if (q) {
          throw new $P.Exception(q[1]);
        }

        if (c) {
          try {
            r = c.call(this, r[1]);
          } catch (ey) {
            throw new $P.Exception(r[1]);
          }
        }

        return [rx, r ? r[1] : s];
      };
    },
    between: function between(d1, p, d2) {
      d2 = d2 || d1;

      var _fn = _.each(_.ignore(d1), p, _.ignore(d2));

      return function (s) {
        var rx = _fn.call(this, s);

        return [[rx[0][0], r[0][2]], rx[1]];
      };
    },
    list: function list(p, d, c) {
      d = d || _.rtoken(/^\s*/);
      c = c || null;
      return p instanceof Array ? _.each(_.product(p.slice(0, -1), _.ignore(d)), p.slice(-1), _.ignore(c)) : _.each(_.many(_.each(p, _.ignore(d))), px, _.ignore(c));
    },
    set: function set(px, d, c) {
      d = d || _.rtoken(/^\s*/);
      c = c || null;
      return function (s) {
        var r = null,
            p = null,
            q = null,
            rx = null,
            best = [[], s],
            last = false;

        for (var i = 0; i < px.length; i++) {
          q = null;
          p = null;
          r = null;
          last = px.length == 1;

          try {
            r = px[i].call(this, s);
          } catch (e) {
            continue;
          }

          rx = [[r[0]], r[1]];

          if (r[1].length > 0 && !last) {
            try {
              q = d.call(this, r[1]);
            } catch (ex) {
              last = true;
            }
          } else {
            last = true;
          }

          if (!last && q[1].length === 0) {
            last = true;
          }

          if (!last) {
            var qx = [];

            for (var j = 0; j < px.length; j++) {
              if (i != j) {
                qx.push(px[j]);
              }
            }

            p = _.set(qx, d).call(this, q[1]);

            if (p[0].length > 0) {
              rx[0] = rx[0].concat(p[0]);
              rx[1] = p[1];
            }
          }

          if (rx[1].length < best[1].length) {
            best = rx;
          }

          if (best[1].length === 0) {
            break;
          }
        }

        if (best[0].length === 0) {
          return best;
        }

        if (c) {
          try {
            q = c.call(this, best[1]);
          } catch (ey) {
            throw new $P.Exception(best[1]);
          }

          best[1] = q[1];
        }

        return best;
      };
    },
    forward: function forward(gr, fname) {
      return function (s) {
        return gr[fname].call(this, s);
      };
    },
    replace: function replace(rule, repl) {
      return function (s) {
        var r = rule.call(this, s);
        return [repl, r[1]];
      };
    },
    process: function process(rule, fn) {
      return function (s) {
        var r = rule.call(this, s);
        return [fn.call(this, r[0]), r[1]];
      };
    },
    min: function min(_min, rule) {
      return function (s) {
        var rx = rule.call(this, s);

        if (rx[0].length < _min) {
          throw new $P.Exception(s);
        }

        return rx;
      };
    }
  };

  var _generator = function _generator(op) {
    return function () {
      var args = null,
          rx = [];

      if (arguments.length > 1) {
        args = Array.prototype.slice.call(arguments);
      } else if (arguments[0] instanceof Array) {
        args = arguments[0];
      }

      if (args) {
        for (var i = 0, px = args.shift(); i < px.length; i++) {
          args.unshift(px[i]);
          rx.push(op.apply(null, args));
          args.shift();
          return rx;
        }
      } else {
        return op.apply(null, arguments);
      }
    };
  };

  var gx = "optional not ignore cache".split(/\s/);

  for (var i = 0; i < gx.length; i++) {
    _[gx[i]] = _generator(_[gx[i]]);
  }

  var _vector = function _vector(op) {
    return function () {
      if (arguments[0] instanceof Array) {
        return op.apply(null, arguments[0]);
      } else {
        return op.apply(null, arguments);
      }
    };
  };

  var vx = "each any all".split(/\s/);

  for (var j = 0; j < vx.length; j++) {
    _[vx[j]] = _vector(_[vx[j]]);
  }
})();

(function () {
  var $D = Date,
      $P = $D.prototype,
      $C = $D.CultureInfo;

  var flattenAndCompact = function flattenAndCompact(ax) {
    var rx = [];

    for (var i = 0; i < ax.length; i++) {
      if (ax[i] instanceof Array) {
        rx = rx.concat(flattenAndCompact(ax[i]));
      } else {
        if (ax[i]) {
          rx.push(ax[i]);
        }
      }
    }

    return rx;
  };

  $D.Grammar = {};
  $D.Translator = {
    hour: function hour(s) {
      return function () {
        this.hour = Number(s);
      };
    },
    minute: function minute(s) {
      return function () {
        this.minute = Number(s);
      };
    },
    second: function second(s) {
      return function () {
        this.second = Number(s);
      };
    },
    meridian: function meridian(s) {
      return function () {
        this.meridian = s.slice(0, 1).toLowerCase();
      };
    },
    timezone: function timezone(s) {
      return function () {
        var n = s.replace(/[^\d\+\-]/g, "");

        if (n.length) {
          this.timezoneOffset = Number(n);
        } else {
          this.timezone = s.toLowerCase();
        }
      };
    },
    day: function day(x) {
      var s = x[0];
      return function () {
        this.day = Number(s.match(/\d+/)[0]);
      };
    },
    month: function month(s) {
      return function () {
        this.month = s.length == 3 ? "jan feb mar apr may jun jul aug sep oct nov dec".indexOf(s) / 4 : Number(s) - 1;
      };
    },
    year: function year(s) {
      return function () {
        var n = Number(s);
        this.year = s.length > 2 ? n : n + (n + 2000 < $C.twoDigitYearMax ? 2000 : 1900);
      };
    },
    rday: function rday(s) {
      return function () {
        switch (s) {
          case "yesterday":
            this.days = -1;
            break;

          case "tomorrow":
            this.days = 1;
            break;

          case "today":
            this.days = 0;
            break;

          case "now":
            this.days = 0;
            this.now = true;
            break;
        }
      };
    },
    finishExact: function finishExact(x) {
      x = x instanceof Array ? x : [x];

      for (var i = 0; i < x.length; i++) {
        if (x[i]) {
          x[i].call(this);
        }
      }

      var now = new Date();

      if ((this.hour || this.minute) && !this.month && !this.year && !this.day) {
        this.day = now.getDate();
      }

      if (!this.year) {
        this.year = now.getFullYear();
      }

      if (!this.month && this.month !== 0) {
        this.month = now.getMonth();
      }

      if (!this.day) {
        this.day = 1;
      }

      if (!this.hour) {
        this.hour = 0;
      }

      if (!this.minute) {
        this.minute = 0;
      }

      if (!this.second) {
        this.second = 0;
      }

      if (this.meridian && this.hour) {
        if (this.meridian == "p" && this.hour < 12) {
          this.hour = this.hour + 12;
        } else if (this.meridian == "a" && this.hour == 12) {
          this.hour = 0;
        }
      }

      if (this.day > $D.getDaysInMonth(this.year, this.month)) {
        throw new RangeError(this.day + " is not a valid value for days.");
      }

      var r = new Date(this.year, this.month, this.day, this.hour, this.minute, this.second);

      if (this.timezone) {
        r.set({
          timezone: this.timezone
        });
      } else if (this.timezoneOffset) {
        r.set({
          timezoneOffset: this.timezoneOffset
        });
      }

      return r;
    },
    finish: function finish(x) {
      x = x instanceof Array ? flattenAndCompact(x) : [x];

      if (x.length === 0) {
        return null;
      }

      for (var i = 0; i < x.length; i++) {
        if (typeof x[i] == "function") {
          x[i].call(this);
        }
      }

      var today = $D.today();

      if (this.now && !this.unit && !this.operator) {
        return new Date();
      } else if (this.now) {
        today = new Date();
      }

      var expression = !!(this.days && this.days !== null || this.orient || this.operator);
      var gap, mod, orient;
      orient = this.orient == "past" || this.operator == "subtract" ? -1 : 1;

      if (!this.now && "hour minute second".indexOf(this.unit) != -1) {
        today.setTimeToNow();
      }

      if (this.month || this.month === 0) {
        if ("year day hour minute second".indexOf(this.unit) != -1) {
          this.value = this.month + 1;
          this.month = null;
          expression = true;
        }
      }

      if (!expression && this.weekday && !this.day && !this.days) {
        var temp = Date[this.weekday]();
        this.day = temp.getDate();

        if (!this.month) {
          this.month = temp.getMonth();
        }

        this.year = temp.getFullYear();
      }

      if (expression && this.weekday && this.unit != "month") {
        this.unit = "day";
        gap = $D.getDayNumberFromName(this.weekday) - today.getDay();
        mod = 7;
        this.days = gap ? (gap + orient * mod) % mod : orient * mod;
      }

      if (this.month && this.unit == "day" && this.operator) {
        this.value = this.month + 1;
        this.month = null;
      }

      if (this.value != null && this.month != null && this.year != null) {
        this.day = this.value * 1;
      }

      if (this.month && !this.day && this.value) {
        today.set({
          day: this.value * 1
        });

        if (!expression) {
          this.day = this.value * 1;
        }
      }

      if (!this.month && this.value && this.unit == "month" && !this.now) {
        this.month = this.value;
        expression = true;
      }

      if (expression && (this.month || this.month === 0) && this.unit != "year") {
        this.unit = "month";
        gap = this.month - today.getMonth();
        mod = 12;
        this.months = gap ? (gap + orient * mod) % mod : orient * mod;
        this.month = null;
      }

      if (!this.unit) {
        this.unit = "day";
      }

      if (!this.value && this.operator && this.operator !== null && this[this.unit + "s"] && this[this.unit + "s"] !== null) {
        this[this.unit + "s"] = this[this.unit + "s"] + (this.operator == "add" ? 1 : -1) + (this.value || 0) * orient;
      } else if (this[this.unit + "s"] == null || this.operator != null) {
        if (!this.value) {
          this.value = 1;
        }

        this[this.unit + "s"] = this.value * orient;
      }

      if (this.meridian && this.hour) {
        if (this.meridian == "p" && this.hour < 12) {
          this.hour = this.hour + 12;
        } else if (this.meridian == "a" && this.hour == 12) {
          this.hour = 0;
        }
      }

      if (this.weekday && !this.day && !this.days) {
        var temp = Date[this.weekday]();
        this.day = temp.getDate();

        if (temp.getMonth() !== today.getMonth()) {
          this.month = temp.getMonth();
        }
      }

      if ((this.month || this.month === 0) && !this.day) {
        this.day = 1;
      }

      if (!this.orient && !this.operator && this.unit == "week" && this.value && !this.day && !this.month) {
        return Date.today().setWeek(this.value);
      }

      if (expression && this.timezone && this.day && this.days) {
        this.day = this.days;
      }

      return expression ? today.add(this) : today.set(this);
    }
  };

  var _ = $D.Parsing.Operators,
      g = $D.Grammar,
      t = $D.Translator,
      _fn;

  g.datePartDelimiter = _.rtoken(/^([\s\-\.\,\/\x27]+)/);
  g.timePartDelimiter = _.stoken(":");
  g.whiteSpace = _.rtoken(/^\s*/);
  g.generalDelimiter = _.rtoken(/^(([\s\,]|at|@|on)+)/);
  var _C = {};

  g.ctoken = function (keys) {
    var fn = _C[keys];

    if (!fn) {
      var c = $C.regexPatterns;
      var kx = keys.split(/\s+/),
          px = [];

      for (var i = 0; i < kx.length; i++) {
        px.push(_.replace(_.rtoken(c[kx[i]]), kx[i]));
      }

      fn = _C[keys] = _.any.apply(null, px);
    }

    return fn;
  };

  g.ctoken2 = function (key) {
    return _.rtoken($C.regexPatterns[key]);
  };

  g.h = _.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/), t.hour));
  g.hh = _.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/), t.hour));
  g.H = _.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/), t.hour));
  g.HH = _.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/), t.hour));
  g.m = _.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/), t.minute));
  g.mm = _.cache(_.process(_.rtoken(/^[0-5][0-9]/), t.minute));
  g.s = _.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/), t.second));
  g.ss = _.cache(_.process(_.rtoken(/^[0-5][0-9]/), t.second));
  g.hms = _.cache(_.sequence([g.H, g.m, g.s], g.timePartDelimiter));
  g.t = _.cache(_.process(g.ctoken2("shortMeridian"), t.meridian));
  g.tt = _.cache(_.process(g.ctoken2("longMeridian"), t.meridian));
  g.z = _.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/), t.timezone));
  g.zz = _.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/), t.timezone));
  g.zzz = _.cache(_.process(g.ctoken2("timezone"), t.timezone));
  g.timeSuffix = _.each(_.ignore(g.whiteSpace), _.set([g.tt, g.zzz]));
  g.time = _.each(_.optional(_.ignore(_.stoken("T"))), g.hms, g.timeSuffix);
  g.d = _.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/), _.optional(g.ctoken2("ordinalSuffix"))), t.day));
  g.dd = _.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/), _.optional(g.ctoken2("ordinalSuffix"))), t.day));
  g.ddd = g.dddd = _.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"), function (s) {
    return function () {
      this.weekday = s;
    };
  }));
  g.M = _.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/), t.month));
  g.MM = _.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/), t.month));
  g.MMM = g.MMMM = _.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"), t.month));
  g.y = _.cache(_.process(_.rtoken(/^(\d\d?)/), t.year));
  g.yy = _.cache(_.process(_.rtoken(/^(\d\d)/), t.year));
  g.yyy = _.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/), t.year));
  g.yyyy = _.cache(_.process(_.rtoken(/^(\d\d\d\d)/), t.year));

  _fn = function _fn() {
    return _.each(_.any.apply(null, arguments), _.not(g.ctoken2("timeContext")));
  };

  g.day = _fn(g.d, g.dd);
  g.month = _fn(g.M, g.MMM);
  g.year = _fn(g.yyyy, g.yy);
  g.orientation = _.process(g.ctoken("past future"), function (s) {
    return function () {
      this.orient = s;
    };
  });
  g.operator = _.process(g.ctoken("add subtract"), function (s) {
    return function () {
      this.operator = s;
    };
  });
  g.rday = _.process(g.ctoken("yesterday tomorrow today now"), t.rday);
  g.unit = _.process(g.ctoken("second minute hour day week month year"), function (s) {
    return function () {
      this.unit = s;
    };
  });
  g.value = _.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/), function (s) {
    return function () {
      this.value = s.replace(/\D/g, "");
    };
  });
  g.expression = _.set([g.rday, g.operator, g.value, g.unit, g.orientation, g.ddd, g.MMM]);

  _fn = function _fn() {
    return _.set(arguments, g.datePartDelimiter);
  };

  g.mdy = _fn(g.ddd, g.month, g.day, g.year);
  g.ymd = _fn(g.ddd, g.year, g.month, g.day);
  g.dmy = _fn(g.ddd, g.day, g.month, g.year);

  g.date = function (s) {
    return (g[$C.dateElementOrder] || g.mdy).call(this, s);
  };

  g.format = _.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/), function (fmt) {
    if (g[fmt]) {
      return g[fmt];
    } else {
      throw $D.Parsing.Exception(fmt);
    }
  }), _.process(_.rtoken(/^[^dMyhHmstz]+/), function (s) {
    return _.ignore(_.stoken(s));
  }))), function (rules) {
    return _.process(_.each.apply(null, rules), t.finishExact);
  });
  var _F = {};

  var _get = function _get(f) {
    return _F[f] = _F[f] || g.format(f)[0];
  };

  g.formats = function (fx) {
    if (fx instanceof Array) {
      var rx = [];

      for (var i = 0; i < fx.length; i++) {
        rx.push(_get(fx[i]));
      }

      return _.any.apply(null, rx);
    } else {
      return _get(fx);
    }
  };

  g._formats = g.formats(["\"yyyy-MM-ddTHH:mm:ssZ\"", "yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ssz", "yyyy-MM-ddTHH:mm:ss", "yyyy-MM-ddTHH:mmZ", "yyyy-MM-ddTHH:mmz", "yyyy-MM-ddTHH:mm", "ddd, MMM dd, yyyy H:mm:ss tt", "ddd MMM d yyyy HH:mm:ss zzz", "MMddyyyy", "ddMMyyyy", "Mddyyyy", "ddMyyyy", "Mdyyyy", "dMyyyy", "yyyy", "Mdyy", "dMyy", "d"]);
  g._start = _.process(_.set([g.date, g.time, g.expression], g.generalDelimiter, g.whiteSpace), t.finish);

  g.start = function (s) {
    try {
      var r = g._formats.call({}, s);

      if (r[1].length === 0) {
        return r;
      }
    } catch (e) {}

    return g._start.call({}, s);
  };

  $D._parse = $D.parse;

  $D.parse = function (s) {
    var r = null;

    if (!s) {
      return null;
    }

    if (s instanceof Date) {
      return s;
    }

    try {
      r = $D.Grammar.start.call({}, s.replace(/^\s*(\S*(\s+\S+)*)\s*$/, "$1"));
    } catch (e) {
      return null;
    }

    return r[1].length === 0 ? r[0] : null;
  };

  $D.getParseFunction = function (fx) {
    var fn = $D.Grammar.formats(fx);
    return function (s) {
      var r = null;

      try {
        r = fn.call({}, s);
      } catch (e) {
        return null;
      }

      return r[1].length === 0 ? r[0] : null;
    };
  };

  $D.parseExact = function (s, fx) {
    return $D.getParseFunction(fx)(s);
  };
})();

/***/ }),

/***/ "./common/static/js/vendor/domReady.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_RESULT__;/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*jslint */

/*global require: false, define: false, requirejs: false,
  window: false, clearInterval: false, document: false,
  self: false, setInterval: false */
!(__WEBPACK_AMD_DEFINE_RESULT__ = function () {
  'use strict';

  var isTop,
      testDiv,
      scrollIntervalId,
      isBrowser = typeof window !== "undefined" && window.document,
      isPageLoaded = !isBrowser,
      doc = isBrowser ? document : null,
      readyCalls = [];

  function runCallbacks(callbacks) {
    var i;

    for (i = 0; i < callbacks.length; i += 1) {
      callbacks[i](doc);
    }
  }

  function callReady() {
    var callbacks = readyCalls;

    if (isPageLoaded) {
      //Call the DOM ready callbacks
      if (callbacks.length) {
        readyCalls = [];
        runCallbacks(callbacks);
      }
    }
  }
  /**
   * Sets the page as loaded.
   */


  function pageLoaded() {
    if (!isPageLoaded) {
      isPageLoaded = true;

      if (scrollIntervalId) {
        clearInterval(scrollIntervalId);
      }

      callReady();
    }
  }

  if (isBrowser) {
    if (document.addEventListener) {
      //Standards. Hooray! Assumption here that if standards based,
      //it knows about DOMContentLoaded.
      document.addEventListener("DOMContentLoaded", pageLoaded, false);
      window.addEventListener("load", pageLoaded, false);
    } else if (window.attachEvent) {
      window.attachEvent("onload", pageLoaded);
      testDiv = document.createElement('div');

      try {
        isTop = window.frameElement === null;
      } catch (e) {} //DOMContentLoaded approximation that uses a doScroll, as found by
      //Diego Perini: http://javascript.nwbox.com/IEContentLoaded/,
      //but modified by other contributors, including jdalton


      if (testDiv.doScroll && isTop && window.external) {
        scrollIntervalId = setInterval(function () {
          try {
            testDiv.doScroll();
            pageLoaded();
          } catch (e) {}
        }, 30);
      }
    } //Check if document already complete, and if so, just trigger page load
    //listeners. Latest webkit browsers also use "interactive", and
    //will fire the onDOMContentLoaded before "interactive" but not after
    //entering "interactive" or "complete". More details:
    //http://dev.w3.org/html5/spec/the-end.html#the-end
    //http://stackoverflow.com/questions/3665561/document-readystate-of-interactive-vs-ondomcontentloaded
    //Hmm, this is more complicated on further use, see "firing too early"
    //bug: https://github.com/requirejs/domReady/issues/1
    //so removing the || document.readyState === "interactive" test.
    //There is still a window.onload binding that should get fired if
    //DOMContentLoaded is missed.


    if (document.readyState === "complete") {
      pageLoaded();
    }
  }
  /** START OF PUBLIC API **/

  /**
   * Registers a callback for DOM ready. If DOM is already ready, the
   * callback is called immediately.
   * @param {Function} callback
   */


  function domReady(callback) {
    if (isPageLoaded) {
      callback(doc);
    } else {
      readyCalls.push(callback);
    }

    return domReady;
  }

  domReady.version = '2.0.1';
  /**
   * Loader Plugin API method
   */

  domReady.load = function (name, req, onLoad, config) {
    if (config.isBuild) {
      onLoad(null);
    } else {
      domReady(onLoad);
    }
  };
  /** END OF PUBLIC API **/


  return domReady;
}.call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./common/static/js/vendor/flot/jquery.flot.min.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/* Javascript plotting library for jQuery, v. 0.7.
 *
 * Released under the MIT license by IOLA, December 2007.
 *
 */
(function (b) {
  b.color = {};

  b.color.make = function (d, e, g, f) {
    var c = {};
    c.r = d || 0;
    c.g = e || 0;
    c.b = g || 0;
    c.a = f != null ? f : 1;

    c.add = function (h, j) {
      for (var k = 0; k < h.length; ++k) {
        c[h.charAt(k)] += j;
      }

      return c.normalize();
    };

    c.scale = function (h, j) {
      for (var k = 0; k < h.length; ++k) {
        c[h.charAt(k)] *= j;
      }

      return c.normalize();
    };

    c.toString = function () {
      if (c.a >= 1) {
        return "rgb(" + [c.r, c.g, c.b].join(",") + ")";
      } else {
        return "rgba(" + [c.r, c.g, c.b, c.a].join(",") + ")";
      }
    };

    c.normalize = function () {
      function h(k, j, l) {
        return j < k ? k : j > l ? l : j;
      }

      c.r = h(0, parseInt(c.r), 255);
      c.g = h(0, parseInt(c.g), 255);
      c.b = h(0, parseInt(c.b), 255);
      c.a = h(0, c.a, 1);
      return c;
    };

    c.clone = function () {
      return b.color.make(c.r, c.b, c.g, c.a);
    };

    return c.normalize();
  };

  b.color.extract = function (d, e) {
    var c;

    do {
      c = d.css(e).toLowerCase();

      if (c != "" && c != "transparent") {
        break;
      }

      d = d.parent();
    } while (!b.nodeName(d.get(0), "body"));

    if (c == "rgba(0, 0, 0, 0)") {
      c = "transparent";
    }

    return b.color.parse(c);
  };

  b.color.parse = function (c) {
    var d,
        f = b.color.make;

    if (d = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c)) {
      return f(parseInt(d[1], 10), parseInt(d[2], 10), parseInt(d[3], 10));
    }

    if (d = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)) {
      return f(parseInt(d[1], 10), parseInt(d[2], 10), parseInt(d[3], 10), parseFloat(d[4]));
    }

    if (d = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c)) {
      return f(parseFloat(d[1]) * 2.55, parseFloat(d[2]) * 2.55, parseFloat(d[3]) * 2.55);
    }

    if (d = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)) {
      return f(parseFloat(d[1]) * 2.55, parseFloat(d[2]) * 2.55, parseFloat(d[3]) * 2.55, parseFloat(d[4]));
    }

    if (d = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c)) {
      return f(parseInt(d[1], 16), parseInt(d[2], 16), parseInt(d[3], 16));
    }

    if (d = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c)) {
      return f(parseInt(d[1] + d[1], 16), parseInt(d[2] + d[2], 16), parseInt(d[3] + d[3], 16));
    }

    var e = b.trim(c).toLowerCase();

    if (e == "transparent") {
      return f(255, 255, 255, 0);
    } else {
      d = a[e] || [0, 0, 0];
      return f(d[0], d[1], d[2]);
    }
  };

  var a = {
    aqua: [0, 255, 255],
    azure: [240, 255, 255],
    beige: [245, 245, 220],
    black: [0, 0, 0],
    blue: [0, 0, 255],
    brown: [165, 42, 42],
    cyan: [0, 255, 255],
    darkblue: [0, 0, 139],
    darkcyan: [0, 139, 139],
    darkgrey: [169, 169, 169],
    darkgreen: [0, 100, 0],
    darkkhaki: [189, 183, 107],
    darkmagenta: [139, 0, 139],
    darkolivegreen: [85, 107, 47],
    darkorange: [255, 140, 0],
    darkorchid: [153, 50, 204],
    darkred: [139, 0, 0],
    darksalmon: [233, 150, 122],
    darkviolet: [148, 0, 211],
    fuchsia: [255, 0, 255],
    gold: [255, 215, 0],
    green: [0, 128, 0],
    indigo: [75, 0, 130],
    khaki: [240, 230, 140],
    lightblue: [173, 216, 230],
    lightcyan: [224, 255, 255],
    lightgreen: [144, 238, 144],
    lightgrey: [211, 211, 211],
    lightpink: [255, 182, 193],
    lightyellow: [255, 255, 224],
    lime: [0, 255, 0],
    magenta: [255, 0, 255],
    maroon: [128, 0, 0],
    navy: [0, 0, 128],
    olive: [128, 128, 0],
    orange: [255, 165, 0],
    pink: [255, 192, 203],
    purple: [128, 0, 128],
    violet: [128, 0, 128],
    red: [255, 0, 0],
    silver: [192, 192, 192],
    white: [255, 255, 255],
    yellow: [255, 255, 0]
  };
})(jQuery);

(function (c) {
  function b(av, ai, J, af) {
    var Q = [],
        O = {
      colors: ["#edc240", "#afd8f8", "#cb4b4b", "#4da74d", "#9440ed"],
      legend: {
        show: true,
        noColumns: 1,
        labelFormatter: null,
        labelBoxBorderColor: "#ccc",
        container: null,
        position: "ne",
        margin: 5,
        backgroundColor: null,
        backgroundOpacity: 0.85
      },
      xaxis: {
        show: null,
        position: "bottom",
        mode: null,
        color: null,
        tickColor: null,
        transform: null,
        inverseTransform: null,
        min: null,
        max: null,
        autoscaleMargin: null,
        ticks: null,
        tickFormatter: null,
        labelWidth: null,
        labelHeight: null,
        reserveSpace: null,
        tickLength: null,
        alignTicksWithAxis: null,
        tickDecimals: null,
        tickSize: null,
        minTickSize: null,
        monthNames: null,
        timeformat: null,
        twelveHourClock: false
      },
      yaxis: {
        autoscaleMargin: 0.02,
        position: "left"
      },
      xaxes: [],
      yaxes: [],
      series: {
        points: {
          show: false,
          radius: 3,
          lineWidth: 2,
          fill: true,
          fillColor: "#ffffff",
          symbol: "circle"
        },
        lines: {
          lineWidth: 2,
          fill: false,
          fillColor: null,
          steps: false
        },
        bars: {
          show: false,
          lineWidth: 2,
          barWidth: 1,
          fill: true,
          fillColor: null,
          align: "left",
          horizontal: false
        },
        shadowSize: 3
      },
      grid: {
        show: true,
        aboveData: false,
        color: "#545454",
        backgroundColor: null,
        borderColor: null,
        tickColor: null,
        labelMargin: 5,
        axisMargin: 8,
        borderWidth: 2,
        minBorderMargin: null,
        markings: null,
        markingsColor: "#f4f4f4",
        markingsLineWidth: 2,
        clickable: false,
        hoverable: false,
        autoHighlight: true,
        mouseActiveRadius: 10
      },
      hooks: {}
    },
        az = null,
        ad = null,
        y = null,
        H = null,
        A = null,
        p = [],
        aw = [],
        q = {
      left: 0,
      right: 0,
      top: 0,
      bottom: 0
    },
        G = 0,
        I = 0,
        h = 0,
        w = 0,
        ak = {
      processOptions: [],
      processRawData: [],
      processDatapoints: [],
      drawSeries: [],
      draw: [],
      bindEvents: [],
      drawOverlay: [],
      shutdown: []
    },
        aq = this;
    aq.setData = aj;
    aq.setupGrid = t;
    aq.draw = W;

    aq.getPlaceholder = function () {
      return av;
    };

    aq.getCanvas = function () {
      return az;
    };

    aq.getPlotOffset = function () {
      return q;
    };

    aq.width = function () {
      return h;
    };

    aq.height = function () {
      return w;
    };

    aq.offset = function () {
      var aB = y.offset();
      aB.left += q.left;
      aB.top += q.top;
      return aB;
    };

    aq.getData = function () {
      return Q;
    };

    aq.getAxes = function () {
      var aC = {},
          aB;
      c.each(p.concat(aw), function (aD, aE) {
        if (aE) {
          aC[aE.direction + (aE.n != 1 ? aE.n : "") + "axis"] = aE;
        }
      });
      return aC;
    };

    aq.getXAxes = function () {
      return p;
    };

    aq.getYAxes = function () {
      return aw;
    };

    aq.c2p = C;
    aq.p2c = ar;

    aq.getOptions = function () {
      return O;
    };

    aq.highlight = x;
    aq.unhighlight = T;
    aq.triggerRedrawOverlay = f;

    aq.pointOffset = function (aB) {
      return {
        left: parseInt(p[aA(aB, "x") - 1].p2c(+aB.x) + q.left),
        top: parseInt(aw[aA(aB, "y") - 1].p2c(+aB.y) + q.top)
      };
    };

    aq.shutdown = ag;

    aq.resize = function () {
      B();
      g(az);
      g(ad);
    };

    aq.hooks = ak;
    F(aq);
    Z(J);
    X();
    aj(ai);
    t();
    W();
    ah();

    function an(aD, aB) {
      aB = [aq].concat(aB);

      for (var aC = 0; aC < aD.length; ++aC) {
        aD[aC].apply(this, aB);
      }
    }

    function F() {
      for (var aB = 0; aB < af.length; ++aB) {
        var aC = af[aB];
        aC.init(aq);

        if (aC.options) {
          c.extend(true, O, aC.options);
        }
      }
    }

    function Z(aC) {
      var aB;
      c.extend(true, O, aC);

      if (O.xaxis.color == null) {
        O.xaxis.color = O.grid.color;
      }

      if (O.yaxis.color == null) {
        O.yaxis.color = O.grid.color;
      }

      if (O.xaxis.tickColor == null) {
        O.xaxis.tickColor = O.grid.tickColor;
      }

      if (O.yaxis.tickColor == null) {
        O.yaxis.tickColor = O.grid.tickColor;
      }

      if (O.grid.borderColor == null) {
        O.grid.borderColor = O.grid.color;
      }

      if (O.grid.tickColor == null) {
        O.grid.tickColor = c.color.parse(O.grid.color).scale("a", 0.22).toString();
      }

      for (aB = 0; aB < Math.max(1, O.xaxes.length); ++aB) {
        O.xaxes[aB] = c.extend(true, {}, O.xaxis, O.xaxes[aB]);
      }

      for (aB = 0; aB < Math.max(1, O.yaxes.length); ++aB) {
        O.yaxes[aB] = c.extend(true, {}, O.yaxis, O.yaxes[aB]);
      }

      if (O.xaxis.noTicks && O.xaxis.ticks == null) {
        O.xaxis.ticks = O.xaxis.noTicks;
      }

      if (O.yaxis.noTicks && O.yaxis.ticks == null) {
        O.yaxis.ticks = O.yaxis.noTicks;
      }

      if (O.x2axis) {
        O.xaxes[1] = c.extend(true, {}, O.xaxis, O.x2axis);
        O.xaxes[1].position = "top";
      }

      if (O.y2axis) {
        O.yaxes[1] = c.extend(true, {}, O.yaxis, O.y2axis);
        O.yaxes[1].position = "right";
      }

      if (O.grid.coloredAreas) {
        O.grid.markings = O.grid.coloredAreas;
      }

      if (O.grid.coloredAreasColor) {
        O.grid.markingsColor = O.grid.coloredAreasColor;
      }

      if (O.lines) {
        c.extend(true, O.series.lines, O.lines);
      }

      if (O.points) {
        c.extend(true, O.series.points, O.points);
      }

      if (O.bars) {
        c.extend(true, O.series.bars, O.bars);
      }

      if (O.shadowSize != null) {
        O.series.shadowSize = O.shadowSize;
      }

      for (aB = 0; aB < O.xaxes.length; ++aB) {
        V(p, aB + 1).options = O.xaxes[aB];
      }

      for (aB = 0; aB < O.yaxes.length; ++aB) {
        V(aw, aB + 1).options = O.yaxes[aB];
      }

      for (var aD in ak) {
        if (O.hooks[aD] && O.hooks[aD].length) {
          ak[aD] = ak[aD].concat(O.hooks[aD]);
        }
      }

      an(ak.processOptions, [O]);
    }

    function aj(aB) {
      Q = Y(aB);
      ax();
      z();
    }

    function Y(aE) {
      var aC = [];

      for (var aB = 0; aB < aE.length; ++aB) {
        var aD = c.extend(true, {}, O.series);

        if (aE[aB].data != null) {
          aD.data = aE[aB].data;
          delete aE[aB].data;
          c.extend(true, aD, aE[aB]);
          aE[aB].data = aD.data;
        } else {
          aD.data = aE[aB];
        }

        aC.push(aD);
      }

      return aC;
    }

    function aA(aC, aD) {
      var aB = aC[aD + "axis"];

      if (_typeof(aB) == "object") {
        aB = aB.n;
      }

      if (typeof aB != "number") {
        aB = 1;
      }

      return aB;
    }

    function m() {
      return c.grep(p.concat(aw), function (aB) {
        return aB;
      });
    }

    function C(aE) {
      var aC = {},
          aB,
          aD;

      for (aB = 0; aB < p.length; ++aB) {
        aD = p[aB];

        if (aD && aD.used) {
          aC["x" + aD.n] = aD.c2p(aE.left);
        }
      }

      for (aB = 0; aB < aw.length; ++aB) {
        aD = aw[aB];

        if (aD && aD.used) {
          aC["y" + aD.n] = aD.c2p(aE.top);
        }
      }

      if (aC.x1 !== undefined) {
        aC.x = aC.x1;
      }

      if (aC.y1 !== undefined) {
        aC.y = aC.y1;
      }

      return aC;
    }

    function ar(aF) {
      var aD = {},
          aC,
          aE,
          aB;

      for (aC = 0; aC < p.length; ++aC) {
        aE = p[aC];

        if (aE && aE.used) {
          aB = "x" + aE.n;

          if (aF[aB] == null && aE.n == 1) {
            aB = "x";
          }

          if (aF[aB] != null) {
            aD.left = aE.p2c(aF[aB]);
            break;
          }
        }
      }

      for (aC = 0; aC < aw.length; ++aC) {
        aE = aw[aC];

        if (aE && aE.used) {
          aB = "y" + aE.n;

          if (aF[aB] == null && aE.n == 1) {
            aB = "y";
          }

          if (aF[aB] != null) {
            aD.top = aE.p2c(aF[aB]);
            break;
          }
        }
      }

      return aD;
    }

    function V(aC, aB) {
      if (!aC[aB - 1]) {
        aC[aB - 1] = {
          n: aB,
          direction: aC == p ? "x" : "y",
          options: c.extend(true, {}, aC == p ? O.xaxis : O.yaxis)
        };
      }

      return aC[aB - 1];
    }

    function ax() {
      var aG;
      var aM = Q.length,
          aB = [],
          aE = [];

      for (aG = 0; aG < Q.length; ++aG) {
        var aJ = Q[aG].color;

        if (aJ != null) {
          --aM;

          if (typeof aJ == "number") {
            aE.push(aJ);
          } else {
            aB.push(c.color.parse(Q[aG].color));
          }
        }
      }

      for (aG = 0; aG < aE.length; ++aG) {
        aM = Math.max(aM, aE[aG] + 1);
      }

      var aC = [],
          aF = 0;
      aG = 0;

      while (aC.length < aM) {
        var aI;

        if (O.colors.length == aG) {
          aI = c.color.make(100, 100, 100);
        } else {
          aI = c.color.parse(O.colors[aG]);
        }

        var aD = aF % 2 == 1 ? -1 : 1;
        aI.scale("rgb", 1 + aD * Math.ceil(aF / 2) * 0.2);
        aC.push(aI);
        ++aG;

        if (aG >= O.colors.length) {
          aG = 0;
          ++aF;
        }
      }

      var aH = 0,
          aN;

      for (aG = 0; aG < Q.length; ++aG) {
        aN = Q[aG];

        if (aN.color == null) {
          aN.color = aC[aH].toString();
          ++aH;
        } else {
          if (typeof aN.color == "number") {
            aN.color = aC[aN.color].toString();
          }
        }

        if (aN.lines.show == null) {
          var aL,
              aK = true;

          for (aL in aN) {
            if (aN[aL] && aN[aL].show) {
              aK = false;
              break;
            }
          }

          if (aK) {
            aN.lines.show = true;
          }
        }

        aN.xaxis = V(p, aA(aN, "x"));
        aN.yaxis = V(aw, aA(aN, "y"));
      }
    }

    function z() {
      var aO = Number.POSITIVE_INFINITY,
          aI = Number.NEGATIVE_INFINITY,
          aB = Number.MAX_VALUE,
          aU,
          aS,
          aR,
          aN,
          aD,
          aJ,
          aT,
          aP,
          aH,
          aG,
          aC,
          a0,
          aX,
          aL;

      function aF(a3, a2, a1) {
        if (a2 < a3.datamin && a2 != -aB) {
          a3.datamin = a2;
        }

        if (a1 > a3.datamax && a1 != aB) {
          a3.datamax = a1;
        }
      }

      c.each(m(), function (a1, a2) {
        a2.datamin = aO;
        a2.datamax = aI;
        a2.used = false;
      });

      for (aU = 0; aU < Q.length; ++aU) {
        aJ = Q[aU];
        aJ.datapoints = {
          points: []
        };
        an(ak.processRawData, [aJ, aJ.data, aJ.datapoints]);
      }

      for (aU = 0; aU < Q.length; ++aU) {
        aJ = Q[aU];
        var aZ = aJ.data,
            aW = aJ.datapoints.format;

        if (!aW) {
          aW = [];
          aW.push({
            x: true,
            number: true,
            required: true
          });
          aW.push({
            y: true,
            number: true,
            required: true
          });

          if (aJ.bars.show || aJ.lines.show && aJ.lines.fill) {
            aW.push({
              y: true,
              number: true,
              required: false,
              defaultValue: 0
            });

            if (aJ.bars.horizontal) {
              delete aW[aW.length - 1].y;
              aW[aW.length - 1].x = true;
            }
          }

          aJ.datapoints.format = aW;
        }

        if (aJ.datapoints.pointsize != null) {
          continue;
        }

        aJ.datapoints.pointsize = aW.length;
        aP = aJ.datapoints.pointsize;
        aT = aJ.datapoints.points;
        insertSteps = aJ.lines.show && aJ.lines.steps;
        aJ.xaxis.used = aJ.yaxis.used = true;

        for (aS = aR = 0; aS < aZ.length; ++aS, aR += aP) {
          aL = aZ[aS];
          var aE = aL == null;

          if (!aE) {
            for (aN = 0; aN < aP; ++aN) {
              a0 = aL[aN];
              aX = aW[aN];

              if (aX) {
                if (aX.number && a0 != null) {
                  a0 = +a0;

                  if (isNaN(a0)) {
                    a0 = null;
                  } else {
                    if (a0 == Infinity) {
                      a0 = aB;
                    } else {
                      if (a0 == -Infinity) {
                        a0 = -aB;
                      }
                    }
                  }
                }

                if (a0 == null) {
                  if (aX.required) {
                    aE = true;
                  }

                  if (aX.defaultValue != null) {
                    a0 = aX.defaultValue;
                  }
                }
              }

              aT[aR + aN] = a0;
            }
          }

          if (aE) {
            for (aN = 0; aN < aP; ++aN) {
              a0 = aT[aR + aN];

              if (a0 != null) {
                aX = aW[aN];

                if (aX.x) {
                  aF(aJ.xaxis, a0, a0);
                }

                if (aX.y) {
                  aF(aJ.yaxis, a0, a0);
                }
              }

              aT[aR + aN] = null;
            }
          } else {
            if (insertSteps && aR > 0 && aT[aR - aP] != null && aT[aR - aP] != aT[aR] && aT[aR - aP + 1] != aT[aR + 1]) {
              for (aN = 0; aN < aP; ++aN) {
                aT[aR + aP + aN] = aT[aR + aN];
              }

              aT[aR + 1] = aT[aR - aP + 1];
              aR += aP;
            }
          }
        }
      }

      for (aU = 0; aU < Q.length; ++aU) {
        aJ = Q[aU];
        an(ak.processDatapoints, [aJ, aJ.datapoints]);
      }

      for (aU = 0; aU < Q.length; ++aU) {
        aJ = Q[aU];
        aT = aJ.datapoints.points, aP = aJ.datapoints.pointsize;
        var aK = aO,
            aQ = aO,
            aM = aI,
            aV = aI;

        for (aS = 0; aS < aT.length; aS += aP) {
          if (aT[aS] == null) {
            continue;
          }

          for (aN = 0; aN < aP; ++aN) {
            a0 = aT[aS + aN];
            aX = aW[aN];

            if (!aX || a0 == aB || a0 == -aB) {
              continue;
            }

            if (aX.x) {
              if (a0 < aK) {
                aK = a0;
              }

              if (a0 > aM) {
                aM = a0;
              }
            }

            if (aX.y) {
              if (a0 < aQ) {
                aQ = a0;
              }

              if (a0 > aV) {
                aV = a0;
              }
            }
          }
        }

        if (aJ.bars.show) {
          var aY = aJ.bars.align == "left" ? 0 : -aJ.bars.barWidth / 2;

          if (aJ.bars.horizontal) {
            aQ += aY;
            aV += aY + aJ.bars.barWidth;
          } else {
            aK += aY;
            aM += aY + aJ.bars.barWidth;
          }
        }

        aF(aJ.xaxis, aK, aM);
        aF(aJ.yaxis, aQ, aV);
      }

      c.each(m(), function (a1, a2) {
        if (a2.datamin == aO) {
          a2.datamin = null;
        }

        if (a2.datamax == aI) {
          a2.datamax = null;
        }
      });
    }

    function j(aB, aC) {
      var aD = document.createElement("canvas");
      aD.className = aC;
      aD.width = G;
      aD.height = I;

      if (!aB) {
        c(aD).css({
          position: "absolute",
          left: 0,
          top: 0
        });
      }

      c(aD).appendTo(av);

      if (!aD.getContext) {
        aD = window.G_vmlCanvasManager.initElement(aD);
      }

      aD.getContext("2d").save();
      return aD;
    }

    function B() {
      G = av.width();
      I = av.height();

      if (G <= 0 || I <= 0) {
        throw "Invalid dimensions for plot, width = " + G + ", height = " + I;
      }
    }

    function g(aC) {
      if (aC.width != G) {
        aC.width = G;
      }

      if (aC.height != I) {
        aC.height = I;
      }

      var aB = aC.getContext("2d");
      aB.restore();
      aB.save();
    }

    function X() {
      var aC,
          aB = av.children("canvas.base"),
          aD = av.children("canvas.overlay");

      if (aB.length == 0 || aD == 0) {
        av.html("");
        av.css({
          padding: 0
        });

        if (av.css("position") == "static") {
          av.css("position", "relative");
        }

        B();
        az = j(true, "base");
        ad = j(false, "overlay");
        aC = false;
      } else {
        az = aB.get(0);
        ad = aD.get(0);
        aC = true;
      }

      H = az.getContext("2d");
      A = ad.getContext("2d");
      y = c([ad, az]);

      if (aC) {
        av.data("plot").shutdown();
        aq.resize();
        A.clearRect(0, 0, G, I);
        y.unbind();
        av.children().not([az, ad]).remove();
      }

      av.data("plot", aq);
    }

    function ah() {
      if (O.grid.hoverable) {
        y.mousemove(aa);
        y.mouseleave(l);
      }

      if (O.grid.clickable) {
        y.click(R);
      }

      an(ak.bindEvents, [y]);
    }

    function ag() {
      if (M) {
        clearTimeout(M);
      }

      y.unbind("mousemove", aa);
      y.unbind("mouseleave", l);
      y.unbind("click", R);
      an(ak.shutdown, [y]);
    }

    function r(aG) {
      function aC(aH) {
        return aH;
      }

      var aF,
          aB,
          aD = aG.options.transform || aC,
          aE = aG.options.inverseTransform;

      if (aG.direction == "x") {
        aF = aG.scale = h / Math.abs(aD(aG.max) - aD(aG.min));
        aB = Math.min(aD(aG.max), aD(aG.min));
      } else {
        aF = aG.scale = w / Math.abs(aD(aG.max) - aD(aG.min));
        aF = -aF;
        aB = Math.max(aD(aG.max), aD(aG.min));
      }

      if (aD == aC) {
        aG.p2c = function (aH) {
          return (aH - aB) * aF;
        };
      } else {
        aG.p2c = function (aH) {
          return (aD(aH) - aB) * aF;
        };
      }

      if (!aE) {
        aG.c2p = function (aH) {
          return aB + aH / aF;
        };
      } else {
        aG.c2p = function (aH) {
          return aE(aB + aH / aF);
        };
      }
    }

    function L(aD) {
      var aB = aD.options,
          aF,
          aJ = aD.ticks || [],
          aI = [],
          aE,
          aK = aB.labelWidth,
          aG = aB.labelHeight,
          aC;

      function aH(aM, aL) {
        return c('<div style="position:absolute;top:-10000px;' + aL + 'font-size:smaller"><div class="' + aD.direction + "Axis " + aD.direction + aD.n + 'Axis">' + aM.join("") + "</div></div>").appendTo(av);
      }

      if (aD.direction == "x") {
        if (aK == null) {
          aK = Math.floor(G / (aJ.length > 0 ? aJ.length : 1));
        }

        if (aG == null) {
          aI = [];

          for (aF = 0; aF < aJ.length; ++aF) {
            aE = aJ[aF].label;

            if (aE) {
              aI.push('<div class="tickLabel" style="float:left;width:' + aK + 'px">' + aE + "</div>");
            }
          }

          if (aI.length > 0) {
            aI.push('<div style="clear:left"></div>');
            aC = aH(aI, "width:10000px;");
            aG = aC.height();
            aC.remove();
          }
        }
      } else {
        if (aK == null || aG == null) {
          for (aF = 0; aF < aJ.length; ++aF) {
            aE = aJ[aF].label;

            if (aE) {
              aI.push('<div class="tickLabel">' + aE + "</div>");
            }
          }

          if (aI.length > 0) {
            aC = aH(aI, "");

            if (aK == null) {
              aK = aC.children().width();
            }

            if (aG == null) {
              aG = aC.find("div.tickLabel").height();
            }

            aC.remove();
          }
        }
      }

      if (aK == null) {
        aK = 0;
      }

      if (aG == null) {
        aG = 0;
      }

      aD.labelWidth = aK;
      aD.labelHeight = aG;
    }

    function au(aD) {
      var aC = aD.labelWidth,
          aL = aD.labelHeight,
          aH = aD.options.position,
          aF = aD.options.tickLength,
          aG = O.grid.axisMargin,
          aJ = O.grid.labelMargin,
          aK = aD.direction == "x" ? p : aw,
          aE;
      var aB = c.grep(aK, function (aN) {
        return aN && aN.options.position == aH && aN.reserveSpace;
      });

      if (c.inArray(aD, aB) == aB.length - 1) {
        aG = 0;
      }

      if (aF == null) {
        aF = "full";
      }

      var aI = c.grep(aK, function (aN) {
        return aN && aN.reserveSpace;
      });
      var aM = c.inArray(aD, aI) == 0;

      if (!aM && aF == "full") {
        aF = 5;
      }

      if (!isNaN(+aF)) {
        aJ += +aF;
      }

      if (aD.direction == "x") {
        aL += aJ;

        if (aH == "bottom") {
          q.bottom += aL + aG;
          aD.box = {
            top: I - q.bottom,
            height: aL
          };
        } else {
          aD.box = {
            top: q.top + aG,
            height: aL
          };
          q.top += aL + aG;
        }
      } else {
        aC += aJ;

        if (aH == "left") {
          aD.box = {
            left: q.left + aG,
            width: aC
          };
          q.left += aC + aG;
        } else {
          q.right += aC + aG;
          aD.box = {
            left: G - q.right,
            width: aC
          };
        }
      }

      aD.position = aH;
      aD.tickLength = aF;
      aD.box.padding = aJ;
      aD.innermost = aM;
    }

    function U(aB) {
      if (aB.direction == "x") {
        aB.box.left = q.left;
        aB.box.width = h;
      } else {
        aB.box.top = q.top;
        aB.box.height = w;
      }
    }

    function t() {
      var aC,
          aE = m();
      c.each(aE, function (aF, aG) {
        aG.show = aG.options.show;

        if (aG.show == null) {
          aG.show = aG.used;
        }

        aG.reserveSpace = aG.show || aG.options.reserveSpace;
        n(aG);
      });
      allocatedAxes = c.grep(aE, function (aF) {
        return aF.reserveSpace;
      });
      q.left = q.right = q.top = q.bottom = 0;

      if (O.grid.show) {
        c.each(allocatedAxes, function (aF, aG) {
          S(aG);
          P(aG);
          ap(aG, aG.ticks);
          L(aG);
        });

        for (aC = allocatedAxes.length - 1; aC >= 0; --aC) {
          au(allocatedAxes[aC]);
        }

        var aD = O.grid.minBorderMargin;

        if (aD == null) {
          aD = 0;

          for (aC = 0; aC < Q.length; ++aC) {
            aD = Math.max(aD, Q[aC].points.radius + Q[aC].points.lineWidth / 2);
          }
        }

        for (var aB in q) {
          q[aB] += O.grid.borderWidth;
          q[aB] = Math.max(aD, q[aB]);
        }
      }

      h = G - q.left - q.right;
      w = I - q.bottom - q.top;
      c.each(aE, function (aF, aG) {
        r(aG);
      });

      if (O.grid.show) {
        c.each(allocatedAxes, function (aF, aG) {
          U(aG);
        });
        k();
      }

      o();
    }

    function n(aE) {
      var aF = aE.options,
          aD = +(aF.min != null ? aF.min : aE.datamin),
          aB = +(aF.max != null ? aF.max : aE.datamax),
          aH = aB - aD;

      if (aH == 0) {
        var aC = aB == 0 ? 1 : 0.01;

        if (aF.min == null) {
          aD -= aC;
        }

        if (aF.max == null || aF.min != null) {
          aB += aC;
        }
      } else {
        var aG = aF.autoscaleMargin;

        if (aG != null) {
          if (aF.min == null) {
            aD -= aH * aG;

            if (aD < 0 && aE.datamin != null && aE.datamin >= 0) {
              aD = 0;
            }
          }

          if (aF.max == null) {
            aB += aH * aG;

            if (aB > 0 && aE.datamax != null && aE.datamax <= 0) {
              aB = 0;
            }
          }
        }
      }

      aE.min = aD;
      aE.max = aB;
    }

    function S(aG) {
      var aM = aG.options;
      var aH;

      if (typeof aM.ticks == "number" && aM.ticks > 0) {
        aH = aM.ticks;
      } else {
        aH = 0.3 * Math.sqrt(aG.direction == "x" ? G : I);
      }

      var aT = (aG.max - aG.min) / aH,
          aO,
          aB,
          aN,
          aR,
          aS,
          aQ,
          aI;

      if (aM.mode == "time") {
        var aJ = {
          second: 1000,
          minute: 60 * 1000,
          hour: 60 * 60 * 1000,
          day: 24 * 60 * 60 * 1000,
          month: 30 * 24 * 60 * 60 * 1000,
          year: 365.2425 * 24 * 60 * 60 * 1000
        };
        var aK = [[1, "second"], [2, "second"], [5, "second"], [10, "second"], [30, "second"], [1, "minute"], [2, "minute"], [5, "minute"], [10, "minute"], [30, "minute"], [1, "hour"], [2, "hour"], [4, "hour"], [8, "hour"], [12, "hour"], [1, "day"], [2, "day"], [3, "day"], [0.25, "month"], [0.5, "month"], [1, "month"], [2, "month"], [3, "month"], [6, "month"], [1, "year"]];
        var aC = 0;

        if (aM.minTickSize != null) {
          if (typeof aM.tickSize == "number") {
            aC = aM.tickSize;
          } else {
            aC = aM.minTickSize[0] * aJ[aM.minTickSize[1]];
          }
        }

        for (var aS = 0; aS < aK.length - 1; ++aS) {
          if (aT < (aK[aS][0] * aJ[aK[aS][1]] + aK[aS + 1][0] * aJ[aK[aS + 1][1]]) / 2 && aK[aS][0] * aJ[aK[aS][1]] >= aC) {
            break;
          }
        }

        aO = aK[aS][0];
        aN = aK[aS][1];

        if (aN == "year") {
          aQ = Math.pow(10, Math.floor(Math.log(aT / aJ.year) / Math.LN10));
          aI = aT / aJ.year / aQ;

          if (aI < 1.5) {
            aO = 1;
          } else {
            if (aI < 3) {
              aO = 2;
            } else {
              if (aI < 7.5) {
                aO = 5;
              } else {
                aO = 10;
              }
            }
          }

          aO *= aQ;
        }

        aG.tickSize = aM.tickSize || [aO, aN];

        aB = function aB(aX) {
          var a2 = [],
              a0 = aX.tickSize[0],
              a3 = aX.tickSize[1],
              a1 = new Date(aX.min);
          var aW = a0 * aJ[a3];

          if (a3 == "second") {
            a1.setUTCSeconds(a(a1.getUTCSeconds(), a0));
          }

          if (a3 == "minute") {
            a1.setUTCMinutes(a(a1.getUTCMinutes(), a0));
          }

          if (a3 == "hour") {
            a1.setUTCHours(a(a1.getUTCHours(), a0));
          }

          if (a3 == "month") {
            a1.setUTCMonth(a(a1.getUTCMonth(), a0));
          }

          if (a3 == "year") {
            a1.setUTCFullYear(a(a1.getUTCFullYear(), a0));
          }

          a1.setUTCMilliseconds(0);

          if (aW >= aJ.minute) {
            a1.setUTCSeconds(0);
          }

          if (aW >= aJ.hour) {
            a1.setUTCMinutes(0);
          }

          if (aW >= aJ.day) {
            a1.setUTCHours(0);
          }

          if (aW >= aJ.day * 4) {
            a1.setUTCDate(1);
          }

          if (aW >= aJ.year) {
            a1.setUTCMonth(0);
          }

          var a5 = 0,
              a4 = Number.NaN,
              aY;

          do {
            aY = a4;
            a4 = a1.getTime();
            a2.push(a4);

            if (a3 == "month") {
              if (a0 < 1) {
                a1.setUTCDate(1);
                var aV = a1.getTime();
                a1.setUTCMonth(a1.getUTCMonth() + 1);
                var aZ = a1.getTime();
                a1.setTime(a4 + a5 * aJ.hour + (aZ - aV) * a0);
                a5 = a1.getUTCHours();
                a1.setUTCHours(0);
              } else {
                a1.setUTCMonth(a1.getUTCMonth() + a0);
              }
            } else {
              if (a3 == "year") {
                a1.setUTCFullYear(a1.getUTCFullYear() + a0);
              } else {
                a1.setTime(a4 + aW);
              }
            }
          } while (a4 < aX.max && a4 != aY);

          return a2;
        };

        aR = function aR(aV, aY) {
          var a0 = new Date(aV);

          if (aM.timeformat != null) {
            return c.plot.formatDate(a0, aM.timeformat, aM.monthNames);
          }

          var aW = aY.tickSize[0] * aJ[aY.tickSize[1]];
          var aX = aY.max - aY.min;
          var aZ = aM.twelveHourClock ? " %p" : "";

          if (aW < aJ.minute) {
            fmt = "%h:%M:%S" + aZ;
          } else {
            if (aW < aJ.day) {
              if (aX < 2 * aJ.day) {
                fmt = "%h:%M" + aZ;
              } else {
                fmt = "%b %d %h:%M" + aZ;
              }
            } else {
              if (aW < aJ.month) {
                fmt = "%b %d";
              } else {
                if (aW < aJ.year) {
                  if (aX < aJ.year) {
                    fmt = "%b";
                  } else {
                    fmt = "%b %y";
                  }
                } else {
                  fmt = "%y";
                }
              }
            }
          }

          return c.plot.formatDate(a0, fmt, aM.monthNames);
        };
      } else {
        var aU = aM.tickDecimals;
        var aP = -Math.floor(Math.log(aT) / Math.LN10);

        if (aU != null && aP > aU) {
          aP = aU;
        }

        aQ = Math.pow(10, -aP);
        aI = aT / aQ;

        if (aI < 1.5) {
          aO = 1;
        } else {
          if (aI < 3) {
            aO = 2;

            if (aI > 2.25 && (aU == null || aP + 1 <= aU)) {
              aO = 2.5;
              ++aP;
            }
          } else {
            if (aI < 7.5) {
              aO = 5;
            } else {
              aO = 10;
            }
          }
        }

        aO *= aQ;

        if (aM.minTickSize != null && aO < aM.minTickSize) {
          aO = aM.minTickSize;
        }

        aG.tickDecimals = Math.max(0, aU != null ? aU : aP);
        aG.tickSize = aM.tickSize || aO;

        aB = function aB(aX) {
          var aZ = [];
          var a0 = a(aX.min, aX.tickSize),
              aW = 0,
              aV = Number.NaN,
              aY;

          do {
            aY = aV;
            aV = a0 + aW * aX.tickSize;
            aZ.push(aV);
            ++aW;
          } while (aV < aX.max && aV != aY);

          return aZ;
        };

        aR = function aR(aV, aW) {
          return aV.toFixed(aW.tickDecimals);
        };
      }

      if (aM.alignTicksWithAxis != null) {
        var aF = (aG.direction == "x" ? p : aw)[aM.alignTicksWithAxis - 1];

        if (aF && aF.used && aF != aG) {
          var aL = aB(aG);

          if (aL.length > 0) {
            if (aM.min == null) {
              aG.min = Math.min(aG.min, aL[0]);
            }

            if (aM.max == null && aL.length > 1) {
              aG.max = Math.max(aG.max, aL[aL.length - 1]);
            }
          }

          aB = function aB(aX) {
            var aY = [],
                aV,
                aW;

            for (aW = 0; aW < aF.ticks.length; ++aW) {
              aV = (aF.ticks[aW].v - aF.min) / (aF.max - aF.min);
              aV = aX.min + aV * (aX.max - aX.min);
              aY.push(aV);
            }

            return aY;
          };

          if (aG.mode != "time" && aM.tickDecimals == null) {
            var aE = Math.max(0, -Math.floor(Math.log(aT) / Math.LN10) + 1),
                aD = aB(aG);

            if (!(aD.length > 1 && /\..*0$/.test((aD[1] - aD[0]).toFixed(aE)))) {
              aG.tickDecimals = aE;
            }
          }
        }
      }

      aG.tickGenerator = aB;

      if (c.isFunction(aM.tickFormatter)) {
        aG.tickFormatter = function (aV, aW) {
          return "" + aM.tickFormatter(aV, aW);
        };
      } else {
        aG.tickFormatter = aR;
      }
    }

    function P(aF) {
      var aH = aF.options.ticks,
          aG = [];

      if (aH == null || typeof aH == "number" && aH > 0) {
        aG = aF.tickGenerator(aF);
      } else {
        if (aH) {
          if (c.isFunction(aH)) {
            aG = aH({
              min: aF.min,
              max: aF.max
            });
          } else {
            aG = aH;
          }
        }
      }

      var aE, aB;
      aF.ticks = [];

      for (aE = 0; aE < aG.length; ++aE) {
        var aC = null;
        var aD = aG[aE];

        if (_typeof(aD) == "object") {
          aB = +aD[0];

          if (aD.length > 1) {
            aC = aD[1];
          }
        } else {
          aB = +aD;
        }

        if (aC == null) {
          aC = aF.tickFormatter(aB, aF);
        }

        if (!isNaN(aB)) {
          aF.ticks.push({
            v: aB,
            label: aC
          });
        }
      }
    }

    function ap(aB, aC) {
      if (aB.options.autoscaleMargin && aC.length > 0) {
        if (aB.options.min == null) {
          aB.min = Math.min(aB.min, aC[0].v);
        }

        if (aB.options.max == null && aC.length > 1) {
          aB.max = Math.max(aB.max, aC[aC.length - 1].v);
        }
      }
    }

    function W() {
      H.clearRect(0, 0, G, I);
      var aC = O.grid;

      if (aC.show && aC.backgroundColor) {
        N();
      }

      if (aC.show && !aC.aboveData) {
        ac();
      }

      for (var aB = 0; aB < Q.length; ++aB) {
        an(ak.drawSeries, [H, Q[aB]]);
        d(Q[aB]);
      }

      an(ak.draw, [H]);

      if (aC.show && aC.aboveData) {
        ac();
      }
    }

    function D(aB, aI) {
      var aE,
          aH,
          aG,
          aD,
          aF = m();

      for (i = 0; i < aF.length; ++i) {
        aE = aF[i];

        if (aE.direction == aI) {
          aD = aI + aE.n + "axis";

          if (!aB[aD] && aE.n == 1) {
            aD = aI + "axis";
          }

          if (aB[aD]) {
            aH = aB[aD].from;
            aG = aB[aD].to;
            break;
          }
        }
      }

      if (!aB[aD]) {
        aE = aI == "x" ? p[0] : aw[0];
        aH = aB[aI + "1"];
        aG = aB[aI + "2"];
      }

      if (aH != null && aG != null && aH > aG) {
        var aC = aH;
        aH = aG;
        aG = aC;
      }

      return {
        from: aH,
        to: aG,
        axis: aE
      };
    }

    function N() {
      H.save();
      H.translate(q.left, q.top);
      H.fillStyle = am(O.grid.backgroundColor, w, 0, "rgba(255, 255, 255, 0)");
      H.fillRect(0, 0, h, w);
      H.restore();
    }

    function ac() {
      var aF;
      H.save();
      H.translate(q.left, q.top);
      var aH = O.grid.markings;

      if (aH) {
        if (c.isFunction(aH)) {
          var aK = aq.getAxes();
          aK.xmin = aK.xaxis.min;
          aK.xmax = aK.xaxis.max;
          aK.ymin = aK.yaxis.min;
          aK.ymax = aK.yaxis.max;
          aH = aH(aK);
        }

        for (aF = 0; aF < aH.length; ++aF) {
          var aD = aH[aF],
              aC = D(aD, "x"),
              aI = D(aD, "y");

          if (aC.from == null) {
            aC.from = aC.axis.min;
          }

          if (aC.to == null) {
            aC.to = aC.axis.max;
          }

          if (aI.from == null) {
            aI.from = aI.axis.min;
          }

          if (aI.to == null) {
            aI.to = aI.axis.max;
          }

          if (aC.to < aC.axis.min || aC.from > aC.axis.max || aI.to < aI.axis.min || aI.from > aI.axis.max) {
            continue;
          }

          aC.from = Math.max(aC.from, aC.axis.min);
          aC.to = Math.min(aC.to, aC.axis.max);
          aI.from = Math.max(aI.from, aI.axis.min);
          aI.to = Math.min(aI.to, aI.axis.max);

          if (aC.from == aC.to && aI.from == aI.to) {
            continue;
          }

          aC.from = aC.axis.p2c(aC.from);
          aC.to = aC.axis.p2c(aC.to);
          aI.from = aI.axis.p2c(aI.from);
          aI.to = aI.axis.p2c(aI.to);

          if (aC.from == aC.to || aI.from == aI.to) {
            H.beginPath();
            H.strokeStyle = aD.color || O.grid.markingsColor;
            H.lineWidth = aD.lineWidth || O.grid.markingsLineWidth;
            H.moveTo(aC.from, aI.from);
            H.lineTo(aC.to, aI.to);
            H.stroke();
          } else {
            H.fillStyle = aD.color || O.grid.markingsColor;
            H.fillRect(aC.from, aI.to, aC.to - aC.from, aI.from - aI.to);
          }
        }
      }

      var aK = m(),
          aM = O.grid.borderWidth;

      for (var aE = 0; aE < aK.length; ++aE) {
        var aB = aK[aE],
            aG = aB.box,
            aQ = aB.tickLength,
            aN,
            aL,
            aP,
            aJ;

        if (!aB.show || aB.ticks.length == 0) {
          continue;
        }

        H.strokeStyle = aB.options.tickColor || c.color.parse(aB.options.color).scale("a", 0.22).toString();
        H.lineWidth = 1;

        if (aB.direction == "x") {
          aN = 0;

          if (aQ == "full") {
            aL = aB.position == "top" ? 0 : w;
          } else {
            aL = aG.top - q.top + (aB.position == "top" ? aG.height : 0);
          }
        } else {
          aL = 0;

          if (aQ == "full") {
            aN = aB.position == "left" ? 0 : h;
          } else {
            aN = aG.left - q.left + (aB.position == "left" ? aG.width : 0);
          }
        }

        if (!aB.innermost) {
          H.beginPath();
          aP = aJ = 0;

          if (aB.direction == "x") {
            aP = h;
          } else {
            aJ = w;
          }

          if (H.lineWidth == 1) {
            aN = Math.floor(aN) + 0.5;
            aL = Math.floor(aL) + 0.5;
          }

          H.moveTo(aN, aL);
          H.lineTo(aN + aP, aL + aJ);
          H.stroke();
        }

        H.beginPath();

        for (aF = 0; aF < aB.ticks.length; ++aF) {
          var aO = aB.ticks[aF].v;
          aP = aJ = 0;

          if (aO < aB.min || aO > aB.max || aQ == "full" && aM > 0 && (aO == aB.min || aO == aB.max)) {
            continue;
          }

          if (aB.direction == "x") {
            aN = aB.p2c(aO);
            aJ = aQ == "full" ? -w : aQ;

            if (aB.position == "top") {
              aJ = -aJ;
            }
          } else {
            aL = aB.p2c(aO);
            aP = aQ == "full" ? -h : aQ;

            if (aB.position == "left") {
              aP = -aP;
            }
          }

          if (H.lineWidth == 1) {
            if (aB.direction == "x") {
              aN = Math.floor(aN) + 0.5;
            } else {
              aL = Math.floor(aL) + 0.5;
            }
          }

          H.moveTo(aN, aL);
          H.lineTo(aN + aP, aL + aJ);
        }

        H.stroke();
      }

      if (aM) {
        H.lineWidth = aM;
        H.strokeStyle = O.grid.borderColor;
        H.strokeRect(-aM / 2, -aM / 2, h + aM, w + aM);
      }

      H.restore();
    }

    function k() {
      av.find(".tickLabels").remove();
      var aG = ['<div class="tickLabels" style="font-size:smaller">'];
      var aJ = m();

      for (var aD = 0; aD < aJ.length; ++aD) {
        var aC = aJ[aD],
            aF = aC.box;

        if (!aC.show) {
          continue;
        }

        aG.push('<div class="' + aC.direction + "Axis " + aC.direction + aC.n + 'Axis" style="color:' + aC.options.color + '">');

        for (var aE = 0; aE < aC.ticks.length; ++aE) {
          var aH = aC.ticks[aE];

          if (!aH.label || aH.v < aC.min || aH.v > aC.max) {
            continue;
          }

          var aK = {},
              aI;

          if (aC.direction == "x") {
            aI = "center";
            aK.left = Math.round(q.left + aC.p2c(aH.v) - aC.labelWidth / 2);

            if (aC.position == "bottom") {
              aK.top = aF.top + aF.padding;
            } else {
              aK.bottom = I - (aF.top + aF.height - aF.padding);
            }
          } else {
            aK.top = Math.round(q.top + aC.p2c(aH.v) - aC.labelHeight / 2);

            if (aC.position == "left") {
              aK.right = G - (aF.left + aF.width - aF.padding);
              aI = "right";
            } else {
              aK.left = aF.left + aF.padding;
              aI = "left";
            }
          }

          aK.width = aC.labelWidth;
          var aB = ["position:absolute", "text-align:" + aI];

          for (var aL in aK) {
            aB.push(aL + ":" + aK[aL] + "px");
          }

          aG.push('<div class="tickLabel" style="' + aB.join(";") + '">' + aH.label + "</div>");
        }

        aG.push("</div>");
      }

      aG.push("</div>");
      av.append(aG.join(""));
    }

    function d(aB) {
      if (aB.lines.show) {
        at(aB);
      }

      if (aB.bars.show) {
        e(aB);
      }

      if (aB.points.show) {
        ao(aB);
      }
    }

    function at(aE) {
      function aD(aP, aQ, aI, aU, aT) {
        var aV = aP.points,
            aJ = aP.pointsize,
            aN = null,
            aM = null;
        H.beginPath();

        for (var aO = aJ; aO < aV.length; aO += aJ) {
          var aL = aV[aO - aJ],
              aS = aV[aO - aJ + 1],
              aK = aV[aO],
              aR = aV[aO + 1];

          if (aL == null || aK == null) {
            continue;
          }

          if (aS <= aR && aS < aT.min) {
            if (aR < aT.min) {
              continue;
            }

            aL = (aT.min - aS) / (aR - aS) * (aK - aL) + aL;
            aS = aT.min;
          } else {
            if (aR <= aS && aR < aT.min) {
              if (aS < aT.min) {
                continue;
              }

              aK = (aT.min - aS) / (aR - aS) * (aK - aL) + aL;
              aR = aT.min;
            }
          }

          if (aS >= aR && aS > aT.max) {
            if (aR > aT.max) {
              continue;
            }

            aL = (aT.max - aS) / (aR - aS) * (aK - aL) + aL;
            aS = aT.max;
          } else {
            if (aR >= aS && aR > aT.max) {
              if (aS > aT.max) {
                continue;
              }

              aK = (aT.max - aS) / (aR - aS) * (aK - aL) + aL;
              aR = aT.max;
            }
          }

          if (aL <= aK && aL < aU.min) {
            if (aK < aU.min) {
              continue;
            }

            aS = (aU.min - aL) / (aK - aL) * (aR - aS) + aS;
            aL = aU.min;
          } else {
            if (aK <= aL && aK < aU.min) {
              if (aL < aU.min) {
                continue;
              }

              aR = (aU.min - aL) / (aK - aL) * (aR - aS) + aS;
              aK = aU.min;
            }
          }

          if (aL >= aK && aL > aU.max) {
            if (aK > aU.max) {
              continue;
            }

            aS = (aU.max - aL) / (aK - aL) * (aR - aS) + aS;
            aL = aU.max;
          } else {
            if (aK >= aL && aK > aU.max) {
              if (aL > aU.max) {
                continue;
              }

              aR = (aU.max - aL) / (aK - aL) * (aR - aS) + aS;
              aK = aU.max;
            }
          }

          if (aL != aN || aS != aM) {
            H.moveTo(aU.p2c(aL) + aQ, aT.p2c(aS) + aI);
          }

          aN = aK;
          aM = aR;
          H.lineTo(aU.p2c(aK) + aQ, aT.p2c(aR) + aI);
        }

        H.stroke();
      }

      function aF(aI, aQ, aP) {
        var aW = aI.points,
            aV = aI.pointsize,
            aN = Math.min(Math.max(0, aP.min), aP.max),
            aX = 0,
            aU,
            aT = false,
            aM = 1,
            aL = 0,
            aR = 0;

        while (true) {
          if (aV > 0 && aX > aW.length + aV) {
            break;
          }

          aX += aV;
          var aZ = aW[aX - aV],
              aK = aW[aX - aV + aM],
              aY = aW[aX],
              aJ = aW[aX + aM];

          if (aT) {
            if (aV > 0 && aZ != null && aY == null) {
              aR = aX;
              aV = -aV;
              aM = 2;
              continue;
            }

            if (aV < 0 && aX == aL + aV) {
              H.fill();
              aT = false;
              aV = -aV;
              aM = 1;
              aX = aL = aR + aV;
              continue;
            }
          }

          if (aZ == null || aY == null) {
            continue;
          }

          if (aZ <= aY && aZ < aQ.min) {
            if (aY < aQ.min) {
              continue;
            }

            aK = (aQ.min - aZ) / (aY - aZ) * (aJ - aK) + aK;
            aZ = aQ.min;
          } else {
            if (aY <= aZ && aY < aQ.min) {
              if (aZ < aQ.min) {
                continue;
              }

              aJ = (aQ.min - aZ) / (aY - aZ) * (aJ - aK) + aK;
              aY = aQ.min;
            }
          }

          if (aZ >= aY && aZ > aQ.max) {
            if (aY > aQ.max) {
              continue;
            }

            aK = (aQ.max - aZ) / (aY - aZ) * (aJ - aK) + aK;
            aZ = aQ.max;
          } else {
            if (aY >= aZ && aY > aQ.max) {
              if (aZ > aQ.max) {
                continue;
              }

              aJ = (aQ.max - aZ) / (aY - aZ) * (aJ - aK) + aK;
              aY = aQ.max;
            }
          }

          if (!aT) {
            H.beginPath();
            H.moveTo(aQ.p2c(aZ), aP.p2c(aN));
            aT = true;
          }

          if (aK >= aP.max && aJ >= aP.max) {
            H.lineTo(aQ.p2c(aZ), aP.p2c(aP.max));
            H.lineTo(aQ.p2c(aY), aP.p2c(aP.max));
            continue;
          } else {
            if (aK <= aP.min && aJ <= aP.min) {
              H.lineTo(aQ.p2c(aZ), aP.p2c(aP.min));
              H.lineTo(aQ.p2c(aY), aP.p2c(aP.min));
              continue;
            }
          }

          var aO = aZ,
              aS = aY;

          if (aK <= aJ && aK < aP.min && aJ >= aP.min) {
            aZ = (aP.min - aK) / (aJ - aK) * (aY - aZ) + aZ;
            aK = aP.min;
          } else {
            if (aJ <= aK && aJ < aP.min && aK >= aP.min) {
              aY = (aP.min - aK) / (aJ - aK) * (aY - aZ) + aZ;
              aJ = aP.min;
            }
          }

          if (aK >= aJ && aK > aP.max && aJ <= aP.max) {
            aZ = (aP.max - aK) / (aJ - aK) * (aY - aZ) + aZ;
            aK = aP.max;
          } else {
            if (aJ >= aK && aJ > aP.max && aK <= aP.max) {
              aY = (aP.max - aK) / (aJ - aK) * (aY - aZ) + aZ;
              aJ = aP.max;
            }
          }

          if (aZ != aO) {
            H.lineTo(aQ.p2c(aO), aP.p2c(aK));
          }

          H.lineTo(aQ.p2c(aZ), aP.p2c(aK));
          H.lineTo(aQ.p2c(aY), aP.p2c(aJ));

          if (aY != aS) {
            H.lineTo(aQ.p2c(aY), aP.p2c(aJ));
            H.lineTo(aQ.p2c(aS), aP.p2c(aJ));
          }
        }
      }

      H.save();
      H.translate(q.left, q.top);
      H.lineJoin = "round";
      var aG = aE.lines.lineWidth,
          aB = aE.shadowSize;

      if (aG > 0 && aB > 0) {
        H.lineWidth = aB;
        H.strokeStyle = "rgba(0,0,0,0.1)";
        var aH = Math.PI / 18;
        aD(aE.datapoints, Math.sin(aH) * (aG / 2 + aB / 2), Math.cos(aH) * (aG / 2 + aB / 2), aE.xaxis, aE.yaxis);
        H.lineWidth = aB / 2;
        aD(aE.datapoints, Math.sin(aH) * (aG / 2 + aB / 4), Math.cos(aH) * (aG / 2 + aB / 4), aE.xaxis, aE.yaxis);
      }

      H.lineWidth = aG;
      H.strokeStyle = aE.color;
      var aC = ae(aE.lines, aE.color, 0, w);

      if (aC) {
        H.fillStyle = aC;
        aF(aE.datapoints, aE.xaxis, aE.yaxis);
      }

      if (aG > 0) {
        aD(aE.datapoints, 0, 0, aE.xaxis, aE.yaxis);
      }

      H.restore();
    }

    function ao(aE) {
      function aH(aN, aM, aU, aK, aS, aT, aQ, aJ) {
        var aR = aN.points,
            aI = aN.pointsize;

        for (var aL = 0; aL < aR.length; aL += aI) {
          var aP = aR[aL],
              aO = aR[aL + 1];

          if (aP == null || aP < aT.min || aP > aT.max || aO < aQ.min || aO > aQ.max) {
            continue;
          }

          H.beginPath();
          aP = aT.p2c(aP);
          aO = aQ.p2c(aO) + aK;

          if (aJ == "circle") {
            H.arc(aP, aO, aM, 0, aS ? Math.PI : Math.PI * 2, false);
          } else {
            aJ(H, aP, aO, aM, aS);
          }

          H.closePath();

          if (aU) {
            H.fillStyle = aU;
            H.fill();
          }

          H.stroke();
        }
      }

      H.save();
      H.translate(q.left, q.top);
      var aG = aE.points.lineWidth,
          aC = aE.shadowSize,
          aB = aE.points.radius,
          aF = aE.points.symbol;

      if (aG > 0 && aC > 0) {
        var aD = aC / 2;
        H.lineWidth = aD;
        H.strokeStyle = "rgba(0,0,0,0.1)";
        aH(aE.datapoints, aB, null, aD + aD / 2, true, aE.xaxis, aE.yaxis, aF);
        H.strokeStyle = "rgba(0,0,0,0.2)";
        aH(aE.datapoints, aB, null, aD / 2, true, aE.xaxis, aE.yaxis, aF);
      }

      H.lineWidth = aG;
      H.strokeStyle = aE.color;
      aH(aE.datapoints, aB, ae(aE.points, aE.color), 0, false, aE.xaxis, aE.yaxis, aF);
      H.restore();
    }

    function E(aN, aM, aV, aI, aQ, aF, aD, aL, aK, aU, aR, aC) {
      var aE, aT, aJ, aP, aG, aB, aO, aH, aS;

      if (aR) {
        aH = aB = aO = true;
        aG = false;
        aE = aV;
        aT = aN;
        aP = aM + aI;
        aJ = aM + aQ;

        if (aT < aE) {
          aS = aT;
          aT = aE;
          aE = aS;
          aG = true;
          aB = false;
        }
      } else {
        aG = aB = aO = true;
        aH = false;
        aE = aN + aI;
        aT = aN + aQ;
        aJ = aV;
        aP = aM;

        if (aP < aJ) {
          aS = aP;
          aP = aJ;
          aJ = aS;
          aH = true;
          aO = false;
        }
      }

      if (aT < aL.min || aE > aL.max || aP < aK.min || aJ > aK.max) {
        return;
      }

      if (aE < aL.min) {
        aE = aL.min;
        aG = false;
      }

      if (aT > aL.max) {
        aT = aL.max;
        aB = false;
      }

      if (aJ < aK.min) {
        aJ = aK.min;
        aH = false;
      }

      if (aP > aK.max) {
        aP = aK.max;
        aO = false;
      }

      aE = aL.p2c(aE);
      aJ = aK.p2c(aJ);
      aT = aL.p2c(aT);
      aP = aK.p2c(aP);

      if (aD) {
        aU.beginPath();
        aU.moveTo(aE, aJ);
        aU.lineTo(aE, aP);
        aU.lineTo(aT, aP);
        aU.lineTo(aT, aJ);
        aU.fillStyle = aD(aJ, aP);
        aU.fill();
      }

      if (aC > 0 && (aG || aB || aO || aH)) {
        aU.beginPath();
        aU.moveTo(aE, aJ + aF);

        if (aG) {
          aU.lineTo(aE, aP + aF);
        } else {
          aU.moveTo(aE, aP + aF);
        }

        if (aO) {
          aU.lineTo(aT, aP + aF);
        } else {
          aU.moveTo(aT, aP + aF);
        }

        if (aB) {
          aU.lineTo(aT, aJ + aF);
        } else {
          aU.moveTo(aT, aJ + aF);
        }

        if (aH) {
          aU.lineTo(aE, aJ + aF);
        } else {
          aU.moveTo(aE, aJ + aF);
        }

        aU.stroke();
      }
    }

    function e(aD) {
      function aC(aJ, aI, aL, aG, aK, aN, aM) {
        var aO = aJ.points,
            aF = aJ.pointsize;

        for (var aH = 0; aH < aO.length; aH += aF) {
          if (aO[aH] == null) {
            continue;
          }

          E(aO[aH], aO[aH + 1], aO[aH + 2], aI, aL, aG, aK, aN, aM, H, aD.bars.horizontal, aD.bars.lineWidth);
        }
      }

      H.save();
      H.translate(q.left, q.top);
      H.lineWidth = aD.bars.lineWidth;
      H.strokeStyle = aD.color;
      var aB = aD.bars.align == "left" ? 0 : -aD.bars.barWidth / 2;
      var aE = aD.bars.fill ? function (aF, aG) {
        return ae(aD.bars, aD.color, aF, aG);
      } : null;
      aC(aD.datapoints, aB, aB + aD.bars.barWidth, 0, aE, aD.xaxis, aD.yaxis);
      H.restore();
    }

    function ae(aD, aB, aC, aF) {
      var aE = aD.fill;

      if (!aE) {
        return null;
      }

      if (aD.fillColor) {
        return am(aD.fillColor, aC, aF, aB);
      }

      var aG = c.color.parse(aB);
      aG.a = typeof aE == "number" ? aE : 0.4;
      aG.normalize();
      return aG.toString();
    }

    function o() {
      av.find(".legend").remove();

      if (!O.legend.show) {
        return;
      }

      var aH = [],
          aF = false,
          aN = O.legend.labelFormatter,
          aM,
          aJ;

      for (var aE = 0; aE < Q.length; ++aE) {
        aM = Q[aE];
        aJ = aM.label;

        if (!aJ) {
          continue;
        }

        if (aE % O.legend.noColumns == 0) {
          if (aF) {
            aH.push("</tr>");
          }

          aH.push("<tr>");
          aF = true;
        }

        if (aN) {
          aJ = aN(aJ, aM);
        }

        aH.push('<td class="legendColorBox"><div style="border:1px solid ' + O.legend.labelBoxBorderColor + ';padding:1px"><div style="width:4px;height:0;border:5px solid ' + aM.color + ';overflow:hidden"></div></div></td><td class="legendLabel">' + aJ + "</td>");
      }

      if (aF) {
        aH.push("</tr>");
      }

      if (aH.length == 0) {
        return;
      }

      var aL = '<table style="font-size:smaller;color:' + O.grid.color + '">' + aH.join("") + "</table>";

      if (O.legend.container != null) {
        c(O.legend.container).html(aL);
      } else {
        var aI = "",
            aC = O.legend.position,
            aD = O.legend.margin;

        if (aD[0] == null) {
          aD = [aD, aD];
        }

        if (aC.charAt(0) == "n") {
          aI += "top:" + (aD[1] + q.top) + "px;";
        } else {
          if (aC.charAt(0) == "s") {
            aI += "bottom:" + (aD[1] + q.bottom) + "px;";
          }
        }

        if (aC.charAt(1) == "e") {
          aI += "right:" + (aD[0] + q.right) + "px;";
        } else {
          if (aC.charAt(1) == "w") {
            aI += "left:" + (aD[0] + q.left) + "px;";
          }
        }

        var aK = c('<div class="legend">' + aL.replace('style="', 'style="position:absolute;' + aI + ";") + "</div>").appendTo(av);

        if (O.legend.backgroundOpacity != 0) {
          var aG = O.legend.backgroundColor;

          if (aG == null) {
            aG = O.grid.backgroundColor;

            if (aG && typeof aG == "string") {
              aG = c.color.parse(aG);
            } else {
              aG = c.color.extract(aK, "background-color");
            }

            aG.a = 1;
            aG = aG.toString();
          }

          var aB = aK.children();
          c('<div style="position:absolute;width:' + aB.width() + "px;height:" + aB.height() + "px;" + aI + "background-color:" + aG + ';"> </div>').prependTo(aK).css("opacity", O.legend.backgroundOpacity);
        }
      }
    }

    var ab = [],
        M = null;

    function K(aI, aG, aD) {
      var aO = O.grid.mouseActiveRadius,
          a0 = aO * aO + 1,
          aY = null,
          aR = false,
          aW,
          aU;

      for (aW = Q.length - 1; aW >= 0; --aW) {
        if (!aD(Q[aW])) {
          continue;
        }

        var aP = Q[aW],
            aH = aP.xaxis,
            aF = aP.yaxis,
            aV = aP.datapoints.points,
            aT = aP.datapoints.pointsize,
            aQ = aH.c2p(aI),
            aN = aF.c2p(aG),
            aC = aO / aH.scale,
            aB = aO / aF.scale;

        if (aH.options.inverseTransform) {
          aC = Number.MAX_VALUE;
        }

        if (aF.options.inverseTransform) {
          aB = Number.MAX_VALUE;
        }

        if (aP.lines.show || aP.points.show) {
          for (aU = 0; aU < aV.length; aU += aT) {
            var aK = aV[aU],
                aJ = aV[aU + 1];

            if (aK == null) {
              continue;
            }

            if (aK - aQ > aC || aK - aQ < -aC || aJ - aN > aB || aJ - aN < -aB) {
              continue;
            }

            var aM = Math.abs(aH.p2c(aK) - aI),
                aL = Math.abs(aF.p2c(aJ) - aG),
                aS = aM * aM + aL * aL;

            if (aS < a0) {
              a0 = aS;
              aY = [aW, aU / aT];
            }
          }
        }

        if (aP.bars.show && !aY) {
          var aE = aP.bars.align == "left" ? 0 : -aP.bars.barWidth / 2,
              aX = aE + aP.bars.barWidth;

          for (aU = 0; aU < aV.length; aU += aT) {
            var aK = aV[aU],
                aJ = aV[aU + 1],
                aZ = aV[aU + 2];

            if (aK == null) {
              continue;
            }

            if (Q[aW].bars.horizontal ? aQ <= Math.max(aZ, aK) && aQ >= Math.min(aZ, aK) && aN >= aJ + aE && aN <= aJ + aX : aQ >= aK + aE && aQ <= aK + aX && aN >= Math.min(aZ, aJ) && aN <= Math.max(aZ, aJ)) {
              aY = [aW, aU / aT];
            }
          }
        }
      }

      if (aY) {
        aW = aY[0];
        aU = aY[1];
        aT = Q[aW].datapoints.pointsize;
        return {
          datapoint: Q[aW].datapoints.points.slice(aU * aT, (aU + 1) * aT),
          dataIndex: aU,
          series: Q[aW],
          seriesIndex: aW
        };
      }

      return null;
    }

    function aa(aB) {
      if (O.grid.hoverable) {
        u("plothover", aB, function (aC) {
          return aC.hoverable != false;
        });
      }
    }

    function l(aB) {
      if (O.grid.hoverable) {
        u("plothover", aB, function (aC) {
          return false;
        });
      }
    }

    function R(aB) {
      u("plotclick", aB, function (aC) {
        return aC.clickable != false;
      });
    }

    function u(aC, aB, aD) {
      var aE = y.offset(),
          aH = aB.pageX - aE.left - q.left,
          aF = aB.pageY - aE.top - q.top,
          aJ = C({
        left: aH,
        top: aF
      });
      aJ.pageX = aB.pageX;
      aJ.pageY = aB.pageY;
      var aK = K(aH, aF, aD);

      if (aK) {
        aK.pageX = parseInt(aK.series.xaxis.p2c(aK.datapoint[0]) + aE.left + q.left);
        aK.pageY = parseInt(aK.series.yaxis.p2c(aK.datapoint[1]) + aE.top + q.top);
      }

      if (O.grid.autoHighlight) {
        for (var aG = 0; aG < ab.length; ++aG) {
          var aI = ab[aG];

          if (aI.auto == aC && !(aK && aI.series == aK.series && aI.point[0] == aK.datapoint[0] && aI.point[1] == aK.datapoint[1])) {
            T(aI.series, aI.point);
          }
        }

        if (aK) {
          x(aK.series, aK.datapoint, aC);
        }
      }

      av.trigger(aC, [aJ, aK]);
    }

    function f() {
      if (!M) {
        M = setTimeout(s, 30);
      }
    }

    function s() {
      M = null;
      A.save();
      A.clearRect(0, 0, G, I);
      A.translate(q.left, q.top);
      var aC, aB;

      for (aC = 0; aC < ab.length; ++aC) {
        aB = ab[aC];

        if (aB.series.bars.show) {
          v(aB.series, aB.point);
        } else {
          ay(aB.series, aB.point);
        }
      }

      A.restore();
      an(ak.drawOverlay, [A]);
    }

    function x(aD, aB, aF) {
      if (typeof aD == "number") {
        aD = Q[aD];
      }

      if (typeof aB == "number") {
        var aE = aD.datapoints.pointsize;
        aB = aD.datapoints.points.slice(aE * aB, aE * (aB + 1));
      }

      var aC = al(aD, aB);

      if (aC == -1) {
        ab.push({
          series: aD,
          point: aB,
          auto: aF
        });
        f();
      } else {
        if (!aF) {
          ab[aC].auto = false;
        }
      }
    }

    function T(aD, aB) {
      if (aD == null && aB == null) {
        ab = [];
        f();
      }

      if (typeof aD == "number") {
        aD = Q[aD];
      }

      if (typeof aB == "number") {
        aB = aD.data[aB];
      }

      var aC = al(aD, aB);

      if (aC != -1) {
        ab.splice(aC, 1);
        f();
      }
    }

    function al(aD, aE) {
      for (var aB = 0; aB < ab.length; ++aB) {
        var aC = ab[aB];

        if (aC.series == aD && aC.point[0] == aE[0] && aC.point[1] == aE[1]) {
          return aB;
        }
      }

      return -1;
    }

    function ay(aE, aD) {
      var aC = aD[0],
          aI = aD[1],
          aH = aE.xaxis,
          aG = aE.yaxis;

      if (aC < aH.min || aC > aH.max || aI < aG.min || aI > aG.max) {
        return;
      }

      var aF = aE.points.radius + aE.points.lineWidth / 2;
      A.lineWidth = aF;
      A.strokeStyle = c.color.parse(aE.color).scale("a", 0.5).toString();
      var aB = 1.5 * aF,
          aC = aH.p2c(aC),
          aI = aG.p2c(aI);
      A.beginPath();

      if (aE.points.symbol == "circle") {
        A.arc(aC, aI, aB, 0, 2 * Math.PI, false);
      } else {
        aE.points.symbol(A, aC, aI, aB, false);
      }

      A.closePath();
      A.stroke();
    }

    function v(aE, aB) {
      A.lineWidth = aE.bars.lineWidth;
      A.strokeStyle = c.color.parse(aE.color).scale("a", 0.5).toString();
      var aD = c.color.parse(aE.color).scale("a", 0.5).toString();
      var aC = aE.bars.align == "left" ? 0 : -aE.bars.barWidth / 2;
      E(aB[0], aB[1], aB[2] || 0, aC, aC + aE.bars.barWidth, 0, function () {
        return aD;
      }, aE.xaxis, aE.yaxis, A, aE.bars.horizontal, aE.bars.lineWidth);
    }

    function am(aJ, aB, aH, aC) {
      if (typeof aJ == "string") {
        return aJ;
      } else {
        var aI = H.createLinearGradient(0, aH, 0, aB);

        for (var aE = 0, aD = aJ.colors.length; aE < aD; ++aE) {
          var aF = aJ.colors[aE];

          if (typeof aF != "string") {
            var aG = c.color.parse(aC);

            if (aF.brightness != null) {
              aG = aG.scale("rgb", aF.brightness);
            }

            if (aF.opacity != null) {
              aG.a *= aF.opacity;
            }

            aF = aG.toString();
          }

          aI.addColorStop(aE / (aD - 1), aF);
        }

        return aI;
      }
    }
  }

  c.plot = function (g, e, d) {
    var f = new b(c(g), e, d, c.plot.plugins);
    return f;
  };

  c.plot.version = "0.7";
  c.plot.plugins = [];

  c.plot.formatDate = function (l, f, h) {
    var o = function o(d) {
      d = "" + d;
      return d.length == 1 ? "0" + d : d;
    };

    var e = [];
    var p = false,
        j = false;
    var n = l.getUTCHours();
    var k = n < 12;

    if (h == null) {
      h = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    }

    if (f.search(/%p|%P/) != -1) {
      if (n > 12) {
        n = n - 12;
      } else {
        if (n == 0) {
          n = 12;
        }
      }
    }

    for (var g = 0; g < f.length; ++g) {
      var m = f.charAt(g);

      if (p) {
        switch (m) {
          case "h":
            m = "" + n;
            break;

          case "H":
            m = o(n);
            break;

          case "M":
            m = o(l.getUTCMinutes());
            break;

          case "S":
            m = o(l.getUTCSeconds());
            break;

          case "d":
            m = "" + l.getUTCDate();
            break;

          case "m":
            m = "" + (l.getUTCMonth() + 1);
            break;

          case "y":
            m = "" + l.getUTCFullYear();
            break;

          case "b":
            m = "" + h[l.getUTCMonth()];
            break;

          case "p":
            m = k ? "am" : "pm";
            break;

          case "P":
            m = k ? "AM" : "PM";
            break;

          case "0":
            m = "";
            j = true;
            break;
        }

        if (m && j) {
          m = o(m);
          j = false;
        }

        e.push(m);

        if (!j) {
          p = false;
        }
      } else {
        if (m == "%") {
          p = true;
        } else {
          e.push(m);
        }
      }
    }

    return e.join("");
  };

  function a(e, d) {
    return d * Math.floor(e / d);
  }
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/html5-input-polyfills/number-polyfill.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {// Generated by CoffeeScript 1.4.0

/*
HTML5 Number polyfill | Jonathan Stipe | https://github.com/jonstipe/number-polyfill
*/
(function () {
  (function ($) {
    var i;
    i = document.createElement("input");
    i.setAttribute("type", "number");

    if (i.type === "text") {
      $.fn.inputNumber = function () {
        var clipValues, decrement, domMouseScrollHandler, extractNumDecimalDigits, getParams, increment, matchStep, mouseWheelHandler;

        getParams = function getParams(elem) {
          var $elem, max, min, step, val;
          $elem = $(elem);
          step = $elem.attr('step');
          min = $elem.attr('min');
          max = $elem.attr('max');
          val = parseFloat($elem.val());
          step = /^-?\d+(?:\.\d+)?$/.test(step) ? parseFloat(step) : null;
          min = /^-?\d+(?:\.\d+)?$/.test(min) ? parseFloat(min) : null;
          max = /^-?\d+(?:\.\d+)?$/.test(max) ? parseFloat(max) : null;

          if (isNaN(val)) {
            val = min || 0;
          }

          return {
            min: min,
            max: max,
            step: step,
            val: val
          };
        };

        clipValues = function clipValues(value, min, max) {
          if (max != null && value > max) {
            return max;
          } else if (min != null && value < min) {
            return min;
          } else {
            return value;
          }
        };

        extractNumDecimalDigits = function extractNumDecimalDigits(input) {
          var num, raisedNum;

          if (input != null) {
            num = 0;
            raisedNum = input;

            while (raisedNum !== Math.round(raisedNum)) {
              num += 1;
              raisedNum = input * Math.pow(10, num);
            }

            return num;
          } else {
            return 0;
          }
        };

        matchStep = function matchStep(value, min, max, step) {
          var mod, raiseTo, raisedMod, raisedStep, raisedStepDown, raisedStepUp, raisedValue, stepDecimalDigits, stepDown, stepUp;
          stepDecimalDigits = extractNumDecimalDigits(step);

          if (step == null) {
            return value;
          } else if (stepDecimalDigits === 0) {
            mod = (value - (min || 0)) % step;

            if (mod === 0) {
              return value;
            } else {
              stepDown = value - mod;
              stepUp = stepDown + step;

              if (stepUp > max || value - stepDown < stepUp - value) {
                return stepDown;
              } else {
                return stepUp;
              }
            }
          } else {
            raiseTo = Math.pow(10, stepDecimalDigits);
            raisedStep = step * raiseTo;
            raisedMod = (value - (min || 0)) * raiseTo % raisedStep;

            if (raisedMod === 0) {
              return value;
            } else {
              raisedValue = value * raiseTo;
              raisedStepDown = raisedValue - raisedMod;
              raisedStepUp = raisedStepDown + raisedStep;

              if (raisedStepUp / raiseTo > max || raisedValue - raisedStepDown < raisedStepUp - raisedValue) {
                return raisedStepDown / raiseTo;
              } else {
                return raisedStepUp / raiseTo;
              }
            }
          }
        };

        increment = function increment(elem) {
          var newVal, params, raiseTo;

          if (!$(elem).is(":disabled")) {
            params = getParams(elem);
            raiseTo = Math.pow(10, Math.max(extractNumDecimalDigits(params['val']), extractNumDecimalDigits(params['step'])));
            newVal = (Math.round(params['val'] * raiseTo) + Math.round((params['step'] || 1) * raiseTo)) / raiseTo;

            if (params['max'] != null && newVal > params['max']) {
              newVal = params['max'];
            }

            newVal = matchStep(newVal, params['min'], params['max'], params['step']);
            $(elem).val(newVal).change();
          }

          return null;
        };

        decrement = function decrement(elem) {
          var newVal, params, raiseTo;

          if (!$(elem).is(":disabled")) {
            params = getParams(elem);
            raiseTo = Math.pow(10, Math.max(extractNumDecimalDigits(params['val']), extractNumDecimalDigits(params['step'])));
            newVal = (Math.round(params['val'] * raiseTo) - Math.round((params['step'] || 1) * raiseTo)) / raiseTo;

            if (params['min'] != null && newVal < params['min']) {
              newVal = params['min'];
            }

            newVal = matchStep(newVal, params['min'], params['max'], params['step']);
            $(elem).val(newVal).change();
          }

          return null;
        };

        domMouseScrollHandler = function domMouseScrollHandler(e) {
          e.preventDefault();

          if (e.originalEvent.detail < 0) {
            increment(this);
          } else {
            decrement(this);
          }

          return null;
        };

        mouseWheelHandler = function mouseWheelHandler(e) {
          e.preventDefault();

          if (e.originalEvent.wheelDelta > 0) {
            increment(this);
          } else {
            decrement(this);
          }

          return null;
        };

        $(this).filter('input[type="number"]').each(function () {
          var $downBtn, $elem, $upBtn, attrMutationCallback, attrObserver, btnContainer, downBtn, elem, halfHeight, upBtn;
          elem = this;
          $elem = $(elem);
          halfHeight = $elem.outerHeight() / 6 + 'px';
          upBtn = document.createElement('div');
          downBtn = document.createElement('div');
          $upBtn = $(upBtn);
          $downBtn = $(downBtn);
          btnContainer = document.createElement('div');
          $upBtn.addClass('number-spin-btn number-spin-btn-up').css('height', halfHeight);
          $downBtn.addClass('number-spin-btn number-spin-btn-down').css('height', halfHeight);
          btnContainer.appendChild(upBtn);
          btnContainer.appendChild(downBtn);
          $(btnContainer).addClass('number-spin-btn-container').insertAfter(elem);
          $elem.on({
            focus: function focus(e) {
              $elem.on({
                DOMMouseScroll: domMouseScrollHandler,
                mousewheel: mouseWheelHandler
              });
              return null;
            },
            blur: function blur(e) {
              $elem.off({
                DOMMouseScroll: domMouseScrollHandler,
                mousewheel: mouseWheelHandler
              });
              return null;
            },
            keypress: function keypress(e) {
              var _ref, _ref1;

              if (e.keyCode === 38) {
                increment(this);
              } else if (e.keyCode === 40) {
                decrement(this);
              } else if ((_ref = e.keyCode) !== 8 && _ref !== 9 && _ref !== 35 && _ref !== 36 && _ref !== 37 && _ref !== 39 && (_ref1 = e.which) !== 45 && _ref1 !== 46 && _ref1 !== 48 && _ref1 !== 49 && _ref1 !== 50 && _ref1 !== 51 && _ref1 !== 52 && _ref1 !== 53 && _ref1 !== 54 && _ref1 !== 55 && _ref1 !== 56 && _ref1 !== 57) {
                e.preventDefault();
              }

              return null;
            },
            change: function change(e) {
              var newVal, params;

              if (e.originalEvent != null) {
                params = getParams(this);
                newVal = clipValues(params['val'], params['min'], params['max']);
                newVal = matchStep(newVal, params['min'], params['max'], params['step'], params['stepDecimal']);
                $(this).val(newVal);
              }

              return null;
            }
          });
          $upBtn.on("mousedown", function (e) {
            var _releaseFunc, _timeoutFunc;

            increment(elem);

            _timeoutFunc = function timeoutFunc(elem, incFunc) {
              incFunc(elem);
              $elem.data("timeoutID", window.setTimeout(_timeoutFunc, 10, elem, incFunc));
              return null;
            };

            _releaseFunc = function releaseFunc(e) {
              window.clearTimeout($elem.data("timeoutID"));
              $(document).off('mouseup', _releaseFunc);
              $upBtn.off('mouseleave', _releaseFunc);
              return null;
            };

            $(document).on('mouseup', _releaseFunc);
            $upBtn.on('mouseleave', _releaseFunc);
            $elem.data("timeoutID", window.setTimeout(_timeoutFunc, 700, elem, increment));
            return null;
          });
          $downBtn.on("mousedown", function (e) {
            var _releaseFunc2, _timeoutFunc2;

            decrement(elem);

            _timeoutFunc2 = function timeoutFunc(elem, decFunc) {
              decFunc(elem);
              $elem.data("timeoutID", window.setTimeout(_timeoutFunc2, 10, elem, decFunc));
              return null;
            };

            _releaseFunc2 = function releaseFunc(e) {
              window.clearTimeout($elem.data("timeoutID"));
              $(document).off('mouseup', _releaseFunc2);
              $downBtn.off('mouseleave', _releaseFunc2);
              return null;
            };

            $(document).on('mouseup', _releaseFunc2);
            $downBtn.on('mouseleave', _releaseFunc2);
            $elem.data("timeoutID", window.setTimeout(_timeoutFunc2, 700, elem, decrement));
            return null;
          });
          $elem.css("textAlign", 'left');

          if ($elem.css("opacity") !== "1") {
            $(btnContainer).css("opacity", $elem.css("opacity"));
          }

          if ($elem.css("visibility") !== "visible") {
            $(btnContainer).css("visibility", $elem.css("visibility"));
          }

          if (elem.style.display !== "") {
            $(btnContainer).css("display", $elem.css("display"));
          }

          if (typeof WebKitMutationObserver !== "undefined" && WebKitMutationObserver !== null || typeof MutationObserver !== "undefined" && MutationObserver !== null) {
            attrMutationCallback = function attrMutationCallback(mutations, observer) {
              var mutation, _i, _len;

              for (_i = 0, _len = mutations.length; _i < _len; _i++) {
                mutation = mutations[_i];

                if (mutation.type === "attributes") {
                  if (mutation.attributeName === "class") {
                    $(btnContainer).removeClass(mutation.oldValue).addClass(elem.className);
                  } else if (mutation.attributeName === "style") {
                    $(btnContainer).css({
                      "opacity": elem.style.opacity,
                      "visibility": elem.style.visibility,
                      "display": elem.style.display
                    });
                  }
                }
              }

              return null;
            };

            attrObserver = typeof WebKitMutationObserver !== "undefined" && WebKitMutationObserver !== null ? new WebKitMutationObserver(attrMutationCallback) : typeof MutationObserver !== "undefined" && MutationObserver !== null ? new MutationObserver(attrMutationCallback) : null;
            attrObserver.observe(elem, {
              attributes: true,
              attributeOldValue: true,
              attributeFilter: ["class", "style"]
            });
          } else if (typeof MutationEvent !== "undefined" && MutationEvent !== null) {
            $elem.on("DOMAttrModified", function (evt) {
              if (evt.originalEvent.attrName === "class") {
                $(btnContainer).removeClass(evt.originalEvent.prevValue).addClass(evt.originalEvent.newValue);
              } else if (evt.originalEvent.attrName === "style") {
                $(btnContainer).css({
                  "display": elem.style.display,
                  "visibility": elem.style.visibility,
                  "opacity": elem.style.opacity
                });
              }

              return null;
            });
          }

          return null;
        });
        return $(this);
      };

      $(function () {
        $('input[type="number"]').inputNumber();
        return null;
      });
      null;
    } else {
      $.fn.inputNumber = function () {
        return $(this);
      };

      null;
    }

    return null;
  })(jQuery);
}).call(this);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery-ui.min.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*! jQuery UI - v1.10.0 - 2013-01-23
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.menu.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
* Copyright (c) 2013 jQuery Foundation and other contributors Licensed MIT */
(function (e, t) {
  function i(t, n) {
    var r,
        i,
        o,
        u = t.nodeName.toLowerCase();
    return "area" === u ? (r = t.parentNode, i = r.name, !t.href || !i || r.nodeName.toLowerCase() !== "map" ? !1 : (o = e("img[usemap=#" + i + "]")[0], !!o && s(o))) : (/input|select|textarea|button|object/.test(u) ? !t.disabled : "a" === u ? t.href || n : n) && s(t);
  }

  function s(t) {
    return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function () {
      return e.css(this, "visibility") === "hidden";
    }).length;
  }

  var n = 0,
      r = /^ui-id-\d+$/;
  e.ui = e.ui || {};
  if (e.ui.version) return;
  e.extend(e.ui, {
    version: "1.10.0",
    keyCode: {
      BACKSPACE: 8,
      COMMA: 188,
      DELETE: 46,
      DOWN: 40,
      END: 35,
      ENTER: 13,
      ESCAPE: 27,
      HOME: 36,
      LEFT: 37,
      NUMPAD_ADD: 107,
      NUMPAD_DECIMAL: 110,
      NUMPAD_DIVIDE: 111,
      NUMPAD_ENTER: 108,
      NUMPAD_MULTIPLY: 106,
      NUMPAD_SUBTRACT: 109,
      PAGE_DOWN: 34,
      PAGE_UP: 33,
      PERIOD: 190,
      RIGHT: 39,
      SPACE: 32,
      TAB: 9,
      UP: 38
    }
  }), e.fn.extend({
    _focus: e.fn.focus,
    focus: function focus(t, n) {
      return typeof t == "number" ? this.each(function () {
        var r = this;
        setTimeout(function () {
          e(r).focus(), n && n.call(r);
        }, t);
      }) : this._focus.apply(this, arguments);
    },
    scrollParent: function scrollParent() {
      var t;
      return e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? t = this.parents().filter(function () {
        return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"));
      }).eq(0) : t = this.parents().filter(function () {
        return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"));
      }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t;
    },
    zIndex: function zIndex(n) {
      if (n !== t) return this.css("zIndex", n);

      if (this.length) {
        var r = e(this[0]),
            i,
            s;

        while (r.length && r[0] !== document) {
          i = r.css("position");

          if (i === "absolute" || i === "relative" || i === "fixed") {
            s = parseInt(r.css("zIndex"), 10);
            if (!isNaN(s) && s !== 0) return s;
          }

          r = r.parent();
        }
      }

      return 0;
    },
    uniqueId: function uniqueId() {
      return this.each(function () {
        this.id || (this.id = "ui-id-" + ++n);
      });
    },
    removeUniqueId: function removeUniqueId() {
      return this.each(function () {
        r.test(this.id) && e(this).removeAttr("id");
      });
    }
  }), e.extend(e.expr[":"], {
    data: e.expr.createPseudo ? e.expr.createPseudo(function (t) {
      return function (n) {
        return !!e.data(n, t);
      };
    }) : function (t, n, r) {
      return !!e.data(t, r[3]);
    },
    focusable: function focusable(t) {
      return i(t, !isNaN(e.attr(t, "tabindex")));
    },
    tabbable: function tabbable(t) {
      var n = e.attr(t, "tabindex"),
          r = isNaN(n);
      return (r || n >= 0) && i(t, !r);
    }
  }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function (n, r) {
    function u(t, n, r, s) {
      return e.each(i, function () {
        n -= parseFloat(e.css(t, "padding" + this)) || 0, r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0);
      }), n;
    }

    var i = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"],
        s = r.toLowerCase(),
        o = {
      innerWidth: e.fn.innerWidth,
      innerHeight: e.fn.innerHeight,
      outerWidth: e.fn.outerWidth,
      outerHeight: e.fn.outerHeight
    };
    e.fn["inner" + r] = function (n) {
      return n === t ? o["inner" + r].call(this) : this.each(function () {
        e(this).css(s, u(this, n) + "px");
      });
    }, e.fn["outer" + r] = function (t, n) {
      return typeof t != "number" ? o["outer" + r].call(this, t) : this.each(function () {
        e(this).css(s, u(this, t, !0, n) + "px");
      });
    };
  }), e.fn.addBack || (e.fn.addBack = function (e) {
    return this.add(e == null ? this.prevObject : this.prevObject.filter(e));
  }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function (t) {
    return function (n) {
      return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this);
    };
  }(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), e.support.selectstart = "onselectstart" in document.createElement("div"), e.fn.extend({
    disableSelection: function disableSelection() {
      return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function (e) {
        e.preventDefault();
      });
    },
    enableSelection: function enableSelection() {
      return this.unbind(".ui-disableSelection");
    }
  }), e.extend(e.ui, {
    plugin: {
      add: function add(t, n, r) {
        var i,
            s = e.ui[t].prototype;

        for (i in r) {
          s.plugins[i] = s.plugins[i] || [], s.plugins[i].push([n, r[i]]);
        }
      },
      call: function call(e, t, n) {
        var r,
            i = e.plugins[t];
        if (!i || !e.element[0].parentNode || e.element[0].parentNode.nodeType === 11) return;

        for (r = 0; r < i.length; r++) {
          e.options[i[r][0]] && i[r][1].apply(e.element, n);
        }
      }
    },
    hasScroll: function hasScroll(t, n) {
      if (e(t).css("overflow") === "hidden") return !1;
      var r = n && n === "left" ? "scrollLeft" : "scrollTop",
          i = !1;
      return t[r] > 0 ? !0 : (t[r] = 1, i = t[r] > 0, t[r] = 0, i);
    }
  });
})(jQuery);

(function (e, t) {
  var n = 0,
      r = Array.prototype.slice,
      i = e.cleanData;
  e.cleanData = function (t) {
    for (var n = 0, r; (r = t[n]) != null; n++) {
      try {
        e(r).triggerHandler("remove");
      } catch (s) {}
    }

    i(t);
  }, e.widget = function (t, n, r) {
    var i,
        s,
        o,
        u,
        a = {},
        f = t.split(".")[0];
    t = t.split(".")[1], i = f + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function (t) {
      return !!e.data(t, i);
    }, e[f] = e[f] || {}, s = e[f][t], o = e[f][t] = function (e, t) {
      if (!this._createWidget) return new o(e, t);
      arguments.length && this._createWidget(e, t);
    }, e.extend(o, s, {
      version: r.version,
      _proto: e.extend({}, r),
      _childConstructors: []
    }), u = new n(), u.options = e.widget.extend({}, u.options), e.each(r, function (t, r) {
      if (!e.isFunction(r)) {
        a[t] = r;
        return;
      }

      a[t] = function () {
        var e = function e() {
          return n.prototype[t].apply(this, arguments);
        },
            i = function i(e) {
          return n.prototype[t].apply(this, e);
        };

        return function () {
          var t = this._super,
              n = this._superApply,
              s;
          return this._super = e, this._superApply = i, s = r.apply(this, arguments), this._super = t, this._superApply = n, s;
        };
      }();
    }), o.prototype = e.widget.extend(u, {
      widgetEventPrefix: s ? u.widgetEventPrefix : t
    }, a, {
      constructor: o,
      namespace: f,
      widgetName: t,
      widgetFullName: i
    }), s ? (e.each(s._childConstructors, function (t, n) {
      var r = n.prototype;
      e.widget(r.namespace + "." + r.widgetName, o, n._proto);
    }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o);
  }, e.widget.extend = function (n) {
    var i = r.call(arguments, 1),
        s = 0,
        o = i.length,
        u,
        a;

    for (; s < o; s++) {
      for (u in i[s]) {
        a = i[s][u], i[s].hasOwnProperty(u) && a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a);
      }
    }

    return n;
  }, e.widget.bridge = function (n, i) {
    var s = i.prototype.widgetFullName || n;

    e.fn[n] = function (o) {
      var u = typeof o == "string",
          a = r.call(arguments, 1),
          f = this;
      return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function () {
        var r,
            i = e.data(this, s);
        if (!i) return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'");
        if (!e.isFunction(i[o]) || o.charAt(0) === "_") return e.error("no such method '" + o + "' for " + n + " widget instance");
        r = i[o].apply(i, a);
        if (r !== i && r !== t) return f = r && r.jquery ? f.pushStack(r.get()) : r, !1;
      }) : this.each(function () {
        var t = e.data(this, s);
        t ? t.option(o || {})._init() : e.data(this, s, new i(o, this));
      }), f;
    };
  }, e.Widget = function () {}, e.Widget._childConstructors = [], e.Widget.prototype = {
    widgetName: "widget",
    widgetEventPrefix: "",
    defaultElement: "<div>",
    options: {
      disabled: !1,
      create: null
    },
    _createWidget: function _createWidget(t, r) {
      r = e(r || this.defaultElement || this)[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetFullName, this), this._on(!0, this.element, {
        remove: function remove(e) {
          e.target === r && this.destroy();
        }
      }), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init();
    },
    _getCreateOptions: e.noop,
    _getCreateEventData: e.noop,
    _create: e.noop,
    _init: e.noop,
    destroy: function destroy() {
      this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus");
    },
    _destroy: e.noop,
    widget: function widget() {
      return this.element;
    },
    option: function option(n, r) {
      var i = n,
          s,
          o,
          u;
      if (arguments.length === 0) return e.widget.extend({}, this.options);

      if (typeof n == "string") {
        i = {}, s = n.split("."), n = s.shift();

        if (s.length) {
          o = i[n] = e.widget.extend({}, this.options[n]);

          for (u = 0; u < s.length - 1; u++) {
            o[s[u]] = o[s[u]] || {}, o = o[s[u]];
          }

          n = s.pop();
          if (r === t) return o[n] === t ? null : o[n];
          o[n] = r;
        } else {
          if (r === t) return this.options[n] === t ? null : this.options[n];
          i[n] = r;
        }
      }

      return this._setOptions(i), this;
    },
    _setOptions: function _setOptions(e) {
      var t;

      for (t in e) {
        this._setOption(t, e[t]);
      }

      return this;
    },
    _setOption: function _setOption(e, t) {
      return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this;
    },
    enable: function enable() {
      return this._setOption("disabled", !1);
    },
    disable: function disable() {
      return this._setOption("disabled", !0);
    },
    _on: function _on(t, n, r) {
      var i,
          s = this;
      typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function (r, o) {
        function u() {
          if (!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) return;
          return (typeof o == "string" ? s[o] : o).apply(s, arguments);
        }

        typeof o != "string" && (u.guid = o.guid = o.guid || u.guid || e.guid++);
        var a = r.match(/^(\w+)\s*(.*)$/),
            f = a[1] + s.eventNamespace,
            l = a[2];
        l ? i.delegate(l, f, u) : n.bind(f, u);
      });
    },
    _off: function _off(e, t) {
      t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t);
    },
    _delay: function _delay(e, t) {
      function n() {
        return (typeof e == "string" ? r[e] : e).apply(r, arguments);
      }

      var r = this;
      return setTimeout(n, t || 0);
    },
    _hoverable: function _hoverable(t) {
      this.hoverable = this.hoverable.add(t), this._on(t, {
        mouseenter: function mouseenter(t) {
          e(t.currentTarget).addClass("ui-state-hover");
        },
        mouseleave: function mouseleave(t) {
          e(t.currentTarget).removeClass("ui-state-hover");
        }
      });
    },
    _focusable: function _focusable(t) {
      this.focusable = this.focusable.add(t), this._on(t, {
        focusin: function focusin(t) {
          e(t.currentTarget).addClass("ui-state-focus");
        },
        focusout: function focusout(t) {
          e(t.currentTarget).removeClass("ui-state-focus");
        }
      });
    },
    _trigger: function _trigger(t, n, r) {
      var i,
          s,
          o = this.options[t];
      r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
      if (s) for (i in s) {
        i in n || (n[i] = s[i]);
      }
      return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented());
    }
  }, e.each({
    show: "fadeIn",
    hide: "fadeOut"
  }, function (t, n) {
    e.Widget.prototype["_" + t] = function (r, i, s) {
      typeof i == "string" && (i = {
        effect: i
      });
      var o,
          u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
      i = i || {}, typeof i == "number" && (i = {
        duration: i
      }), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && e.effects && e.effects.effect[u] ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function (n) {
        e(this)[t](), s && s.call(r[0]), n();
      });
    };
  });
})(jQuery);

(function (e, t) {
  var n = !1;
  e(document).mouseup(function () {
    n = !1;
  }), e.widget("ui.mouse", {
    version: "1.10.0",
    options: {
      cancel: "input,textarea,button,select,option",
      distance: 1,
      delay: 0
    },
    _mouseInit: function _mouseInit() {
      var t = this;
      this.element.bind("mousedown." + this.widgetName, function (e) {
        return t._mouseDown(e);
      }).bind("click." + this.widgetName, function (n) {
        if (!0 === e.data(n.target, t.widgetName + ".preventClickEvent")) return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1;
      }), this.started = !1;
    },
    _mouseDestroy: function _mouseDestroy() {
      this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
    },
    _mouseDown: function _mouseDown(t) {
      if (n) return;
      this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
      var r = this,
          i = t.which === 1,
          s = typeof this.options.cancel == "string" && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1;
      if (!i || s || !this._mouseCapture(t)) return !0;
      this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
        r.mouseDelayMet = !0;
      }, this.options.delay));

      if (this._mouseDistanceMet(t) && this._mouseDelayMet(t)) {
        this._mouseStarted = this._mouseStart(t) !== !1;
        if (!this._mouseStarted) return t.preventDefault(), !0;
      }

      return !0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (e) {
        return r._mouseMove(e);
      }, this._mouseUpDelegate = function (e) {
        return r._mouseUp(e);
      }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), n = !0, !0;
    },
    _mouseMove: function _mouseMove(t) {
      return e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted);
    },
    _mouseUp: function _mouseUp(t) {
      return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1;
    },
    _mouseDistanceMet: function _mouseDistanceMet(e) {
      return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance;
    },
    _mouseDelayMet: function _mouseDelayMet() {
      return this.mouseDelayMet;
    },
    _mouseStart: function _mouseStart() {},
    _mouseDrag: function _mouseDrag() {},
    _mouseStop: function _mouseStop() {},
    _mouseCapture: function _mouseCapture() {
      return !0;
    }
  });
})(jQuery);

(function (e, t) {
  function h(e, t, n) {
    return [parseInt(e[0], 10) * (l.test(e[0]) ? t / 100 : 1), parseInt(e[1], 10) * (l.test(e[1]) ? n / 100 : 1)];
  }

  function p(t, n) {
    return parseInt(e.css(t, n), 10) || 0;
  }

  function d(t) {
    var n = t[0];
    return n.nodeType === 9 ? {
      width: t.width(),
      height: t.height(),
      offset: {
        top: 0,
        left: 0
      }
    } : e.isWindow(n) ? {
      width: t.width(),
      height: t.height(),
      offset: {
        top: t.scrollTop(),
        left: t.scrollLeft()
      }
    } : n.preventDefault ? {
      width: 0,
      height: 0,
      offset: {
        top: n.pageY,
        left: n.pageX
      }
    } : {
      width: t.outerWidth(),
      height: t.outerHeight(),
      offset: t.offset()
    };
  }

  e.ui = e.ui || {};
  var n,
      r = Math.max,
      i = Math.abs,
      s = Math.round,
      o = /left|center|right/,
      u = /top|center|bottom/,
      a = /[\+\-]\d+%?/,
      f = /^\w+/,
      l = /%$/,
      c = e.fn.position;
  e.position = {
    scrollbarWidth: function scrollbarWidth() {
      if (n !== t) return n;
      var r,
          i,
          s = e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
          o = s.children()[0];
      return e("body").append(s), r = o.offsetWidth, s.css("overflow", "scroll"), i = o.offsetWidth, r === i && (i = s[0].clientWidth), s.remove(), n = r - i;
    },
    getScrollInfo: function getScrollInfo(t) {
      var n = t.isWindow ? "" : t.element.css("overflow-x"),
          r = t.isWindow ? "" : t.element.css("overflow-y"),
          i = n === "scroll" || n === "auto" && t.width < t.element[0].scrollWidth,
          s = r === "scroll" || r === "auto" && t.height < t.element[0].scrollHeight;
      return {
        width: i ? e.position.scrollbarWidth() : 0,
        height: s ? e.position.scrollbarWidth() : 0
      };
    },
    getWithinInfo: function getWithinInfo(t) {
      var n = e(t || window),
          r = e.isWindow(n[0]);
      return {
        element: n,
        isWindow: r,
        offset: n.offset() || {
          left: 0,
          top: 0
        },
        scrollLeft: n.scrollLeft(),
        scrollTop: n.scrollTop(),
        width: r ? n.width() : n.outerWidth(),
        height: r ? n.height() : n.outerHeight()
      };
    }
  }, e.fn.position = function (t) {
    if (!t || !t.of) return c.apply(this, arguments);
    t = e.extend({}, t);
    var n,
        l,
        v,
        m,
        g,
        y,
        b = e(t.of),
        w = e.position.getWithinInfo(t.within),
        E = e.position.getScrollInfo(w),
        S = (t.collision || "flip").split(" "),
        x = {};
    return y = d(b), b[0].preventDefault && (t.at = "left top"), l = y.width, v = y.height, m = y.offset, g = e.extend({}, m), e.each(["my", "at"], function () {
      var e = (t[this] || "").split(" "),
          n,
          r;
      e.length === 1 && (e = o.test(e[0]) ? e.concat(["center"]) : u.test(e[0]) ? ["center"].concat(e) : ["center", "center"]), e[0] = o.test(e[0]) ? e[0] : "center", e[1] = u.test(e[1]) ? e[1] : "center", n = a.exec(e[0]), r = a.exec(e[1]), x[this] = [n ? n[0] : 0, r ? r[0] : 0], t[this] = [f.exec(e[0])[0], f.exec(e[1])[0]];
    }), S.length === 1 && (S[1] = S[0]), t.at[0] === "right" ? g.left += l : t.at[0] === "center" && (g.left += l / 2), t.at[1] === "bottom" ? g.top += v : t.at[1] === "center" && (g.top += v / 2), n = h(x.at, l, v), g.left += n[0], g.top += n[1], this.each(function () {
      var o,
          u,
          a = e(this),
          f = a.outerWidth(),
          c = a.outerHeight(),
          d = p(this, "marginLeft"),
          y = p(this, "marginTop"),
          T = f + d + p(this, "marginRight") + E.width,
          N = c + y + p(this, "marginBottom") + E.height,
          C = e.extend({}, g),
          k = h(x.my, a.outerWidth(), a.outerHeight());
      t.my[0] === "right" ? C.left -= f : t.my[0] === "center" && (C.left -= f / 2), t.my[1] === "bottom" ? C.top -= c : t.my[1] === "center" && (C.top -= c / 2), C.left += k[0], C.top += k[1], e.support.offsetFractions || (C.left = s(C.left), C.top = s(C.top)), o = {
        marginLeft: d,
        marginTop: y
      }, e.each(["left", "top"], function (r, i) {
        e.ui.position[S[r]] && e.ui.position[S[r]][i](C, {
          targetWidth: l,
          targetHeight: v,
          elemWidth: f,
          elemHeight: c,
          collisionPosition: o,
          collisionWidth: T,
          collisionHeight: N,
          offset: [n[0] + k[0], n[1] + k[1]],
          my: t.my,
          at: t.at,
          within: w,
          elem: a
        });
      }), t.using && (u = function u(e) {
        var n = m.left - C.left,
            s = n + l - f,
            o = m.top - C.top,
            u = o + v - c,
            h = {
          target: {
            element: b,
            left: m.left,
            top: m.top,
            width: l,
            height: v
          },
          element: {
            element: a,
            left: C.left,
            top: C.top,
            width: f,
            height: c
          },
          horizontal: s < 0 ? "left" : n > 0 ? "right" : "center",
          vertical: u < 0 ? "top" : o > 0 ? "bottom" : "middle"
        };
        l < f && i(n + s) < l && (h.horizontal = "center"), v < c && i(o + u) < v && (h.vertical = "middle"), r(i(n), i(s)) > r(i(o), i(u)) ? h.important = "horizontal" : h.important = "vertical", t.using.call(this, e, h);
      }), a.offset(e.extend(C, {
        using: u
      }));
    });
  }, e.ui.position = {
    fit: {
      left: function left(e, t) {
        var n = t.within,
            i = n.isWindow ? n.scrollLeft : n.offset.left,
            s = n.width,
            o = e.left - t.collisionPosition.marginLeft,
            u = i - o,
            a = o + t.collisionWidth - s - i,
            f;
        t.collisionWidth > s ? u > 0 && a <= 0 ? (f = e.left + u + t.collisionWidth - s - i, e.left += u - f) : a > 0 && u <= 0 ? e.left = i : u > a ? e.left = i + s - t.collisionWidth : e.left = i : u > 0 ? e.left += u : a > 0 ? e.left -= a : e.left = r(e.left - o, e.left);
      },
      top: function top(e, t) {
        var n = t.within,
            i = n.isWindow ? n.scrollTop : n.offset.top,
            s = t.within.height,
            o = e.top - t.collisionPosition.marginTop,
            u = i - o,
            a = o + t.collisionHeight - s - i,
            f;
        t.collisionHeight > s ? u > 0 && a <= 0 ? (f = e.top + u + t.collisionHeight - s - i, e.top += u - f) : a > 0 && u <= 0 ? e.top = i : u > a ? e.top = i + s - t.collisionHeight : e.top = i : u > 0 ? e.top += u : a > 0 ? e.top -= a : e.top = r(e.top - o, e.top);
      }
    },
    flip: {
      left: function left(e, t) {
        var n = t.within,
            r = n.offset.left + n.scrollLeft,
            s = n.width,
            o = n.isWindow ? n.scrollLeft : n.offset.left,
            u = e.left - t.collisionPosition.marginLeft,
            a = u - o,
            f = u + t.collisionWidth - s - o,
            l = t.my[0] === "left" ? -t.elemWidth : t.my[0] === "right" ? t.elemWidth : 0,
            c = t.at[0] === "left" ? t.targetWidth : t.at[0] === "right" ? -t.targetWidth : 0,
            h = -2 * t.offset[0],
            p,
            d;

        if (a < 0) {
          p = e.left + l + c + h + t.collisionWidth - s - r;
          if (p < 0 || p < i(a)) e.left += l + c + h;
        } else if (f > 0) {
          d = e.left - t.collisionPosition.marginLeft + l + c + h - o;
          if (d > 0 || i(d) < f) e.left += l + c + h;
        }
      },
      top: function top(e, t) {
        var n = t.within,
            r = n.offset.top + n.scrollTop,
            s = n.height,
            o = n.isWindow ? n.scrollTop : n.offset.top,
            u = e.top - t.collisionPosition.marginTop,
            a = u - o,
            f = u + t.collisionHeight - s - o,
            l = t.my[1] === "top",
            c = l ? -t.elemHeight : t.my[1] === "bottom" ? t.elemHeight : 0,
            h = t.at[1] === "top" ? t.targetHeight : t.at[1] === "bottom" ? -t.targetHeight : 0,
            p = -2 * t.offset[1],
            d,
            v;
        a < 0 ? (v = e.top + c + h + p + t.collisionHeight - s - r, e.top + c + h + p > a && (v < 0 || v < i(a)) && (e.top += c + h + p)) : f > 0 && (d = e.top - t.collisionPosition.marginTop + c + h + p - o, e.top + c + h + p > f && (d > 0 || i(d) < f) && (e.top += c + h + p));
      }
    },
    flipfit: {
      left: function left() {
        e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments);
      },
      top: function top() {
        e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments);
      }
    }
  }, function () {
    var t,
        n,
        r,
        i,
        s,
        o = document.getElementsByTagName("body")[0],
        u = document.createElement("div");
    t = document.createElement(o ? "div" : "body"), r = {
      visibility: "hidden",
      width: 0,
      height: 0,
      border: 0,
      margin: 0,
      background: "none"
    }, o && e.extend(r, {
      position: "absolute",
      left: "-1000px",
      top: "-1000px"
    });

    for (s in r) {
      t.style[s] = r[s];
    }

    t.appendChild(u), n = o || document.documentElement, n.insertBefore(t, n.firstChild), u.style.cssText = "position: absolute; left: 10.7432222px;", i = e(u).offset().left, e.support.offsetFractions = i > 10 && i < 11, t.innerHTML = "", n.removeChild(t);
  }();
})(jQuery);

(function (e, t) {
  e.widget("ui.draggable", e.ui.mouse, {
    version: "1.10.0",
    widgetEventPrefix: "drag",
    options: {
      addClasses: !0,
      appendTo: "parent",
      axis: !1,
      connectToSortable: !1,
      containment: !1,
      cursor: "auto",
      cursorAt: !1,
      grid: !1,
      handle: !1,
      helper: "original",
      iframeFix: !1,
      opacity: !1,
      refreshPositions: !1,
      revert: !1,
      revertDuration: 500,
      scope: "default",
      scroll: !0,
      scrollSensitivity: 20,
      scrollSpeed: 20,
      snap: !1,
      snapMode: "both",
      snapTolerance: 20,
      stack: !1,
      zIndex: !1,
      drag: null,
      start: null,
      stop: null
    },
    _create: function _create() {
      this.options.helper === "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit();
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy();
    },
    _mouseCapture: function _mouseCapture(t) {
      var n = this.options;
      return this.helper || n.disabled || e(t.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(t), this.handle ? (e(n.iframeFix === !0 ? "iframe" : n.iframeFix).each(function () {
        e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({
          width: this.offsetWidth + "px",
          height: this.offsetHeight + "px",
          position: "absolute",
          opacity: "0.001",
          zIndex: 1e3
        }).css(e(this).offset()).appendTo("body");
      }), !0) : !1);
    },
    _mouseStart: function _mouseStart(t) {
      var n = this.options;
      return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {
        top: this.offset.top - this.margins.top,
        left: this.offset.left - this.margins.left
      }, e.extend(this.offset, {
        click: {
          left: t.pageX - this.offset.left,
          top: t.pageY - this.offset.top
        },
        parent: this._getParentOffset(),
        relative: this._getRelativeOffset()
      }), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), n.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0);
    },
    _mouseDrag: function _mouseDrag(t, n) {
      this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute");

      if (!n) {
        var r = this._uiHash();

        if (this._trigger("drag", t, r) === !1) return this._mouseUp({}), !1;
        this.position = r.position;
      }

      if (!this.options.axis || this.options.axis !== "y") this.helper[0].style.left = this.position.left + "px";
      if (!this.options.axis || this.options.axis !== "x") this.helper[0].style.top = this.position.top + "px";
      return e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1;
    },
    _mouseStop: function _mouseStop(t) {
      var n,
          r = this,
          i = !1,
          s = !1;
      e.ui.ddmanager && !this.options.dropBehaviour && (s = e.ui.ddmanager.drop(this, t)), this.dropped && (s = this.dropped, this.dropped = !1), n = this.element[0];

      while (n && (n = n.parentNode)) {
        n === document && (i = !0);
      }

      return !i && this.options.helper === "original" ? !1 : (this.options.revert === "invalid" && !s || this.options.revert === "valid" && s || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, s) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
        r._trigger("stop", t) !== !1 && r._clear();
      }) : this._trigger("stop", t) !== !1 && this._clear(), !1);
    },
    _mouseUp: function _mouseUp(t) {
      return e("div.ui-draggable-iframeFix").each(function () {
        this.parentNode.removeChild(this);
      }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t);
    },
    cancel: function cancel() {
      return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this;
    },
    _getHandle: function _getHandle(t) {
      var n = !this.options.handle || !e(this.options.handle, this.element).length ? !0 : !1;
      return e(this.options.handle, this.element).find("*").addBack().each(function () {
        this === t.target && (n = !0);
      }), n;
    },
    _createHelper: function _createHelper(t) {
      var n = this.options,
          r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t])) : n.helper === "clone" ? this.element.clone().removeAttr("id") : this.element;
      return r.parents("body").length || r.appendTo(n.appendTo === "parent" ? this.element[0].parentNode : n.appendTo), r[0] !== this.element[0] && !/(fixed|absolute)/.test(r.css("position")) && r.css("position", "absolute"), r;
    },
    _adjustOffsetFromHelper: function _adjustOffsetFromHelper(t) {
      typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {
        left: +t[0],
        top: +t[1] || 0
      }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top);
    },
    _getParentOffset: function _getParentOffset() {
      this.offsetParent = this.helper.offsetParent();
      var t = this.offsetParent.offset();
      this.cssPosition === "absolute" && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
      if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && e.ui.ie) t = {
        top: 0,
        left: 0
      };
      return {
        top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
        left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
      };
    },
    _getRelativeOffset: function _getRelativeOffset() {
      if (this.cssPosition === "relative") {
        var e = this.element.position();
        return {
          top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
          left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
        };
      }

      return {
        top: 0,
        left: 0
      };
    },
    _cacheMargins: function _cacheMargins() {
      this.margins = {
        left: parseInt(this.element.css("marginLeft"), 10) || 0,
        top: parseInt(this.element.css("marginTop"), 10) || 0,
        right: parseInt(this.element.css("marginRight"), 10) || 0,
        bottom: parseInt(this.element.css("marginBottom"), 10) || 0
      };
    },
    _cacheHelperProportions: function _cacheHelperProportions() {
      this.helperProportions = {
        width: this.helper.outerWidth(),
        height: this.helper.outerHeight()
      };
    },
    _setContainment: function _setContainment() {
      var t,
          n,
          r,
          i = this.options;
      i.containment === "parent" && (i.containment = this.helper[0].parentNode);
      if (i.containment === "document" || i.containment === "window") this.containment = [i.containment === "document" ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, i.containment === "document" ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (i.containment === "document" ? 0 : e(window).scrollLeft()) + e(i.containment === "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (i.containment === "document" ? 0 : e(window).scrollTop()) + (e(i.containment === "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];

      if (!/^(document|window|parent)$/.test(i.containment) && i.containment.constructor !== Array) {
        n = e(i.containment), r = n[0];
        if (!r) return;
        t = e(r).css("overflow") !== "hidden", this.containment = [(parseInt(e(r).css("borderLeftWidth"), 10) || 0) + (parseInt(e(r).css("paddingLeft"), 10) || 0), (parseInt(e(r).css("borderTopWidth"), 10) || 0) + (parseInt(e(r).css("paddingTop"), 10) || 0), (t ? Math.max(r.scrollWidth, r.offsetWidth) : r.offsetWidth) - (parseInt(e(r).css("borderLeftWidth"), 10) || 0) - (parseInt(e(r).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(r.scrollHeight, r.offsetHeight) : r.offsetHeight) - (parseInt(e(r).css("borderTopWidth"), 10) || 0) - (parseInt(e(r).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = n;
      } else i.containment.constructor === Array && (this.containment = i.containment);
    },
    _convertPositionTo: function _convertPositionTo(t, n) {
      n || (n = this.position);
      var r = t === "absolute" ? 1 : -1,
          i = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
          s = /(html|body)/i.test(i[0].tagName);
      return {
        top: n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : s ? 0 : i.scrollTop()) * r,
        left: n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : s ? 0 : i.scrollLeft()) * r
      };
    },
    _generatePosition: function _generatePosition(t) {
      var n,
          r,
          i,
          s,
          o = this.options,
          u = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
          a = /(html|body)/i.test(u[0].tagName),
          f = t.pageX,
          l = t.pageY;
      return this.originalPosition && (this.containment && (this.relative_container ? (r = this.relative_container.offset(), n = [this.containment[0] + r.left, this.containment[1] + r.top, this.containment[2] + r.left, this.containment[3] + r.top]) : n = this.containment, t.pageX - this.offset.click.left < n[0] && (f = n[0] + this.offset.click.left), t.pageY - this.offset.click.top < n[1] && (l = n[1] + this.offset.click.top), t.pageX - this.offset.click.left > n[2] && (f = n[2] + this.offset.click.left), t.pageY - this.offset.click.top > n[3] && (l = n[3] + this.offset.click.top)), o.grid && (i = o.grid[1] ? this.originalPageY + Math.round((l - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY, l = n ? i - this.offset.click.top >= n[1] || i - this.offset.click.top > n[3] ? i : i - this.offset.click.top >= n[1] ? i - o.grid[1] : i + o.grid[1] : i, s = o.grid[0] ? this.originalPageX + Math.round((f - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX, f = n ? s - this.offset.click.left >= n[0] || s - this.offset.click.left > n[2] ? s : s - this.offset.click.left >= n[0] ? s - o.grid[0] : s + o.grid[0] : s)), {
        top: l - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : a ? 0 : u.scrollTop()),
        left: f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : a ? 0 : u.scrollLeft())
      };
    },
    _clear: function _clear() {
      this.helper.removeClass("ui-draggable-dragging"), this.helper[0] !== this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1;
    },
    _trigger: function _trigger(t, n, r) {
      return r = r || this._uiHash(), e.ui.plugin.call(this, t, [n, r]), t === "drag" && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, n, r);
    },
    plugins: {},
    _uiHash: function _uiHash() {
      return {
        helper: this.helper,
        position: this.position,
        originalPosition: this.originalPosition,
        offset: this.positionAbs
      };
    }
  }), e.ui.plugin.add("draggable", "connectToSortable", {
    start: function start(t, n) {
      var r = e(this).data("ui-draggable"),
          i = r.options,
          s = e.extend({}, n, {
        item: r.element
      });
      r.sortables = [], e(i.connectToSortable).each(function () {
        var n = e.data(this, "ui-sortable");
        n && !n.options.disabled && (r.sortables.push({
          instance: n,
          shouldRevert: n.options.revert
        }), n.refreshPositions(), n._trigger("activate", t, s));
      });
    },
    stop: function stop(t, n) {
      var r = e(this).data("ui-draggable"),
          i = e.extend({}, n, {
        item: r.element
      });
      e.each(r.sortables, function () {
        this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, r.options.helper === "original" && this.instance.currentItem.css({
          top: "auto",
          left: "auto"
        })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, i));
      });
    },
    drag: function drag(t, n) {
      var r = e(this).data("ui-draggable"),
          i = this;
      e.each(r.sortables, function () {
        var s = !1,
            o = this;
        this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (s = !0, e.each(r.sortables, function () {
          return this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this !== o && this.instance._intersectsWith(this.instance.containerCache) && e.ui.contains(o.instance.element[0], this.instance.element[0]) && (s = !1), s;
        })), s ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function () {
          return n.helper[0];
        }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", t), r.dropped = !1);
      });
    }
  }), e.ui.plugin.add("draggable", "cursor", {
    start: function start() {
      var t = e("body"),
          n = e(this).data("ui-draggable").options;
      t.css("cursor") && (n._cursor = t.css("cursor")), t.css("cursor", n.cursor);
    },
    stop: function stop() {
      var t = e(this).data("ui-draggable").options;
      t._cursor && e("body").css("cursor", t._cursor);
    }
  }), e.ui.plugin.add("draggable", "opacity", {
    start: function start(t, n) {
      var r = e(n.helper),
          i = e(this).data("ui-draggable").options;
      r.css("opacity") && (i._opacity = r.css("opacity")), r.css("opacity", i.opacity);
    },
    stop: function stop(t, n) {
      var r = e(this).data("ui-draggable").options;
      r._opacity && e(n.helper).css("opacity", r._opacity);
    }
  }), e.ui.plugin.add("draggable", "scroll", {
    start: function start() {
      var t = e(this).data("ui-draggable");
      t.scrollParent[0] !== document && t.scrollParent[0].tagName !== "HTML" && (t.overflowOffset = t.scrollParent.offset());
    },
    drag: function drag(t) {
      var n = e(this).data("ui-draggable"),
          r = n.options,
          i = !1;

      if (n.scrollParent[0] !== document && n.scrollParent[0].tagName !== "HTML") {
        if (!r.axis || r.axis !== "x") n.overflowOffset.top + n.scrollParent[0].offsetHeight - t.pageY < r.scrollSensitivity ? n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop + r.scrollSpeed : t.pageY - n.overflowOffset.top < r.scrollSensitivity && (n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop - r.scrollSpeed);
        if (!r.axis || r.axis !== "y") n.overflowOffset.left + n.scrollParent[0].offsetWidth - t.pageX < r.scrollSensitivity ? n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft + r.scrollSpeed : t.pageX - n.overflowOffset.left < r.scrollSensitivity && (n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft - r.scrollSpeed);
      } else {
        if (!r.axis || r.axis !== "x") t.pageY - e(document).scrollTop() < r.scrollSensitivity ? i = e(document).scrollTop(e(document).scrollTop() - r.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < r.scrollSensitivity && (i = e(document).scrollTop(e(document).scrollTop() + r.scrollSpeed));
        if (!r.axis || r.axis !== "y") t.pageX - e(document).scrollLeft() < r.scrollSensitivity ? i = e(document).scrollLeft(e(document).scrollLeft() - r.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < r.scrollSensitivity && (i = e(document).scrollLeft(e(document).scrollLeft() + r.scrollSpeed));
      }

      i !== !1 && e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(n, t);
    }
  }), e.ui.plugin.add("draggable", "snap", {
    start: function start() {
      var t = e(this).data("ui-draggable"),
          n = t.options;
      t.snapElements = [], e(n.snap.constructor !== String ? n.snap.items || ":data(ui-draggable)" : n.snap).each(function () {
        var n = e(this),
            r = n.offset();
        this !== t.element[0] && t.snapElements.push({
          item: this,
          width: n.outerWidth(),
          height: n.outerHeight(),
          top: r.top,
          left: r.left
        });
      });
    },
    drag: function drag(t, n) {
      var r,
          i,
          s,
          o,
          u,
          a,
          f,
          l,
          c,
          h,
          p = e(this).data("ui-draggable"),
          d = p.options,
          v = d.snapTolerance,
          m = n.offset.left,
          g = m + p.helperProportions.width,
          y = n.offset.top,
          b = y + p.helperProportions.height;

      for (c = p.snapElements.length - 1; c >= 0; c--) {
        u = p.snapElements[c].left, a = u + p.snapElements[c].width, f = p.snapElements[c].top, l = f + p.snapElements[c].height;

        if (!(u - v < m && m < a + v && f - v < y && y < l + v || u - v < m && m < a + v && f - v < b && b < l + v || u - v < g && g < a + v && f - v < y && y < l + v || u - v < g && g < a + v && f - v < b && b < l + v)) {
          p.snapElements[c].snapping && p.options.snap.release && p.options.snap.release.call(p.element, t, e.extend(p._uiHash(), {
            snapItem: p.snapElements[c].item
          })), p.snapElements[c].snapping = !1;
          continue;
        }

        d.snapMode !== "inner" && (r = Math.abs(f - b) <= v, i = Math.abs(l - y) <= v, s = Math.abs(u - g) <= v, o = Math.abs(a - m) <= v, r && (n.position.top = p._convertPositionTo("relative", {
          top: f - p.helperProportions.height,
          left: 0
        }).top - p.margins.top), i && (n.position.top = p._convertPositionTo("relative", {
          top: l,
          left: 0
        }).top - p.margins.top), s && (n.position.left = p._convertPositionTo("relative", {
          top: 0,
          left: u - p.helperProportions.width
        }).left - p.margins.left), o && (n.position.left = p._convertPositionTo("relative", {
          top: 0,
          left: a
        }).left - p.margins.left)), h = r || i || s || o, d.snapMode !== "outer" && (r = Math.abs(f - y) <= v, i = Math.abs(l - b) <= v, s = Math.abs(u - m) <= v, o = Math.abs(a - g) <= v, r && (n.position.top = p._convertPositionTo("relative", {
          top: f,
          left: 0
        }).top - p.margins.top), i && (n.position.top = p._convertPositionTo("relative", {
          top: l - p.helperProportions.height,
          left: 0
        }).top - p.margins.top), s && (n.position.left = p._convertPositionTo("relative", {
          top: 0,
          left: u
        }).left - p.margins.left), o && (n.position.left = p._convertPositionTo("relative", {
          top: 0,
          left: a - p.helperProportions.width
        }).left - p.margins.left)), !p.snapElements[c].snapping && (r || i || s || o || h) && p.options.snap.snap && p.options.snap.snap.call(p.element, t, e.extend(p._uiHash(), {
          snapItem: p.snapElements[c].item
        })), p.snapElements[c].snapping = r || i || s || o || h;
      }
    }
  }), e.ui.plugin.add("draggable", "stack", {
    start: function start() {
      var t,
          n = e(this).data("ui-draggable").options,
          r = e.makeArray(e(n.stack)).sort(function (t, n) {
        return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(n).css("zIndex"), 10) || 0);
      });
      if (!r.length) return;
      t = parseInt(r[0].style.zIndex, 10) || 0, e(r).each(function (e) {
        this.style.zIndex = t + e;
      }), this[0].style.zIndex = t + r.length;
    }
  }), e.ui.plugin.add("draggable", "zIndex", {
    start: function start(t, n) {
      var r = e(n.helper),
          i = e(this).data("ui-draggable").options;
      r.css("zIndex") && (i._zIndex = r.css("zIndex")), r.css("zIndex", i.zIndex);
    },
    stop: function stop(t, n) {
      var r = e(this).data("ui-draggable").options;
      r._zIndex && e(n.helper).css("zIndex", r._zIndex);
    }
  });
})(jQuery);

(function (e, t) {
  function n(e, t, n) {
    return e > t && e < t + n;
  }

  e.widget("ui.droppable", {
    version: "1.10.0",
    widgetEventPrefix: "drop",
    options: {
      accept: "*",
      activeClass: !1,
      addClasses: !0,
      greedy: !1,
      hoverClass: !1,
      scope: "default",
      tolerance: "intersect",
      activate: null,
      deactivate: null,
      drop: null,
      out: null,
      over: null
    },
    _create: function _create() {
      var t = this.options,
          n = t.accept;
      this.isover = !1, this.isout = !0, this.accept = e.isFunction(n) ? n : function (e) {
        return e.is(n);
      }, this.proportions = {
        width: this.element[0].offsetWidth,
        height: this.element[0].offsetHeight
      }, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable");
    },
    _destroy: function _destroy() {
      var t = 0,
          n = e.ui.ddmanager.droppables[this.options.scope];

      for (; t < n.length; t++) {
        n[t] === this && n.splice(t, 1);
      }

      this.element.removeClass("ui-droppable ui-droppable-disabled");
    },
    _setOption: function _setOption(t, n) {
      t === "accept" && (this.accept = e.isFunction(n) ? n : function (e) {
        return e.is(n);
      }), e.Widget.prototype._setOption.apply(this, arguments);
    },
    _activate: function _activate(t) {
      var n = e.ui.ddmanager.current;
      this.options.activeClass && this.element.addClass(this.options.activeClass), n && this._trigger("activate", t, this.ui(n));
    },
    _deactivate: function _deactivate(t) {
      var n = e.ui.ddmanager.current;
      this.options.activeClass && this.element.removeClass(this.options.activeClass), n && this._trigger("deactivate", t, this.ui(n));
    },
    _over: function _over(t) {
      var n = e.ui.ddmanager.current;
      if (!n || (n.currentItem || n.element)[0] === this.element[0]) return;
      this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(n)));
    },
    _out: function _out(t) {
      var n = e.ui.ddmanager.current;
      if (!n || (n.currentItem || n.element)[0] === this.element[0]) return;
      this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(n)));
    },
    _drop: function _drop(t, n) {
      var r = n || e.ui.ddmanager.current,
          i = !1;
      return !r || (r.currentItem || r.element)[0] === this.element[0] ? !1 : (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function () {
        var t = e.data(this, "ui-droppable");
        if (t.options.greedy && !t.options.disabled && t.options.scope === r.options.scope && t.accept.call(t.element[0], r.currentItem || r.element) && e.ui.intersect(r, e.extend(t, {
          offset: t.element.offset()
        }), t.options.tolerance)) return i = !0, !1;
      }), i ? !1 : this.accept.call(this.element[0], r.currentItem || r.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(r)), this.element) : !1);
    },
    ui: function ui(e) {
      return {
        draggable: e.currentItem || e.element,
        helper: e.helper,
        position: e.position,
        offset: e.positionAbs
      };
    }
  }), e.ui.intersect = function (e, t, r) {
    if (!t.offset) return !1;
    var i,
        s,
        o = (e.positionAbs || e.position.absolute).left,
        u = o + e.helperProportions.width,
        a = (e.positionAbs || e.position.absolute).top,
        f = a + e.helperProportions.height,
        l = t.offset.left,
        c = l + t.proportions.width,
        h = t.offset.top,
        p = h + t.proportions.height;

    switch (r) {
      case "fit":
        return l <= o && u <= c && h <= a && f <= p;

      case "intersect":
        return l < o + e.helperProportions.width / 2 && u - e.helperProportions.width / 2 < c && h < a + e.helperProportions.height / 2 && f - e.helperProportions.height / 2 < p;

      case "pointer":
        return i = (e.positionAbs || e.position.absolute).left + (e.clickOffset || e.offset.click).left, s = (e.positionAbs || e.position.absolute).top + (e.clickOffset || e.offset.click).top, n(s, h, t.proportions.height) && n(i, l, t.proportions.width);

      case "touch":
        return (a >= h && a <= p || f >= h && f <= p || a < h && f > p) && (o >= l && o <= c || u >= l && u <= c || o < l && u > c);

      default:
        return !1;
    }
  }, e.ui.ddmanager = {
    current: null,
    droppables: {
      "default": []
    },
    prepareOffsets: function prepareOffsets(t, n) {
      var r,
          i,
          s = e.ui.ddmanager.droppables[t.options.scope] || [],
          o = n ? n.type : null,
          u = (t.currentItem || t.element).find(":data(ui-droppable)").addBack();

      e: for (r = 0; r < s.length; r++) {
        if (s[r].options.disabled || t && !s[r].accept.call(s[r].element[0], t.currentItem || t.element)) continue;

        for (i = 0; i < u.length; i++) {
          if (u[i] === s[r].element[0]) {
            s[r].proportions.height = 0;
            continue e;
          }
        }

        s[r].visible = s[r].element.css("display") !== "none";
        if (!s[r].visible) continue;
        o === "mousedown" && s[r]._activate.call(s[r], n), s[r].offset = s[r].element.offset(), s[r].proportions = {
          width: s[r].element[0].offsetWidth,
          height: s[r].element[0].offsetHeight
        };
      }
    },
    drop: function drop(t, n) {
      var r = !1;
      return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function () {
        if (!this.options) return;
        !this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (r = this._drop.call(this, n) || r), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, n));
      }), r;
    },
    dragStart: function dragStart(t, n) {
      t.element.parentsUntil("body").bind("scroll.droppable", function () {
        t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n);
      });
    },
    drag: function drag(t, n) {
      t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, n), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function () {
        if (this.options.disabled || this.greedyChild || !this.visible) return;
        var r,
            i,
            s,
            o = e.ui.intersect(t, this, this.options.tolerance),
            u = !o && this.isover ? "isout" : o && !this.isover ? "isover" : null;
        if (!u) return;
        this.options.greedy && (i = this.options.scope, s = this.element.parents(":data(ui-droppable)").filter(function () {
          return e.data(this, "ui-droppable").options.scope === i;
        }), s.length && (r = e.data(s[0], "ui-droppable"), r.greedyChild = u === "isover")), r && u === "isover" && (r.isover = !1, r.isout = !0, r._out.call(r, n)), this[u] = !0, this[u === "isout" ? "isover" : "isout"] = !1, this[u === "isover" ? "_over" : "_out"].call(this, n), r && u === "isout" && (r.isout = !1, r.isover = !0, r._over.call(r, n));
      });
    },
    dragStop: function dragStop(t, n) {
      t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n);
    }
  };
})(jQuery);

(function (e, t) {
  function n(e) {
    return parseInt(e, 10) || 0;
  }

  function r(e) {
    return !isNaN(parseInt(e, 10));
  }

  e.widget("ui.resizable", e.ui.mouse, {
    version: "1.10.0",
    widgetEventPrefix: "resize",
    options: {
      alsoResize: !1,
      animate: !1,
      animateDuration: "slow",
      animateEasing: "swing",
      aspectRatio: !1,
      autoHide: !1,
      containment: !1,
      ghost: !1,
      grid: !1,
      handles: "e,s,se",
      helper: !1,
      maxHeight: null,
      maxWidth: null,
      minHeight: 10,
      minWidth: 10,
      zIndex: 90,
      resize: null,
      start: null,
      stop: null
    },
    _create: function _create() {
      var t,
          n,
          r,
          i,
          s,
          o = this,
          u = this.options;
      this.element.addClass("ui-resizable"), e.extend(this, {
        _aspectRatio: !!u.aspectRatio,
        aspectRatio: u.aspectRatio,
        originalElement: this.element,
        _proportionallyResizeElements: [],
        _helper: u.helper || u.ghost || u.animate ? u.helper || "ui-resizable-helper" : null
      }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
        position: this.element.css("position"),
        width: this.element.outerWidth(),
        height: this.element.outerHeight(),
        top: this.element.css("top"),
        left: this.element.css("left")
      })), this.element = this.element.parent().data("ui-resizable", this.element.data("ui-resizable")), this.elementIsWrapper = !0, this.element.css({
        marginLeft: this.originalElement.css("marginLeft"),
        marginTop: this.originalElement.css("marginTop"),
        marginRight: this.originalElement.css("marginRight"),
        marginBottom: this.originalElement.css("marginBottom")
      }), this.originalElement.css({
        marginLeft: 0,
        marginTop: 0,
        marginRight: 0,
        marginBottom: 0
      }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
        position: "static",
        zoom: 1,
        display: "block"
      })), this.originalElement.css({
        margin: this.originalElement.css("margin")
      }), this._proportionallyResize()), this.handles = u.handles || (e(".ui-resizable-handle", this.element).length ? {
        n: ".ui-resizable-n",
        e: ".ui-resizable-e",
        s: ".ui-resizable-s",
        w: ".ui-resizable-w",
        se: ".ui-resizable-se",
        sw: ".ui-resizable-sw",
        ne: ".ui-resizable-ne",
        nw: ".ui-resizable-nw"
      } : "e,s,se");

      if (this.handles.constructor === String) {
        this.handles === "all" && (this.handles = "n,e,s,w,se,sw,ne,nw"), t = this.handles.split(","), this.handles = {};

        for (n = 0; n < t.length; n++) {
          r = e.trim(t[n]), s = "ui-resizable-" + r, i = e("<div class='ui-resizable-handle " + s + "'></div>"), i.css({
            zIndex: u.zIndex
          }), "se" === r && i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[r] = ".ui-resizable-" + r, this.element.append(i);
        }
      }

      this._renderAxis = function (t) {
        var n, r, i, s;
        t = t || this.element;

        for (n in this.handles) {
          this.handles[n].constructor === String && (this.handles[n] = e(this.handles[n], this.element).show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i) && (r = e(this.handles[n], this.element), s = /sw|ne|nw|se|n|s/.test(n) ? r.outerHeight() : r.outerWidth(), i = ["padding", /ne|nw|n/.test(n) ? "Top" : /se|sw|s/.test(n) ? "Bottom" : /^e$/.test(n) ? "Right" : "Left"].join(""), t.css(i, s), this._proportionallyResize());
          if (!e(this.handles[n]).length) continue;
        }
      }, this._renderAxis(this.element), this._handles = e(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function () {
        o.resizing || (this.className && (i = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), o.axis = i && i[1] ? i[1] : "se");
      }), u.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter(function () {
        if (u.disabled) return;
        e(this).removeClass("ui-resizable-autohide"), o._handles.show();
      }).mouseleave(function () {
        if (u.disabled) return;
        o.resizing || (e(this).addClass("ui-resizable-autohide"), o._handles.hide());
      })), this._mouseInit();
    },
    _destroy: function _destroy() {
      this._mouseDestroy();

      var t,
          n = function n(t) {
        e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove();
      };

      return this.elementIsWrapper && (n(this.element), t = this.element, this.originalElement.css({
        position: t.css("position"),
        width: t.outerWidth(),
        height: t.outerHeight(),
        top: t.css("top"),
        left: t.css("left")
      }).insertAfter(t), t.remove()), this.originalElement.css("resize", this.originalResizeStyle), n(this.originalElement), this;
    },
    _mouseCapture: function _mouseCapture(t) {
      var n,
          r,
          i = !1;

      for (n in this.handles) {
        r = e(this.handles[n])[0];
        if (r === t.target || e.contains(r, t.target)) i = !0;
      }

      return !this.options.disabled && i;
    },
    _mouseStart: function _mouseStart(t) {
      var r,
          i,
          s,
          o = this.options,
          u = this.element.position(),
          a = this.element;
      return this.resizing = !0, /absolute/.test(a.css("position")) ? a.css({
        position: "absolute",
        top: a.css("top"),
        left: a.css("left")
      }) : a.is(".ui-draggable") && a.css({
        position: "absolute",
        top: u.top,
        left: u.left
      }), this._renderProxy(), r = n(this.helper.css("left")), i = n(this.helper.css("top")), o.containment && (r += e(o.containment).scrollLeft() || 0, i += e(o.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
        left: r,
        top: i
      }, this.size = this._helper ? {
        width: a.outerWidth(),
        height: a.outerHeight()
      } : {
        width: a.width(),
        height: a.height()
      }, this.originalSize = this._helper ? {
        width: a.outerWidth(),
        height: a.outerHeight()
      } : {
        width: a.width(),
        height: a.height()
      }, this.originalPosition = {
        left: r,
        top: i
      }, this.sizeDiff = {
        width: a.outerWidth() - a.width(),
        height: a.outerHeight() - a.height()
      }, this.originalMousePosition = {
        left: t.pageX,
        top: t.pageY
      }, this.aspectRatio = typeof o.aspectRatio == "number" ? o.aspectRatio : this.originalSize.width / this.originalSize.height || 1, s = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", s === "auto" ? this.axis + "-resize" : s), a.addClass("ui-resizable-resizing"), this._propagate("start", t), !0;
    },
    _mouseDrag: function _mouseDrag(t) {
      var n,
          r = this.helper,
          i = {},
          s = this.originalMousePosition,
          o = this.axis,
          u = this.position.top,
          a = this.position.left,
          f = this.size.width,
          l = this.size.height,
          c = t.pageX - s.left || 0,
          h = t.pageY - s.top || 0,
          p = this._change[o];
      if (!p) return !1;
      n = p.apply(this, [t, c, h]), this._updateVirtualBoundaries(t.shiftKey);
      if (this._aspectRatio || t.shiftKey) n = this._updateRatio(n, t);
      return n = this._respectSize(n, t), this._updateCache(n), this._propagate("resize", t), this.position.top !== u && (i.top = this.position.top + "px"), this.position.left !== a && (i.left = this.position.left + "px"), this.size.width !== f && (i.width = this.size.width + "px"), this.size.height !== l && (i.height = this.size.height + "px"), r.css(i), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), e.isEmptyObject(i) || this._trigger("resize", t, this.ui()), !1;
    },
    _mouseStop: function _mouseStop(t) {
      this.resizing = !1;
      var n,
          r,
          i,
          s,
          o,
          u,
          a,
          f = this.options,
          l = this;
      return this._helper && (n = this._proportionallyResizeElements, r = n.length && /textarea/i.test(n[0].nodeName), i = r && e.ui.hasScroll(n[0], "left") ? 0 : l.sizeDiff.height, s = r ? 0 : l.sizeDiff.width, o = {
        width: l.helper.width() - s,
        height: l.helper.height() - i
      }, u = parseInt(l.element.css("left"), 10) + (l.position.left - l.originalPosition.left) || null, a = parseInt(l.element.css("top"), 10) + (l.position.top - l.originalPosition.top) || null, f.animate || this.element.css(e.extend(o, {
        top: a,
        left: u
      })), l.helper.height(l.size.height), l.helper.width(l.size.width), this._helper && !f.animate && this._proportionallyResize()), e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1;
    },
    _updateVirtualBoundaries: function _updateVirtualBoundaries(e) {
      var t,
          n,
          i,
          s,
          o,
          u = this.options;
      o = {
        minWidth: r(u.minWidth) ? u.minWidth : 0,
        maxWidth: r(u.maxWidth) ? u.maxWidth : Infinity,
        minHeight: r(u.minHeight) ? u.minHeight : 0,
        maxHeight: r(u.maxHeight) ? u.maxHeight : Infinity
      };
      if (this._aspectRatio || e) t = o.minHeight * this.aspectRatio, i = o.minWidth / this.aspectRatio, n = o.maxHeight * this.aspectRatio, s = o.maxWidth / this.aspectRatio, t > o.minWidth && (o.minWidth = t), i > o.minHeight && (o.minHeight = i), n < o.maxWidth && (o.maxWidth = n), s < o.maxHeight && (o.maxHeight = s);
      this._vBoundaries = o;
    },
    _updateCache: function _updateCache(e) {
      this.offset = this.helper.offset(), r(e.left) && (this.position.left = e.left), r(e.top) && (this.position.top = e.top), r(e.height) && (this.size.height = e.height), r(e.width) && (this.size.width = e.width);
    },
    _updateRatio: function _updateRatio(e) {
      var t = this.position,
          n = this.size,
          i = this.axis;
      return r(e.height) ? e.width = e.height * this.aspectRatio : r(e.width) && (e.height = e.width / this.aspectRatio), i === "sw" && (e.left = t.left + (n.width - e.width), e.top = null), i === "nw" && (e.top = t.top + (n.height - e.height), e.left = t.left + (n.width - e.width)), e;
    },
    _respectSize: function _respectSize(e) {
      var t = this._vBoundaries,
          n = this.axis,
          i = r(e.width) && t.maxWidth && t.maxWidth < e.width,
          s = r(e.height) && t.maxHeight && t.maxHeight < e.height,
          o = r(e.width) && t.minWidth && t.minWidth > e.width,
          u = r(e.height) && t.minHeight && t.minHeight > e.height,
          a = this.originalPosition.left + this.originalSize.width,
          f = this.position.top + this.size.height,
          l = /sw|nw|w/.test(n),
          c = /nw|ne|n/.test(n);
      return o && (e.width = t.minWidth), u && (e.height = t.minHeight), i && (e.width = t.maxWidth), s && (e.height = t.maxHeight), o && l && (e.left = a - t.minWidth), i && l && (e.left = a - t.maxWidth), u && c && (e.top = f - t.minHeight), s && c && (e.top = f - t.maxHeight), !e.width && !e.height && !e.left && e.top ? e.top = null : !e.width && !e.height && !e.top && e.left && (e.left = null), e;
    },
    _proportionallyResize: function _proportionallyResize() {
      if (!this._proportionallyResizeElements.length) return;
      var e,
          t,
          n,
          r,
          i,
          s = this.helper || this.element;

      for (e = 0; e < this._proportionallyResizeElements.length; e++) {
        i = this._proportionallyResizeElements[e];

        if (!this.borderDif) {
          this.borderDif = [], n = [i.css("borderTopWidth"), i.css("borderRightWidth"), i.css("borderBottomWidth"), i.css("borderLeftWidth")], r = [i.css("paddingTop"), i.css("paddingRight"), i.css("paddingBottom"), i.css("paddingLeft")];

          for (t = 0; t < n.length; t++) {
            this.borderDif[t] = (parseInt(n[t], 10) || 0) + (parseInt(r[t], 10) || 0);
          }
        }

        i.css({
          height: s.height() - this.borderDif[0] - this.borderDif[2] || 0,
          width: s.width() - this.borderDif[1] - this.borderDif[3] || 0
        });
      }
    },
    _renderProxy: function _renderProxy() {
      var t = this.element,
          n = this.options;
      this.elementOffset = t.offset(), this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
        width: this.element.outerWidth() - 1,
        height: this.element.outerHeight() - 1,
        position: "absolute",
        left: this.elementOffset.left + "px",
        top: this.elementOffset.top + "px",
        zIndex: ++n.zIndex
      }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element;
    },
    _change: {
      e: function e(_e, t) {
        return {
          width: this.originalSize.width + t
        };
      },
      w: function w(e, t) {
        var n = this.originalSize,
            r = this.originalPosition;
        return {
          left: r.left + t,
          width: n.width - t
        };
      },
      n: function n(e, t, _n) {
        var r = this.originalSize,
            i = this.originalPosition;
        return {
          top: i.top + _n,
          height: r.height - _n
        };
      },
      s: function s(e, t, n) {
        return {
          height: this.originalSize.height + n
        };
      },
      se: function se(t, n, r) {
        return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, n, r]));
      },
      sw: function sw(t, n, r) {
        return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, n, r]));
      },
      ne: function ne(t, n, r) {
        return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, n, r]));
      },
      nw: function nw(t, n, r) {
        return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, n, r]));
      }
    },
    _propagate: function _propagate(t, n) {
      e.ui.plugin.call(this, t, [n, this.ui()]), t !== "resize" && this._trigger(t, n, this.ui());
    },
    plugins: {},
    ui: function ui() {
      return {
        originalElement: this.originalElement,
        element: this.element,
        helper: this.helper,
        position: this.position,
        size: this.size,
        originalSize: this.originalSize,
        originalPosition: this.originalPosition
      };
    }
  }), e.ui.plugin.add("resizable", "animate", {
    stop: function stop(t) {
      var n = e(this).data("ui-resizable"),
          r = n.options,
          i = n._proportionallyResizeElements,
          s = i.length && /textarea/i.test(i[0].nodeName),
          o = s && e.ui.hasScroll(i[0], "left") ? 0 : n.sizeDiff.height,
          u = s ? 0 : n.sizeDiff.width,
          a = {
        width: n.size.width - u,
        height: n.size.height - o
      },
          f = parseInt(n.element.css("left"), 10) + (n.position.left - n.originalPosition.left) || null,
          l = parseInt(n.element.css("top"), 10) + (n.position.top - n.originalPosition.top) || null;
      n.element.animate(e.extend(a, l && f ? {
        top: l,
        left: f
      } : {}), {
        duration: r.animateDuration,
        easing: r.animateEasing,
        step: function step() {
          var r = {
            width: parseInt(n.element.css("width"), 10),
            height: parseInt(n.element.css("height"), 10),
            top: parseInt(n.element.css("top"), 10),
            left: parseInt(n.element.css("left"), 10)
          };
          i && i.length && e(i[0]).css({
            width: r.width,
            height: r.height
          }), n._updateCache(r), n._propagate("resize", t);
        }
      });
    }
  }), e.ui.plugin.add("resizable", "containment", {
    start: function start() {
      var t,
          r,
          i,
          s,
          o,
          u,
          a,
          f = e(this).data("ui-resizable"),
          l = f.options,
          c = f.element,
          h = l.containment,
          p = h instanceof e ? h.get(0) : /parent/.test(h) ? c.parent().get(0) : h;
      if (!p) return;
      f.containerElement = e(p), /document/.test(h) || h === document ? (f.containerOffset = {
        left: 0,
        top: 0
      }, f.containerPosition = {
        left: 0,
        top: 0
      }, f.parentData = {
        element: e(document),
        left: 0,
        top: 0,
        width: e(document).width(),
        height: e(document).height() || document.body.parentNode.scrollHeight
      }) : (t = e(p), r = [], e(["Top", "Right", "Left", "Bottom"]).each(function (e, i) {
        r[e] = n(t.css("padding" + i));
      }), f.containerOffset = t.offset(), f.containerPosition = t.position(), f.containerSize = {
        height: t.innerHeight() - r[3],
        width: t.innerWidth() - r[1]
      }, i = f.containerOffset, s = f.containerSize.height, o = f.containerSize.width, u = e.ui.hasScroll(p, "left") ? p.scrollWidth : o, a = e.ui.hasScroll(p) ? p.scrollHeight : s, f.parentData = {
        element: p,
        left: i.left,
        top: i.top,
        width: u,
        height: a
      });
    },
    resize: function resize(t) {
      var n,
          r,
          i,
          s,
          o = e(this).data("ui-resizable"),
          u = o.options,
          a = o.containerOffset,
          f = o.position,
          l = o._aspectRatio || t.shiftKey,
          c = {
        top: 0,
        left: 0
      },
          h = o.containerElement;
      h[0] !== document && /static/.test(h.css("position")) && (c = a), f.left < (o._helper ? a.left : 0) && (o.size.width = o.size.width + (o._helper ? o.position.left - a.left : o.position.left - c.left), l && (o.size.height = o.size.width / o.aspectRatio), o.position.left = u.helper ? a.left : 0), f.top < (o._helper ? a.top : 0) && (o.size.height = o.size.height + (o._helper ? o.position.top - a.top : o.position.top), l && (o.size.width = o.size.height * o.aspectRatio), o.position.top = o._helper ? a.top : 0), o.offset.left = o.parentData.left + o.position.left, o.offset.top = o.parentData.top + o.position.top, n = Math.abs((o._helper ? o.offset.left - c.left : o.offset.left - c.left) + o.sizeDiff.width), r = Math.abs((o._helper ? o.offset.top - c.top : o.offset.top - a.top) + o.sizeDiff.height), i = o.containerElement.get(0) === o.element.parent().get(0), s = /relative|absolute/.test(o.containerElement.css("position")), i && s && (n -= o.parentData.left), n + o.size.width >= o.parentData.width && (o.size.width = o.parentData.width - n, l && (o.size.height = o.size.width / o.aspectRatio)), r + o.size.height >= o.parentData.height && (o.size.height = o.parentData.height - r, l && (o.size.width = o.size.height * o.aspectRatio));
    },
    stop: function stop() {
      var t = e(this).data("ui-resizable"),
          n = t.options,
          r = t.containerOffset,
          i = t.containerPosition,
          s = t.containerElement,
          o = e(t.helper),
          u = o.offset(),
          a = o.outerWidth() - t.sizeDiff.width,
          f = o.outerHeight() - t.sizeDiff.height;
      t._helper && !n.animate && /relative/.test(s.css("position")) && e(this).css({
        left: u.left - i.left - r.left,
        width: a,
        height: f
      }), t._helper && !n.animate && /static/.test(s.css("position")) && e(this).css({
        left: u.left - i.left - r.left,
        width: a,
        height: f
      });
    }
  }), e.ui.plugin.add("resizable", "alsoResize", {
    start: function start() {
      var t = e(this).data("ui-resizable"),
          n = t.options,
          r = function r(t) {
        e(t).each(function () {
          var t = e(this);
          t.data("ui-resizable-alsoresize", {
            width: parseInt(t.width(), 10),
            height: parseInt(t.height(), 10),
            left: parseInt(t.css("left"), 10),
            top: parseInt(t.css("top"), 10)
          });
        });
      };

      _typeof(n.alsoResize) == "object" && !n.alsoResize.parentNode ? n.alsoResize.length ? (n.alsoResize = n.alsoResize[0], r(n.alsoResize)) : e.each(n.alsoResize, function (e) {
        r(e);
      }) : r(n.alsoResize);
    },
    resize: function resize(t, n) {
      var r = e(this).data("ui-resizable"),
          i = r.options,
          s = r.originalSize,
          o = r.originalPosition,
          u = {
        height: r.size.height - s.height || 0,
        width: r.size.width - s.width || 0,
        top: r.position.top - o.top || 0,
        left: r.position.left - o.left || 0
      },
          a = function a(t, r) {
        e(t).each(function () {
          var t = e(this),
              i = e(this).data("ui-resizable-alsoresize"),
              s = {},
              o = r && r.length ? r : t.parents(n.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
          e.each(o, function (e, t) {
            var n = (i[t] || 0) + (u[t] || 0);
            n && n >= 0 && (s[t] = n || null);
          }), t.css(s);
        });
      };

      _typeof(i.alsoResize) == "object" && !i.alsoResize.nodeType ? e.each(i.alsoResize, function (e, t) {
        a(e, t);
      }) : a(i.alsoResize);
    },
    stop: function stop() {
      e(this).removeData("resizable-alsoresize");
    }
  }), e.ui.plugin.add("resizable", "ghost", {
    start: function start() {
      var t = e(this).data("ui-resizable"),
          n = t.options,
          r = t.size;
      t.ghost = t.originalElement.clone(), t.ghost.css({
        opacity: .25,
        display: "block",
        position: "relative",
        height: r.height,
        width: r.width,
        margin: 0,
        left: 0,
        top: 0
      }).addClass("ui-resizable-ghost").addClass(typeof n.ghost == "string" ? n.ghost : ""), t.ghost.appendTo(t.helper);
    },
    resize: function resize() {
      var t = e(this).data("ui-resizable");
      t.ghost && t.ghost.css({
        position: "relative",
        height: t.size.height,
        width: t.size.width
      });
    },
    stop: function stop() {
      var t = e(this).data("ui-resizable");
      t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0));
    }
  }), e.ui.plugin.add("resizable", "grid", {
    resize: function resize() {
      var t = e(this).data("ui-resizable"),
          n = t.options,
          r = t.size,
          i = t.originalSize,
          s = t.originalPosition,
          o = t.axis,
          u = typeof n.grid == "number" ? [n.grid, n.grid] : n.grid,
          a = u[0] || 1,
          f = u[1] || 1,
          l = Math.round((r.width - i.width) / a) * a,
          c = Math.round((r.height - i.height) / f) * f,
          h = i.width + l,
          p = i.height + c,
          d = n.maxWidth && n.maxWidth < h,
          v = n.maxHeight && n.maxHeight < p,
          m = n.minWidth && n.minWidth > h,
          g = n.minHeight && n.minHeight > p;
      n.grid = u, m && (h += a), g && (p += f), d && (h -= a), v && (p -= f), /^(se|s|e)$/.test(o) ? (t.size.width = h, t.size.height = p) : /^(ne)$/.test(o) ? (t.size.width = h, t.size.height = p, t.position.top = s.top - c) : /^(sw)$/.test(o) ? (t.size.width = h, t.size.height = p, t.position.left = s.left - l) : (t.size.width = h, t.size.height = p, t.position.top = s.top - c, t.position.left = s.left - l);
    }
  });
})(jQuery);

(function (e, t) {
  e.widget("ui.selectable", e.ui.mouse, {
    version: "1.10.0",
    options: {
      appendTo: "body",
      autoRefresh: !0,
      distance: 0,
      filter: "*",
      tolerance: "touch",
      selected: null,
      selecting: null,
      start: null,
      stop: null,
      unselected: null,
      unselecting: null
    },
    _create: function _create() {
      var t,
          n = this;
      this.element.addClass("ui-selectable"), this.dragged = !1, this.refresh = function () {
        t = e(n.options.filter, n.element[0]), t.addClass("ui-selectee"), t.each(function () {
          var t = e(this),
              n = t.offset();
          e.data(this, "selectable-item", {
            element: this,
            $element: t,
            left: n.left,
            top: n.top,
            right: n.left + t.outerWidth(),
            bottom: n.top + t.outerHeight(),
            startselected: !1,
            selected: t.hasClass("ui-selected"),
            selecting: t.hasClass("ui-selecting"),
            unselecting: t.hasClass("ui-unselecting")
          });
        });
      }, this.refresh(), this.selectees = t.addClass("ui-selectee"), this._mouseInit(), this.helper = e("<div class='ui-selectable-helper'></div>");
    },
    _destroy: function _destroy() {
      this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy();
    },
    _mouseStart: function _mouseStart(t) {
      var n = this,
          r = this.options;
      this.opos = [t.pageX, t.pageY];
      if (this.options.disabled) return;
      this.selectees = e(r.filter, this.element[0]), this._trigger("start", t), e(r.appendTo).append(this.helper), this.helper.css({
        left: t.pageX,
        top: t.pageY,
        width: 0,
        height: 0
      }), r.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function () {
        var r = e.data(this, "selectable-item");
        r.startselected = !0, !t.metaKey && !t.ctrlKey && (r.$element.removeClass("ui-selected"), r.selected = !1, r.$element.addClass("ui-unselecting"), r.unselecting = !0, n._trigger("unselecting", t, {
          unselecting: r.element
        }));
      }), e(t.target).parents().addBack().each(function () {
        var r,
            i = e.data(this, "selectable-item");
        if (i) return r = !t.metaKey && !t.ctrlKey || !i.$element.hasClass("ui-selected"), i.$element.removeClass(r ? "ui-unselecting" : "ui-selected").addClass(r ? "ui-selecting" : "ui-unselecting"), i.unselecting = !r, i.selecting = r, i.selected = r, r ? n._trigger("selecting", t, {
          selecting: i.element
        }) : n._trigger("unselecting", t, {
          unselecting: i.element
        }), !1;
      });
    },
    _mouseDrag: function _mouseDrag(t) {
      this.dragged = !0;
      if (this.options.disabled) return;
      var n,
          r = this,
          i = this.options,
          s = this.opos[0],
          o = this.opos[1],
          u = t.pageX,
          a = t.pageY;
      return s > u && (n = u, u = s, s = n), o > a && (n = a, a = o, o = n), this.helper.css({
        left: s,
        top: o,
        width: u - s,
        height: a - o
      }), this.selectees.each(function () {
        var n = e.data(this, "selectable-item"),
            f = !1;
        if (!n || n.element === r.element[0]) return;
        i.tolerance === "touch" ? f = !(n.left > u || n.right < s || n.top > a || n.bottom < o) : i.tolerance === "fit" && (f = n.left > s && n.right < u && n.top > o && n.bottom < a), f ? (n.selected && (n.$element.removeClass("ui-selected"), n.selected = !1), n.unselecting && (n.$element.removeClass("ui-unselecting"), n.unselecting = !1), n.selecting || (n.$element.addClass("ui-selecting"), n.selecting = !0, r._trigger("selecting", t, {
          selecting: n.element
        }))) : (n.selecting && ((t.metaKey || t.ctrlKey) && n.startselected ? (n.$element.removeClass("ui-selecting"), n.selecting = !1, n.$element.addClass("ui-selected"), n.selected = !0) : (n.$element.removeClass("ui-selecting"), n.selecting = !1, n.startselected && (n.$element.addClass("ui-unselecting"), n.unselecting = !0), r._trigger("unselecting", t, {
          unselecting: n.element
        }))), n.selected && !t.metaKey && !t.ctrlKey && !n.startselected && (n.$element.removeClass("ui-selected"), n.selected = !1, n.$element.addClass("ui-unselecting"), n.unselecting = !0, r._trigger("unselecting", t, {
          unselecting: n.element
        })));
      }), !1;
    },
    _mouseStop: function _mouseStop(t) {
      var n = this;
      return this.dragged = !1, e(".ui-unselecting", this.element[0]).each(function () {
        var r = e.data(this, "selectable-item");
        r.$element.removeClass("ui-unselecting"), r.unselecting = !1, r.startselected = !1, n._trigger("unselected", t, {
          unselected: r.element
        });
      }), e(".ui-selecting", this.element[0]).each(function () {
        var r = e.data(this, "selectable-item");
        r.$element.removeClass("ui-selecting").addClass("ui-selected"), r.selecting = !1, r.selected = !0, r.startselected = !0, n._trigger("selected", t, {
          selected: r.element
        });
      }), this._trigger("stop", t), this.helper.remove(), !1;
    }
  });
})(jQuery);

(function (e, t) {
  function n(e, t, n) {
    return e > t && e < t + n;
  }

  e.widget("ui.sortable", e.ui.mouse, {
    version: "1.10.0",
    widgetEventPrefix: "sort",
    ready: !1,
    options: {
      appendTo: "parent",
      axis: !1,
      connectWith: !1,
      containment: !1,
      cursor: "auto",
      cursorAt: !1,
      dropOnEmpty: !0,
      forcePlaceholderSize: !1,
      forceHelperSize: !1,
      grid: !1,
      handle: !1,
      helper: "original",
      items: "> *",
      opacity: !1,
      placeholder: !1,
      revert: !1,
      scroll: !0,
      scrollSensitivity: 20,
      scrollSpeed: 20,
      scope: "default",
      tolerance: "intersect",
      zIndex: 1e3,
      activate: null,
      beforeStop: null,
      change: null,
      deactivate: null,
      out: null,
      over: null,
      receive: null,
      remove: null,
      sort: null,
      start: null,
      stop: null,
      update: null
    },
    _create: function _create() {
      var e = this.options;
      this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0;
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();

      for (var e = this.items.length - 1; e >= 0; e--) {
        this.items[e].item.removeData(this.widgetName + "-item");
      }

      return this;
    },
    _setOption: function _setOption(t, n) {
      t === "disabled" ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments);
    },
    _mouseCapture: function _mouseCapture(t, n) {
      var r = null,
          i = !1,
          s = this;
      if (this.reverting) return !1;
      if (this.options.disabled || this.options.type === "static") return !1;
      this._refreshItems(t), e(t.target).parents().each(function () {
        if (e.data(this, s.widgetName + "-item") === s) return r = e(this), !1;
      }), e.data(t.target, s.widgetName + "-item") === s && (r = e(t.target));
      if (!r) return !1;

      if (this.options.handle && !n) {
        e(this.options.handle, r).find("*").addBack().each(function () {
          this === t.target && (i = !0);
        });
        if (!i) return !1;
      }

      return this.currentItem = r, this._removeCurrentsFromItems(), !0;
    },
    _mouseStart: function _mouseStart(t, n, r) {
      var i,
          s = this.options;
      this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
        top: this.offset.top - this.margins.top,
        left: this.offset.left - this.margins.left
      }, e.extend(this.offset, {
        click: {
          left: t.pageX - this.offset.left,
          top: t.pageY - this.offset.top
        },
        parent: this._getParentOffset(),
        relative: this._getRelativeOffset()
      }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, s.cursorAt && this._adjustOffsetFromHelper(s.cursorAt), this.domPosition = {
        prev: this.currentItem.prev()[0],
        parent: this.currentItem.parent()[0]
      }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), s.containment && this._setContainment(), s.cursor && (e("body").css("cursor") && (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", s.cursor)), s.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", s.opacity)), s.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", s.zIndex)), this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
      if (!r) for (i = this.containers.length - 1; i >= 0; i--) {
        this.containers[i]._trigger("activate", t, this._uiHash(this));
      }
      return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !s.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0;
    },
    _mouseDrag: function _mouseDrag(t) {
      var n,
          r,
          i,
          s,
          o = this.options,
          u = !1;
      this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < o.scrollSensitivity ? this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop + o.scrollSpeed : t.pageY - this.overflowOffset.top < o.scrollSensitivity && (this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop - o.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < o.scrollSensitivity ? this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft + o.scrollSpeed : t.pageX - this.overflowOffset.left < o.scrollSensitivity && (this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft - o.scrollSpeed)) : (t.pageY - e(document).scrollTop() < o.scrollSensitivity ? u = e(document).scrollTop(e(document).scrollTop() - o.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < o.scrollSensitivity && (u = e(document).scrollTop(e(document).scrollTop() + o.scrollSpeed)), t.pageX - e(document).scrollLeft() < o.scrollSensitivity ? u = e(document).scrollLeft(e(document).scrollLeft() - o.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < o.scrollSensitivity && (u = e(document).scrollLeft(e(document).scrollLeft() + o.scrollSpeed))), u !== !1 && e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute");
      if (!this.options.axis || this.options.axis !== "y") this.helper[0].style.left = this.position.left + "px";
      if (!this.options.axis || this.options.axis !== "x") this.helper[0].style.top = this.position.top + "px";

      for (n = this.items.length - 1; n >= 0; n--) {
        r = this.items[n], i = r.item[0], s = this._intersectsWithPointer(r);
        if (!s) continue;
        if (r.instance !== this.currentContainer) continue;

        if (i !== this.currentItem[0] && this.placeholder[s === 1 ? "next" : "prev"]()[0] !== i && !e.contains(this.placeholder[0], i) && (this.options.type === "semi-dynamic" ? !e.contains(this.element[0], i) : !0)) {
          this.direction = s === 1 ? "down" : "up";
          if (this.options.tolerance !== "pointer" && !this._intersectsWithSides(r)) break;
          this._rearrange(t, r), this._trigger("change", t, this._uiHash());
          break;
        }
      }

      return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1;
    },
    _mouseStop: function _mouseStop(t, n) {
      if (!t) return;
      e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t);

      if (this.options.revert) {
        var r = this,
            i = this.placeholder.offset();
        this.reverting = !0, e(this.helper).animate({
          left: i.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft),
          top: i.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)
        }, parseInt(this.options.revert, 10) || 500, function () {
          r._clear(t);
        });
      } else this._clear(t, n);

      return !1;
    },
    cancel: function cancel() {
      if (this.dragging) {
        this._mouseUp({
          target: null
        }), this.options.helper === "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();

        for (var t = this.containers.length - 1; t >= 0; t--) {
          this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0);
        }
      }

      return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper !== "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
        helper: null,
        dragging: !1,
        reverting: !1,
        _noFinalSort: null
      }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this;
    },
    serialize: function serialize(t) {
      var n = this._getItemsAsjQuery(t && t.connected),
          r = [];

      return t = t || {}, e(n).each(function () {
        var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
        n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]));
      }), !r.length && t.key && r.push(t.key + "="), r.join("&");
    },
    toArray: function toArray(t) {
      var n = this._getItemsAsjQuery(t && t.connected),
          r = [];

      return t = t || {}, n.each(function () {
        r.push(e(t.item || this).attr(t.attribute || "id") || "");
      }), r;
    },
    _intersectsWith: function _intersectsWith(e) {
      var t = this.positionAbs.left,
          n = t + this.helperProportions.width,
          r = this.positionAbs.top,
          i = r + this.helperProportions.height,
          s = e.left,
          o = s + e.width,
          u = e.top,
          a = u + e.height,
          f = this.offset.click.top,
          l = this.offset.click.left,
          c = r + f > u && r + f < a && t + l > s && t + l < o;
      return this.options.tolerance === "pointer" || this.options.forcePointerForContainers || this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? c : s < t + this.helperProportions.width / 2 && n - this.helperProportions.width / 2 < o && u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a;
    },
    _intersectsWithPointer: function _intersectsWithPointer(e) {
      var t = this.options.axis === "x" || n(this.positionAbs.top + this.offset.click.top, e.top, e.height),
          r = this.options.axis === "y" || n(this.positionAbs.left + this.offset.click.left, e.left, e.width),
          i = t && r,
          s = this._getDragVerticalDirection(),
          o = this._getDragHorizontalDirection();

      return i ? this.floating ? o && o === "right" || s === "down" ? 2 : 1 : s && (s === "down" ? 2 : 1) : !1;
    },
    _intersectsWithSides: function _intersectsWithSides(e) {
      var t = n(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height),
          r = n(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width),
          i = this._getDragVerticalDirection(),
          s = this._getDragHorizontalDirection();

      return this.floating && s ? s === "right" && r || s === "left" && !r : i && (i === "down" && t || i === "up" && !t);
    },
    _getDragVerticalDirection: function _getDragVerticalDirection() {
      var e = this.positionAbs.top - this.lastPositionAbs.top;
      return e !== 0 && (e > 0 ? "down" : "up");
    },
    _getDragHorizontalDirection: function _getDragHorizontalDirection() {
      var e = this.positionAbs.left - this.lastPositionAbs.left;
      return e !== 0 && (e > 0 ? "right" : "left");
    },
    refresh: function refresh(e) {
      return this._refreshItems(e), this.refreshPositions(), this;
    },
    _connectWith: function _connectWith() {
      var e = this.options;
      return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith;
    },
    _getItemsAsjQuery: function _getItemsAsjQuery(t) {
      var n,
          r,
          i,
          s,
          o = [],
          u = [],
          a = this._connectWith();

      if (a && t) for (n = a.length - 1; n >= 0; n--) {
        i = e(a[n]);

        for (r = i.length - 1; r >= 0; r--) {
          s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && u.push([e.isFunction(s.options.items) ? s.options.items.call(s.element) : e(s.options.items, s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), s]);
        }
      }
      u.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
        options: this.options,
        item: this.currentItem
      }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);

      for (n = u.length - 1; n >= 0; n--) {
        u[n][0].each(function () {
          o.push(this);
        });
      }

      return e(o);
    },
    _removeCurrentsFromItems: function _removeCurrentsFromItems() {
      var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
      this.items = e.grep(this.items, function (e) {
        for (var n = 0; n < t.length; n++) {
          if (t[n] === e.item[0]) return !1;
        }

        return !0;
      });
    },
    _refreshItems: function _refreshItems(t) {
      this.items = [], this.containers = [this];

      var n,
          r,
          i,
          s,
          o,
          u,
          a,
          f,
          l = this.items,
          c = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
        item: this.currentItem
      }) : e(this.options.items, this.element), this]],
          h = this._connectWith();

      if (h && this.ready) for (n = h.length - 1; n >= 0; n--) {
        i = e(h[n]);

        for (r = i.length - 1; r >= 0; r--) {
          s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && (c.push([e.isFunction(s.options.items) ? s.options.items.call(s.element[0], t, {
            item: this.currentItem
          }) : e(s.options.items, s.element), s]), this.containers.push(s));
        }
      }

      for (n = c.length - 1; n >= 0; n--) {
        o = c[n][1], u = c[n][0];

        for (r = 0, f = u.length; r < f; r++) {
          a = e(u[r]), a.data(this.widgetName + "-item", o), l.push({
            item: a,
            instance: o,
            width: 0,
            height: 0,
            left: 0,
            top: 0
          });
        }
      }
    },
    refreshPositions: function refreshPositions(t) {
      this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
      var n, r, i, s;

      for (n = this.items.length - 1; n >= 0; n--) {
        r = this.items[n];
        if (r.instance !== this.currentContainer && this.currentContainer && r.item[0] !== this.currentItem[0]) continue;
        i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item, t || (r.width = i.outerWidth(), r.height = i.outerHeight()), s = i.offset(), r.left = s.left, r.top = s.top;
      }

      if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this);else for (n = this.containers.length - 1; n >= 0; n--) {
        s = this.containers[n].element.offset(), this.containers[n].containerCache.left = s.left, this.containers[n].containerCache.top = s.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight();
      }
      return this;
    },
    _createPlaceholder: function _createPlaceholder(t) {
      t = t || this;
      var n,
          r = t.options;
      if (!r.placeholder || r.placeholder.constructor === String) n = r.placeholder, r.placeholder = {
        element: function element() {
          var r = e(document.createElement(t.currentItem[0].nodeName)).addClass(n || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
          return n || (r.style.visibility = "hidden"), r;
        },
        update: function update(e, i) {
          if (n && !r.forcePlaceholderSize) return;
          i.height() || i.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), i.width() || i.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10));
        }
      };
      t.placeholder = e(r.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), r.placeholder.update(t, t.placeholder);
    },
    _contactContainers: function _contactContainers(t) {
      var n,
          r,
          i,
          s,
          o,
          u,
          a,
          f,
          l,
          c = null,
          h = null;

      for (n = this.containers.length - 1; n >= 0; n--) {
        if (e.contains(this.currentItem[0], this.containers[n].element[0])) continue;

        if (this._intersectsWith(this.containers[n].containerCache)) {
          if (c && e.contains(this.containers[n].element[0], c.element[0])) continue;
          c = this.containers[n], h = n;
        } else this.containers[n].containerCache.over && (this.containers[n]._trigger("out", t, this._uiHash(this)), this.containers[n].containerCache.over = 0);
      }

      if (!c) return;
      if (this.containers.length === 1) this.containers[h]._trigger("over", t, this._uiHash(this)), this.containers[h].containerCache.over = 1;else {
        i = 1e4, s = null, o = this.containers[h].floating ? "left" : "top", u = this.containers[h].floating ? "width" : "height", a = this.positionAbs[o] + this.offset.click[o];

        for (r = this.items.length - 1; r >= 0; r--) {
          if (!e.contains(this.containers[h].element[0], this.items[r].item[0])) continue;
          if (this.items[r].item[0] === this.currentItem[0]) continue;
          f = this.items[r].item.offset()[o], l = !1, Math.abs(f - a) > Math.abs(f + this.items[r][u] - a) && (l = !0, f += this.items[r][u]), Math.abs(f - a) < i && (i = Math.abs(f - a), s = this.items[r], this.direction = l ? "up" : "down");
        }

        if (!s && !this.options.dropOnEmpty) return;
        this.currentContainer = this.containers[h], s ? this._rearrange(t, s, null, !0) : this._rearrange(t, null, this.containers[h].element, !0), this._trigger("change", t, this._uiHash()), this.containers[h]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[h]._trigger("over", t, this._uiHash(this)), this.containers[h].containerCache.over = 1;
      }
    },
    _createHelper: function _createHelper(t) {
      var n = this.options,
          r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper === "clone" ? this.currentItem.clone() : this.currentItem;
      return r.parents("body").length || e(n.appendTo !== "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(r[0]), r[0] === this.currentItem[0] && (this._storedCSS = {
        width: this.currentItem[0].style.width,
        height: this.currentItem[0].style.height,
        position: this.currentItem.css("position"),
        top: this.currentItem.css("top"),
        left: this.currentItem.css("left")
      }), (!r[0].style.width || n.forceHelperSize) && r.width(this.currentItem.width()), (!r[0].style.height || n.forceHelperSize) && r.height(this.currentItem.height()), r;
    },
    _adjustOffsetFromHelper: function _adjustOffsetFromHelper(t) {
      typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {
        left: +t[0],
        top: +t[1] || 0
      }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top);
    },
    _getParentOffset: function _getParentOffset() {
      this.offsetParent = this.helper.offsetParent();
      var t = this.offsetParent.offset();
      this.cssPosition === "absolute" && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
      if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && e.ui.ie) t = {
        top: 0,
        left: 0
      };
      return {
        top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
        left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
      };
    },
    _getRelativeOffset: function _getRelativeOffset() {
      if (this.cssPosition === "relative") {
        var e = this.currentItem.position();
        return {
          top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
          left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
        };
      }

      return {
        top: 0,
        left: 0
      };
    },
    _cacheMargins: function _cacheMargins() {
      this.margins = {
        left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
        top: parseInt(this.currentItem.css("marginTop"), 10) || 0
      };
    },
    _cacheHelperProportions: function _cacheHelperProportions() {
      this.helperProportions = {
        width: this.helper.outerWidth(),
        height: this.helper.outerHeight()
      };
    },
    _setContainment: function _setContainment() {
      var t,
          n,
          r,
          i = this.options;
      i.containment === "parent" && (i.containment = this.helper[0].parentNode);
      if (i.containment === "document" || i.containment === "window") this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(i.containment === "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(i.containment === "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
      /^(document|window|parent)$/.test(i.containment) || (t = e(i.containment)[0], n = e(i.containment).offset(), r = e(t).css("overflow") !== "hidden", this.containment = [n.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, n.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, n.left + (r ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, n.top + (r ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]);
    },
    _convertPositionTo: function _convertPositionTo(t, n) {
      n || (n = this.position);
      var r = t === "absolute" ? 1 : -1,
          i = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
          s = /(html|body)/i.test(i[0].tagName);
      return {
        top: n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : s ? 0 : i.scrollTop()) * r,
        left: n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : s ? 0 : i.scrollLeft()) * r
      };
    },
    _generatePosition: function _generatePosition(t) {
      var n,
          r,
          i = this.options,
          s = t.pageX,
          o = t.pageY,
          u = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
          a = /(html|body)/i.test(u[0].tagName);
      return this.cssPosition === "relative" && (this.scrollParent[0] === document || this.scrollParent[0] === this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top)), i.grid && (n = this.originalPageY + Math.round((o - this.originalPageY) / i.grid[1]) * i.grid[1], o = this.containment ? n - this.offset.click.top >= this.containment[1] && n - this.offset.click.top <= this.containment[3] ? n : n - this.offset.click.top >= this.containment[1] ? n - i.grid[1] : n + i.grid[1] : n, r = this.originalPageX + Math.round((s - this.originalPageX) / i.grid[0]) * i.grid[0], s = this.containment ? r - this.offset.click.left >= this.containment[0] && r - this.offset.click.left <= this.containment[2] ? r : r - this.offset.click.left >= this.containment[0] ? r - i.grid[0] : r + i.grid[0] : r)), {
        top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : a ? 0 : u.scrollTop()),
        left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : a ? 0 : u.scrollLeft())
      };
    },
    _rearrange: function _rearrange(e, t, n, r) {
      n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction === "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
      var i = this.counter;

      this._delay(function () {
        i === this.counter && this.refreshPositions(!r);
      });
    },
    _clear: function _clear(t, n) {
      this.reverting = !1;
      var r,
          i = [];
      !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;

      if (this.helper[0] === this.currentItem[0]) {
        for (r in this._storedCSS) {
          if (this._storedCSS[r] === "auto" || this._storedCSS[r] === "static") this._storedCSS[r] = "";
        }

        this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
      } else this.currentItem.show();

      this.fromOutside && !n && i.push(function (e) {
        this._trigger("receive", e, this._uiHash(this.fromOutside));
      }), (this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !n && i.push(function (e) {
        this._trigger("update", e, this._uiHash());
      }), this !== this.currentContainer && (n || (i.push(function (e) {
        this._trigger("remove", e, this._uiHash());
      }), i.push(function (e) {
        return function (t) {
          e._trigger("receive", t, this._uiHash(this));
        };
      }.call(this, this.currentContainer)), i.push(function (e) {
        return function (t) {
          e._trigger("update", t, this._uiHash(this));
        };
      }.call(this, this.currentContainer))));

      for (r = this.containers.length - 1; r >= 0; r--) {
        n || i.push(function (e) {
          return function (t) {
            e._trigger("deactivate", t, this._uiHash(this));
          };
        }.call(this, this.containers[r])), this.containers[r].containerCache.over && (i.push(function (e) {
          return function (t) {
            e._trigger("out", t, this._uiHash(this));
          };
        }.call(this, this.containers[r])), this.containers[r].containerCache.over = 0);
      }

      this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex), this.dragging = !1;

      if (this.cancelHelperRemoval) {
        if (!n) {
          this._trigger("beforeStop", t, this._uiHash());

          for (r = 0; r < i.length; r++) {
            i[r].call(this, t);
          }

          this._trigger("stop", t, this._uiHash());
        }

        return this.fromOutside = !1, !1;
      }

      n || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null;

      if (!n) {
        for (r = 0; r < i.length; r++) {
          i[r].call(this, t);
        }

        this._trigger("stop", t, this._uiHash());
      }

      return this.fromOutside = !1, !0;
    },
    _trigger: function _trigger() {
      e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel();
    },
    _uiHash: function _uiHash(t) {
      var n = t || this;
      return {
        helper: n.helper,
        placeholder: n.placeholder || e([]),
        position: n.position,
        originalPosition: n.originalPosition,
        offset: n.positionAbs,
        item: n.currentItem,
        sender: t ? t.element : null
      };
    }
  });
})(jQuery);

(function (e, t) {
  var n = 0,
      r = {},
      i = {};
  r.height = r.paddingTop = r.paddingBottom = r.borderTopWidth = r.borderBottomWidth = "hide", i.height = i.paddingTop = i.paddingBottom = i.borderTopWidth = i.borderBottomWidth = "show", e.widget("ui.accordion", {
    version: "1.10.0",
    options: {
      active: 0,
      animate: {},
      collapsible: !1,
      event: "click",
      header: "> li > :first-child,> :not(li):even",
      heightStyle: "auto",
      icons: {
        activeHeader: "ui-icon-triangle-1-s",
        header: "ui-icon-triangle-1-e"
      },
      activate: null,
      beforeActivate: null
    },
    _create: function _create() {
      var t = this.options;
      this.prevShow = this.prevHide = e(), this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role", "tablist"), !t.collapsible && (t.active === !1 || t.active == null) && (t.active = 0), this._processPanels(), t.active < 0 && (t.active += this.headers.length), this._refresh();
    },
    _getCreateEventData: function _getCreateEventData() {
      return {
        header: this.active,
        content: this.active.length ? this.active.next() : e()
      };
    },
    _createIcons: function _createIcons() {
      var t = this.options.icons;
      t && (e("<span>").addClass("ui-accordion-header-icon ui-icon " + t.header).prependTo(this.headers), this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader), this.headers.addClass("ui-accordion-icons"));
    },
    _destroyIcons: function _destroyIcons() {
      this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove();
    },
    _destroy: function _destroy() {
      var e;
      this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"), this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function () {
        /^ui-accordion/.test(this.id) && this.removeAttribute("id");
      }), this._destroyIcons(), e = this.headers.next().css("display", "").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function () {
        /^ui-accordion/.test(this.id) && this.removeAttribute("id");
      }), this.options.heightStyle !== "content" && e.css("height", "");
    },
    _setOption: function _setOption(e, t) {
      if (e === "active") {
        this._activate(t);

        return;
      }

      e === "event" && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(t)), this._super(e, t), e === "collapsible" && !t && this.options.active === !1 && this._activate(0), e === "icons" && (this._destroyIcons(), t && this._createIcons()), e === "disabled" && this.headers.add(this.headers.next()).toggleClass("ui-state-disabled", !!t);
    },
    _keydown: function _keydown(t) {
      if (t.altKey || t.ctrlKey) return;
      var n = e.ui.keyCode,
          r = this.headers.length,
          i = this.headers.index(t.target),
          s = !1;

      switch (t.keyCode) {
        case n.RIGHT:
        case n.DOWN:
          s = this.headers[(i + 1) % r];
          break;

        case n.LEFT:
        case n.UP:
          s = this.headers[(i - 1 + r) % r];
          break;

        case n.SPACE:
        case n.ENTER:
          this._eventHandler(t);

          break;

        case n.HOME:
          s = this.headers[0];
          break;

        case n.END:
          s = this.headers[r - 1];
      }

      s && (e(t.target).attr("tabIndex", -1), e(s).attr("tabIndex", 0), s.focus(), t.preventDefault());
    },
    _panelKeyDown: function _panelKeyDown(t) {
      t.keyCode === e.ui.keyCode.UP && t.ctrlKey && e(t.currentTarget).prev().focus();
    },
    refresh: function refresh() {
      var t = this.options;

      this._processPanels();

      if (t.active === !1 && t.collapsible === !0 || !this.headers.length) t.active = !1, this.active = e();
      t.active === !1 ? this._activate(0) : this.active.length && !e.contains(this.element[0], this.active[0]) ? this.headers.length === this.headers.find(".ui-state-disabled").length ? (t.active = !1, this.active = e()) : this._activate(Math.max(0, t.active - 1)) : t.active = this.headers.index(this.active), this._destroyIcons(), this._refresh();
    },
    _processPanels: function _processPanels() {
      this.headers = this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"), this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide();
    },
    _refresh: function _refresh() {
      var t,
          r = this.options,
          i = r.heightStyle,
          s = this.element.parent(),
          o = this.accordionId = "ui-accordion-" + (this.element.attr("id") || ++n);
      this.active = this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"), this.active.next().addClass("ui-accordion-content-active").show(), this.headers.attr("role", "tab").each(function (t) {
        var n = e(this),
            r = n.attr("id"),
            i = n.next(),
            s = i.attr("id");
        r || (r = o + "-header-" + t, n.attr("id", r)), s || (s = o + "-panel-" + t, i.attr("id", s)), n.attr("aria-controls", s), i.attr("aria-labelledby", r);
      }).next().attr("role", "tabpanel"), this.headers.not(this.active).attr({
        "aria-selected": "false",
        tabIndex: -1
      }).next().attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }).hide(), this.active.length ? this.active.attr({
        "aria-selected": "true",
        tabIndex: 0
      }).next().attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }) : this.headers.eq(0).attr("tabIndex", 0), this._createIcons(), this._setupEvents(r.event), i === "fill" ? (t = s.height(), this.element.siblings(":visible").each(function () {
        var n = e(this),
            r = n.css("position");
        if (r === "absolute" || r === "fixed") return;
        t -= n.outerHeight(!0);
      }), this.headers.each(function () {
        t -= e(this).outerHeight(!0);
      }), this.headers.next().each(function () {
        e(this).height(Math.max(0, t - e(this).innerHeight() + e(this).height()));
      }).css("overflow", "auto")) : i === "auto" && (t = 0, this.headers.next().each(function () {
        t = Math.max(t, e(this).css("height", "").height());
      }).height(t));
    },
    _activate: function _activate(t) {
      var n = this._findActive(t)[0];

      if (n === this.active[0]) return;
      n = n || this.active[0], this._eventHandler({
        target: n,
        currentTarget: n,
        preventDefault: e.noop
      });
    },
    _findActive: function _findActive(t) {
      return typeof t == "number" ? this.headers.eq(t) : e();
    },
    _setupEvents: function _setupEvents(t) {
      var n = {
        keydown: "_keydown"
      };
      t && e.each(t.split(" "), function (e, t) {
        n[t] = "_eventHandler";
      }), this._off(this.headers.add(this.headers.next())), this._on(this.headers, n), this._on(this.headers.next(), {
        keydown: "_panelKeyDown"
      }), this._hoverable(this.headers), this._focusable(this.headers);
    },
    _eventHandler: function _eventHandler(t) {
      var n = this.options,
          r = this.active,
          i = e(t.currentTarget),
          s = i[0] === r[0],
          o = s && n.collapsible,
          u = o ? e() : i.next(),
          a = r.next(),
          f = {
        oldHeader: r,
        oldPanel: a,
        newHeader: o ? e() : i,
        newPanel: u
      };
      t.preventDefault();
      if (s && !n.collapsible || this._trigger("beforeActivate", t, f) === !1) return;
      n.active = o ? !1 : this.headers.index(i), this.active = s ? e() : i, this._toggle(f), r.removeClass("ui-accordion-header-active ui-state-active"), n.icons && r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header), s || (i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"), n.icons && i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader), i.next().addClass("ui-accordion-content-active"));
    },
    _toggle: function _toggle(t) {
      var n = t.newPanel,
          r = this.prevShow.length ? this.prevShow : t.oldPanel;
      this.prevShow.add(this.prevHide).stop(!0, !0), this.prevShow = n, this.prevHide = r, this.options.animate ? this._animate(n, r, t) : (r.hide(), n.show(), this._toggleComplete(t)), r.attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), r.prev().attr("aria-selected", "false"), n.length && r.length ? r.prev().attr("tabIndex", -1) : n.length && this.headers.filter(function () {
        return e(this).attr("tabIndex") === 0;
      }).attr("tabIndex", -1), n.attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }).prev().attr({
        "aria-selected": "true",
        tabIndex: 0
      });
    },
    _animate: function _animate(e, t, n) {
      var s,
          o,
          u,
          a = this,
          f = 0,
          l = e.length && (!t.length || e.index() < t.index()),
          c = this.options.animate || {},
          h = l && c.down || c,
          p = function p() {
        a._toggleComplete(n);
      };

      typeof h == "number" && (u = h), typeof h == "string" && (o = h), o = o || h.easing || c.easing, u = u || h.duration || c.duration;
      if (!t.length) return e.animate(i, u, o, p);
      if (!e.length) return t.animate(r, u, o, p);
      s = e.show().outerHeight(), t.animate(r, {
        duration: u,
        easing: o,
        step: function step(e, t) {
          t.now = Math.round(e);
        }
      }), e.hide().animate(i, {
        duration: u,
        easing: o,
        complete: p,
        step: function step(e, n) {
          n.now = Math.round(e), n.prop !== "height" ? f += n.now : a.options.heightStyle !== "content" && (n.now = Math.round(s - t.outerHeight() - f), f = 0);
        }
      });
    },
    _toggleComplete: function _toggleComplete(e) {
      var t = e.oldPanel;
      t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"), t.length && (t.parent()[0].className = t.parent()[0].className), this._trigger("activate", null, e);
    }
  });
})(jQuery);

(function (e, t) {
  var n = 0;
  e.widget("ui.autocomplete", {
    version: "1.10.0",
    defaultElement: "<input>",
    options: {
      appendTo: null,
      autoFocus: !1,
      delay: 300,
      minLength: 1,
      position: {
        my: "left top",
        at: "left bottom",
        collision: "none"
      },
      source: null,
      change: null,
      close: null,
      focus: null,
      open: null,
      response: null,
      search: null,
      select: null
    },
    pending: 0,
    _create: function _create() {
      var t, n, r;
      this.isMultiLine = this._isMultiLine(), this.valueMethod = this.element[this.element.is("input,textarea") ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {
        keydown: function keydown(i) {
          if (this.element.prop("readOnly")) {
            t = !0, r = !0, n = !0;
            return;
          }

          t = !1, r = !1, n = !1;
          var s = e.ui.keyCode;

          switch (i.keyCode) {
            case s.PAGE_UP:
              t = !0, this._move("previousPage", i);
              break;

            case s.PAGE_DOWN:
              t = !0, this._move("nextPage", i);
              break;

            case s.UP:
              t = !0, this._keyEvent("previous", i);
              break;

            case s.DOWN:
              t = !0, this._keyEvent("next", i);
              break;

            case s.ENTER:
            case s.NUMPAD_ENTER:
              this.menu.active && (t = !0, i.preventDefault(), this.menu.select(i));
              break;

            case s.TAB:
              this.menu.active && this.menu.select(i);
              break;

            case s.ESCAPE:
              this.menu.element.is(":visible") && (this._value(this.term), this.close(i), i.preventDefault());
              break;

            default:
              n = !0, this._searchTimeout(i);
          }
        },
        keypress: function keypress(r) {
          if (t) {
            t = !1, r.preventDefault();
            return;
          }

          if (n) return;
          var i = e.ui.keyCode;

          switch (r.keyCode) {
            case i.PAGE_UP:
              this._move("previousPage", r);

              break;

            case i.PAGE_DOWN:
              this._move("nextPage", r);

              break;

            case i.UP:
              this._keyEvent("previous", r);

              break;

            case i.DOWN:
              this._keyEvent("next", r);

          }
        },
        input: function input(e) {
          if (r) {
            r = !1, e.preventDefault();
            return;
          }

          this._searchTimeout(e);
        },
        focus: function focus() {
          this.selectedItem = null, this.previous = this._value();
        },
        blur: function blur(e) {
          if (this.cancelBlur) {
            delete this.cancelBlur;
            return;
          }

          clearTimeout(this.searching), this.close(e), this._change(e);
        }
      }), this._initSource(), this.menu = e("<ul>").addClass("ui-autocomplete").appendTo(this._appendTo()).menu({
        input: e(),
        role: null
      }).zIndex(this.element.zIndex() + 1).hide().data("ui-menu"), this._on(this.menu.element, {
        mousedown: function mousedown(t) {
          t.preventDefault(), this.cancelBlur = !0, this._delay(function () {
            delete this.cancelBlur;
          });
          var n = this.menu.element[0];
          e(t.target).closest(".ui-menu-item").length || this._delay(function () {
            var t = this;
            this.document.one("mousedown", function (r) {
              r.target !== t.element[0] && r.target !== n && !e.contains(n, r.target) && t.close();
            });
          });
        },
        menufocus: function menufocus(t, n) {
          if (this.isNewMenu) {
            this.isNewMenu = !1;

            if (t.originalEvent && /^mouse/.test(t.originalEvent.type)) {
              this.menu.blur(), this.document.one("mousemove", function () {
                e(t.target).trigger(t.originalEvent);
              });
              return;
            }
          }

          var r = n.item.data("ui-autocomplete-item");
          !1 !== this._trigger("focus", t, {
            item: r
          }) ? t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(r.value) : this.liveRegion.text(r.value);
        },
        menuselect: function menuselect(e, t) {
          var n = t.item.data("ui-autocomplete-item"),
              r = this.previous;
          this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function () {
            this.previous = r, this.selectedItem = n;
          })), !1 !== this._trigger("select", e, {
            item: n
          }) && this._value(n.value), this.term = this._value(), this.close(e), this.selectedItem = n;
        }
      }), this.liveRegion = e("<span>", {
        role: "status",
        "aria-live": "polite"
      }).addClass("ui-helper-hidden-accessible").insertAfter(this.element), this._on(this.window, {
        beforeunload: function beforeunload() {
          this.element.removeAttr("autocomplete");
        }
      });
    },
    _destroy: function _destroy() {
      clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove();
    },
    _setOption: function _setOption(e, t) {
      this._super(e, t), e === "source" && this._initSource(), e === "appendTo" && this.menu.element.appendTo(this._appendTo()), e === "disabled" && t && this.xhr && this.xhr.abort();
    },
    _appendTo: function _appendTo() {
      var t = this.options.appendTo;
      return t && (t = t.jquery || t.nodeType ? e(t) : this.document.find(t).eq(0)), t || (t = this.element.closest(".ui-front")), t.length || (t = this.document[0].body), t;
    },
    _isMultiLine: function _isMultiLine() {
      return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable");
    },
    _initSource: function _initSource() {
      var t,
          n,
          r = this;
      e.isArray(this.options.source) ? (t = this.options.source, this.source = function (n, r) {
        r(e.ui.autocomplete.filter(t, n.term));
      }) : typeof this.options.source == "string" ? (n = this.options.source, this.source = function (t, i) {
        r.xhr && r.xhr.abort(), r.xhr = e.ajax({
          url: n,
          data: t,
          dataType: "json",
          success: function success(e) {
            i(e);
          },
          error: function error() {
            i([]);
          }
        });
      }) : this.source = this.options.source;
    },
    _searchTimeout: function _searchTimeout(e) {
      clearTimeout(this.searching), this.searching = this._delay(function () {
        this.term !== this._value() && (this.selectedItem = null, this.search(null, e));
      }, this.options.delay);
    },
    search: function search(e, t) {
      e = e != null ? e : this._value(), this.term = this._value();
      if (e.length < this.options.minLength) return this.close(t);
      if (this._trigger("search", t) === !1) return;
      return this._search(e);
    },
    _search: function _search(e) {
      this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({
        term: e
      }, this._response());
    },
    _response: function _response() {
      var e = this,
          t = ++n;
      return function (r) {
        t === n && e.__response(r), e.pending--, e.pending || e.element.removeClass("ui-autocomplete-loading");
      };
    },
    __response: function __response(e) {
      e && (e = this._normalize(e)), this._trigger("response", null, {
        content: e
      }), !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close();
    },
    close: function close(e) {
      this.cancelSearch = !0, this._close(e);
    },
    _close: function _close(e) {
      this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e));
    },
    _change: function _change(e) {
      this.previous !== this._value() && this._trigger("change", e, {
        item: this.selectedItem
      });
    },
    _normalize: function _normalize(t) {
      return t.length && t[0].label && t[0].value ? t : e.map(t, function (t) {
        return typeof t == "string" ? {
          label: t,
          value: t
        } : e.extend({
          label: t.label || t.value,
          value: t.value || t.label
        }, t);
      });
    },
    _suggest: function _suggest(t) {
      var n = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
      this._renderMenu(n, t), this.menu.refresh(), n.show(), this._resizeMenu(), n.position(e.extend({
        of: this.element
      }, this.options.position)), this.options.autoFocus && this.menu.next();
    },
    _resizeMenu: function _resizeMenu() {
      var e = this.menu.element;
      e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()));
    },
    _renderMenu: function _renderMenu(t, n) {
      var r = this;
      e.each(n, function (e, n) {
        r._renderItemData(t, n);
      });
    },
    _renderItemData: function _renderItemData(e, t) {
      return this._renderItem(e, t).data("ui-autocomplete-item", t);
    },
    _renderItem: function _renderItem(t, n) {
      return e("<li>").append(e("<a>").text(n.label)).appendTo(t);
    },
    _move: function _move(e, t) {
      if (!this.menu.element.is(":visible")) {
        this.search(null, t);
        return;
      }

      if (this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e)) {
        this._value(this.term), this.menu.blur();
        return;
      }

      this.menu[e](t);
    },
    widget: function widget() {
      return this.menu.element;
    },
    _value: function _value() {
      return this.valueMethod.apply(this.element, arguments);
    },
    _keyEvent: function _keyEvent(e, t) {
      if (!this.isMultiLine || this.menu.element.is(":visible")) this._move(e, t), t.preventDefault();
    }
  }), e.extend(e.ui.autocomplete, {
    escapeRegex: function escapeRegex(e) {
      return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
    },
    filter: function filter(t, n) {
      var r = new RegExp(e.ui.autocomplete.escapeRegex(n), "i");
      return e.grep(t, function (e) {
        return r.test(e.label || e.value || e);
      });
    }
  }), e.widget("ui.autocomplete", e.ui.autocomplete, {
    options: {
      messages: {
        noResults: "No search results.",
        results: function results(e) {
          return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate.";
        }
      }
    },
    __response: function __response(e) {
      var t;

      this._superApply(arguments);

      if (this.options.disabled || this.cancelSearch) return;
      e && e.length ? t = this.options.messages.results(e.length) : t = this.options.messages.noResults, this.liveRegion.text(t);
    }
  });
})(jQuery);

(function (e, t) {
  var n,
      r,
      i,
      s,
      o = "ui-button ui-widget ui-state-default ui-corner-all",
      u = "ui-state-hover ui-state-active ",
      a = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",
      f = function f() {
    var t = e(this).find(":ui-button");
    setTimeout(function () {
      t.button("refresh");
    }, 1);
  },
      l = function l(t) {
    var n = t.name,
        r = t.form,
        i = e([]);
    return n && (n = n.replace(/'/g, "\\'"), r ? i = e(r).find("[name='" + n + "']") : i = e("[name='" + n + "']", t.ownerDocument).filter(function () {
      return !this.form;
    })), i;
  };

  e.widget("ui.button", {
    version: "1.10.0",
    defaultElement: "<button>",
    options: {
      disabled: null,
      text: !0,
      label: null,
      icons: {
        primary: null,
        secondary: null
      }
    },
    _create: function _create() {
      this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, f), typeof this.options.disabled != "boolean" ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
      var t = this,
          u = this.options,
          a = this.type === "checkbox" || this.type === "radio",
          c = a ? "" : "ui-state-active",
          h = "ui-state-focus";
      u.label === null && (u.label = this.type === "input" ? this.buttonElement.val() : this.buttonElement.html()), this._hoverable(this.buttonElement), this.buttonElement.addClass(o).attr("role", "button").bind("mouseenter" + this.eventNamespace, function () {
        if (u.disabled) return;
        this === n && e(this).addClass("ui-state-active");
      }).bind("mouseleave" + this.eventNamespace, function () {
        if (u.disabled) return;
        e(this).removeClass(c);
      }).bind("click" + this.eventNamespace, function (e) {
        u.disabled && (e.preventDefault(), e.stopImmediatePropagation());
      }), this.element.bind("focus" + this.eventNamespace, function () {
        t.buttonElement.addClass(h);
      }).bind("blur" + this.eventNamespace, function () {
        t.buttonElement.removeClass(h);
      }), a && (this.element.bind("change" + this.eventNamespace, function () {
        if (s) return;
        t.refresh();
      }), this.buttonElement.bind("mousedown" + this.eventNamespace, function (e) {
        if (u.disabled) return;
        s = !1, r = e.pageX, i = e.pageY;
      }).bind("mouseup" + this.eventNamespace, function (e) {
        if (u.disabled) return;
        if (r !== e.pageX || i !== e.pageY) s = !0;
      })), this.type === "checkbox" ? this.buttonElement.bind("click" + this.eventNamespace, function () {
        if (u.disabled || s) return !1;
      }) : this.type === "radio" ? this.buttonElement.bind("click" + this.eventNamespace, function () {
        if (u.disabled || s) return !1;
        e(this).addClass("ui-state-active"), t.buttonElement.attr("aria-pressed", "true");
        var n = t.element[0];
        l(n).not(n).map(function () {
          return e(this).button("widget")[0];
        }).removeClass("ui-state-active").attr("aria-pressed", "false");
      }) : (this.buttonElement.bind("mousedown" + this.eventNamespace, function () {
        if (u.disabled) return !1;
        e(this).addClass("ui-state-active"), n = this, t.document.one("mouseup", function () {
          n = null;
        });
      }).bind("mouseup" + this.eventNamespace, function () {
        if (u.disabled) return !1;
        e(this).removeClass("ui-state-active");
      }).bind("keydown" + this.eventNamespace, function (t) {
        if (u.disabled) return !1;
        (t.keyCode === e.ui.keyCode.SPACE || t.keyCode === e.ui.keyCode.ENTER) && e(this).addClass("ui-state-active");
      }).bind("keyup" + this.eventNamespace + " blur" + this.eventNamespace, function () {
        e(this).removeClass("ui-state-active");
      }), this.buttonElement.is("a") && this.buttonElement.keyup(function (t) {
        t.keyCode === e.ui.keyCode.SPACE && e(this).click();
      })), this._setOption("disabled", u.disabled), this._resetButton();
    },
    _determineButtonType: function _determineButtonType() {
      var e, t, n;
      this.element.is("[type=checkbox]") ? this.type = "checkbox" : this.element.is("[type=radio]") ? this.type = "radio" : this.element.is("input") ? this.type = "input" : this.type = "button", this.type === "checkbox" || this.type === "radio" ? (e = this.element.parents().last(), t = "label[for='" + this.element.attr("id") + "']", this.buttonElement = e.find(t), this.buttonElement.length || (e = e.length ? e.siblings() : this.element.siblings(), this.buttonElement = e.filter(t), this.buttonElement.length || (this.buttonElement = e.find(t))), this.element.addClass("ui-helper-hidden-accessible"), n = this.element.is(":checked"), n && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", n)) : this.buttonElement = this.element;
    },
    widget: function widget() {
      return this.buttonElement;
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass(o + " " + u + " " + a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title");
    },
    _setOption: function _setOption(e, t) {
      this._super(e, t);

      if (e === "disabled") {
        t ? this.element.prop("disabled", !0) : this.element.prop("disabled", !1);
        return;
      }

      this._resetButton();
    },
    refresh: function refresh() {
      var t = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
      t !== this.options.disabled && this._setOption("disabled", t), this.type === "radio" ? l(this.element[0]).each(function () {
        e(this).is(":checked") ? e(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false");
      }) : this.type === "checkbox" && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"));
    },
    _resetButton: function _resetButton() {
      if (this.type === "input") {
        this.options.label && this.element.val(this.options.label);
        return;
      }

      var t = this.buttonElement.removeClass(a),
          n = e("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),
          r = this.options.icons,
          i = r.primary && r.secondary,
          s = [];
      r.primary || r.secondary ? (this.options.text && s.push("ui-button-text-icon" + (i ? "s" : r.primary ? "-primary" : "-secondary")), r.primary && t.prepend("<span class='ui-button-icon-primary ui-icon " + r.primary + "'></span>"), r.secondary && t.append("<span class='ui-button-icon-secondary ui-icon " + r.secondary + "'></span>"), this.options.text || (s.push(i ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || t.attr("title", e.trim(n)))) : s.push("ui-button-text-only"), t.addClass(s.join(" "));
    }
  }), e.widget("ui.buttonset", {
    version: "1.10.0",
    options: {
      items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"
    },
    _create: function _create() {
      this.element.addClass("ui-buttonset");
    },
    _init: function _init() {
      this.refresh();
    },
    _setOption: function _setOption(e, t) {
      e === "disabled" && this.buttons.button("option", e, t), this._super(e, t);
    },
    refresh: function refresh() {
      var t = this.element.css("direction") === "rtl";
      this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function () {
        return e(this).button("widget")[0];
      }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(t ? "ui-corner-left" : "ui-corner-right").end().end();
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-buttonset"), this.buttons.map(function () {
        return e(this).button("widget")[0];
      }).removeClass("ui-corner-left ui-corner-right").end().button("destroy");
    }
  });
})(jQuery);

(function (e, t) {
  function s() {
    this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = {
      closeText: "Done",
      prevText: "Prev",
      nextText: "Next",
      currentText: "Today",
      monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
      weekHeader: "Wk",
      dateFormat: "mm/dd/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }, this._defaults = {
      showOn: "focus",
      showAnim: "fadeIn",
      showOptions: {},
      defaultDate: null,
      appendText: "",
      buttonText: "...",
      buttonImage: "",
      buttonImageOnly: !1,
      hideIfNoPrevNext: !1,
      navigationAsDateFormat: !1,
      gotoCurrent: !1,
      changeMonth: !1,
      changeYear: !1,
      yearRange: "c-10:c+10",
      showOtherMonths: !1,
      selectOtherMonths: !1,
      showWeek: !1,
      calculateWeek: this.iso8601Week,
      shortYearCutoff: "+10",
      minDate: null,
      maxDate: null,
      duration: "fast",
      beforeShowDay: null,
      beforeShow: null,
      onSelect: null,
      onChangeMonthYear: null,
      onClose: null,
      numberOfMonths: 1,
      showCurrentAtPos: 0,
      stepMonths: 1,
      stepBigMonths: 12,
      altField: "",
      altFormat: "",
      constrainInput: !0,
      showButtonPanel: !1,
      autoSize: !1,
      disabled: !1
    }, e.extend(this._defaults, this.regional[""]), this.dpDiv = o(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));
  }

  function o(t) {
    var n = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
    return t.delegate(n, "mouseout", function () {
      e(this).removeClass("ui-state-hover"), this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).removeClass("ui-datepicker-prev-hover"), this.className.indexOf("ui-datepicker-next") !== -1 && e(this).removeClass("ui-datepicker-next-hover");
    }).delegate(n, "mouseover", function () {
      e.datepicker._isDisabledDatepicker(i.inline ? t.parent()[0] : i.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), e(this).addClass("ui-state-hover"), this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).addClass("ui-datepicker-prev-hover"), this.className.indexOf("ui-datepicker-next") !== -1 && e(this).addClass("ui-datepicker-next-hover"));
    });
  }

  function u(t, n) {
    e.extend(t, n);

    for (var r in n) {
      n[r] == null && (t[r] = n[r]);
    }

    return t;
  }

  e.extend(e.ui, {
    datepicker: {
      version: "1.10.0"
    }
  });
  var n = "datepicker",
      r = new Date().getTime(),
      i;
  e.extend(s.prototype, {
    markerClassName: "hasDatepicker",
    maxRows: 4,
    _widgetDatepicker: function _widgetDatepicker() {
      return this.dpDiv;
    },
    setDefaults: function setDefaults(e) {
      return u(this._defaults, e || {}), this;
    },
    _attachDatepicker: function _attachDatepicker(t, n) {
      var r, i, s;
      r = t.nodeName.toLowerCase(), i = r === "div" || r === "span", t.id || (this.uuid += 1, t.id = "dp" + this.uuid), s = this._newInst(e(t), i), s.settings = e.extend({}, n || {}), r === "input" ? this._connectDatepicker(t, s) : i && this._inlineDatepicker(t, s);
    },
    _newInst: function _newInst(t, n) {
      var r = t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1");
      return {
        id: r,
        input: t,
        selectedDay: 0,
        selectedMonth: 0,
        selectedYear: 0,
        drawMonth: 0,
        drawYear: 0,
        inline: n,
        dpDiv: n ? o(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
      };
    },
    _connectDatepicker: function _connectDatepicker(t, r) {
      var i = e(t);
      r.append = e([]), r.trigger = e([]);
      if (i.hasClass(this.markerClassName)) return;
      this._attachments(i, r), i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp), this._autoSize(r), e.data(t, n, r), r.settings.disabled && this._disableDatepicker(t);
    },
    _attachments: function _attachments(t, n) {
      var r,
          i,
          s,
          o = this._get(n, "appendText"),
          u = this._get(n, "isRTL");

      n.append && n.append.remove(), o && (n.append = e("<span class='" + this._appendClass + "'>" + o + "</span>"), t[u ? "before" : "after"](n.append)), t.unbind("focus", this._showDatepicker), n.trigger && n.trigger.remove(), r = this._get(n, "showOn"), (r === "focus" || r === "both") && t.focus(this._showDatepicker);
      if (r === "button" || r === "both") i = this._get(n, "buttonText"), s = this._get(n, "buttonImage"), n.trigger = e(this._get(n, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({
        src: s,
        alt: i,
        title: i
      }) : e("<button type='button'></button>").addClass(this._triggerClass).html(s ? e("<img/>").attr({
        src: s,
        alt: i,
        title: i
      }) : i)), t[u ? "before" : "after"](n.trigger), n.trigger.click(function () {
        return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(), e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]), !1;
      });
    },
    _autoSize: function _autoSize(e) {
      if (this._get(e, "autoSize") && !e.inline) {
        var t,
            n,
            r,
            i,
            s = new Date(2009, 11, 20),
            o = this._get(e, "dateFormat");

        o.match(/[DM]/) && (t = function t(e) {
          n = 0, r = 0;

          for (i = 0; i < e.length; i++) {
            e[i].length > n && (n = e[i].length, r = i);
          }

          return r;
        }, s.setMonth(t(this._get(e, o.match(/MM/) ? "monthNames" : "monthNamesShort"))), s.setDate(t(this._get(e, o.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - s.getDay())), e.input.attr("size", this._formatDate(e, s).length);
      }
    },
    _inlineDatepicker: function _inlineDatepicker(t, r) {
      var i = e(t);
      if (i.hasClass(this.markerClassName)) return;
      i.addClass(this.markerClassName).append(r.dpDiv), e.data(t, n, r), this._setDate(r, this._getDefaultDate(r), !0), this._updateDatepicker(r), this._updateAlternate(r), r.settings.disabled && this._disableDatepicker(t), r.dpDiv.css("display", "block");
    },
    _dialogDatepicker: function _dialogDatepicker(t, r, i, s, o) {
      var a,
          f,
          l,
          c,
          h,
          p = this._dialogInst;
      return p || (this.uuid += 1, a = "dp" + this.uuid, this._dialogInput = e("<input type='text' id='" + a + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.keydown(this._doKeyDown), e("body").append(this._dialogInput), p = this._dialogInst = this._newInst(this._dialogInput, !1), p.settings = {}, e.data(this._dialogInput[0], n, p)), u(p.settings, s || {}), r = r && r.constructor === Date ? this._formatDate(p, r) : r, this._dialogInput.val(r), this._pos = o ? o.length ? o : [o.pageX, o.pageY] : null, this._pos || (f = document.documentElement.clientWidth, l = document.documentElement.clientHeight, c = document.documentElement.scrollLeft || document.body.scrollLeft, h = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [f / 2 - 100 + c, l / 2 - 150 + h]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), p.settings.onSelect = i, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), e.blockUI && e.blockUI(this.dpDiv), e.data(this._dialogInput[0], n, p), this;
    },
    _destroyDatepicker: function _destroyDatepicker(t) {
      var r,
          i = e(t),
          s = e.data(t, n);
      if (!i.hasClass(this.markerClassName)) return;
      r = t.nodeName.toLowerCase(), e.removeData(t, n), r === "input" ? (s.append.remove(), s.trigger.remove(), i.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : (r === "div" || r === "span") && i.removeClass(this.markerClassName).empty();
    },
    _enableDatepicker: function _enableDatepicker(t) {
      var r,
          i,
          s = e(t),
          o = e.data(t, n);
      if (!s.hasClass(this.markerClassName)) return;
      r = t.nodeName.toLowerCase();
      if (r === "input") t.disabled = !1, o.trigger.filter("button").each(function () {
        this.disabled = !1;
      }).end().filter("img").css({
        opacity: "1.0",
        cursor: ""
      });else if (r === "div" || r === "span") i = s.children("." + this._inlineClass), i.children().removeClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1);
      this._disabledInputs = e.map(this._disabledInputs, function (e) {
        return e === t ? null : e;
      });
    },
    _disableDatepicker: function _disableDatepicker(t) {
      var r,
          i,
          s = e(t),
          o = e.data(t, n);
      if (!s.hasClass(this.markerClassName)) return;
      r = t.nodeName.toLowerCase();
      if (r === "input") t.disabled = !0, o.trigger.filter("button").each(function () {
        this.disabled = !0;
      }).end().filter("img").css({
        opacity: "0.5",
        cursor: "default"
      });else if (r === "div" || r === "span") i = s.children("." + this._inlineClass), i.children().addClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0);
      this._disabledInputs = e.map(this._disabledInputs, function (e) {
        return e === t ? null : e;
      }), this._disabledInputs[this._disabledInputs.length] = t;
    },
    _isDisabledDatepicker: function _isDisabledDatepicker(e) {
      if (!e) return !1;

      for (var t = 0; t < this._disabledInputs.length; t++) {
        if (this._disabledInputs[t] === e) return !0;
      }

      return !1;
    },
    _getInst: function _getInst(t) {
      try {
        return e.data(t, n);
      } catch (r) {
        throw "Missing instance data for this datepicker";
      }
    },
    _optionDatepicker: function _optionDatepicker(n, r, i) {
      var s,
          o,
          a,
          f,
          l = this._getInst(n);

      if (arguments.length === 2 && typeof r == "string") return r === "defaults" ? e.extend({}, e.datepicker._defaults) : l ? r === "all" ? e.extend({}, l.settings) : this._get(l, r) : null;
      s = r || {}, typeof r == "string" && (s = {}, s[r] = i), l && (this._curInst === l && this._hideDatepicker(), o = this._getDateDatepicker(n, !0), a = this._getMinMaxDate(l, "min"), f = this._getMinMaxDate(l, "max"), u(l.settings, s), a !== null && s.dateFormat !== t && s.minDate === t && (l.settings.minDate = this._formatDate(l, a)), f !== null && s.dateFormat !== t && s.maxDate === t && (l.settings.maxDate = this._formatDate(l, f)), "disabled" in s && (s.disabled ? this._disableDatepicker(n) : this._enableDatepicker(n)), this._attachments(e(n), l), this._autoSize(l), this._setDate(l, o), this._updateAlternate(l), this._updateDatepicker(l));
    },
    _changeDatepicker: function _changeDatepicker(e, t, n) {
      this._optionDatepicker(e, t, n);
    },
    _refreshDatepicker: function _refreshDatepicker(e) {
      var t = this._getInst(e);

      t && this._updateDatepicker(t);
    },
    _setDateDatepicker: function _setDateDatepicker(e, t) {
      var n = this._getInst(e);

      n && (this._setDate(n, t), this._updateDatepicker(n), this._updateAlternate(n));
    },
    _getDateDatepicker: function _getDateDatepicker(e, t) {
      var n = this._getInst(e);

      return n && !n.inline && this._setDateFromField(n, t), n ? this._getDate(n) : null;
    },
    _doKeyDown: function _doKeyDown(t) {
      var n,
          r,
          i,
          s = e.datepicker._getInst(t.target),
          o = !0,
          u = s.dpDiv.is(".ui-datepicker-rtl");

      s._keyEvent = !0;
      if (e.datepicker._datepickerShowing) switch (t.keyCode) {
        case 9:
          e.datepicker._hideDatepicker(), o = !1;
          break;

        case 13:
          return i = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", s.dpDiv), i[0] && e.datepicker._selectDay(t.target, s.selectedMonth, s.selectedYear, i[0]), n = e.datepicker._get(s, "onSelect"), n ? (r = e.datepicker._formatDate(s), n.apply(s.input ? s.input[0] : null, [r, s])) : e.datepicker._hideDatepicker(), !1;

        case 27:
          e.datepicker._hideDatepicker();

          break;

        case 33:
          e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");

          break;

        case 34:
          e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");

          break;

        case 35:
          (t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target), o = t.ctrlKey || t.metaKey;
          break;

        case 36:
          (t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target), o = t.ctrlKey || t.metaKey;
          break;

        case 37:
          (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, u ? 1 : -1, "D"), o = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");
          break;

        case 38:
          (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"), o = t.ctrlKey || t.metaKey;
          break;

        case 39:
          (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, u ? -1 : 1, "D"), o = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");
          break;

        case 40:
          (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"), o = t.ctrlKey || t.metaKey;
          break;

        default:
          o = !1;
      } else t.keyCode === 36 && t.ctrlKey ? e.datepicker._showDatepicker(this) : o = !1;
      o && (t.preventDefault(), t.stopPropagation());
    },
    _doKeyPress: function _doKeyPress(t) {
      var n,
          r,
          i = e.datepicker._getInst(t.target);

      if (e.datepicker._get(i, "constrainInput")) return n = e.datepicker._possibleChars(e.datepicker._get(i, "dateFormat")), r = String.fromCharCode(t.charCode == null ? t.keyCode : t.charCode), t.ctrlKey || t.metaKey || r < " " || !n || n.indexOf(r) > -1;
    },
    _doKeyUp: function _doKeyUp(t) {
      var n,
          r = e.datepicker._getInst(t.target);

      if (r.input.val() !== r.lastVal) try {
        n = e.datepicker.parseDate(e.datepicker._get(r, "dateFormat"), r.input ? r.input.val() : null, e.datepicker._getFormatConfig(r)), n && (e.datepicker._setDateFromField(r), e.datepicker._updateAlternate(r), e.datepicker._updateDatepicker(r));
      } catch (i) {}
      return !0;
    },
    _showDatepicker: function _showDatepicker(t) {
      t = t.target || t, t.nodeName.toLowerCase() !== "input" && (t = e("input", t.parentNode)[0]);
      if (e.datepicker._isDisabledDatepicker(t) || e.datepicker._lastInput === t) return;
      var n, r, i, s, o, a, f;
      n = e.datepicker._getInst(t), e.datepicker._curInst && e.datepicker._curInst !== n && (e.datepicker._curInst.dpDiv.stop(!0, !0), n && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])), r = e.datepicker._get(n, "beforeShow"), i = r ? r.apply(t, [t, n]) : {};
      if (i === !1) return;
      u(n.settings, i), n.lastVal = null, e.datepicker._lastInput = t, e.datepicker._setDateFromField(n), e.datepicker._inDialog && (t.value = ""), e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t), e.datepicker._pos[1] += t.offsetHeight), s = !1, e(t).parents().each(function () {
        return s |= e(this).css("position") === "fixed", !s;
      }), o = {
        left: e.datepicker._pos[0],
        top: e.datepicker._pos[1]
      }, e.datepicker._pos = null, n.dpDiv.empty(), n.dpDiv.css({
        position: "absolute",
        display: "block",
        top: "-1000px"
      }), e.datepicker._updateDatepicker(n), o = e.datepicker._checkOffset(n, o, s), n.dpDiv.css({
        position: e.datepicker._inDialog && e.blockUI ? "static" : s ? "fixed" : "absolute",
        display: "none",
        left: o.left + "px",
        top: o.top + "px"
      }), n.inline || (a = e.datepicker._get(n, "showAnim"), f = e.datepicker._get(n, "duration"), n.dpDiv.zIndex(e(t).zIndex() + 1), e.datepicker._datepickerShowing = !0, e.effects && e.effects.effect[a] ? n.dpDiv.show(a, e.datepicker._get(n, "showOptions"), f) : n.dpDiv[a || "show"](a ? f : null), n.input.is(":visible") && !n.input.is(":disabled") && n.input.focus(), e.datepicker._curInst = n);
    },
    _updateDatepicker: function _updateDatepicker(t) {
      this.maxRows = 4, i = t, t.dpDiv.empty().append(this._generateHTML(t)), this._attachHandlers(t), t.dpDiv.find("." + this._dayOverClass + " a").mouseover();

      var n,
          r = this._getNumberOfMonths(t),
          s = r[1],
          o = 17;

      t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), s > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + s).css("width", o * s + "em"), t.dpDiv[(r[0] !== 1 || r[1] !== 1 ? "add" : "remove") + "Class"]("ui-datepicker-multi"), t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), t === e.datepicker._curInst && e.datepicker._datepickerShowing && t.input && t.input.is(":visible") && !t.input.is(":disabled") && t.input[0] !== document.activeElement && t.input.focus(), t.yearshtml && (n = t.yearshtml, setTimeout(function () {
        n === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml), n = t.yearshtml = null;
      }, 0));
    },
    _getBorders: function _getBorders(e) {
      var t = function t(e) {
        return {
          thin: 1,
          medium: 2,
          thick: 3
        }[e] || e;
      };

      return [parseFloat(t(e.css("border-left-width"))), parseFloat(t(e.css("border-top-width")))];
    },
    _checkOffset: function _checkOffset(t, n, r) {
      var i = t.dpDiv.outerWidth(),
          s = t.dpDiv.outerHeight(),
          o = t.input ? t.input.outerWidth() : 0,
          u = t.input ? t.input.outerHeight() : 0,
          a = document.documentElement.clientWidth + (r ? 0 : e(document).scrollLeft()),
          f = document.documentElement.clientHeight + (r ? 0 : e(document).scrollTop());
      return n.left -= this._get(t, "isRTL") ? i - o : 0, n.left -= r && n.left === t.input.offset().left ? e(document).scrollLeft() : 0, n.top -= r && n.top === t.input.offset().top + u ? e(document).scrollTop() : 0, n.left -= Math.min(n.left, n.left + i > a && a > i ? Math.abs(n.left + i - a) : 0), n.top -= Math.min(n.top, n.top + s > f && f > s ? Math.abs(s + u) : 0), n;
    },
    _findPos: function _findPos(t) {
      var n,
          r = this._getInst(t),
          i = this._get(r, "isRTL");

      while (t && (t.type === "hidden" || t.nodeType !== 1 || e.expr.filters.hidden(t))) {
        t = t[i ? "previousSibling" : "nextSibling"];
      }

      return n = e(t).offset(), [n.left, n.top];
    },
    _hideDatepicker: function _hideDatepicker(t) {
      var r,
          i,
          s,
          o,
          u = this._curInst;
      if (!u || t && u !== e.data(t, n)) return;
      this._datepickerShowing && (r = this._get(u, "showAnim"), i = this._get(u, "duration"), s = function s() {
        e.datepicker._tidyDialog(u);
      }, e.effects && (e.effects.effect[r] || e.effects[r]) ? u.dpDiv.hide(r, e.datepicker._get(u, "showOptions"), i, s) : u.dpDiv[r === "slideDown" ? "slideUp" : r === "fadeIn" ? "fadeOut" : "hide"](r ? i : null, s), r || s(), this._datepickerShowing = !1, o = this._get(u, "onClose"), o && o.apply(u.input ? u.input[0] : null, [u.input ? u.input.val() : "", u]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
        position: "absolute",
        left: "0",
        top: "-100px"
      }), e.blockUI && (e.unblockUI(), e("body").append(this.dpDiv))), this._inDialog = !1);
    },
    _tidyDialog: function _tidyDialog(e) {
      e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar");
    },
    _checkExternalClick: function _checkExternalClick(t) {
      if (!e.datepicker._curInst) return;

      var n = e(t.target),
          r = e.datepicker._getInst(n[0]);

      (n[0].id !== e.datepicker._mainDivId && n.parents("#" + e.datepicker._mainDivId).length === 0 && !n.hasClass(e.datepicker.markerClassName) && !n.closest("." + e.datepicker._triggerClass).length && e.datepicker._datepickerShowing && (!e.datepicker._inDialog || !e.blockUI) || n.hasClass(e.datepicker.markerClassName) && e.datepicker._curInst !== r) && e.datepicker._hideDatepicker();
    },
    _adjustDate: function _adjustDate(t, n, r) {
      var i = e(t),
          s = this._getInst(i[0]);

      if (this._isDisabledDatepicker(i[0])) return;
      this._adjustInstDate(s, n + (r === "M" ? this._get(s, "showCurrentAtPos") : 0), r), this._updateDatepicker(s);
    },
    _gotoToday: function _gotoToday(t) {
      var n,
          r = e(t),
          i = this._getInst(r[0]);

      this._get(i, "gotoCurrent") && i.currentDay ? (i.selectedDay = i.currentDay, i.drawMonth = i.selectedMonth = i.currentMonth, i.drawYear = i.selectedYear = i.currentYear) : (n = new Date(), i.selectedDay = n.getDate(), i.drawMonth = i.selectedMonth = n.getMonth(), i.drawYear = i.selectedYear = n.getFullYear()), this._notifyChange(i), this._adjustDate(r);
    },
    _selectMonthYear: function _selectMonthYear(t, n, r) {
      var i = e(t),
          s = this._getInst(i[0]);

      s["selected" + (r === "M" ? "Month" : "Year")] = s["draw" + (r === "M" ? "Month" : "Year")] = parseInt(n.options[n.selectedIndex].value, 10), this._notifyChange(s), this._adjustDate(i);
    },
    _selectDay: function _selectDay(t, n, r, i) {
      var s,
          o = e(t);
      if (e(i).hasClass(this._unselectableClass) || this._isDisabledDatepicker(o[0])) return;
      s = this._getInst(o[0]), s.selectedDay = s.currentDay = e("a", i).html(), s.selectedMonth = s.currentMonth = n, s.selectedYear = s.currentYear = r, this._selectDate(t, this._formatDate(s, s.currentDay, s.currentMonth, s.currentYear));
    },
    _clearDate: function _clearDate(t) {
      var n = e(t);

      this._selectDate(n, "");
    },
    _selectDate: function _selectDate(t, n) {
      var r,
          i = e(t),
          s = this._getInst(i[0]);

      n = n != null ? n : this._formatDate(s), s.input && s.input.val(n), this._updateAlternate(s), r = this._get(s, "onSelect"), r ? r.apply(s.input ? s.input[0] : null, [n, s]) : s.input && s.input.trigger("change"), s.inline ? this._updateDatepicker(s) : (this._hideDatepicker(), this._lastInput = s.input[0], _typeof(s.input[0]) != "object" && s.input.focus(), this._lastInput = null);
    },
    _updateAlternate: function _updateAlternate(t) {
      var n,
          r,
          i,
          s = this._get(t, "altField");

      s && (n = this._get(t, "altFormat") || this._get(t, "dateFormat"), r = this._getDate(t), i = this.formatDate(n, r, this._getFormatConfig(t)), e(s).each(function () {
        e(this).val(i);
      }));
    },
    noWeekends: function noWeekends(e) {
      var t = e.getDay();
      return [t > 0 && t < 6, ""];
    },
    iso8601Week: function iso8601Week(e) {
      var t,
          n = new Date(e.getTime());
      return n.setDate(n.getDate() + 4 - (n.getDay() || 7)), t = n.getTime(), n.setMonth(0), n.setDate(1), Math.floor(Math.round((t - n) / 864e5) / 7) + 1;
    },
    parseDate: function parseDate(t, n, r) {
      if (t == null || n == null) throw "Invalid arguments";
      n = _typeof(n) == "object" ? n.toString() : n + "";
      if (n === "") return null;

      var i,
          s,
          o,
          u = 0,
          a = (r ? r.shortYearCutoff : null) || this._defaults.shortYearCutoff,
          f = typeof a != "string" ? a : new Date().getFullYear() % 100 + parseInt(a, 10),
          l = (r ? r.dayNamesShort : null) || this._defaults.dayNamesShort,
          c = (r ? r.dayNames : null) || this._defaults.dayNames,
          h = (r ? r.monthNamesShort : null) || this._defaults.monthNamesShort,
          p = (r ? r.monthNames : null) || this._defaults.monthNames,
          d = -1,
          v = -1,
          m = -1,
          g = -1,
          y = !1,
          b,
          w = function w(e) {
        var n = i + 1 < t.length && t.charAt(i + 1) === e;
        return n && i++, n;
      },
          E = function E(e) {
        var t = w(e),
            r = e === "@" ? 14 : e === "!" ? 20 : e === "y" && t ? 4 : e === "o" ? 3 : 2,
            i = new RegExp("^\\d{1," + r + "}"),
            s = n.substring(u).match(i);
        if (!s) throw "Missing number at position " + u;
        return u += s[0].length, parseInt(s[0], 10);
      },
          S = function S(t, r, i) {
        var s = -1,
            o = e.map(w(t) ? i : r, function (e, t) {
          return [[t, e]];
        }).sort(function (e, t) {
          return -(e[1].length - t[1].length);
        });
        e.each(o, function (e, t) {
          var r = t[1];
          if (n.substr(u, r.length).toLowerCase() === r.toLowerCase()) return s = t[0], u += r.length, !1;
        });
        if (s !== -1) return s + 1;
        throw "Unknown name at position " + u;
      },
          x = function x() {
        if (n.charAt(u) !== t.charAt(i)) throw "Unexpected literal at position " + u;
        u++;
      };

      for (i = 0; i < t.length; i++) {
        if (y) t.charAt(i) === "'" && !w("'") ? y = !1 : x();else switch (t.charAt(i)) {
          case "d":
            m = E("d");
            break;

          case "D":
            S("D", l, c);
            break;

          case "o":
            g = E("o");
            break;

          case "m":
            v = E("m");
            break;

          case "M":
            v = S("M", h, p);
            break;

          case "y":
            d = E("y");
            break;

          case "@":
            b = new Date(E("@")), d = b.getFullYear(), v = b.getMonth() + 1, m = b.getDate();
            break;

          case "!":
            b = new Date((E("!") - this._ticksTo1970) / 1e4), d = b.getFullYear(), v = b.getMonth() + 1, m = b.getDate();
            break;

          case "'":
            w("'") ? x() : y = !0;
            break;

          default:
            x();
        }
      }

      if (u < n.length) {
        o = n.substr(u);
        if (!/^\s+/.test(o)) throw "Extra/unparsed characters found in date: " + o;
      }

      d === -1 ? d = new Date().getFullYear() : d < 100 && (d += new Date().getFullYear() - new Date().getFullYear() % 100 + (d <= f ? 0 : -100));

      if (g > -1) {
        v = 1, m = g;

        do {
          s = this._getDaysInMonth(d, v - 1);
          if (m <= s) break;
          v++, m -= s;
        } while (!0);
      }

      b = this._daylightSavingAdjust(new Date(d, v - 1, m));
      if (b.getFullYear() !== d || b.getMonth() + 1 !== v || b.getDate() !== m) throw "Invalid date";
      return b;
    },
    ATOM: "yy-mm-dd",
    COOKIE: "D, dd M yy",
    ISO_8601: "yy-mm-dd",
    RFC_822: "D, d M y",
    RFC_850: "DD, dd-M-y",
    RFC_1036: "D, d M y",
    RFC_1123: "D, d M yy",
    RFC_2822: "D, d M yy",
    RSS: "D, d M y",
    TICKS: "!",
    TIMESTAMP: "@",
    W3C: "yy-mm-dd",
    _ticksTo1970: (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)) * 24 * 60 * 60 * 1e7,
    formatDate: function formatDate(e, t, n) {
      if (!t) return "";

      var r,
          i = (n ? n.dayNamesShort : null) || this._defaults.dayNamesShort,
          s = (n ? n.dayNames : null) || this._defaults.dayNames,
          o = (n ? n.monthNamesShort : null) || this._defaults.monthNamesShort,
          u = (n ? n.monthNames : null) || this._defaults.monthNames,
          a = function a(t) {
        var n = r + 1 < e.length && e.charAt(r + 1) === t;
        return n && r++, n;
      },
          f = function f(e, t, n) {
        var r = "" + t;
        if (a(e)) while (r.length < n) {
          r = "0" + r;
        }
        return r;
      },
          l = function l(e, t, n, r) {
        return a(e) ? r[t] : n[t];
      },
          c = "",
          h = !1;

      if (t) for (r = 0; r < e.length; r++) {
        if (h) e.charAt(r) === "'" && !a("'") ? h = !1 : c += e.charAt(r);else switch (e.charAt(r)) {
          case "d":
            c += f("d", t.getDate(), 2);
            break;

          case "D":
            c += l("D", t.getDay(), i, s);
            break;

          case "o":
            c += f("o", Math.round((new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5), 3);
            break;

          case "m":
            c += f("m", t.getMonth() + 1, 2);
            break;

          case "M":
            c += l("M", t.getMonth(), o, u);
            break;

          case "y":
            c += a("y") ? t.getFullYear() : (t.getYear() % 100 < 10 ? "0" : "") + t.getYear() % 100;
            break;

          case "@":
            c += t.getTime();
            break;

          case "!":
            c += t.getTime() * 1e4 + this._ticksTo1970;
            break;

          case "'":
            a("'") ? c += "'" : h = !0;
            break;

          default:
            c += e.charAt(r);
        }
      }
      return c;
    },
    _possibleChars: function _possibleChars(e) {
      var t,
          n = "",
          r = !1,
          i = function i(n) {
        var r = t + 1 < e.length && e.charAt(t + 1) === n;
        return r && t++, r;
      };

      for (t = 0; t < e.length; t++) {
        if (r) e.charAt(t) === "'" && !i("'") ? r = !1 : n += e.charAt(t);else switch (e.charAt(t)) {
          case "d":
          case "m":
          case "y":
          case "@":
            n += "0123456789";
            break;

          case "D":
          case "M":
            return null;

          case "'":
            i("'") ? n += "'" : r = !0;
            break;

          default:
            n += e.charAt(t);
        }
      }

      return n;
    },
    _get: function _get(e, n) {
      return e.settings[n] !== t ? e.settings[n] : this._defaults[n];
    },
    _setDateFromField: function _setDateFromField(e, t) {
      if (e.input.val() === e.lastVal) return;

      var n = this._get(e, "dateFormat"),
          r = e.lastVal = e.input ? e.input.val() : null,
          i = this._getDefaultDate(e),
          s = i,
          o = this._getFormatConfig(e);

      try {
        s = this.parseDate(n, r, o) || i;
      } catch (u) {
        r = t ? "" : r;
      }

      e.selectedDay = s.getDate(), e.drawMonth = e.selectedMonth = s.getMonth(), e.drawYear = e.selectedYear = s.getFullYear(), e.currentDay = r ? s.getDate() : 0, e.currentMonth = r ? s.getMonth() : 0, e.currentYear = r ? s.getFullYear() : 0, this._adjustInstDate(e);
    },
    _getDefaultDate: function _getDefaultDate(e) {
      return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date()));
    },
    _determineDate: function _determineDate(t, n, r) {
      var i = function i(e) {
        var t = new Date();
        return t.setDate(t.getDate() + e), t;
      },
          s = function s(n) {
        try {
          return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), n, e.datepicker._getFormatConfig(t));
        } catch (r) {}

        var i = (n.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date(),
            s = i.getFullYear(),
            o = i.getMonth(),
            u = i.getDate(),
            a = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,
            f = a.exec(n);

        while (f) {
          switch (f[2] || "d") {
            case "d":
            case "D":
              u += parseInt(f[1], 10);
              break;

            case "w":
            case "W":
              u += parseInt(f[1], 10) * 7;
              break;

            case "m":
            case "M":
              o += parseInt(f[1], 10), u = Math.min(u, e.datepicker._getDaysInMonth(s, o));
              break;

            case "y":
            case "Y":
              s += parseInt(f[1], 10), u = Math.min(u, e.datepicker._getDaysInMonth(s, o));
          }

          f = a.exec(n);
        }

        return new Date(s, o, u);
      },
          o = n == null || n === "" ? r : typeof n == "string" ? s(n) : typeof n == "number" ? isNaN(n) ? r : i(n) : new Date(n.getTime());

      return o = o && o.toString() === "Invalid Date" ? r : o, o && (o.setHours(0), o.setMinutes(0), o.setSeconds(0), o.setMilliseconds(0)), this._daylightSavingAdjust(o);
    },
    _daylightSavingAdjust: function _daylightSavingAdjust(e) {
      return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null;
    },
    _setDate: function _setDate(e, t, n) {
      var r = !t,
          i = e.selectedMonth,
          s = e.selectedYear,
          o = this._restrictMinMax(e, this._determineDate(e, t, new Date()));

      e.selectedDay = e.currentDay = o.getDate(), e.drawMonth = e.selectedMonth = e.currentMonth = o.getMonth(), e.drawYear = e.selectedYear = e.currentYear = o.getFullYear(), (i !== e.selectedMonth || s !== e.selectedYear) && !n && this._notifyChange(e), this._adjustInstDate(e), e.input && e.input.val(r ? "" : this._formatDate(e));
    },
    _getDate: function _getDate(e) {
      var t = !e.currentYear || e.input && e.input.val() === "" ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
      return t;
    },
    _attachHandlers: function _attachHandlers(t) {
      var n = this._get(t, "stepMonths"),
          i = "#" + t.id.replace(/\\\\/g, "\\");

      t.dpDiv.find("[data-handler]").map(function () {
        var t = {
          prev: function prev() {
            window["DP_jQuery_" + r].datepicker._adjustDate(i, -n, "M");
          },
          next: function next() {
            window["DP_jQuery_" + r].datepicker._adjustDate(i, +n, "M");
          },
          hide: function hide() {
            window["DP_jQuery_" + r].datepicker._hideDatepicker();
          },
          today: function today() {
            window["DP_jQuery_" + r].datepicker._gotoToday(i);
          },
          selectDay: function selectDay() {
            return window["DP_jQuery_" + r].datepicker._selectDay(i, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1;
          },
          selectMonth: function selectMonth() {
            return window["DP_jQuery_" + r].datepicker._selectMonthYear(i, this, "M"), !1;
          },
          selectYear: function selectYear() {
            return window["DP_jQuery_" + r].datepicker._selectMonthYear(i, this, "Y"), !1;
          }
        };
        e(this).bind(this.getAttribute("data-event"), t[this.getAttribute("data-handler")]);
      });
    },
    _generateHTML: function _generateHTML(e) {
      var t,
          n,
          r,
          i,
          s,
          o,
          u,
          a,
          f,
          l,
          c,
          h,
          p,
          d,
          v,
          m,
          g,
          y,
          b,
          w,
          E,
          S,
          x,
          T,
          N,
          C,
          k,
          L,
          A,
          O,
          M,
          _,
          D,
          P,
          H,
          B,
          j,
          F,
          I,
          q = new Date(),
          R = this._daylightSavingAdjust(new Date(q.getFullYear(), q.getMonth(), q.getDate())),
          U = this._get(e, "isRTL"),
          z = this._get(e, "showButtonPanel"),
          W = this._get(e, "hideIfNoPrevNext"),
          X = this._get(e, "navigationAsDateFormat"),
          V = this._getNumberOfMonths(e),
          $ = this._get(e, "showCurrentAtPos"),
          J = this._get(e, "stepMonths"),
          K = V[0] !== 1 || V[1] !== 1,
          Q = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)),
          G = this._getMinMaxDate(e, "min"),
          Y = this._getMinMaxDate(e, "max"),
          Z = e.drawMonth - $,
          et = e.drawYear;

      Z < 0 && (Z += 12, et--);

      if (Y) {
        t = this._daylightSavingAdjust(new Date(Y.getFullYear(), Y.getMonth() - V[0] * V[1] + 1, Y.getDate())), t = G && t < G ? G : t;

        while (this._daylightSavingAdjust(new Date(et, Z, 1)) > t) {
          Z--, Z < 0 && (Z = 11, et--);
        }
      }

      e.drawMonth = Z, e.drawYear = et, n = this._get(e, "prevText"), n = X ? this.formatDate(n, this._daylightSavingAdjust(new Date(et, Z - J, 1)), this._getFormatConfig(e)) : n, r = this._canAdjustMonth(e, -1, et, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>" : W ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>", i = this._get(e, "nextText"), i = X ? this.formatDate(i, this._daylightSavingAdjust(new Date(et, Z + J, 1)), this._getFormatConfig(e)) : i, s = this._canAdjustMonth(e, 1, et, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + i + "</span></a>" : W ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + i + "</span></a>", o = this._get(e, "currentText"), u = this._get(e, "gotoCurrent") && e.currentDay ? Q : R, o = X ? this.formatDate(o, u, this._getFormatConfig(e)) : o, a = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>", f = z ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (U ? a : "") + (this._isInRange(e, u) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + o + "</button>" : "") + (U ? "" : a) + "</div>" : "", l = parseInt(this._get(e, "firstDay"), 10), l = isNaN(l) ? 0 : l, c = this._get(e, "showWeek"), h = this._get(e, "dayNames"), p = this._get(e, "dayNamesMin"), d = this._get(e, "monthNames"), v = this._get(e, "monthNamesShort"), m = this._get(e, "beforeShowDay"), g = this._get(e, "showOtherMonths"), y = this._get(e, "selectOtherMonths"), b = this._getDefaultDate(e), w = "", E;

      for (S = 0; S < V[0]; S++) {
        x = "", this.maxRows = 4;

        for (T = 0; T < V[1]; T++) {
          N = this._daylightSavingAdjust(new Date(et, Z, e.selectedDay)), C = " ui-corner-all", k = "";

          if (K) {
            k += "<div class='ui-datepicker-group";
            if (V[1] > 1) switch (T) {
              case 0:
                k += " ui-datepicker-group-first", C = " ui-corner-" + (U ? "right" : "left");
                break;

              case V[1] - 1:
                k += " ui-datepicker-group-last", C = " ui-corner-" + (U ? "left" : "right");
                break;

              default:
                k += " ui-datepicker-group-middle", C = "";
            }
            k += "'>";
          }

          k += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + C + "'>" + (/all|left/.test(C) && S === 0 ? U ? s : r : "") + (/all|right/.test(C) && S === 0 ? U ? r : s : "") + this._generateMonthYearHeader(e, Z, et, G, Y, S > 0 || T > 0, d, v) + "</div><table class='ui-datepicker-calendar'><thead>" + "<tr>", L = c ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "";

          for (E = 0; E < 7; E++) {
            A = (E + l) % 7, L += "<th" + ((E + l + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + ">" + "<span title='" + h[A] + "'>" + p[A] + "</span></th>";
          }

          k += L + "</tr></thead><tbody>", O = this._getDaysInMonth(et, Z), et === e.selectedYear && Z === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, O)), M = (this._getFirstDayOfMonth(et, Z) - l + 7) % 7, _ = Math.ceil((M + O) / 7), D = K ? this.maxRows > _ ? this.maxRows : _ : _, this.maxRows = D, P = this._daylightSavingAdjust(new Date(et, Z, 1 - M));

          for (H = 0; H < D; H++) {
            k += "<tr>", B = c ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(P) + "</td>" : "";

            for (E = 0; E < 7; E++) {
              j = m ? m.apply(e.input ? e.input[0] : null, [P]) : [!0, ""], F = P.getMonth() !== Z, I = F && !y || !j[0] || G && P < G || Y && P > Y, B += "<td class='" + ((E + l + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (F ? " ui-datepicker-other-month" : "") + (P.getTime() === N.getTime() && Z === e.selectedMonth && e._keyEvent || b.getTime() === P.getTime() && b.getTime() === N.getTime() ? " " + this._dayOverClass : "") + (I ? " " + this._unselectableClass + " ui-state-disabled" : "") + (F && !g ? "" : " " + j[1] + (P.getTime() === Q.getTime() ? " " + this._currentClass : "") + (P.getTime() === R.getTime() ? " ui-datepicker-today" : "")) + "'" + ((!F || g) && j[2] ? " title='" + j[2] + "'" : "") + (I ? "" : " data-handler='selectDay' data-event='click' data-month='" + P.getMonth() + "' data-year='" + P.getFullYear() + "'") + ">" + (F && !g ? "&#xa0;" : I ? "<span class='ui-state-default'>" + P.getDate() + "</span>" : "<a class='ui-state-default" + (P.getTime() === R.getTime() ? " ui-state-highlight" : "") + (P.getTime() === Q.getTime() ? " ui-state-active" : "") + (F ? " ui-priority-secondary" : "") + "' href='#'>" + P.getDate() + "</a>") + "</td>", P.setDate(P.getDate() + 1), P = this._daylightSavingAdjust(P);
            }

            k += B + "</tr>";
          }

          Z++, Z > 11 && (Z = 0, et++), k += "</tbody></table>" + (K ? "</div>" + (V[0] > 0 && T === V[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""), x += k;
        }

        w += x;
      }

      return w += f, e._keyEvent = !1, w;
    },
    _generateMonthYearHeader: function _generateMonthYearHeader(e, t, n, r, i, s, o, u) {
      var a,
          f,
          l,
          c,
          h,
          p,
          d,
          v,
          m = this._get(e, "changeMonth"),
          g = this._get(e, "changeYear"),
          y = this._get(e, "showMonthAfterYear"),
          b = "<div class='ui-datepicker-title'>",
          w = "";

      if (s || !m) w += "<span class='ui-datepicker-month'>" + o[t] + "</span>";else {
        a = r && r.getFullYear() === n, f = i && i.getFullYear() === n, w += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";

        for (l = 0; l < 12; l++) {
          (!a || l >= r.getMonth()) && (!f || l <= i.getMonth()) && (w += "<option value='" + l + "'" + (l === t ? " selected='selected'" : "") + ">" + u[l] + "</option>");
        }

        w += "</select>";
      }
      y || (b += w + (s || !m || !g ? "&#xa0;" : ""));

      if (!e.yearshtml) {
        e.yearshtml = "";
        if (s || !g) b += "<span class='ui-datepicker-year'>" + n + "</span>";else {
          c = this._get(e, "yearRange").split(":"), h = new Date().getFullYear(), p = function p(e) {
            var t = e.match(/c[+\-].*/) ? n + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? h + parseInt(e, 10) : parseInt(e, 10);
            return isNaN(t) ? h : t;
          }, d = p(c[0]), v = Math.max(d, p(c[1] || "")), d = r ? Math.max(d, r.getFullYear()) : d, v = i ? Math.min(v, i.getFullYear()) : v, e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";

          for (; d <= v; d++) {
            e.yearshtml += "<option value='" + d + "'" + (d === n ? " selected='selected'" : "") + ">" + d + "</option>";
          }

          e.yearshtml += "</select>", b += e.yearshtml, e.yearshtml = null;
        }
      }

      return b += this._get(e, "yearSuffix"), y && (b += (s || !m || !g ? "&#xa0;" : "") + w), b += "</div>", b;
    },
    _adjustInstDate: function _adjustInstDate(e, t, n) {
      var r = e.drawYear + (n === "Y" ? t : 0),
          i = e.drawMonth + (n === "M" ? t : 0),
          s = Math.min(e.selectedDay, this._getDaysInMonth(r, i)) + (n === "D" ? t : 0),
          o = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(r, i, s)));

      e.selectedDay = o.getDate(), e.drawMonth = e.selectedMonth = o.getMonth(), e.drawYear = e.selectedYear = o.getFullYear(), (n === "M" || n === "Y") && this._notifyChange(e);
    },
    _restrictMinMax: function _restrictMinMax(e, t) {
      var n = this._getMinMaxDate(e, "min"),
          r = this._getMinMaxDate(e, "max"),
          i = n && t < n ? n : t;

      return r && i > r ? r : i;
    },
    _notifyChange: function _notifyChange(e) {
      var t = this._get(e, "onChangeMonthYear");

      t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e]);
    },
    _getNumberOfMonths: function _getNumberOfMonths(e) {
      var t = this._get(e, "numberOfMonths");

      return t == null ? [1, 1] : typeof t == "number" ? [1, t] : t;
    },
    _getMinMaxDate: function _getMinMaxDate(e, t) {
      return this._determineDate(e, this._get(e, t + "Date"), null);
    },
    _getDaysInMonth: function _getDaysInMonth(e, t) {
      return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate();
    },
    _getFirstDayOfMonth: function _getFirstDayOfMonth(e, t) {
      return new Date(e, t, 1).getDay();
    },
    _canAdjustMonth: function _canAdjustMonth(e, t, n, r) {
      var i = this._getNumberOfMonths(e),
          s = this._daylightSavingAdjust(new Date(n, r + (t < 0 ? t : i[0] * i[1]), 1));

      return t < 0 && s.setDate(this._getDaysInMonth(s.getFullYear(), s.getMonth())), this._isInRange(e, s);
    },
    _isInRange: function _isInRange(e, t) {
      var n,
          r,
          i = this._getMinMaxDate(e, "min"),
          s = this._getMinMaxDate(e, "max"),
          o = null,
          u = null,
          a = this._get(e, "yearRange");

      return a && (n = a.split(":"), r = new Date().getFullYear(), o = parseInt(n[0], 10) + r, u = parseInt(n[1], 10) + r), (!i || t.getTime() >= i.getTime()) && (!s || t.getTime() <= s.getTime()) && (!o || t.getFullYear() >= o) && (!u || t.getFullYear() <= u);
    },
    _getFormatConfig: function _getFormatConfig(e) {
      var t = this._get(e, "shortYearCutoff");

      return t = typeof t != "string" ? t : new Date().getFullYear() % 100 + parseInt(t, 10), {
        shortYearCutoff: t,
        dayNamesShort: this._get(e, "dayNamesShort"),
        dayNames: this._get(e, "dayNames"),
        monthNamesShort: this._get(e, "monthNamesShort"),
        monthNames: this._get(e, "monthNames")
      };
    },
    _formatDate: function _formatDate(e, t, n, r) {
      t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear);
      var i = t ? _typeof(t) == "object" ? t : this._daylightSavingAdjust(new Date(r, n, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
      return this.formatDate(this._get(e, "dateFormat"), i, this._getFormatConfig(e));
    }
  }), e.fn.datepicker = function (t) {
    if (!this.length) return this;
    e.datepicker.initialized || (e(document).mousedown(e.datepicker._checkExternalClick), e.datepicker.initialized = !0), e("#" + e.datepicker._mainDivId).length === 0 && e("body").append(e.datepicker.dpDiv);
    var n = Array.prototype.slice.call(arguments, 1);
    return typeof t != "string" || t !== "isDisabled" && t !== "getDate" && t !== "widget" ? t === "option" && arguments.length === 2 && typeof arguments[1] == "string" ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n)) : this.each(function () {
      typeof t == "string" ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(n)) : e.datepicker._attachDatepicker(this, t);
    }) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n));
  }, e.datepicker = new s(), e.datepicker.initialized = !1, e.datepicker.uuid = new Date().getTime(), e.datepicker.version = "1.10.0", window["DP_jQuery_" + r] = e;
})(jQuery);

(function (e, t) {
  var n = {
    buttons: !0,
    height: !0,
    maxHeight: !0,
    maxWidth: !0,
    minHeight: !0,
    minWidth: !0,
    width: !0
  },
      r = {
    maxHeight: !0,
    maxWidth: !0,
    minHeight: !0,
    minWidth: !0
  };
  e.widget("ui.dialog", {
    version: "1.10.0",
    options: {
      appendTo: "body",
      autoOpen: !0,
      buttons: [],
      closeOnEscape: !0,
      closeText: "close",
      dialogClass: "",
      draggable: !0,
      hide: null,
      height: "auto",
      maxHeight: null,
      maxWidth: null,
      minHeight: 150,
      minWidth: 150,
      modal: !1,
      position: {
        my: "center",
        at: "center",
        of: window,
        collision: "fit",
        using: function using(t) {
          var n = e(this).css(t).offset().top;
          n < 0 && e(this).css("top", t.top - n);
        }
      },
      resizable: !0,
      show: null,
      title: null,
      width: 300,
      beforeClose: null,
      close: null,
      drag: null,
      dragStart: null,
      dragStop: null,
      focus: null,
      open: null,
      resize: null,
      resizeStart: null,
      resizeStop: null
    },
    _create: function _create() {
      this.originalCss = {
        display: this.element[0].style.display,
        width: this.element[0].style.width,
        minHeight: this.element[0].style.minHeight,
        maxHeight: this.element[0].style.maxHeight,
        height: this.element[0].style.height
      }, this.originalPosition = {
        parent: this.element.parent(),
        index: this.element.parent().children().index(this.element)
      }, this.originalTitle = this.element.attr("title"), this.options.title = this.options.title || this.originalTitle, this._createWrapper(), this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog), this._createTitlebar(), this._createButtonPane(), this.options.draggable && e.fn.draggable && this._makeDraggable(), this.options.resizable && e.fn.resizable && this._makeResizable(), this._isOpen = !1;
    },
    _init: function _init() {
      this.options.autoOpen && this.open();
    },
    _appendTo: function _appendTo() {
      var t = this.options.appendTo;
      return t && (t.jquery || t.nodeType) ? e(t) : this.document.find(t || "body").eq(0);
    },
    _destroy: function _destroy() {
      var e,
          t = this.originalPosition;
      this._destroyOverlay(), this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(), this.uiDialog.stop(!0, !0).remove(), this.originalTitle && this.element.attr("title", this.originalTitle), e = t.parent.children().eq(t.index), e.length && e[0] !== this.element[0] ? e.before(this.element) : t.parent.append(this.element);
    },
    widget: function widget() {
      return this.uiDialog;
    },
    disable: e.noop,
    enable: e.noop,
    close: function close(t) {
      var n = this;
      if (!this._isOpen || this._trigger("beforeClose", t) === !1) return;
      this._isOpen = !1, this._destroyOverlay(), this.opener.filter(":focusable").focus().length || e(this.document[0].activeElement).blur(), this._hide(this.uiDialog, this.options.hide, function () {
        n._trigger("close", t);
      });
    },
    isOpen: function isOpen() {
      return this._isOpen;
    },
    moveToTop: function moveToTop() {
      this._moveToTop();
    },
    _moveToTop: function _moveToTop(e, t) {
      var n = !!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
      return n && !t && this._trigger("focus", e), n;
    },
    open: function open() {
      if (this._isOpen) {
        this._moveToTop() && this._focusTabbable();
        return;
      }

      this.opener = e(this.document[0].activeElement), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this._show(this.uiDialog, this.options.show), this._focusTabbable(), this._isOpen = !0, this._trigger("open"), this._trigger("focus");
    },
    _focusTabbable: function _focusTabbable() {
      var e = this.element.find("[autofocus]");
      e.length || (e = this.element.find(":tabbable")), e.length || (e = this.uiDialogButtonPane.find(":tabbable")), e.length || (e = this.uiDialogTitlebarClose.filter(":tabbable")), e.length || (e = this.uiDialog), e.eq(0).focus();
    },
    _keepFocus: function _keepFocus(t) {
      function n() {
        var t = this.document[0].activeElement,
            n = this.uiDialog[0] === t || e.contains(this.uiDialog[0], t);
        n || this._focusTabbable();
      }

      t.preventDefault(), n.call(this), this._delay(n);
    },
    _createWrapper: function _createWrapper() {
      this.uiDialog = e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front " + this.options.dialogClass).hide().attr({
        tabIndex: -1,
        role: "dialog"
      }).appendTo(this._appendTo()), this._on(this.uiDialog, {
        keydown: function keydown(t) {
          if (this.options.closeOnEscape && !t.isDefaultPrevented() && t.keyCode && t.keyCode === e.ui.keyCode.ESCAPE) {
            t.preventDefault(), this.close(t);
            return;
          }

          if (t.keyCode !== e.ui.keyCode.TAB) return;
          var n = this.uiDialog.find(":tabbable"),
              r = n.filter(":first"),
              i = n.filter(":last");
          t.target !== i[0] && t.target !== this.uiDialog[0] || !!t.shiftKey ? (t.target === r[0] || t.target === this.uiDialog[0]) && t.shiftKey && (i.focus(1), t.preventDefault()) : (r.focus(1), t.preventDefault());
        },
        mousedown: function mousedown(e) {
          this._moveToTop(e) && this._focusTabbable();
        }
      }), this.element.find("[aria-describedby]").length || this.uiDialog.attr({
        "aria-describedby": this.element.uniqueId().attr("id")
      });
    },
    _createTitlebar: function _createTitlebar() {
      var t;
      this.uiDialogTitlebar = e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog), this._on(this.uiDialogTitlebar, {
        mousedown: function mousedown(t) {
          e(t.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.focus();
        }
      }), this.uiDialogTitlebarClose = e("<button></button>").button({
        label: this.options.closeText,
        icons: {
          primary: "ui-icon-closethick"
        },
        text: !1
      }).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar), this._on(this.uiDialogTitlebarClose, {
        click: function click(e) {
          e.preventDefault(), this.close(e);
        }
      }), t = e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar), this._title(t), this.uiDialog.attr({
        "aria-labelledby": t.attr("id")
      });
    },
    _title: function _title(e) {
      this.options.title || e.html("&#160;"), e.text(this.options.title);
    },
    _createButtonPane: function _createButtonPane() {
      this.uiDialogButtonPane = e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), this.uiButtonSet = e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane), this._createButtons();
    },
    _createButtons: function _createButtons() {
      var t = this,
          n = this.options.buttons;
      this.uiDialogButtonPane.remove(), this.uiButtonSet.empty();

      if (e.isEmptyObject(n)) {
        this.uiDialog.removeClass("ui-dialog-buttons");
        return;
      }

      e.each(n, function (n, r) {
        var i, s;
        r = e.isFunction(r) ? {
          click: r,
          text: n
        } : r, r = e.extend({
          type: "button"
        }, r), i = r.click, r.click = function () {
          i.apply(t.element[0], arguments);
        }, s = {
          icons: r.icons,
          text: r.showText
        }, delete r.icons, delete r.showText, e("<button></button>", r).button(s).appendTo(t.uiButtonSet);
      }), this.uiDialog.addClass("ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog);
    },
    _makeDraggable: function _makeDraggable() {
      function r(e) {
        return {
          position: e.position,
          offset: e.offset
        };
      }

      var t = this,
          n = this.options;
      this.uiDialog.draggable({
        cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
        handle: ".ui-dialog-titlebar",
        containment: "document",
        start: function start(n, i) {
          e(this).addClass("ui-dialog-dragging"), t._trigger("dragStart", n, r(i));
        },
        drag: function drag(e, n) {
          t._trigger("drag", e, r(n));
        },
        stop: function stop(i, s) {
          n.position = [s.position.left - t.document.scrollLeft(), s.position.top - t.document.scrollTop()], e(this).removeClass("ui-dialog-dragging"), t._trigger("dragStop", i, r(s));
        }
      });
    },
    _makeResizable: function _makeResizable() {
      function o(e) {
        return {
          originalPosition: e.originalPosition,
          originalSize: e.originalSize,
          position: e.position,
          size: e.size
        };
      }

      var t = this,
          n = this.options,
          r = n.resizable,
          i = this.uiDialog.css("position"),
          s = typeof r == "string" ? r : "n,e,s,w,se,sw,ne,nw";
      this.uiDialog.resizable({
        cancel: ".ui-dialog-content",
        containment: "document",
        alsoResize: this.element,
        maxWidth: n.maxWidth,
        maxHeight: n.maxHeight,
        minWidth: n.minWidth,
        minHeight: this._minHeight(),
        handles: s,
        start: function start(n, r) {
          e(this).addClass("ui-dialog-resizing"), t._trigger("resizeStart", n, o(r));
        },
        resize: function resize(e, n) {
          t._trigger("resize", e, o(n));
        },
        stop: function stop(r, i) {
          n.height = e(this).height(), n.width = e(this).width(), e(this).removeClass("ui-dialog-resizing"), t._trigger("resizeStop", r, o(i));
        }
      }).css("position", i);
    },
    _minHeight: function _minHeight() {
      var e = this.options;
      return e.height === "auto" ? e.minHeight : Math.min(e.minHeight, e.height);
    },
    _position: function _position() {
      var e = this.uiDialog.is(":visible");
      e || this.uiDialog.show(), this.uiDialog.position(this.options.position), e || this.uiDialog.hide();
    },
    _setOptions: function _setOptions(t) {
      var i = this,
          s = !1,
          o = {};
      e.each(t, function (e, t) {
        i._setOption(e, t), e in n && (s = !0), e in r && (o[e] = t);
      }), s && (this._size(), this._position()), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", o);
    },
    _setOption: function _setOption(e, t) {
      var n,
          r,
          i = this.uiDialog;
      e === "dialogClass" && i.removeClass(this.options.dialogClass).addClass(t);
      if (e === "disabled") return;
      this._super(e, t), e === "appendTo" && this.uiDialog.appendTo(this._appendTo()), e === "buttons" && this._createButtons(), e === "closeText" && this.uiDialogTitlebarClose.button({
        label: "" + t
      }), e === "draggable" && (n = i.is(":data(ui-draggable)"), n && !t && i.draggable("destroy"), !n && t && this._makeDraggable()), e === "position" && this._position(), e === "resizable" && (r = i.is(":data(ui-resizable)"), r && !t && i.resizable("destroy"), r && typeof t == "string" && i.resizable("option", "handles", t), !r && t !== !1 && this._makeResizable()), e === "title" && this._title(this.uiDialogTitlebar.find(".ui-dialog-title"));
    },
    _size: function _size() {
      var e,
          t,
          n,
          r = this.options;
      this.element.show().css({
        width: "auto",
        minHeight: 0,
        maxHeight: "none",
        height: 0
      }), r.minWidth > r.width && (r.width = r.minWidth), e = this.uiDialog.css({
        height: "auto",
        width: r.width
      }).outerHeight(), t = Math.max(0, r.minHeight - e), n = typeof r.maxHeight == "number" ? Math.max(0, r.maxHeight - e) : "none", r.height === "auto" ? this.element.css({
        minHeight: t,
        maxHeight: n,
        height: "auto"
      }) : this.element.height(Math.max(0, r.height - e)), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight());
    },
    _createOverlay: function _createOverlay() {
      if (!this.options.modal) return;
      e.ui.dialog.overlayInstances || this._delay(function () {
        e.ui.dialog.overlayInstances && this._on(this.document, {
          focusin: function focusin(t) {
            e(t.target).closest(".ui-dialog").length || (t.preventDefault(), e(".ui-dialog:visible:last .ui-dialog-content").data("ui-dialog")._focusTabbable());
          }
        });
      }), this.overlay = e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this.document[0].body), this._on(this.overlay, {
        mousedown: "_keepFocus"
      }), e.ui.dialog.overlayInstances++;
    },
    _destroyOverlay: function _destroyOverlay() {
      if (!this.options.modal) return;
      e.ui.dialog.overlayInstances--, e.ui.dialog.overlayInstances || this._off(this.document, "focusin"), this.overlay.remove();
    }
  }), e.ui.dialog.overlayInstances = 0, e.uiBackCompat !== !1 && e.widget("ui.dialog", e.ui.dialog, {
    _position: function _position() {
      var t = this.options.position,
          n = [],
          r = [0, 0],
          i;

      if (t) {
        if (typeof t == "string" || _typeof(t) == "object" && "0" in t) n = t.split ? t.split(" ") : [t[0], t[1]], n.length === 1 && (n[1] = n[0]), e.each(["left", "top"], function (e, t) {
          +n[e] === n[e] && (r[e] = n[e], n[e] = t);
        }), t = {
          my: n[0] + (r[0] < 0 ? r[0] : "+" + r[0]) + " " + n[1] + (r[1] < 0 ? r[1] : "+" + r[1]),
          at: n.join(" ")
        };
        t = e.extend({}, e.ui.dialog.prototype.options.position, t);
      } else t = e.ui.dialog.prototype.options.position;

      i = this.uiDialog.is(":visible"), i || this.uiDialog.show(), this.uiDialog.position(t), i || this.uiDialog.hide();
    }
  });
})(jQuery);

(function (e, t) {
  e.widget("ui.menu", {
    version: "1.10.0",
    defaultElement: "<ul>",
    delay: 300,
    options: {
      icons: {
        submenu: "ui-icon-carat-1-e"
      },
      menus: "ul",
      position: {
        my: "left top",
        at: "right top"
      },
      role: "menu",
      blur: null,
      focus: null,
      select: null
    },
    _create: function _create() {
      this.activeMenu = this.element, this.mouseHandled = !1, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({
        role: this.options.role,
        tabIndex: 0
      }).bind("click" + this.eventNamespace, e.proxy(function (e) {
        this.options.disabled && e.preventDefault();
      }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({
        "mousedown .ui-menu-item > a": function mousedownUiMenuItemA(e) {
          e.preventDefault();
        },
        "click .ui-state-disabled > a": function clickUiStateDisabledA(e) {
          e.preventDefault();
        },
        "click .ui-menu-item:has(a)": function clickUiMenuItemHasA(t) {
          var n = e(t.target).closest(".ui-menu-item");
          !this.mouseHandled && n.not(".ui-state-disabled").length && (this.mouseHandled = !0, this.select(t), n.has(".ui-menu").length ? this.expand(t) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer)));
        },
        "mouseenter .ui-menu-item": function mouseenterUiMenuItem(t) {
          var n = e(t.currentTarget);
          n.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(t, n);
        },
        mouseleave: "collapseAll",
        "mouseleave .ui-menu": "collapseAll",
        focus: function focus(e, t) {
          var n = this.active || this.element.children(".ui-menu-item").eq(0);
          t || this.focus(e, n);
        },
        blur: function blur(t) {
          this._delay(function () {
            e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t);
          });
        },
        keydown: "_keydown"
      }), this.refresh(), this._on(this.document, {
        click: function click(t) {
          e(t.target).closest(".ui-menu").length || this.collapseAll(t), this.mouseHandled = !1;
        }
      });
    },
    _destroy: function _destroy() {
      this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function () {
        var t = e(this);
        t.data("ui-menu-submenu-carat") && t.remove();
      }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content");
    },
    _keydown: function _keydown(t) {
      function a(e) {
        return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
      }

      var n,
          r,
          i,
          s,
          o,
          u = !0;

      switch (t.keyCode) {
        case e.ui.keyCode.PAGE_UP:
          this.previousPage(t);
          break;

        case e.ui.keyCode.PAGE_DOWN:
          this.nextPage(t);
          break;

        case e.ui.keyCode.HOME:
          this._move("first", "first", t);

          break;

        case e.ui.keyCode.END:
          this._move("last", "last", t);

          break;

        case e.ui.keyCode.UP:
          this.previous(t);
          break;

        case e.ui.keyCode.DOWN:
          this.next(t);
          break;

        case e.ui.keyCode.LEFT:
          this.collapse(t);
          break;

        case e.ui.keyCode.RIGHT:
          this.active && !this.active.is(".ui-state-disabled") && this.expand(t);
          break;

        case e.ui.keyCode.ENTER:
        case e.ui.keyCode.SPACE:
          this._activate(t);

          break;

        case e.ui.keyCode.ESCAPE:
          this.collapse(t);
          break;

        default:
          u = !1, r = this.previousFilter || "", i = String.fromCharCode(t.keyCode), s = !1, clearTimeout(this.filterTimer), i === r ? s = !0 : i = r + i, o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function () {
            return o.test(e(this).children("a").text());
          }), n = s && n.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : n, n.length || (i = String.fromCharCode(t.keyCode), o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function () {
            return o.test(e(this).children("a").text());
          })), n.length ? (this.focus(t, n), n.length > 1 ? (this.previousFilter = i, this.filterTimer = this._delay(function () {
            delete this.previousFilter;
          }, 1e3)) : delete this.previousFilter) : delete this.previousFilter;
      }

      u && t.preventDefault();
    },
    _activate: function _activate(e) {
      this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e));
    },
    refresh: function refresh() {
      var t,
          n = this.options.icons.submenu,
          r = this.element.find(this.options.menus);
      r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({
        role: this.options.role,
        "aria-hidden": "true",
        "aria-expanded": "false"
      }).each(function () {
        var t = e(this),
            r = t.prev("a"),
            i = e("<span>").addClass("ui-menu-icon ui-icon " + n).data("ui-menu-submenu-carat", !0);
        r.attr("aria-haspopup", "true").prepend(i), t.attr("aria-labelledby", r.attr("id"));
      }), t = r.add(this.element), t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({
        tabIndex: -1,
        role: this._itemRole()
      }), t.children(":not(.ui-menu-item)").each(function () {
        var t = e(this);
        /[^\-—–\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider");
      }), t.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !e.contains(this.element[0], this.active[0]) && this.blur();
    },
    _itemRole: function _itemRole() {
      return {
        menu: "menuitem",
        listbox: "option"
      }[this.options.role];
    },
    _setOption: function _setOption(e, t) {
      e === "icons" && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu), this._super(e, t);
    },
    focus: function focus(e, t) {
      var n, r;
      this.blur(e, e && e.type === "focus"), this._scrollIntoView(t), this.active = t.first(), r = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", r.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), e && e.type === "keydown" ? this._close() : this.timer = this._delay(function () {
        this._close();
      }, this.delay), n = t.children(".ui-menu"), n.length && /^mouse/.test(e.type) && this._startOpening(n), this.activeMenu = t.parent(), this._trigger("focus", e, {
        item: t
      });
    },
    _scrollIntoView: function _scrollIntoView(t) {
      var n, r, i, s, o, u;
      this._hasScroll() && (n = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, r = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - n - r, s = this.activeMenu.scrollTop(), o = this.activeMenu.height(), u = t.height(), i < 0 ? this.activeMenu.scrollTop(s + i) : i + u > o && this.activeMenu.scrollTop(s + i - o + u));
    },
    blur: function blur(e, t) {
      t || clearTimeout(this.timer);
      if (!this.active) return;
      this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {
        item: this.active
      });
    },
    _startOpening: function _startOpening(e) {
      clearTimeout(this.timer);
      if (e.attr("aria-hidden") !== "true") return;
      this.timer = this._delay(function () {
        this._close(), this._open(e);
      }, this.delay);
    },
    _open: function _open(t) {
      var n = e.extend({
        of: this.active
      }, this.options.position);
      clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(n);
    },
    collapseAll: function collapseAll(t, n) {
      clearTimeout(this.timer), this.timer = this._delay(function () {
        var r = n ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
        r.length || (r = this.element), this._close(r), this.blur(t), this.activeMenu = r;
      }, this.delay);
    },
    _close: function _close(e) {
      e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active");
    },
    collapse: function collapse(e) {
      var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
      t && t.length && (this._close(), this.focus(e, t));
    },
    expand: function expand(e) {
      var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
      t && t.length && (this._open(t.parent()), this._delay(function () {
        this.focus(e, t);
      }));
    },
    next: function next(e) {
      this._move("next", "first", e);
    },
    previous: function previous(e) {
      this._move("prev", "last", e);
    },
    isFirstItem: function isFirstItem() {
      return this.active && !this.active.prevAll(".ui-menu-item").length;
    },
    isLastItem: function isLastItem() {
      return this.active && !this.active.nextAll(".ui-menu-item").length;
    },
    _move: function _move(e, t, n) {
      var r;
      this.active && (e === "first" || e === "last" ? r = this.active[e === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : r = this.active[e + "All"](".ui-menu-item").eq(0));
      if (!r || !r.length || !this.active) r = this.activeMenu.children(".ui-menu-item")[t]();
      this.focus(n, r);
    },
    nextPage: function nextPage(t) {
      var n, r, i;

      if (!this.active) {
        this.next(t);
        return;
      }

      if (this.isLastItem()) return;
      this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () {
        return n = e(this), n.offset().top - r - i < 0;
      }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]());
    },
    previousPage: function previousPage(t) {
      var n, r, i;

      if (!this.active) {
        this.next(t);
        return;
      }

      if (this.isFirstItem()) return;
      this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () {
        return n = e(this), n.offset().top - r + i > 0;
      }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first());
    },
    _hasScroll: function _hasScroll() {
      return this.element.outerHeight() < this.element.prop("scrollHeight");
    },
    select: function select(t) {
      this.active = this.active || e(t.target).closest(".ui-menu-item");
      var n = {
        item: this.active
      };
      this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, n);
    }
  });
})(jQuery);

(function (e, t) {
  e.widget("ui.progressbar", {
    version: "1.10.0",
    options: {
      max: 100,
      value: 0,
      change: null,
      complete: null
    },
    min: 0,
    _create: function _create() {
      this.oldValue = this.options.value = this._constrainedValue(), this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({
        role: "progressbar",
        "aria-valuemin": this.min
      }), this.valueDiv = e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element), this._refreshValue();
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.valueDiv.remove();
    },
    value: function value(e) {
      if (e === t) return this.options.value;
      this.options.value = this._constrainedValue(e), this._refreshValue();
    },
    _constrainedValue: function _constrainedValue(e) {
      return e === t && (e = this.options.value), this.indeterminate = e === !1, typeof e != "number" && (e = 0), this.indeterminate ? !1 : Math.min(this.options.max, Math.max(this.min, e));
    },
    _setOptions: function _setOptions(e) {
      var t = e.value;
      delete e.value, this._super(e), this.options.value = this._constrainedValue(t), this._refreshValue();
    },
    _setOption: function _setOption(e, t) {
      e === "max" && (t = Math.max(this.min, t)), this._super(e, t);
    },
    _percentage: function _percentage() {
      return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min);
    },
    _refreshValue: function _refreshValue() {
      var t = this.options.value,
          n = this._percentage();

      this.valueDiv.toggle(this.indeterminate || t > this.min).toggleClass("ui-corner-right", t === this.options.max).width(n.toFixed(0) + "%"), this.element.toggleClass("ui-progressbar-indeterminate", this.indeterminate), this.indeterminate ? (this.element.removeAttr("aria-valuenow"), this.overlayDiv || (this.overlayDiv = e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))) : (this.element.attr({
        "aria-valuemax": this.options.max,
        "aria-valuenow": t
      }), this.overlayDiv && (this.overlayDiv.remove(), this.overlayDiv = null)), this.oldValue !== t && (this.oldValue = t, this._trigger("change")), t === this.options.max && this._trigger("complete");
    }
  });
})(jQuery);

(function (e, t) {
  var n = 5;
  e.widget("ui.slider", e.ui.mouse, {
    version: "1.10.0",
    widgetEventPrefix: "slide",
    options: {
      animate: !1,
      distance: 0,
      max: 100,
      min: 0,
      orientation: "horizontal",
      range: !1,
      step: 1,
      value: 0,
      values: null,
      change: null,
      slide: null,
      start: null,
      stop: null
    },
    _create: function _create() {
      var t,
          n,
          r = this.options,
          i = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
          s = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",
          o = [];
      this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all"), this.range = e([]), r.range && (r.range === !0 && (r.values ? r.values.length && r.values.length !== 2 ? r.values = [r.values[0], r.values[0]] : e.isArray(r.values) && (r.values = r.values.slice(0)) : r.values = [this._valueMin(), this._valueMin()]), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + (r.range === "min" || r.range === "max" ? " ui-slider-range-" + r.range : ""))), n = r.values && r.values.length || 1;

      for (t = i.length; t < n; t++) {
        o.push(s);
      }

      this.handles = i.add(e(o.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function (e) {
        e.preventDefault();
      }).mouseenter(function () {
        r.disabled || e(this).addClass("ui-state-hover");
      }).mouseleave(function () {
        e(this).removeClass("ui-state-hover");
      }).focus(function () {
        r.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"));
      }).blur(function () {
        e(this).removeClass("ui-state-focus");
      }), this.handles.each(function (t) {
        e(this).data("ui-slider-handle-index", t);
      }), this._setOption("disabled", r.disabled), this._on(this.handles, this._handleEvents), this._refreshValue(), this._animateOff = !1;
    },
    _destroy: function _destroy() {
      this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy();
    },
    _mouseCapture: function _mouseCapture(t) {
      var n,
          r,
          i,
          s,
          o,
          u,
          a,
          f,
          l = this,
          c = this.options;
      return c.disabled ? !1 : (this.elementSize = {
        width: this.element.outerWidth(),
        height: this.element.outerHeight()
      }, this.elementOffset = this.element.offset(), n = {
        x: t.pageX,
        y: t.pageY
      }, r = this._normValueFromMouse(n), i = this._valueMax() - this._valueMin() + 1, this.handles.each(function (t) {
        var n = Math.abs(r - l.values(t));
        if (i > n || i === n && (t === l._lastChangedValue || l.values(t) === c.min)) i = n, s = e(this), o = t;
      }), u = this._start(t, o), u === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = o, s.addClass("ui-state-active").focus(), a = s.offset(), f = !e(t.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = f ? {
        left: 0,
        top: 0
      } : {
        left: t.pageX - a.left - s.width() / 2,
        top: t.pageY - a.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 10) || 0) + (parseInt(s.css("marginTop"), 10) || 0)
      }, this.handles.hasClass("ui-state-hover") || this._slide(t, o, r), this._animateOff = !0, !0));
    },
    _mouseStart: function _mouseStart() {
      return !0;
    },
    _mouseDrag: function _mouseDrag(e) {
      var t = {
        x: e.pageX,
        y: e.pageY
      },
          n = this._normValueFromMouse(t);

      return this._slide(e, this._handleIndex, n), !1;
    },
    _mouseStop: function _mouseStop(e) {
      return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1;
    },
    _detectOrientation: function _detectOrientation() {
      this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal";
    },
    _normValueFromMouse: function _normValueFromMouse(e) {
      var t, n, r, i, s;
      return this.orientation === "horizontal" ? (t = this.elementSize.width, n = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, n = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), r = n / t, r > 1 && (r = 1), r < 0 && (r = 0), this.orientation === "vertical" && (r = 1 - r), i = this._valueMax() - this._valueMin(), s = this._valueMin() + r * i, this._trimAlignValue(s);
    },
    _start: function _start(e, t) {
      var n = {
        handle: this.handles[t],
        value: this.value()
      };
      return this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("start", e, n);
    },
    _slide: function _slide(e, t, n) {
      var r, i, s;
      this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), this.options.values.length === 2 && this.options.range === !0 && (t === 0 && n > r || t === 1 && n < r) && (n = r), n !== this.values(t) && (i = this.values(), i[t] = n, s = this._trigger("slide", e, {
        handle: this.handles[t],
        value: n,
        values: i
      }), r = this.values(t ? 0 : 1), s !== !1 && this.values(t, n, !0))) : n !== this.value() && (s = this._trigger("slide", e, {
        handle: this.handles[t],
        value: n
      }), s !== !1 && this.value(n));
    },
    _stop: function _stop(e, t) {
      var n = {
        handle: this.handles[t],
        value: this.value()
      };
      this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("stop", e, n);
    },
    _change: function _change(e, t) {
      if (!this._keySliding && !this._mouseSliding) {
        var n = {
          handle: this.handles[t],
          value: this.value()
        };
        this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._lastChangedValue = t, this._trigger("change", e, n);
      }
    },
    value: function value(e) {
      if (arguments.length) {
        this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0);
        return;
      }

      return this._value();
    },
    values: function values(t, n) {
      var r, i, s;

      if (arguments.length > 1) {
        this.options.values[t] = this._trimAlignValue(n), this._refreshValue(), this._change(null, t);
        return;
      }

      if (!arguments.length) return this._values();
      if (!e.isArray(arguments[0])) return this.options.values && this.options.values.length ? this._values(t) : this.value();
      r = this.options.values, i = arguments[0];

      for (s = 0; s < r.length; s += 1) {
        r[s] = this._trimAlignValue(i[s]), this._change(null, s);
      }

      this._refreshValue();
    },
    _setOption: function _setOption(t, n) {
      var r,
          i = 0;
      e.isArray(this.options.values) && (i = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments);

      switch (t) {
        case "disabled":
          n ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.prop("disabled", !0)) : this.handles.prop("disabled", !1);
          break;

        case "orientation":
          this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
          break;

        case "value":
          this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
          break;

        case "values":
          this._animateOff = !0, this._refreshValue();

          for (r = 0; r < i; r += 1) {
            this._change(null, r);
          }

          this._animateOff = !1;
          break;

        case "min":
        case "max":
          this._animateOff = !0, this._refreshValue(), this._animateOff = !1;
      }
    },
    _value: function _value() {
      var e = this.options.value;
      return e = this._trimAlignValue(e), e;
    },
    _values: function _values(e) {
      var t, n, r;
      if (arguments.length) return t = this.options.values[e], t = this._trimAlignValue(t), t;
      n = this.options.values.slice();

      for (r = 0; r < n.length; r += 1) {
        n[r] = this._trimAlignValue(n[r]);
      }

      return n;
    },
    _trimAlignValue: function _trimAlignValue(e) {
      if (e <= this._valueMin()) return this._valueMin();
      if (e >= this._valueMax()) return this._valueMax();
      var t = this.options.step > 0 ? this.options.step : 1,
          n = (e - this._valueMin()) % t,
          r = e - n;
      return Math.abs(n) * 2 >= t && (r += n > 0 ? t : -t), parseFloat(r.toFixed(5));
    },
    _valueMin: function _valueMin() {
      return this.options.min;
    },
    _valueMax: function _valueMax() {
      return this.options.max;
    },
    _refreshValue: function _refreshValue() {
      var t,
          n,
          r,
          i,
          s,
          o = this.options.range,
          u = this.options,
          a = this,
          f = this._animateOff ? !1 : u.animate,
          l = {};
      this.options.values && this.options.values.length ? this.handles.each(function (r) {
        n = (a.values(r) - a._valueMin()) / (a._valueMax() - a._valueMin()) * 100, l[a.orientation === "horizontal" ? "left" : "bottom"] = n + "%", e(this).stop(1, 1)[f ? "animate" : "css"](l, u.animate), a.options.range === !0 && (a.orientation === "horizontal" ? (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({
          left: n + "%"
        }, u.animate), r === 1 && a.range[f ? "animate" : "css"]({
          width: n - t + "%"
        }, {
          queue: !1,
          duration: u.animate
        })) : (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({
          bottom: n + "%"
        }, u.animate), r === 1 && a.range[f ? "animate" : "css"]({
          height: n - t + "%"
        }, {
          queue: !1,
          duration: u.animate
        }))), t = n;
      }) : (r = this.value(), i = this._valueMin(), s = this._valueMax(), n = s !== i ? (r - i) / (s - i) * 100 : 0, l[this.orientation === "horizontal" ? "left" : "bottom"] = n + "%", this.handle.stop(1, 1)[f ? "animate" : "css"](l, u.animate), o === "min" && this.orientation === "horizontal" && this.range.stop(1, 1)[f ? "animate" : "css"]({
        width: n + "%"
      }, u.animate), o === "max" && this.orientation === "horizontal" && this.range[f ? "animate" : "css"]({
        width: 100 - n + "%"
      }, {
        queue: !1,
        duration: u.animate
      }), o === "min" && this.orientation === "vertical" && this.range.stop(1, 1)[f ? "animate" : "css"]({
        height: n + "%"
      }, u.animate), o === "max" && this.orientation === "vertical" && this.range[f ? "animate" : "css"]({
        height: 100 - n + "%"
      }, {
        queue: !1,
        duration: u.animate
      }));
    },
    _handleEvents: {
      keydown: function keydown(t) {
        var r,
            i,
            s,
            o,
            u = e(t.target).data("ui-slider-handle-index");

        switch (t.keyCode) {
          case e.ui.keyCode.HOME:
          case e.ui.keyCode.END:
          case e.ui.keyCode.PAGE_UP:
          case e.ui.keyCode.PAGE_DOWN:
          case e.ui.keyCode.UP:
          case e.ui.keyCode.RIGHT:
          case e.ui.keyCode.DOWN:
          case e.ui.keyCode.LEFT:
            t.preventDefault();

            if (!this._keySliding) {
              this._keySliding = !0, e(t.target).addClass("ui-state-active"), r = this._start(t, u);
              if (r === !1) return;
            }

        }

        o = this.options.step, this.options.values && this.options.values.length ? i = s = this.values(u) : i = s = this.value();

        switch (t.keyCode) {
          case e.ui.keyCode.HOME:
            s = this._valueMin();
            break;

          case e.ui.keyCode.END:
            s = this._valueMax();
            break;

          case e.ui.keyCode.PAGE_UP:
            s = this._trimAlignValue(i + (this._valueMax() - this._valueMin()) / n);
            break;

          case e.ui.keyCode.PAGE_DOWN:
            s = this._trimAlignValue(i - (this._valueMax() - this._valueMin()) / n);
            break;

          case e.ui.keyCode.UP:
          case e.ui.keyCode.RIGHT:
            if (i === this._valueMax()) return;
            s = this._trimAlignValue(i + o);
            break;

          case e.ui.keyCode.DOWN:
          case e.ui.keyCode.LEFT:
            if (i === this._valueMin()) return;
            s = this._trimAlignValue(i - o);
        }

        this._slide(t, u, s);
      },
      keyup: function keyup(t) {
        var n = e(t.target).data("ui-slider-handle-index");
        this._keySliding && (this._keySliding = !1, this._stop(t, n), this._change(t, n), e(t.target).removeClass("ui-state-active"));
      }
    }
  });
})(jQuery);

(function (e) {
  function t(e) {
    return function () {
      var t = this.element.val();
      e.apply(this, arguments), this._refresh(), t !== this.element.val() && this._trigger("change");
    };
  }

  e.widget("ui.spinner", {
    version: "1.10.0",
    defaultElement: "<input>",
    widgetEventPrefix: "spin",
    options: {
      culture: null,
      icons: {
        down: "ui-icon-triangle-1-s",
        up: "ui-icon-triangle-1-n"
      },
      incremental: !0,
      max: null,
      min: null,
      numberFormat: null,
      page: 10,
      step: 1,
      change: null,
      spin: null,
      start: null,
      stop: null
    },
    _create: function _create() {
      this._setOption("max", this.options.max), this._setOption("min", this.options.min), this._setOption("step", this.options.step), this._value(this.element.val(), !0), this._draw(), this._on(this._events), this._refresh(), this._on(this.window, {
        beforeunload: function beforeunload() {
          this.element.removeAttr("autocomplete");
        }
      });
    },
    _getCreateOptions: function _getCreateOptions() {
      var t = {},
          n = this.element;
      return e.each(["min", "max", "step"], function (e, r) {
        var i = n.attr(r);
        i !== undefined && i.length && (t[r] = i);
      }), t;
    },
    _events: {
      keydown: function keydown(e) {
        this._start(e) && this._keydown(e) && e.preventDefault();
      },
      keyup: "_stop",
      focus: function focus() {
        this.previous = this.element.val();
      },
      blur: function blur(e) {
        if (this.cancelBlur) {
          delete this.cancelBlur;
          return;
        }

        this._refresh(), this.previous !== this.element.val() && this._trigger("change", e);
      },
      mousewheel: function mousewheel(e, t) {
        if (!t) return;
        if (!this.spinning && !this._start(e)) return !1;
        this._spin((t > 0 ? 1 : -1) * this.options.step, e), clearTimeout(this.mousewheelTimer), this.mousewheelTimer = this._delay(function () {
          this.spinning && this._stop(e);
        }, 100), e.preventDefault();
      },
      "mousedown .ui-spinner-button": function mousedownUiSpinnerButton(t) {
        function r() {
          var e = this.element[0] === this.document[0].activeElement;
          e || (this.element.focus(), this.previous = n, this._delay(function () {
            this.previous = n;
          }));
        }

        var n;
        n = this.element[0] === this.document[0].activeElement ? this.previous : this.element.val(), t.preventDefault(), r.call(this), this.cancelBlur = !0, this._delay(function () {
          delete this.cancelBlur, r.call(this);
        });
        if (this._start(t) === !1) return;

        this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t);
      },
      "mouseup .ui-spinner-button": "_stop",
      "mouseenter .ui-spinner-button": function mouseenterUiSpinnerButton(t) {
        if (!e(t.currentTarget).hasClass("ui-state-active")) return;
        if (this._start(t) === !1) return !1;

        this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t);
      },
      "mouseleave .ui-spinner-button": "_stop"
    },
    _draw: function _draw() {
      var e = this.uiSpinner = this.element.addClass("ui-spinner-input").attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());
      this.element.attr("role", "spinbutton"), this.buttons = e.find(".ui-spinner-button").attr("tabIndex", -1).button().removeClass("ui-corner-all"), this.buttons.height() > Math.ceil(e.height() * .5) && e.height() > 0 && e.height(e.height()), this.options.disabled && this.disable();
    },
    _keydown: function _keydown(t) {
      var n = this.options,
          r = e.ui.keyCode;

      switch (t.keyCode) {
        case r.UP:
          return this._repeat(null, 1, t), !0;

        case r.DOWN:
          return this._repeat(null, -1, t), !0;

        case r.PAGE_UP:
          return this._repeat(null, n.page, t), !0;

        case r.PAGE_DOWN:
          return this._repeat(null, -n.page, t), !0;
      }

      return !1;
    },
    _uiSpinnerHtml: function _uiSpinnerHtml() {
      return "<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>";
    },
    _buttonHtml: function _buttonHtml() {
      return "<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon " + this.options.icons.up + "'>&#9650;</span>" + "</a>" + "<a class='ui-spinner-button ui-spinner-down ui-corner-br'>" + "<span class='ui-icon " + this.options.icons.down + "'>&#9660;</span>" + "</a>";
    },
    _start: function _start(e) {
      return !this.spinning && this._trigger("start", e) === !1 ? !1 : (this.counter || (this.counter = 1), this.spinning = !0, !0);
    },
    _repeat: function _repeat(e, t, n) {
      e = e || 500, clearTimeout(this.timer), this.timer = this._delay(function () {
        this._repeat(40, t, n);
      }, e), this._spin(t * this.options.step, n);
    },
    _spin: function _spin(e, t) {
      var n = this.value() || 0;
      this.counter || (this.counter = 1), n = this._adjustValue(n + e * this._increment(this.counter));
      if (!this.spinning || this._trigger("spin", t, {
        value: n
      }) !== !1) this._value(n), this.counter++;
    },
    _increment: function _increment(t) {
      var n = this.options.incremental;
      return n ? e.isFunction(n) ? n(t) : Math.floor(t * t * t / 5e4 - t * t / 500 + 17 * t / 200 + 1) : 1;
    },
    _precision: function _precision() {
      var e = this._precisionOf(this.options.step);

      return this.options.min !== null && (e = Math.max(e, this._precisionOf(this.options.min))), e;
    },
    _precisionOf: function _precisionOf(e) {
      var t = e.toString(),
          n = t.indexOf(".");
      return n === -1 ? 0 : t.length - n - 1;
    },
    _adjustValue: function _adjustValue(e) {
      var t,
          n,
          r = this.options;
      return t = r.min !== null ? r.min : 0, n = e - t, n = Math.round(n / r.step) * r.step, e = t + n, e = parseFloat(e.toFixed(this._precision())), r.max !== null && e > r.max ? r.max : r.min !== null && e < r.min ? r.min : e;
    },
    _stop: function _stop(e) {
      if (!this.spinning) return;
      clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", e);
    },
    _setOption: function _setOption(e, t) {
      if (e === "culture" || e === "numberFormat") {
        var n = this._parse(this.element.val());

        this.options[e] = t, this.element.val(this._format(n));
        return;
      }

      (e === "max" || e === "min" || e === "step") && typeof t == "string" && (t = this._parse(t)), e === "icons" && (this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up), this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)), this._super(e, t), e === "disabled" && (t ? (this.element.prop("disabled", !0), this.buttons.button("disable")) : (this.element.prop("disabled", !1), this.buttons.button("enable")));
    },
    _setOptions: t(function (e) {
      this._super(e), this._value(this.element.val());
    }),
    _parse: function _parse(e) {
      return typeof e == "string" && e !== "" && (e = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(e, 10, this.options.culture) : +e), e === "" || isNaN(e) ? null : e;
    },
    _format: function _format(e) {
      return e === "" ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(e, this.options.numberFormat, this.options.culture) : e;
    },
    _refresh: function _refresh() {
      this.element.attr({
        "aria-valuemin": this.options.min,
        "aria-valuemax": this.options.max,
        "aria-valuenow": this._parse(this.element.val())
      });
    },
    _value: function _value(e, t) {
      var n;
      e !== "" && (n = this._parse(e), n !== null && (t || (n = this._adjustValue(n)), e = this._format(n))), this.element.val(e), this._refresh();
    },
    _destroy: function _destroy() {
      this.element.removeClass("ui-spinner-input").prop("disabled", !1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.uiSpinner.replaceWith(this.element);
    },
    stepUp: t(function (e) {
      this._stepUp(e);
    }),
    _stepUp: function _stepUp(e) {
      this._start() && (this._spin((e || 1) * this.options.step), this._stop());
    },
    stepDown: t(function (e) {
      this._stepDown(e);
    }),
    _stepDown: function _stepDown(e) {
      this._start() && (this._spin((e || 1) * -this.options.step), this._stop());
    },
    pageUp: t(function (e) {
      this._stepUp((e || 1) * this.options.page);
    }),
    pageDown: t(function (e) {
      this._stepDown((e || 1) * this.options.page);
    }),
    value: function value(e) {
      if (!arguments.length) return this._parse(this.element.val());
      t(this._value).call(this, e);
    },
    widget: function widget() {
      return this.uiSpinner;
    }
  });
})(jQuery);

(function (e, t) {
  function i() {
    return ++n;
  }

  function s(e) {
    return e.hash.length > 1 && decodeURIComponent(e.href.replace(r, "")) === decodeURIComponent(location.href.replace(r, ""));
  }

  var n = 0,
      r = /#.*$/;
  e.widget("ui.tabs", {
    version: "1.10.0",
    delay: 300,
    options: {
      active: null,
      collapsible: !1,
      event: "click",
      heightStyle: "content",
      hide: null,
      show: null,
      activate: null,
      beforeActivate: null,
      beforeLoad: null,
      load: null
    },
    _create: function _create() {
      var t = this,
          n = this.options;
      this.running = !1, this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", n.collapsible).delegate(".ui-tabs-nav > li", "mousedown" + this.eventNamespace, function (t) {
        e(this).is(".ui-state-disabled") && t.preventDefault();
      }).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, function () {
        e(this).closest("li").is(".ui-state-disabled") && this.blur();
      }), this._processTabs(), n.active = this._initialActive(), e.isArray(n.disabled) && (n.disabled = e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), function (e) {
        return t.tabs.index(e);
      }))).sort()), this.options.active !== !1 && this.anchors.length ? this.active = this._findActive(n.active) : this.active = e(), this._refresh(), this.active.length && this.load(n.active);
    },
    _initialActive: function _initialActive() {
      var t = this.options.active,
          n = this.options.collapsible,
          r = location.hash.substring(1);

      if (t === null) {
        r && this.tabs.each(function (n, i) {
          if (e(i).attr("aria-controls") === r) return t = n, !1;
        }), t === null && (t = this.tabs.index(this.tabs.filter(".ui-tabs-active")));
        if (t === null || t === -1) t = this.tabs.length ? 0 : !1;
      }

      return t !== !1 && (t = this.tabs.index(this.tabs.eq(t)), t === -1 && (t = n ? !1 : 0)), !n && t === !1 && this.anchors.length && (t = 0), t;
    },
    _getCreateEventData: function _getCreateEventData() {
      return {
        tab: this.active,
        panel: this.active.length ? this._getPanelForTab(this.active) : e()
      };
    },
    _tabKeydown: function _tabKeydown(t) {
      var n = e(this.document[0].activeElement).closest("li"),
          r = this.tabs.index(n),
          i = !0;
      if (this._handlePageNav(t)) return;

      switch (t.keyCode) {
        case e.ui.keyCode.RIGHT:
        case e.ui.keyCode.DOWN:
          r++;
          break;

        case e.ui.keyCode.UP:
        case e.ui.keyCode.LEFT:
          i = !1, r--;
          break;

        case e.ui.keyCode.END:
          r = this.anchors.length - 1;
          break;

        case e.ui.keyCode.HOME:
          r = 0;
          break;

        case e.ui.keyCode.SPACE:
          t.preventDefault(), clearTimeout(this.activating), this._activate(r);
          return;

        case e.ui.keyCode.ENTER:
          t.preventDefault(), clearTimeout(this.activating), this._activate(r === this.options.active ? !1 : r);
          return;

        default:
          return;
      }

      t.preventDefault(), clearTimeout(this.activating), r = this._focusNextTab(r, i), t.ctrlKey || (n.attr("aria-selected", "false"), this.tabs.eq(r).attr("aria-selected", "true"), this.activating = this._delay(function () {
        this.option("active", r);
      }, this.delay));
    },
    _panelKeydown: function _panelKeydown(t) {
      if (this._handlePageNav(t)) return;
      t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), this.active.focus());
    },
    _handlePageNav: function _handlePageNav(t) {
      if (t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP) return this._activate(this._focusNextTab(this.options.active - 1, !1)), !0;
      if (t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN) return this._activate(this._focusNextTab(this.options.active + 1, !0)), !0;
    },
    _findNextTab: function _findNextTab(t, n) {
      function i() {
        return t > r && (t = 0), t < 0 && (t = r), t;
      }

      var r = this.tabs.length - 1;

      while (e.inArray(i(), this.options.disabled) !== -1) {
        t = n ? t + 1 : t - 1;
      }

      return t;
    },
    _focusNextTab: function _focusNextTab(e, t) {
      return e = this._findNextTab(e, t), this.tabs.eq(e).focus(), e;
    },
    _setOption: function _setOption(e, t) {
      if (e === "active") {
        this._activate(t);

        return;
      }

      if (e === "disabled") {
        this._setupDisabled(t);

        return;
      }

      this._super(e, t), e === "collapsible" && (this.element.toggleClass("ui-tabs-collapsible", t), !t && this.options.active === !1 && this._activate(0)), e === "event" && this._setupEvents(t), e === "heightStyle" && this._setupHeightStyle(t);
    },
    _tabId: function _tabId(e) {
      return e.attr("aria-controls") || "ui-tabs-" + i();
    },
    _sanitizeSelector: function _sanitizeSelector(e) {
      return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : "";
    },
    refresh: function refresh() {
      var t = this.options,
          n = this.tablist.children(":has(a[href])");
      t.disabled = e.map(n.filter(".ui-state-disabled"), function (e) {
        return n.index(e);
      }), this._processTabs(), t.active === !1 || !this.anchors.length ? (t.active = !1, this.active = e()) : this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active), this._refresh();
    },
    _refresh: function _refresh() {
      this._setupDisabled(this.options.disabled), this._setupEvents(this.options.event), this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({
        "aria-selected": "false",
        tabIndex: -1
      }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
        "aria-selected": "true",
        tabIndex: 0
      }), this._getPanelForTab(this.active).show().attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      })) : this.tabs.eq(0).attr("tabIndex", 0);
    },
    _processTabs: function _processTabs() {
      var t = this;
      this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist"), this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
        role: "tab",
        tabIndex: -1
      }), this.anchors = this.tabs.map(function () {
        return e("a", this)[0];
      }).addClass("ui-tabs-anchor").attr({
        role: "presentation",
        tabIndex: -1
      }), this.panels = e(), this.anchors.each(function (n, r) {
        var i,
            o,
            u,
            a = e(r).uniqueId().attr("id"),
            f = e(r).closest("li"),
            l = f.attr("aria-controls");
        s(r) ? (i = r.hash, o = t.element.find(t._sanitizeSelector(i))) : (u = t._tabId(f), i = "#" + u, o = t.element.find(i), o.length || (o = t._createPanel(u), o.insertAfter(t.panels[n - 1] || t.tablist)), o.attr("aria-live", "polite")), o.length && (t.panels = t.panels.add(o)), l && f.data("ui-tabs-aria-controls", l), f.attr({
          "aria-controls": i.substring(1),
          "aria-labelledby": a
        }), o.attr("aria-labelledby", a);
      }), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel");
    },
    _getList: function _getList() {
      return this.element.find("ol,ul").eq(0);
    },
    _createPanel: function _createPanel(t) {
      return e("<div>").attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0);
    },
    _setupDisabled: function _setupDisabled(t) {
      e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1);

      for (var n = 0, r; r = this.tabs[n]; n++) {
        t === !0 || e.inArray(n, t) !== -1 ? e(r).addClass("ui-state-disabled").attr("aria-disabled", "true") : e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");
      }

      this.options.disabled = t;
    },
    _setupEvents: function _setupEvents(t) {
      var n = {
        click: function click(e) {
          e.preventDefault();
        }
      };
      t && e.each(t.split(" "), function (e, t) {
        n[t] = "_eventHandler";
      }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(this.anchors, n), this._on(this.tabs, {
        keydown: "_tabKeydown"
      }), this._on(this.panels, {
        keydown: "_panelKeydown"
      }), this._focusable(this.tabs), this._hoverable(this.tabs);
    },
    _setupHeightStyle: function _setupHeightStyle(t) {
      var n,
          r = this.element.parent();
      t === "fill" ? (n = r.height(), n -= this.element.outerHeight() - this.element.height(), this.element.siblings(":visible").each(function () {
        var t = e(this),
            r = t.css("position");
        if (r === "absolute" || r === "fixed") return;
        n -= t.outerHeight(!0);
      }), this.element.children().not(this.panels).each(function () {
        n -= e(this).outerHeight(!0);
      }), this.panels.each(function () {
        e(this).height(Math.max(0, n - e(this).innerHeight() + e(this).height()));
      }).css("overflow", "auto")) : t === "auto" && (n = 0, this.panels.each(function () {
        n = Math.max(n, e(this).height("").height());
      }).height(n));
    },
    _eventHandler: function _eventHandler(t) {
      var n = this.options,
          r = this.active,
          i = e(t.currentTarget),
          s = i.closest("li"),
          o = s[0] === r[0],
          u = o && n.collapsible,
          a = u ? e() : this._getPanelForTab(s),
          f = r.length ? this._getPanelForTab(r) : e(),
          l = {
        oldTab: r,
        oldPanel: f,
        newTab: u ? e() : s,
        newPanel: a
      };
      t.preventDefault();
      if (s.hasClass("ui-state-disabled") || s.hasClass("ui-tabs-loading") || this.running || o && !n.collapsible || this._trigger("beforeActivate", t, l) === !1) return;
      n.active = u ? !1 : this.tabs.index(s), this.active = o ? e() : s, this.xhr && this.xhr.abort(), !f.length && !a.length && e.error("jQuery UI Tabs: Mismatching fragment identifier."), a.length && this.load(this.tabs.index(s), t), this._toggle(t, l);
    },
    _toggle: function _toggle(t, n) {
      function o() {
        r.running = !1, r._trigger("activate", t, n);
      }

      function u() {
        n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), i.length && r.options.show ? r._show(i, r.options.show, o) : (i.show(), o());
      }

      var r = this,
          i = n.newPanel,
          s = n.oldPanel;
      this.running = !0, s.length && this.options.hide ? this._hide(s, this.options.hide, function () {
        n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), u();
      }) : (n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), s.hide(), u()), s.attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), n.oldTab.attr("aria-selected", "false"), i.length && s.length ? n.oldTab.attr("tabIndex", -1) : i.length && this.tabs.filter(function () {
        return e(this).attr("tabIndex") === 0;
      }).attr("tabIndex", -1), i.attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }), n.newTab.attr({
        "aria-selected": "true",
        tabIndex: 0
      });
    },
    _activate: function _activate(t) {
      var n,
          r = this._findActive(t);

      if (r[0] === this.active[0]) return;
      r.length || (r = this.active), n = r.find(".ui-tabs-anchor")[0], this._eventHandler({
        target: n,
        currentTarget: n,
        preventDefault: e.noop
      });
    },
    _findActive: function _findActive(t) {
      return t === !1 ? e() : this.tabs.eq(t);
    },
    _getIndex: function _getIndex(e) {
      return typeof e == "string" && (e = this.anchors.index(this.anchors.filter("[href$='" + e + "']"))), e;
    },
    _destroy: function _destroy() {
      this.xhr && this.xhr.abort(), this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"), this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"), this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(), this.tabs.add(this.panels).each(function () {
        e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role");
      }), this.tabs.each(function () {
        var t = e(this),
            n = t.data("ui-tabs-aria-controls");
        n ? t.attr("aria-controls", n).removeData("ui-tabs-aria-controls") : t.removeAttr("aria-controls");
      }), this.panels.show(), this.options.heightStyle !== "content" && this.panels.css("height", "");
    },
    enable: function enable(n) {
      var r = this.options.disabled;
      if (r === !1) return;
      n === t ? r = !1 : (n = this._getIndex(n), e.isArray(r) ? r = e.map(r, function (e) {
        return e !== n ? e : null;
      }) : r = e.map(this.tabs, function (e, t) {
        return t !== n ? t : null;
      })), this._setupDisabled(r);
    },
    disable: function disable(n) {
      var r = this.options.disabled;
      if (r === !0) return;
      if (n === t) r = !0;else {
        n = this._getIndex(n);
        if (e.inArray(n, r) !== -1) return;
        e.isArray(r) ? r = e.merge([n], r).sort() : r = [n];
      }

      this._setupDisabled(r);
    },
    load: function load(t, n) {
      t = this._getIndex(t);

      var r = this,
          i = this.tabs.eq(t),
          o = i.find(".ui-tabs-anchor"),
          u = this._getPanelForTab(i),
          a = {
        tab: i,
        panel: u
      };

      if (s(o[0])) return;
      this.xhr = e.ajax(this._ajaxSettings(o, n, a)), this.xhr && this.xhr.statusText !== "canceled" && (i.addClass("ui-tabs-loading"), u.attr("aria-busy", "true"), this.xhr.success(function (e) {
        setTimeout(function () {
          u.html(e), r._trigger("load", n, a);
        }, 1);
      }).complete(function (e, t) {
        setTimeout(function () {
          t === "abort" && r.panels.stop(!1, !0), i.removeClass("ui-tabs-loading"), u.removeAttr("aria-busy"), e === r.xhr && delete r.xhr;
        }, 1);
      }));
    },
    _ajaxSettings: function _ajaxSettings(t, n, r) {
      var i = this;
      return {
        url: t.attr("href"),
        beforeSend: function beforeSend(t, s) {
          return i._trigger("beforeLoad", n, e.extend({
            jqXHR: t,
            ajaxSettings: s
          }, r));
        }
      };
    },
    _getPanelForTab: function _getPanelForTab(t) {
      var n = e(t).attr("aria-controls");
      return this.element.find(this._sanitizeSelector("#" + n));
    }
  });
})(jQuery);

(function (e) {
  function n(t, n) {
    var r = (t.attr("aria-describedby") || "").split(/\s+/);
    r.push(n), t.data("ui-tooltip-id", n).attr("aria-describedby", e.trim(r.join(" ")));
  }

  function r(t) {
    var n = t.data("ui-tooltip-id"),
        r = (t.attr("aria-describedby") || "").split(/\s+/),
        i = e.inArray(n, r);
    i !== -1 && r.splice(i, 1), t.removeData("ui-tooltip-id"), r = e.trim(r.join(" ")), r ? t.attr("aria-describedby", r) : t.removeAttr("aria-describedby");
  }

  var t = 0;
  e.widget("ui.tooltip", {
    version: "1.10.0",
    options: {
      content: function content() {
        var t = e(this).attr("title") || "";
        return e("<a>").text(t).html();
      },
      hide: !0,
      items: "[title]:not([disabled])",
      position: {
        my: "left top+15",
        at: "left bottom",
        collision: "flipfit flip"
      },
      show: !0,
      tooltipClass: null,
      track: !1,
      close: null,
      open: null
    },
    _create: function _create() {
      this._on({
        mouseover: "open",
        focusin: "open"
      }), this.tooltips = {}, this.parents = {}, this.options.disabled && this._disable();
    },
    _setOption: function _setOption(t, n) {
      var r = this;

      if (t === "disabled") {
        this[n ? "_disable" : "_enable"](), this.options[t] = n;
        return;
      }

      this._super(t, n), t === "content" && e.each(this.tooltips, function (e, t) {
        r._updateContent(t);
      });
    },
    _disable: function _disable() {
      var t = this;
      e.each(this.tooltips, function (n, r) {
        var i = e.Event("blur");
        i.target = i.currentTarget = r[0], t.close(i, !0);
      }), this.element.find(this.options.items).addBack().each(function () {
        var t = e(this);
        t.is("[title]") && t.data("ui-tooltip-title", t.attr("title")).attr("title", "");
      });
    },
    _enable: function _enable() {
      this.element.find(this.options.items).addBack().each(function () {
        var t = e(this);
        t.data("ui-tooltip-title") && t.attr("title", t.data("ui-tooltip-title"));
      });
    },
    open: function open(t) {
      var n = this,
          r = e(t ? t.target : this.element).closest(this.options.items);
      if (!r.length || r.data("ui-tooltip-id")) return;
      r.attr("title") && r.data("ui-tooltip-title", r.attr("title")), r.data("ui-tooltip-open", !0), t && t.type === "mouseover" && r.parents().each(function () {
        var t = e(this),
            r;
        t.data("ui-tooltip-open") && (r = e.Event("blur"), r.target = r.currentTarget = this, n.close(r, !0)), t.attr("title") && (t.uniqueId(), n.parents[this.id] = {
          element: this,
          title: t.attr("title")
        }, t.attr("title", ""));
      }), this._updateContent(r, t);
    },
    _updateContent: function _updateContent(e, t) {
      var n,
          r = this.options.content,
          i = this,
          s = t ? t.type : null;
      if (typeof r == "string") return this._open(t, e, r);
      n = r.call(e[0], function (n) {
        if (!e.data("ui-tooltip-open")) return;

        i._delay(function () {
          t && (t.type = s), this._open(t, e, n);
        });
      }), n && this._open(t, e, n);
    },
    _open: function _open(t, r, i) {
      function f(e) {
        a.of = e;
        if (s.is(":hidden")) return;
        s.position(a);
      }

      var s,
          o,
          u,
          a = e.extend({}, this.options.position);
      if (!i) return;
      s = this._find(r);

      if (s.length) {
        s.find(".ui-tooltip-content").html(i);
        return;
      }

      r.is("[title]") && (t && t.type === "mouseover" ? r.attr("title", "") : r.removeAttr("title")), s = this._tooltip(r), n(r, s.attr("id")), s.find(".ui-tooltip-content").html(i), this.options.track && t && /^mouse/.test(t.type) ? (this._on(this.document, {
        mousemove: f
      }), f(t)) : s.position(e.extend({
        of: r
      }, this.options.position)), s.hide(), this._show(s, this.options.show), this.options.show && this.options.show.delay && (u = this.delayedShow = setInterval(function () {
        s.is(":visible") && (f(a.of), clearInterval(u));
      }, e.fx.interval)), this._trigger("open", t, {
        tooltip: s
      }), o = {
        keyup: function keyup(t) {
          if (t.keyCode === e.ui.keyCode.ESCAPE) {
            var n = e.Event(t);
            n.currentTarget = r[0], this.close(n, !0);
          }
        },
        remove: function remove() {
          this._removeTooltip(s);
        }
      };
      if (!t || t.type === "mouseover") o.mouseleave = "close";
      if (!t || t.type === "focusin") o.focusout = "close";

      this._on(!0, r, o);
    },
    close: function close(t) {
      var n = this,
          i = e(t ? t.currentTarget : this.element),
          s = this._find(i);

      if (this.closing) return;
      clearInterval(this.delayedShow), i.data("ui-tooltip-title") && i.attr("title", i.data("ui-tooltip-title")), r(i), s.stop(!0), this._hide(s, this.options.hide, function () {
        n._removeTooltip(e(this));
      }), i.removeData("ui-tooltip-open"), this._off(i, "mouseleave focusout keyup"), i[0] !== this.element[0] && this._off(i, "remove"), this._off(this.document, "mousemove"), t && t.type === "mouseleave" && e.each(this.parents, function (t, r) {
        e(r.element).attr("title", r.title), delete n.parents[t];
      }), this.closing = !0, this._trigger("close", t, {
        tooltip: s
      }), this.closing = !1;
    },
    _tooltip: function _tooltip(n) {
      var r = "ui-tooltip-" + t++,
          i = e("<div>").attr({
        id: r,
        role: "tooltip"
      }).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content " + (this.options.tooltipClass || ""));
      return e("<div>").addClass("ui-tooltip-content").appendTo(i), i.appendTo(this.document[0].body), this.tooltips[r] = n, i;
    },
    _find: function _find(t) {
      var n = t.data("ui-tooltip-id");
      return n ? e("#" + n) : e();
    },
    _removeTooltip: function _removeTooltip(e) {
      e.remove(), delete this.tooltips[e.attr("id")];
    },
    _destroy: function _destroy() {
      var t = this;
      e.each(this.tooltips, function (n, r) {
        var i = e.Event("blur");
        i.target = i.currentTarget = r[0], t.close(i, !0), e("#" + n).remove(), r.data("ui-tooltip-title") && (r.attr("title", r.data("ui-tooltip-title")), r.removeData("ui-tooltip-title"));
      });
    }
  });
})(jQuery);

jQuery.effects || function (e, t) {
  var n = "ui-effects-";
  e.effects = {
    effect: {}
  }, function (e, t) {
    function h(e, t, n) {
      var r = u[t.type] || {};
      return e == null ? n || !t.def ? null : t.def : (e = r.floor ? ~~e : parseFloat(e), isNaN(e) ? t.def : r.mod ? (e + r.mod) % r.mod : 0 > e ? 0 : r.max < e ? r.max : e);
    }

    function p(t) {
      var n = s(),
          r = n._rgba = [];
      return t = t.toLowerCase(), c(i, function (e, i) {
        var s,
            u = i.re.exec(t),
            a = u && i.parse(u),
            f = i.space || "rgba";
        if (a) return s = n[f](a), n[o[f].cache] = s[o[f].cache], r = n._rgba = s._rgba, !1;
      }), r.length ? (r.join() === "0,0,0,0" && e.extend(r, l.transparent), n) : l[t];
    }

    function d(e, t, n) {
      return n = (n + 1) % 1, n * 6 < 1 ? e + (t - e) * n * 6 : n * 2 < 1 ? t : n * 3 < 2 ? e + (t - e) * (2 / 3 - n) * 6 : e;
    }

    var n = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",
        r = /^([\-+])=\s*(\d+\.?\d*)/,
        i = [{
      re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
      parse: function parse(e) {
        return [e[1], e[2], e[3], e[4]];
      }
    }, {
      re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
      parse: function parse(e) {
        return [e[1] * 2.55, e[2] * 2.55, e[3] * 2.55, e[4]];
      }
    }, {
      re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
      parse: function parse(e) {
        return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)];
      }
    }, {
      re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,
      parse: function parse(e) {
        return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)];
      }
    }, {
      re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
      space: "hsla",
      parse: function parse(e) {
        return [e[1], e[2] / 100, e[3] / 100, e[4]];
      }
    }],
        s = e.Color = function (t, n, r, i) {
      return new e.Color.fn.parse(t, n, r, i);
    },
        o = {
      rgba: {
        props: {
          red: {
            idx: 0,
            type: "byte"
          },
          green: {
            idx: 1,
            type: "byte"
          },
          blue: {
            idx: 2,
            type: "byte"
          }
        }
      },
      hsla: {
        props: {
          hue: {
            idx: 0,
            type: "degrees"
          },
          saturation: {
            idx: 1,
            type: "percent"
          },
          lightness: {
            idx: 2,
            type: "percent"
          }
        }
      }
    },
        u = {
      "byte": {
        floor: !0,
        max: 255
      },
      percent: {
        max: 1
      },
      degrees: {
        mod: 360,
        floor: !0
      }
    },
        a = s.support = {},
        f = e("<p>")[0],
        l,
        c = e.each;

    f.style.cssText = "background-color:rgba(1,1,1,.5)", a.rgba = f.style.backgroundColor.indexOf("rgba") > -1, c(o, function (e, t) {
      t.cache = "_" + e, t.props.alpha = {
        idx: 3,
        type: "percent",
        def: 1
      };
    }), s.fn = e.extend(s.prototype, {
      parse: function parse(n, r, i, u) {
        if (n === t) return this._rgba = [null, null, null, null], this;
        if (n.jquery || n.nodeType) n = e(n).css(r), r = t;
        var a = this,
            f = e.type(n),
            d = this._rgba = [];
        r !== t && (n = [n, r, i, u], f = "array");
        if (f === "string") return this.parse(p(n) || l._default);
        if (f === "array") return c(o.rgba.props, function (e, t) {
          d[t.idx] = h(n[t.idx], t);
        }), this;
        if (f === "object") return n instanceof s ? c(o, function (e, t) {
          n[t.cache] && (a[t.cache] = n[t.cache].slice());
        }) : c(o, function (t, r) {
          var i = r.cache;
          c(r.props, function (e, t) {
            if (!a[i] && r.to) {
              if (e === "alpha" || n[e] == null) return;
              a[i] = r.to(a._rgba);
            }

            a[i][t.idx] = h(n[e], t, !0);
          }), a[i] && e.inArray(null, a[i].slice(0, 3)) < 0 && (a[i][3] = 1, r.from && (a._rgba = r.from(a[i])));
        }), this;
      },
      is: function is(e) {
        var t = s(e),
            n = !0,
            r = this;
        return c(o, function (e, i) {
          var s,
              o = t[i.cache];
          return o && (s = r[i.cache] || i.to && i.to(r._rgba) || [], c(i.props, function (e, t) {
            if (o[t.idx] != null) return n = o[t.idx] === s[t.idx], n;
          })), n;
        }), n;
      },
      _space: function _space() {
        var e = [],
            t = this;
        return c(o, function (n, r) {
          t[r.cache] && e.push(n);
        }), e.pop();
      },
      transition: function transition(e, t) {
        var n = s(e),
            r = n._space(),
            i = o[r],
            a = this.alpha() === 0 ? s("transparent") : this,
            f = a[i.cache] || i.to(a._rgba),
            l = f.slice();

        return n = n[i.cache], c(i.props, function (e, r) {
          var i = r.idx,
              s = f[i],
              o = n[i],
              a = u[r.type] || {};
          if (o === null) return;
          s === null ? l[i] = o : (a.mod && (o - s > a.mod / 2 ? s += a.mod : s - o > a.mod / 2 && (s -= a.mod)), l[i] = h((o - s) * t + s, r));
        }), this[r](l);
      },
      blend: function blend(t) {
        if (this._rgba[3] === 1) return this;

        var n = this._rgba.slice(),
            r = n.pop(),
            i = s(t)._rgba;

        return s(e.map(n, function (e, t) {
          return (1 - r) * i[t] + r * e;
        }));
      },
      toRgbaString: function toRgbaString() {
        var t = "rgba(",
            n = e.map(this._rgba, function (e, t) {
          return e == null ? t > 2 ? 1 : 0 : e;
        });
        return n[3] === 1 && (n.pop(), t = "rgb("), t + n.join() + ")";
      },
      toHslaString: function toHslaString() {
        var t = "hsla(",
            n = e.map(this.hsla(), function (e, t) {
          return e == null && (e = t > 2 ? 1 : 0), t && t < 3 && (e = Math.round(e * 100) + "%"), e;
        });
        return n[3] === 1 && (n.pop(), t = "hsl("), t + n.join() + ")";
      },
      toHexString: function toHexString(t) {
        var n = this._rgba.slice(),
            r = n.pop();

        return t && n.push(~~(r * 255)), "#" + e.map(n, function (e) {
          return e = (e || 0).toString(16), e.length === 1 ? "0" + e : e;
        }).join("");
      },
      toString: function toString() {
        return this._rgba[3] === 0 ? "transparent" : this.toRgbaString();
      }
    }), s.fn.parse.prototype = s.fn, o.hsla.to = function (e) {
      if (e[0] == null || e[1] == null || e[2] == null) return [null, null, null, e[3]];
      var t = e[0] / 255,
          n = e[1] / 255,
          r = e[2] / 255,
          i = e[3],
          s = Math.max(t, n, r),
          o = Math.min(t, n, r),
          u = s - o,
          a = s + o,
          f = a * .5,
          l,
          c;
      return o === s ? l = 0 : t === s ? l = 60 * (n - r) / u + 360 : n === s ? l = 60 * (r - t) / u + 120 : l = 60 * (t - n) / u + 240, u === 0 ? c = 0 : f <= .5 ? c = u / a : c = u / (2 - a), [Math.round(l) % 360, c, f, i == null ? 1 : i];
    }, o.hsla.from = function (e) {
      if (e[0] == null || e[1] == null || e[2] == null) return [null, null, null, e[3]];
      var t = e[0] / 360,
          n = e[1],
          r = e[2],
          i = e[3],
          s = r <= .5 ? r * (1 + n) : r + n - r * n,
          o = 2 * r - s;
      return [Math.round(d(o, s, t + 1 / 3) * 255), Math.round(d(o, s, t) * 255), Math.round(d(o, s, t - 1 / 3) * 255), i];
    }, c(o, function (n, i) {
      var o = i.props,
          u = i.cache,
          a = i.to,
          f = i.from;
      s.fn[n] = function (n) {
        a && !this[u] && (this[u] = a(this._rgba));
        if (n === t) return this[u].slice();
        var r,
            i = e.type(n),
            l = i === "array" || i === "object" ? n : arguments,
            p = this[u].slice();
        return c(o, function (e, t) {
          var n = l[i === "object" ? e : t.idx];
          n == null && (n = p[t.idx]), p[t.idx] = h(n, t);
        }), f ? (r = s(f(p)), r[u] = p, r) : s(p);
      }, c(o, function (t, i) {
        if (s.fn[t]) return;

        s.fn[t] = function (s) {
          var o = e.type(s),
              u = t === "alpha" ? this._hsla ? "hsla" : "rgba" : n,
              a = this[u](),
              f = a[i.idx],
              l;
          return o === "undefined" ? f : (o === "function" && (s = s.call(this, f), o = e.type(s)), s == null && i.empty ? this : (o === "string" && (l = r.exec(s), l && (s = f + parseFloat(l[2]) * (l[1] === "+" ? 1 : -1))), a[i.idx] = s, this[u](a)));
        };
      });
    }), s.hook = function (t) {
      var n = t.split(" ");
      c(n, function (t, n) {
        e.cssHooks[n] = {
          set: function set(t, r) {
            var i,
                o,
                u = "";

            if (r !== "transparent" && (e.type(r) !== "string" || (i = p(r)))) {
              r = s(i || r);

              if (!a.rgba && r._rgba[3] !== 1) {
                o = n === "backgroundColor" ? t.parentNode : t;

                while ((u === "" || u === "transparent") && o && o.style) {
                  try {
                    u = e.css(o, "backgroundColor"), o = o.parentNode;
                  } catch (f) {}
                }

                r = r.blend(u && u !== "transparent" ? u : "_default");
              }

              r = r.toRgbaString();
            }

            try {
              t.style[n] = r;
            } catch (f) {}
          }
        }, e.fx.step[n] = function (t) {
          t.colorInit || (t.start = s(t.elem, n), t.end = s(t.end), t.colorInit = !0), e.cssHooks[n].set(t.elem, t.start.transition(t.end, t.pos));
        };
      });
    }, s.hook(n), e.cssHooks.borderColor = {
      expand: function expand(e) {
        var t = {};
        return c(["Top", "Right", "Bottom", "Left"], function (n, r) {
          t["border" + r + "Color"] = e;
        }), t;
      }
    }, l = e.Color.names = {
      aqua: "#00ffff",
      black: "#000000",
      blue: "#0000ff",
      fuchsia: "#ff00ff",
      gray: "#808080",
      green: "#008000",
      lime: "#00ff00",
      maroon: "#800000",
      navy: "#000080",
      olive: "#808000",
      purple: "#800080",
      red: "#ff0000",
      silver: "#c0c0c0",
      teal: "#008080",
      white: "#ffffff",
      yellow: "#ffff00",
      transparent: [null, null, null, 0],
      _default: "#ffffff"
    };
  }(jQuery), function () {
    function i(t) {
      var n,
          r,
          i = t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle,
          s = {};

      if (i && i.length && i[0] && i[i[0]]) {
        r = i.length;

        while (r--) {
          n = i[r], typeof i[n] == "string" && (s[e.camelCase(n)] = i[n]);
        }
      } else for (n in i) {
        typeof i[n] == "string" && (s[n] = i[n]);
      }

      return s;
    }

    function s(t, n) {
      var i = {},
          s,
          o;

      for (s in n) {
        o = n[s], t[s] !== o && !r[s] && (e.fx.step[s] || !isNaN(parseFloat(o))) && (i[s] = o);
      }

      return i;
    }

    var n = ["add", "remove", "toggle"],
        r = {
      border: 1,
      borderBottom: 1,
      borderColor: 1,
      borderLeft: 1,
      borderRight: 1,
      borderTop: 1,
      borderWidth: 1,
      margin: 1,
      padding: 1
    };
    e.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function (t, n) {
      e.fx.step[n] = function (e) {
        if (e.end !== "none" && !e.setAttr || e.pos === 1 && !e.setAttr) jQuery.style(e.elem, n, e.end), e.setAttr = !0;
      };
    }), e.fn.addBack || (e.fn.addBack = function (e) {
      return this.add(e == null ? this.prevObject : this.prevObject.filter(e));
    }), e.effects.animateClass = function (t, r, o, u) {
      var a = e.speed(r, o, u);
      return this.queue(function () {
        var r = e(this),
            o = r.attr("class") || "",
            u,
            f = a.children ? r.find("*").addBack() : r;
        f = f.map(function () {
          var t = e(this);
          return {
            el: t,
            start: i(this)
          };
        }), u = function u() {
          e.each(n, function (e, n) {
            t[n] && r[n + "Class"](t[n]);
          });
        }, u(), f = f.map(function () {
          return this.end = i(this.el[0]), this.diff = s(this.start, this.end), this;
        }), r.attr("class", o), f = f.map(function () {
          var t = this,
              n = e.Deferred(),
              r = e.extend({}, a, {
            queue: !1,
            complete: function complete() {
              n.resolve(t);
            }
          });
          return this.el.animate(this.diff, r), n.promise();
        }), e.when.apply(e, f.get()).done(function () {
          u(), e.each(arguments, function () {
            var t = this.el;
            e.each(this.diff, function (e) {
              t.css(e, "");
            });
          }), a.complete.call(r[0]);
        });
      });
    }, e.fn.extend({
      _addClass: e.fn.addClass,
      addClass: function addClass(t, n, r, i) {
        return n ? e.effects.animateClass.call(this, {
          add: t
        }, n, r, i) : this._addClass(t);
      },
      _removeClass: e.fn.removeClass,
      removeClass: function removeClass(t, n, r, i) {
        return n ? e.effects.animateClass.call(this, {
          remove: t
        }, n, r, i) : this._removeClass(t);
      },
      _toggleClass: e.fn.toggleClass,
      toggleClass: function toggleClass(n, r, i, s, o) {
        return typeof r == "boolean" || r === t ? i ? e.effects.animateClass.call(this, r ? {
          add: n
        } : {
          remove: n
        }, i, s, o) : this._toggleClass(n, r) : e.effects.animateClass.call(this, {
          toggle: n
        }, r, i, s);
      },
      switchClass: function switchClass(t, n, r, i, s) {
        return e.effects.animateClass.call(this, {
          add: n,
          remove: t
        }, r, i, s);
      }
    });
  }(), function () {
    function r(t, n, r, i) {
      e.isPlainObject(t) && (n = t, t = t.effect), t = {
        effect: t
      }, n == null && (n = {}), e.isFunction(n) && (i = n, r = null, n = {});
      if (typeof n == "number" || e.fx.speeds[n]) i = r, r = n, n = {};
      return e.isFunction(r) && (i = r, r = null), n && e.extend(t, n), r = r || n.duration, t.duration = e.fx.off ? 0 : typeof r == "number" ? r : r in e.fx.speeds ? e.fx.speeds[r] : e.fx.speeds._default, t.complete = i || n.complete, t;
    }

    function i(t) {
      return !t || typeof t == "number" || e.fx.speeds[t] ? !0 : typeof t == "string" && !e.effects.effect[t];
    }

    e.extend(e.effects, {
      version: "1.10.0",
      save: function save(e, t) {
        for (var r = 0; r < t.length; r++) {
          t[r] !== null && e.data(n + t[r], e[0].style[t[r]]);
        }
      },
      restore: function restore(e, r) {
        var i, s;

        for (s = 0; s < r.length; s++) {
          r[s] !== null && (i = e.data(n + r[s]), i === t && (i = ""), e.css(r[s], i));
        }
      },
      setMode: function setMode(e, t) {
        return t === "toggle" && (t = e.is(":hidden") ? "show" : "hide"), t;
      },
      getBaseline: function getBaseline(e, t) {
        var n, r;

        switch (e[0]) {
          case "top":
            n = 0;
            break;

          case "middle":
            n = .5;
            break;

          case "bottom":
            n = 1;
            break;

          default:
            n = e[0] / t.height;
        }

        switch (e[1]) {
          case "left":
            r = 0;
            break;

          case "center":
            r = .5;
            break;

          case "right":
            r = 1;
            break;

          default:
            r = e[1] / t.width;
        }

        return {
          x: r,
          y: n
        };
      },
      createWrapper: function createWrapper(t) {
        if (t.parent().is(".ui-effects-wrapper")) return t.parent();
        var n = {
          width: t.outerWidth(!0),
          height: t.outerHeight(!0),
          "float": t.css("float")
        },
            r = e("<div></div>").addClass("ui-effects-wrapper").css({
          fontSize: "100%",
          background: "transparent",
          border: "none",
          margin: 0,
          padding: 0
        }),
            i = {
          width: t.width(),
          height: t.height()
        },
            s = document.activeElement;

        try {
          s.id;
        } catch (o) {
          s = document.body;
        }

        return t.wrap(r), (t[0] === s || e.contains(t[0], s)) && e(s).focus(), r = t.parent(), t.css("position") === "static" ? (r.css({
          position: "relative"
        }), t.css({
          position: "relative"
        })) : (e.extend(n, {
          position: t.css("position"),
          zIndex: t.css("z-index")
        }), e.each(["top", "left", "bottom", "right"], function (e, r) {
          n[r] = t.css(r), isNaN(parseInt(n[r], 10)) && (n[r] = "auto");
        }), t.css({
          position: "relative",
          top: 0,
          left: 0,
          right: "auto",
          bottom: "auto"
        })), t.css(i), r.css(n).show();
      },
      removeWrapper: function removeWrapper(t) {
        var n = document.activeElement;
        return t.parent().is(".ui-effects-wrapper") && (t.parent().replaceWith(t), (t[0] === n || e.contains(t[0], n)) && e(n).focus()), t;
      },
      setTransition: function setTransition(t, n, r, i) {
        return i = i || {}, e.each(n, function (e, n) {
          var s = t.cssUnit(n);
          s[0] > 0 && (i[n] = s[0] * r + s[1]);
        }), i;
      }
    }), e.fn.extend({
      effect: function effect() {
        function o(n) {
          function u() {
            e.isFunction(i) && i.call(r[0]), e.isFunction(n) && n();
          }

          var r = e(this),
              i = t.complete,
              o = t.mode;
          (r.is(":hidden") ? o === "hide" : o === "show") ? u() : s.call(r[0], t, u);
        }

        var t = r.apply(this, arguments),
            n = t.mode,
            i = t.queue,
            s = e.effects.effect[t.effect];
        return e.fx.off || !s ? n ? this[n](t.duration, t.complete) : this.each(function () {
          t.complete && t.complete.call(this);
        }) : i === !1 ? this.each(o) : this.queue(i || "fx", o);
      },
      _show: e.fn.show,
      show: function show(e) {
        if (i(e)) return this._show.apply(this, arguments);
        var t = r.apply(this, arguments);
        return t.mode = "show", this.effect.call(this, t);
      },
      _hide: e.fn.hide,
      hide: function hide(e) {
        if (i(e)) return this._hide.apply(this, arguments);
        var t = r.apply(this, arguments);
        return t.mode = "hide", this.effect.call(this, t);
      },
      __toggle: e.fn.toggle,
      toggle: function toggle(t) {
        if (i(t) || typeof t == "boolean" || e.isFunction(t)) return this.__toggle.apply(this, arguments);
        var n = r.apply(this, arguments);
        return n.mode = "toggle", this.effect.call(this, n);
      },
      cssUnit: function cssUnit(t) {
        var n = this.css(t),
            r = [];
        return e.each(["em", "px", "%", "pt"], function (e, t) {
          n.indexOf(t) > 0 && (r = [parseFloat(n), t]);
        }), r;
      }
    });
  }(), function () {
    var t = {};
    e.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function (e, n) {
      t[n] = function (t) {
        return Math.pow(t, e + 2);
      };
    }), e.extend(t, {
      Sine: function Sine(e) {
        return 1 - Math.cos(e * Math.PI / 2);
      },
      Circ: function Circ(e) {
        return 1 - Math.sqrt(1 - e * e);
      },
      Elastic: function Elastic(e) {
        return e === 0 || e === 1 ? e : -Math.pow(2, 8 * (e - 1)) * Math.sin(((e - 1) * 80 - 7.5) * Math.PI / 15);
      },
      Back: function Back(e) {
        return e * e * (3 * e - 2);
      },
      Bounce: function Bounce(e) {
        var t,
            n = 4;

        while (e < ((t = Math.pow(2, --n)) - 1) / 11) {
          ;
        }

        return 1 / Math.pow(4, 3 - n) - 7.5625 * Math.pow((t * 3 - 2) / 22 - e, 2);
      }
    }), e.each(t, function (t, n) {
      e.easing["easeIn" + t] = n, e.easing["easeOut" + t] = function (e) {
        return 1 - n(1 - e);
      }, e.easing["easeInOut" + t] = function (e) {
        return e < .5 ? n(e * 2) / 2 : 1 - n(e * -2 + 2) / 2;
      };
    });
  }();
}(jQuery);

(function (e, t) {
  var n = /up|down|vertical/,
      r = /up|left|vertical|horizontal/;

  e.effects.effect.blind = function (t, i) {
    var s = e(this),
        o = ["position", "top", "bottom", "left", "right", "height", "width"],
        u = e.effects.setMode(s, t.mode || "hide"),
        a = t.direction || "up",
        f = n.test(a),
        l = f ? "height" : "width",
        c = f ? "top" : "left",
        h = r.test(a),
        p = {},
        d = u === "show",
        v,
        m,
        g;
    s.parent().is(".ui-effects-wrapper") ? e.effects.save(s.parent(), o) : e.effects.save(s, o), s.show(), v = e.effects.createWrapper(s).css({
      overflow: "hidden"
    }), m = v[l](), g = parseFloat(v.css(c)) || 0, p[l] = d ? m : 0, h || (s.css(f ? "bottom" : "right", 0).css(f ? "top" : "left", "auto").css({
      position: "absolute"
    }), p[c] = d ? g : m + g), d && (v.css(l, 0), h || v.css(c, g + m)), v.animate(p, {
      duration: t.duration,
      easing: t.easing,
      queue: !1,
      complete: function complete() {
        u === "hide" && s.hide(), e.effects.restore(s, o), e.effects.removeWrapper(s), i();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.bounce = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "height", "width"],
        s = e.effects.setMode(r, t.mode || "effect"),
        o = s === "hide",
        u = s === "show",
        a = t.direction || "up",
        f = t.distance,
        l = t.times || 5,
        c = l * 2 + (u || o ? 1 : 0),
        h = t.duration / c,
        p = t.easing,
        d = a === "up" || a === "down" ? "top" : "left",
        v = a === "up" || a === "left",
        m,
        g,
        y,
        b = r.queue(),
        w = b.length;
    (u || o) && i.push("opacity"), e.effects.save(r, i), r.show(), e.effects.createWrapper(r), f || (f = r[d === "top" ? "outerHeight" : "outerWidth"]() / 3), u && (y = {
      opacity: 1
    }, y[d] = 0, r.css("opacity", 0).css(d, v ? -f * 2 : f * 2).animate(y, h, p)), o && (f /= Math.pow(2, l - 1)), y = {}, y[d] = 0;

    for (m = 0; m < l; m++) {
      g = {}, g[d] = (v ? "-=" : "+=") + f, r.animate(g, h, p).animate(y, h, p), f = o ? f * 2 : f / 2;
    }

    o && (g = {
      opacity: 0
    }, g[d] = (v ? "-=" : "+=") + f, r.animate(g, h, p)), r.queue(function () {
      o && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
    }), w > 1 && b.splice.apply(b, [1, 0].concat(b.splice(w, c + 1))), r.dequeue();
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.clip = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "height", "width"],
        s = e.effects.setMode(r, t.mode || "hide"),
        o = s === "show",
        u = t.direction || "vertical",
        a = u === "vertical",
        f = a ? "height" : "width",
        l = a ? "top" : "left",
        c = {},
        h,
        p,
        d;
    e.effects.save(r, i), r.show(), h = e.effects.createWrapper(r).css({
      overflow: "hidden"
    }), p = r[0].tagName === "IMG" ? h : r, d = p[f](), o && (p.css(f, 0), p.css(l, d / 2)), c[f] = o ? d : 0, c[l] = o ? 0 : d / 2, p.animate(c, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: function complete() {
        o || r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.drop = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"],
        s = e.effects.setMode(r, t.mode || "hide"),
        o = s === "show",
        u = t.direction || "left",
        a = u === "up" || u === "down" ? "top" : "left",
        f = u === "up" || u === "left" ? "pos" : "neg",
        l = {
      opacity: o ? 1 : 0
    },
        c;
    e.effects.save(r, i), r.show(), e.effects.createWrapper(r), c = t.distance || r[a === "top" ? "outerHeight" : "outerWidth"](!0) / 2, o && r.css("opacity", 0).css(a, f === "pos" ? -c : c), l[a] = (o ? f === "pos" ? "+=" : "-=" : f === "pos" ? "-=" : "+=") + c, r.animate(l, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: function complete() {
        s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.explode = function (t, n) {
    function y() {
      c.push(this), c.length === r * i && b();
    }

    function b() {
      s.css({
        visibility: "visible"
      }), e(c).remove(), u || s.hide(), n();
    }

    var r = t.pieces ? Math.round(Math.sqrt(t.pieces)) : 3,
        i = r,
        s = e(this),
        o = e.effects.setMode(s, t.mode || "hide"),
        u = o === "show",
        a = s.show().css("visibility", "hidden").offset(),
        f = Math.ceil(s.outerWidth() / i),
        l = Math.ceil(s.outerHeight() / r),
        c = [],
        h,
        p,
        d,
        v,
        m,
        g;

    for (h = 0; h < r; h++) {
      v = a.top + h * l, g = h - (r - 1) / 2;

      for (p = 0; p < i; p++) {
        d = a.left + p * f, m = p - (i - 1) / 2, s.clone().appendTo("body").wrap("<div></div>").css({
          position: "absolute",
          visibility: "visible",
          left: -p * f,
          top: -h * l
        }).parent().addClass("ui-effects-explode").css({
          position: "absolute",
          overflow: "hidden",
          width: f,
          height: l,
          left: d + (u ? m * f : 0),
          top: v + (u ? g * l : 0),
          opacity: u ? 0 : 1
        }).animate({
          left: d + (u ? 0 : m * f),
          top: v + (u ? 0 : g * l),
          opacity: u ? 1 : 0
        }, t.duration || 500, t.easing, y);
      }
    }
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.fade = function (t, n) {
    var r = e(this),
        i = e.effects.setMode(r, t.mode || "toggle");
    r.animate({
      opacity: i
    }, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: n
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.fold = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "height", "width"],
        s = e.effects.setMode(r, t.mode || "hide"),
        o = s === "show",
        u = s === "hide",
        a = t.size || 15,
        f = /([0-9]+)%/.exec(a),
        l = !!t.horizFirst,
        c = o !== l,
        h = c ? ["width", "height"] : ["height", "width"],
        p = t.duration / 2,
        d,
        v,
        m = {},
        g = {};
    e.effects.save(r, i), r.show(), d = e.effects.createWrapper(r).css({
      overflow: "hidden"
    }), v = c ? [d.width(), d.height()] : [d.height(), d.width()], f && (a = parseInt(f[1], 10) / 100 * v[u ? 0 : 1]), o && d.css(l ? {
      height: 0,
      width: a
    } : {
      height: a,
      width: 0
    }), m[h[0]] = o ? v[0] : a, g[h[1]] = o ? v[1] : 0, d.animate(m, p, t.easing).animate(g, p, t.easing, function () {
      u && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.highlight = function (t, n) {
    var r = e(this),
        i = ["backgroundImage", "backgroundColor", "opacity"],
        s = e.effects.setMode(r, t.mode || "show"),
        o = {
      backgroundColor: r.css("backgroundColor")
    };
    s === "hide" && (o.opacity = 0), e.effects.save(r, i), r.show().css({
      backgroundImage: "none",
      backgroundColor: t.color || "#ffff99"
    }).animate(o, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: function complete() {
        s === "hide" && r.hide(), e.effects.restore(r, i), n();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.pulsate = function (t, n) {
    var r = e(this),
        i = e.effects.setMode(r, t.mode || "show"),
        s = i === "show",
        o = i === "hide",
        u = s || i === "hide",
        a = (t.times || 5) * 2 + (u ? 1 : 0),
        f = t.duration / a,
        l = 0,
        c = r.queue(),
        h = c.length,
        p;
    if (s || !r.is(":visible")) r.css("opacity", 0).show(), l = 1;

    for (p = 1; p < a; p++) {
      r.animate({
        opacity: l
      }, f, t.easing), l = 1 - l;
    }

    r.animate({
      opacity: l
    }, f, t.easing), r.queue(function () {
      o && r.hide(), n();
    }), h > 1 && c.splice.apply(c, [1, 0].concat(c.splice(h, a + 1))), r.dequeue();
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.puff = function (t, n) {
    var r = e(this),
        i = e.effects.setMode(r, t.mode || "hide"),
        s = i === "hide",
        o = parseInt(t.percent, 10) || 150,
        u = o / 100,
        a = {
      height: r.height(),
      width: r.width(),
      outerHeight: r.outerHeight(),
      outerWidth: r.outerWidth()
    };
    e.extend(t, {
      effect: "scale",
      queue: !1,
      fade: !0,
      mode: i,
      complete: n,
      percent: s ? o : 100,
      from: s ? a : {
        height: a.height * u,
        width: a.width * u,
        outerHeight: a.outerHeight * u,
        outerWidth: a.outerWidth * u
      }
    }), r.effect(t);
  }, e.effects.effect.scale = function (t, n) {
    var r = e(this),
        i = e.extend(!0, {}, t),
        s = e.effects.setMode(r, t.mode || "effect"),
        o = parseInt(t.percent, 10) || (parseInt(t.percent, 10) === 0 ? 0 : s === "hide" ? 0 : 100),
        u = t.direction || "both",
        a = t.origin,
        f = {
      height: r.height(),
      width: r.width(),
      outerHeight: r.outerHeight(),
      outerWidth: r.outerWidth()
    },
        l = {
      y: u !== "horizontal" ? o / 100 : 1,
      x: u !== "vertical" ? o / 100 : 1
    };
    i.effect = "size", i.queue = !1, i.complete = n, s !== "effect" && (i.origin = a || ["middle", "center"], i.restore = !0), i.from = t.from || (s === "show" ? {
      height: 0,
      width: 0,
      outerHeight: 0,
      outerWidth: 0
    } : f), i.to = {
      height: f.height * l.y,
      width: f.width * l.x,
      outerHeight: f.outerHeight * l.y,
      outerWidth: f.outerWidth * l.x
    }, i.fade && (s === "show" && (i.from.opacity = 0, i.to.opacity = 1), s === "hide" && (i.from.opacity = 1, i.to.opacity = 0)), r.effect(i);
  }, e.effects.effect.size = function (t, n) {
    var r,
        i,
        s,
        o = e(this),
        u = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"],
        a = ["position", "top", "bottom", "left", "right", "overflow", "opacity"],
        f = ["width", "height", "overflow"],
        l = ["fontSize"],
        c = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"],
        h = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"],
        p = e.effects.setMode(o, t.mode || "effect"),
        d = t.restore || p !== "effect",
        v = t.scale || "both",
        m = t.origin || ["middle", "center"],
        g = o.css("position"),
        y = d ? u : a,
        b = {
      height: 0,
      width: 0,
      outerHeight: 0,
      outerWidth: 0
    };
    p === "show" && o.show(), r = {
      height: o.height(),
      width: o.width(),
      outerHeight: o.outerHeight(),
      outerWidth: o.outerWidth()
    }, t.mode === "toggle" && p === "show" ? (o.from = t.to || b, o.to = t.from || r) : (o.from = t.from || (p === "show" ? b : r), o.to = t.to || (p === "hide" ? b : r)), s = {
      from: {
        y: o.from.height / r.height,
        x: o.from.width / r.width
      },
      to: {
        y: o.to.height / r.height,
        x: o.to.width / r.width
      }
    };
    if (v === "box" || v === "both") s.from.y !== s.to.y && (y = y.concat(c), o.from = e.effects.setTransition(o, c, s.from.y, o.from), o.to = e.effects.setTransition(o, c, s.to.y, o.to)), s.from.x !== s.to.x && (y = y.concat(h), o.from = e.effects.setTransition(o, h, s.from.x, o.from), o.to = e.effects.setTransition(o, h, s.to.x, o.to));
    (v === "content" || v === "both") && s.from.y !== s.to.y && (y = y.concat(l).concat(f), o.from = e.effects.setTransition(o, l, s.from.y, o.from), o.to = e.effects.setTransition(o, l, s.to.y, o.to)), e.effects.save(o, y), o.show(), e.effects.createWrapper(o), o.css("overflow", "hidden").css(o.from), m && (i = e.effects.getBaseline(m, r), o.from.top = (r.outerHeight - o.outerHeight()) * i.y, o.from.left = (r.outerWidth - o.outerWidth()) * i.x, o.to.top = (r.outerHeight - o.to.outerHeight) * i.y, o.to.left = (r.outerWidth - o.to.outerWidth) * i.x), o.css(o.from);
    if (v === "content" || v === "both") c = c.concat(["marginTop", "marginBottom"]).concat(l), h = h.concat(["marginLeft", "marginRight"]), f = u.concat(c).concat(h), o.find("*[width]").each(function () {
      var n = e(this),
          r = {
        height: n.height(),
        width: n.width(),
        outerHeight: n.outerHeight(),
        outerWidth: n.outerWidth()
      };
      d && e.effects.save(n, f), n.from = {
        height: r.height * s.from.y,
        width: r.width * s.from.x,
        outerHeight: r.outerHeight * s.from.y,
        outerWidth: r.outerWidth * s.from.x
      }, n.to = {
        height: r.height * s.to.y,
        width: r.width * s.to.x,
        outerHeight: r.height * s.to.y,
        outerWidth: r.width * s.to.x
      }, s.from.y !== s.to.y && (n.from = e.effects.setTransition(n, c, s.from.y, n.from), n.to = e.effects.setTransition(n, c, s.to.y, n.to)), s.from.x !== s.to.x && (n.from = e.effects.setTransition(n, h, s.from.x, n.from), n.to = e.effects.setTransition(n, h, s.to.x, n.to)), n.css(n.from), n.animate(n.to, t.duration, t.easing, function () {
        d && e.effects.restore(n, f);
      });
    });
    o.animate(o.to, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: function complete() {
        o.to.opacity === 0 && o.css("opacity", o.from.opacity), p === "hide" && o.hide(), e.effects.restore(o, y), d || (g === "static" ? o.css({
          position: "relative",
          top: o.to.top,
          left: o.to.left
        }) : e.each(["top", "left"], function (e, t) {
          o.css(t, function (t, n) {
            var r = parseInt(n, 10),
                i = e ? o.to.left : o.to.top;
            return n === "auto" ? i + "px" : r + i + "px";
          });
        })), e.effects.removeWrapper(o), n();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.shake = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "height", "width"],
        s = e.effects.setMode(r, t.mode || "effect"),
        o = t.direction || "left",
        u = t.distance || 20,
        a = t.times || 3,
        f = a * 2 + 1,
        l = Math.round(t.duration / f),
        c = o === "up" || o === "down" ? "top" : "left",
        h = o === "up" || o === "left",
        p = {},
        d = {},
        v = {},
        m,
        g = r.queue(),
        y = g.length;
    e.effects.save(r, i), r.show(), e.effects.createWrapper(r), p[c] = (h ? "-=" : "+=") + u, d[c] = (h ? "+=" : "-=") + u * 2, v[c] = (h ? "-=" : "+=") + u * 2, r.animate(p, l, t.easing);

    for (m = 1; m < a; m++) {
      r.animate(d, l, t.easing).animate(v, l, t.easing);
    }

    r.animate(d, l, t.easing).animate(p, l / 2, t.easing).queue(function () {
      s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
    }), y > 1 && g.splice.apply(g, [1, 0].concat(g.splice(y, f + 1))), r.dequeue();
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.slide = function (t, n) {
    var r = e(this),
        i = ["position", "top", "bottom", "left", "right", "width", "height"],
        s = e.effects.setMode(r, t.mode || "show"),
        o = s === "show",
        u = t.direction || "left",
        a = u === "up" || u === "down" ? "top" : "left",
        f = u === "up" || u === "left",
        l,
        c = {};
    e.effects.save(r, i), r.show(), l = t.distance || r[a === "top" ? "outerHeight" : "outerWidth"](!0), e.effects.createWrapper(r).css({
      overflow: "hidden"
    }), o && r.css(a, f ? isNaN(l) ? "-" + l : -l : l), c[a] = (o ? f ? "+=" : "-=" : f ? "-=" : "+=") + l, r.animate(c, {
      queue: !1,
      duration: t.duration,
      easing: t.easing,
      complete: function complete() {
        s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n();
      }
    });
  };
})(jQuery);

(function (e, t) {
  e.effects.effect.transfer = function (t, n) {
    var r = e(this),
        i = e(t.to),
        s = i.css("position") === "fixed",
        o = e("body"),
        u = s ? o.scrollTop() : 0,
        a = s ? o.scrollLeft() : 0,
        f = i.offset(),
        l = {
      top: f.top - u,
      left: f.left - a,
      height: i.innerHeight(),
      width: i.innerWidth()
    },
        c = r.offset(),
        h = e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({
      top: c.top - u,
      left: c.left - a,
      height: r.innerHeight(),
      width: r.innerWidth(),
      position: s ? "fixed" : "absolute"
    }).animate(l, t.duration, t.easing, function () {
      h.remove(), n();
    });
  };
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery.ajaxQueue.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {/*
* jQuery.ajaxQueue - A queue for ajax requests
*
* @copyright: Copyright (c) 2013 Corey Frang
* @license: Licensed under the MIT license. See https://github.com/gnarf/jquery-ajaxQueue/blob/master/LICENSE-MIT.
* @website: https://github.com/gnarf/jquery-ajaxQueue
*/
(function ($) {
  // jQuery on an empty object, we are going to use this as our Queue
  var ajaxQueue = $({});

  $.ajaxQueue = function (ajaxOpts) {
    var jqXHR,
        dfd = $.Deferred(),
        promise = dfd.promise(); // run the actual query

    function doRequest(next) {
      jqXHR = $.ajax(ajaxOpts);
      jqXHR.done(dfd.resolve).fail(dfd.reject).then(next, next);
    } // queue our ajax request


    ajaxQueue.queue(doRequest); // add the abort method

    promise.abort = function (statusText) {
      // proxy abort to the jqXHR if it is active
      if (jqXHR) {
        return jqXHR.abort(statusText);
      } // if there wasn't already a jqXHR we need to remove from queue


      var queue = ajaxQueue.queue(),
          index = $.inArray(doRequest, queue);

      if (index > -1) {
        queue.splice(index, 1);
      } // and then reject the deferred


      dfd.rejectWith(ajaxOpts.context || ajaxOpts, [promise, statusText, ""]);
      return promise;
    };

    return promise;
  };
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery.cookie.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function ($) {
  $.cookie = function (key, value, options) {
    // key and at least value given, set cookie...
    if (arguments.length > 1 && (!/Object/.test(Object.prototype.toString.call(value)) || value === null || value === undefined)) {
      options = $.extend({}, options);

      if (value === null || value === undefined) {
        options.expires = -1;
      }

      if (typeof options.expires === 'number') {
        var days = options.expires,
            t = options.expires = new Date();
        t.setDate(t.getDate() + days);
      }

      value = String(value);
      return document.cookie = [encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value), options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
      options.path ? '; path=' + options.path : '', options.domain ? '; domain=' + options.domain : '', options.secure ? '; secure' : ''].join('');
    } // key and possibly options given, get cookie...


    options = value || {};
    var decode = options.raw ? function (s) {
      return s;
    } : decodeURIComponent;
    var pairs = document.cookie.split('; ');

    for (var i = 0, pair; pair = pairs[i] && pairs[i].split('='); i++) {
      if (decode(pair[0]) === key) return decode(pair[1] || ''); // IE saves cookies with empty string as "c; ", e.g. without "=" as opposed to EOMB, thus pair[1] may be undefined
    }

    return null;
  };
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery.form.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*!
 * jQuery Form Plugin
 * version: 3.18 (28-SEP-2012)
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */

/*global ActiveXObject alert */
;

(function ($) {
  "use strict";
  /*
      Usage Note:
      -----------
      Do not use both ajaxSubmit and ajaxForm on the same form.  These
      functions are mutually exclusive.  Use ajaxSubmit if you want
      to bind your own submit handler to the form.  For example,
  
      $(document).ready(function() {
          $('#myForm').on('submit', function(e) {
              e.preventDefault(); // <-- important
              $(this).ajaxSubmit({
                  target: '#output'
              });
          });
      });
  
      Use ajaxForm when you want the plugin to manage all the event binding
      for you.  For example,
  
      $(document).ready(function() {
          $('#myForm').ajaxForm({
              target: '#output'
          });
      });
      
      You can also use ajaxForm with delegation (requires jQuery v1.7+), so the
      form does not have to exist when you invoke ajaxForm:
  
      $('#myForm').ajaxForm({
          delegation: true,
          target: '#output'
      });
      
      When using ajaxForm, the ajaxSubmit function will be invoked for you
      at the appropriate time.
  */

  /**
   * Feature detection
   */

  var feature = {};
  feature.fileapi = $("<input type='file'/>").get(0).files !== undefined;
  feature.formdata = window.FormData !== undefined;
  /**
   * ajaxSubmit() provides a mechanism for immediately submitting
   * an HTML form using AJAX.
   */

  $.fn.ajaxSubmit = function (options) {
    /*jshint scripturl:true */
    // fast fail if nothing selected (http://dev.jquery.com/ticket/2752)
    if (!this.length) {
      log('ajaxSubmit: skipping submit process - no element selected');
      return this;
    }

    var method,
        action,
        url,
        $form = this;

    if (typeof options == 'function') {
      options = {
        success: options
      };
    }

    method = this.attr('method');
    action = this.attr('action');
    url = typeof action === 'string' ? $.trim(action) : '';
    url = url || window.location.href || '';

    if (url) {
      // clean url (don't include hash vaue)
      url = (url.match(/^([^#]+)/) || [])[1];
    }

    options = $.extend(true, {
      url: url,
      success: $.ajaxSettings.success,
      type: method || 'GET',
      iframeSrc: /^https/i.test(window.location.href || '') ? 'javascript:false' : 'about:blank'
    }, options); // hook for manipulating the form data before it is extracted;
    // convenient for use with rich editors like tinyMCE or FCKEditor

    var veto = {};
    this.trigger('form-pre-serialize', [this, options, veto]);

    if (veto.veto) {
      log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');
      return this;
    } // provide opportunity to alter form data before it is serialized


    if (options.beforeSerialize && options.beforeSerialize(this, options) === false) {
      log('ajaxSubmit: submit aborted via beforeSerialize callback');
      return this;
    }

    var traditional = options.traditional;

    if (traditional === undefined) {
      traditional = $.ajaxSettings.traditional;
    }

    var elements = [];
    var qx,
        a = this.formToArray(options.semantic, elements);

    if (options.data) {
      options.extraData = options.data;
      qx = $.param(options.data, traditional);
    } // give pre-submit callback an opportunity to abort the submit


    if (options.beforeSubmit && options.beforeSubmit(a, this, options) === false) {
      log('ajaxSubmit: submit aborted via beforeSubmit callback');
      return this;
    } // fire vetoable 'validate' event


    this.trigger('form-submit-validate', [a, this, options, veto]);

    if (veto.veto) {
      log('ajaxSubmit: submit vetoed via form-submit-validate trigger');
      return this;
    }

    var q = $.param(a, traditional);

    if (qx) {
      q = q ? q + '&' + qx : qx;
    }

    if (options.type.toUpperCase() == 'GET') {
      options.url += (options.url.indexOf('?') >= 0 ? '&' : '?') + q;
      options.data = null; // data is null for 'get'
    } else {
      options.data = q; // data is the query string for 'post'
    }

    var callbacks = [];

    if (options.resetForm) {
      callbacks.push(function () {
        $form.resetForm();
      });
    }

    if (options.clearForm) {
      callbacks.push(function () {
        $form.clearForm(options.includeHidden);
      });
    } // perform a load on the target only if dataType is not provided


    if (!options.dataType && options.target) {
      var oldSuccess = options.success || function () {};

      callbacks.push(function (data) {
        var fn = options.replaceTarget ? 'replaceWith' : 'html';
        $(options.target)[fn](data).each(oldSuccess, arguments);
      });
    } else if (options.success) {
      callbacks.push(options.success);
    }

    options.success = function (data, status, xhr) {
      // jQuery 1.4+ passes xhr as 3rd arg
      var context = options.context || this; // jQuery 1.4+ supports scope context 

      for (var i = 0, max = callbacks.length; i < max; i++) {
        callbacks[i].apply(context, [data, status, xhr || $form, $form]);
      }
    }; // are there files to upload?


    var fileInputs = $('input:file:enabled[value]', this); // [value] (issue #113)

    var hasFileInputs = fileInputs.length > 0;
    var mp = 'multipart/form-data';
    var multipart = $form.attr('enctype') == mp || $form.attr('encoding') == mp;
    var fileAPI = feature.fileapi && feature.formdata;
    log("fileAPI :" + fileAPI);
    var shouldUseFrame = (hasFileInputs || multipart) && !fileAPI;
    var jqxhr; // options.iframe allows user to force iframe mode
    // 06-NOV-09: now defaulting to iframe mode if file input is detected

    if (options.iframe !== false && (options.iframe || shouldUseFrame)) {
      // hack to fix Safari hang (thanks to Tim Molendijk for this)
      // see:  http://groups.google.com/group/jquery-dev/browse_thread/thread/36395b7ab510dd5d
      if (options.closeKeepAlive) {
        $.get(options.closeKeepAlive, function () {
          jqxhr = fileUploadIframe(a);
        });
      } else {
        jqxhr = fileUploadIframe(a);
      }
    } else if ((hasFileInputs || multipart) && fileAPI) {
      jqxhr = fileUploadXhr(a);
    } else {
      jqxhr = $.ajax(options);
    }

    $form.removeData('jqxhr').data('jqxhr', jqxhr); // clear element array

    for (var k = 0; k < elements.length; k++) {
      elements[k] = null;
    } // fire 'notify' event


    this.trigger('form-submit-notify', [this, options]);
    return this; // utility fn for deep serialization

    function deepSerialize(extraData) {
      var serialized = $.param(extraData).split('&');
      var len = serialized.length;
      var result = {};
      var i, part;

      for (i = 0; i < len; i++) {
        part = serialized[i].split('=');
        result[decodeURIComponent(part[0])] = decodeURIComponent(part[1]);
      }

      return result;
    } // XMLHttpRequest Level 2 file uploads (big hat tip to francois2metz)


    function fileUploadXhr(a) {
      var formdata = new FormData();

      for (var i = 0; i < a.length; i++) {
        formdata.append(a[i].name, a[i].value);
      }

      if (options.extraData) {
        var serializedData = deepSerialize(options.extraData);

        for (var p in serializedData) {
          if (serializedData.hasOwnProperty(p)) formdata.append(p, serializedData[p]);
        }
      }

      options.data = null;
      var s = $.extend(true, {}, $.ajaxSettings, options, {
        contentType: false,
        processData: false,
        cache: false,
        type: method || 'POST'
      });

      if (options.uploadProgress) {
        // workaround because jqXHR does not expose upload property
        s.xhr = function () {
          var xhr = jQuery.ajaxSettings.xhr();

          if (xhr.upload) {
            xhr.upload.onprogress = function (event) {
              var percent = 0;
              var position = event.loaded || event.position;
              /*event.position is deprecated*/

              var total = event.total;

              if (event.lengthComputable) {
                percent = Math.ceil(position / total * 100);
              }

              options.uploadProgress(event, position, total, percent);
            };
          }

          return xhr;
        };
      }

      s.data = null;
      var beforeSend = s.beforeSend;

      s.beforeSend = function (xhr, o) {
        o.data = formdata;
        if (beforeSend) beforeSend.call(this, xhr, o);
      };

      return $.ajax(s);
    } // private function for handling file uploads (hat tip to YAHOO!)


    function fileUploadIframe(a) {
      var form = $form[0],
          el,
          i,
          s,
          g,
          id,
          $io,
          io,
          xhr,
          sub,
          n,
          timedOut,
          timeoutHandle;
      var useProp = !!$.fn.prop;
      var deferred = $.Deferred();

      if ($(':input[name=submit],:input[id=submit]', form).length) {
        // if there is an input with a name or id of 'submit' then we won't be
        // able to invoke the submit fn on the form (at least not x-browser)
        alert('Error: Form elements must not have name or id of "submit".');
        deferred.reject();
        return deferred;
      }

      if (a) {
        // ensure that every serialized input is still enabled
        for (i = 0; i < elements.length; i++) {
          el = $(elements[i]);
          if (useProp) el.prop('disabled', false);else el.removeAttr('disabled');
        }
      }

      s = $.extend(true, {}, $.ajaxSettings, options);
      s.context = s.context || s;
      id = 'jqFormIO' + new Date().getTime();

      if (s.iframeTarget) {
        $io = $(s.iframeTarget);
        n = $io.attr('name');
        if (!n) $io.attr('name', id);else id = n;
      } else {
        $io = $('<iframe name="' + id + '" src="' + s.iframeSrc + '" />');
        $io.css({
          position: 'absolute',
          top: '-1000px',
          left: '-1000px'
        });
      }

      io = $io[0];
      xhr = {
        // mock object
        aborted: 0,
        responseText: null,
        responseXML: null,
        status: 0,
        statusText: 'n/a',
        getAllResponseHeaders: function getAllResponseHeaders() {},
        getResponseHeader: function getResponseHeader() {},
        setRequestHeader: function setRequestHeader() {},
        abort: function abort(status) {
          var e = status === 'timeout' ? 'timeout' : 'aborted';
          log('aborting upload... ' + e);
          this.aborted = 1; // #214

          if (io.contentWindow.document.execCommand) {
            try {
              // #214
              io.contentWindow.document.execCommand('Stop');
            } catch (ignore) {}
          }

          $io.attr('src', s.iframeSrc); // abort op in progress

          xhr.error = e;
          if (s.error) s.error.call(s.context, xhr, e, status);
          if (g) $.event.trigger("ajaxError", [xhr, s, e]);
          if (s.complete) s.complete.call(s.context, xhr, e);
        }
      };
      g = s.global; // trigger ajax global events so that activity/block indicators work like normal

      if (g && 0 === $.active++) {
        $.event.trigger("ajaxStart");
      }

      if (g) {
        $.event.trigger("ajaxSend", [xhr, s]);
      }

      if (s.beforeSend && s.beforeSend.call(s.context, xhr, s) === false) {
        if (s.global) {
          $.active--;
        }

        deferred.reject();
        return deferred;
      }

      if (xhr.aborted) {
        deferred.reject();
        return deferred;
      } // add submitting element to data if we know it


      sub = form.clk;

      if (sub) {
        n = sub.name;

        if (n && !sub.disabled) {
          s.extraData = s.extraData || {};
          s.extraData[n] = sub.value;

          if (sub.type == "image") {
            s.extraData[n + '.x'] = form.clk_x;
            s.extraData[n + '.y'] = form.clk_y;
          }
        }
      }

      var CLIENT_TIMEOUT_ABORT = 1;
      var SERVER_ABORT = 2;

      function getDoc(frame) {
        var doc = frame.contentWindow ? frame.contentWindow.document : frame.contentDocument ? frame.contentDocument : frame.document;
        return doc;
      } // Rails CSRF hack (thanks to Yvan Barthelemy)


      var csrf_token = $('meta[name=csrf-token]').attr('content');
      var csrf_param = $('meta[name=csrf-param]').attr('content');

      if (csrf_param && csrf_token) {
        s.extraData = s.extraData || {};
        s.extraData[csrf_param] = csrf_token;
      } // take a breath so that pending repaints get some cpu time before the upload starts


      function doSubmit() {
        // make sure form attrs are set
        var t = $form.attr('target'),
            a = $form.attr('action'); // update form attrs in IE friendly way

        form.setAttribute('target', id);

        if (!method) {
          form.setAttribute('method', 'POST');
        }

        if (a != s.url) {
          form.setAttribute('action', s.url);
        } // ie borks in some cases when setting encoding


        if (!s.skipEncodingOverride && (!method || /post/i.test(method))) {
          $form.attr({
            encoding: 'multipart/form-data',
            enctype: 'multipart/form-data'
          });
        } // support timout


        if (s.timeout) {
          timeoutHandle = setTimeout(function () {
            timedOut = true;
            cb(CLIENT_TIMEOUT_ABORT);
          }, s.timeout);
        } // look for server aborts


        function checkState() {
          try {
            var state = getDoc(io).readyState;
            log('state = ' + state);
            if (state && state.toLowerCase() == 'uninitialized') setTimeout(checkState, 50);
          } catch (e) {
            log('Server abort: ', e, ' (', e.name, ')');
            cb(SERVER_ABORT);
            if (timeoutHandle) clearTimeout(timeoutHandle);
            timeoutHandle = undefined;
          }
        } // add "extra" data to form if provided in options


        var extraInputs = [];

        try {
          if (s.extraData) {
            for (var n in s.extraData) {
              if (s.extraData.hasOwnProperty(n)) {
                // if using the $.param format that allows for multiple values with the same name
                if ($.isPlainObject(s.extraData[n]) && s.extraData[n].hasOwnProperty('name') && s.extraData[n].hasOwnProperty('value')) {
                  extraInputs.push($('<input type="hidden" name="' + s.extraData[n].name + '">').attr('value', s.extraData[n].value).appendTo(form)[0]);
                } else {
                  extraInputs.push($('<input type="hidden" name="' + n + '">').attr('value', s.extraData[n]).appendTo(form)[0]);
                }
              }
            }
          }

          if (!s.iframeTarget) {
            // add iframe to doc and submit the form
            $io.appendTo('body');
            if (io.attachEvent) io.attachEvent('onload', cb);else io.addEventListener('load', cb, false);
          }

          setTimeout(checkState, 15);
          form.submit();
        } finally {
          // reset attrs and remove "extra" input elements
          form.setAttribute('action', a);

          if (t) {
            form.setAttribute('target', t);
          } else {
            $form.removeAttr('target');
          }

          $(extraInputs).remove();
        }
      }

      if (s.forceSync) {
        doSubmit();
      } else {
        setTimeout(doSubmit, 10); // this lets dom updates render
      }

      var data,
          doc,
          domCheckCount = 50,
          callbackProcessed;

      function cb(e) {
        if (xhr.aborted || callbackProcessed) {
          return;
        }

        try {
          doc = getDoc(io);
        } catch (ex) {
          log('cannot access response document: ', ex);
          e = SERVER_ABORT;
        }

        if (e === CLIENT_TIMEOUT_ABORT && xhr) {
          xhr.abort('timeout');
          deferred.reject(xhr, 'timeout');
          return;
        } else if (e == SERVER_ABORT && xhr) {
          xhr.abort('server abort');
          deferred.reject(xhr, 'error', 'server abort');
          return;
        }

        if (!doc || doc.location.href == s.iframeSrc) {
          // response not received yet
          if (!timedOut) return;
        }

        if (io.detachEvent) io.detachEvent('onload', cb);else io.removeEventListener('load', cb, false);
        var status = 'success',
            errMsg;

        try {
          if (timedOut) {
            throw 'timeout';
          }

          var isXml = s.dataType == 'xml' || doc.XMLDocument || $.isXMLDoc(doc);
          log('isXml=' + isXml);

          if (!isXml && window.opera && (doc.body === null || !doc.body.innerHTML)) {
            if (--domCheckCount) {
              // in some browsers (Opera) the iframe DOM is not always traversable when
              // the onload callback fires, so we loop a bit to accommodate
              log('requeing onLoad callback, DOM not available');
              setTimeout(cb, 250);
              return;
            } // let this fall through because server response could be an empty document
            //log('Could not access iframe DOM after mutiple tries.');
            //throw 'DOMException: not available';

          } //log('response detected');


          var docRoot = doc.body ? doc.body : doc.documentElement;
          xhr.responseText = docRoot ? docRoot.innerHTML : null;
          xhr.responseXML = doc.XMLDocument ? doc.XMLDocument : doc;
          if (isXml) s.dataType = 'xml';

          xhr.getResponseHeader = function (header) {
            var headers = {
              'content-type': s.dataType
            };
            return headers[header];
          }; // support for XHR 'status' & 'statusText' emulation :


          if (docRoot) {
            xhr.status = Number(docRoot.getAttribute('status')) || xhr.status;
            xhr.statusText = docRoot.getAttribute('statusText') || xhr.statusText;
          }

          var dt = (s.dataType || '').toLowerCase();
          var scr = /(json|script|text)/.test(dt);

          if (scr || s.textarea) {
            // see if user embedded response in textarea
            var ta = doc.getElementsByTagName('textarea')[0];

            if (ta) {
              xhr.responseText = ta.value; // support for XHR 'status' & 'statusText' emulation :

              xhr.status = Number(ta.getAttribute('status')) || xhr.status;
              xhr.statusText = ta.getAttribute('statusText') || xhr.statusText;
            } else if (scr) {
              // account for browsers injecting pre around json response
              var pre = doc.getElementsByTagName('pre')[0];
              var b = doc.getElementsByTagName('body')[0];

              if (pre) {
                xhr.responseText = pre.textContent ? pre.textContent : pre.innerText;
              } else if (b) {
                xhr.responseText = b.textContent ? b.textContent : b.innerText;
              }
            }
          } else if (dt == 'xml' && !xhr.responseXML && xhr.responseText) {
            xhr.responseXML = toXml(xhr.responseText);
          }

          try {
            data = httpData(xhr, dt, s);
          } catch (e) {
            status = 'parsererror';
            xhr.error = errMsg = e || status;
          }
        } catch (e) {
          log('error caught: ', e);
          status = 'error';
          xhr.error = errMsg = e || status;
        }

        if (xhr.aborted) {
          log('upload aborted');
          status = null;
        }

        if (xhr.status) {
          // we've set xhr.status
          status = xhr.status >= 200 && xhr.status < 300 || xhr.status === 304 ? 'success' : 'error';
        } // ordering of these callbacks/triggers is odd, but that's how $.ajax does it


        if (status === 'success') {
          if (s.success) s.success.call(s.context, data, 'success', xhr);
          deferred.resolve(xhr.responseText, 'success', xhr);
          if (g) $.event.trigger("ajaxSuccess", [xhr, s]);
        } else if (status) {
          if (errMsg === undefined) errMsg = xhr.statusText;
          if (s.error) s.error.call(s.context, xhr, status, errMsg);
          deferred.reject(xhr, 'error', errMsg);
          if (g) $.event.trigger("ajaxError", [xhr, s, errMsg]);
        }

        if (g) $.event.trigger("ajaxComplete", [xhr, s]);

        if (g && ! --$.active) {
          $.event.trigger("ajaxStop");
        }

        if (s.complete) s.complete.call(s.context, xhr, status);
        callbackProcessed = true;
        if (s.timeout) clearTimeout(timeoutHandle); // clean up

        setTimeout(function () {
          if (!s.iframeTarget) $io.remove();
          xhr.responseXML = null;
        }, 100);
      }

      var toXml = $.parseXML || function (s, doc) {
        // use parseXML if available (jQuery 1.5+)
        if (window.ActiveXObject) {
          doc = new ActiveXObject('Microsoft.XMLDOM');
          doc.async = 'false';
          doc.loadXML(s);
        } else {
          doc = new DOMParser().parseFromString(s, 'text/xml');
        }

        return doc && doc.documentElement && doc.documentElement.nodeName != 'parsererror' ? doc : null;
      };

      var parseJSON = $.parseJSON || function (s) {
        /*jslint evil:true */
        return window['eval']('(' + s + ')');
      };

      var httpData = function httpData(xhr, type, s) {
        // mostly lifted from jq1.4.4
        var ct = xhr.getResponseHeader('content-type') || '',
            xml = type === 'xml' || !type && ct.indexOf('xml') >= 0,
            data = xml ? xhr.responseXML : xhr.responseText;

        if (xml && data.documentElement.nodeName === 'parsererror') {
          if ($.error) $.error('parsererror');
        }

        if (s && s.dataFilter) {
          data = s.dataFilter(data, type);
        }

        if (typeof data === 'string') {
          if (type === 'json' || !type && ct.indexOf('json') >= 0) {
            data = parseJSON(data);
          } else if (type === "script" || !type && ct.indexOf("javascript") >= 0) {
            $.globalEval(data);
          }
        }

        return data;
      };

      return deferred;
    }
  };
  /**
   * ajaxForm() provides a mechanism for fully automating form submission.
   *
   * The advantages of using this method instead of ajaxSubmit() are:
   *
   * 1: This method will include coordinates for <input type="image" /> elements (if the element
   *    is used to submit the form).
   * 2. This method will include the submit element's name/value data (for the element that was
   *    used to submit the form).
   * 3. This method binds the submit() method to the form for you.
   *
   * The options argument for ajaxForm works exactly as it does for ajaxSubmit.  ajaxForm merely
   * passes the options argument along after properly binding events for submit elements and
   * the form itself.
   */


  $.fn.ajaxForm = function (options) {
    options = options || {};
    options.delegation = options.delegation && $.isFunction($.fn.on); // in jQuery 1.3+ we can fix mistakes with the ready state

    if (!options.delegation && this.length === 0) {
      var o = {
        s: this.selector,
        c: this.context
      };

      if (!$.isReady && o.s) {
        log('DOM not ready, queuing ajaxForm');
        $(function () {
          $(o.s, o.c).ajaxForm(options);
        });
        return this;
      } // is your DOM ready?  http://docs.jquery.com/Tutorials:Introducing_$(document).ready()


      log('terminating; zero elements found by selector' + ($.isReady ? '' : ' (DOM not ready)'));
      return this;
    }

    if (options.delegation) {
      $(document).off('submit.form-plugin', this.selector, doAjaxSubmit).off('click.form-plugin', this.selector, captureSubmittingElement).on('submit.form-plugin', this.selector, options, doAjaxSubmit).on('click.form-plugin', this.selector, options, captureSubmittingElement);
      return this;
    }

    return this.ajaxFormUnbind().bind('submit.form-plugin', options, doAjaxSubmit).bind('click.form-plugin', options, captureSubmittingElement);
  }; // private event handlers    


  function doAjaxSubmit(e) {
    /*jshint validthis:true */
    var options = e.data;

    if (!e.isDefaultPrevented()) {
      // if event has been canceled, don't proceed
      e.preventDefault();
      $(this).ajaxSubmit(options);
    }
  }

  function captureSubmittingElement(e) {
    /*jshint validthis:true */
    var target = e.target;
    var $el = $(target);

    if (!$el.is(":submit,input:image")) {
      // is this a child element of the submit el?  (ex: a span within a button)
      var t = $el.closest(':submit');

      if (t.length === 0) {
        return;
      }

      target = t[0];
    }

    var form = this;
    form.clk = target;

    if (target.type == 'image') {
      if (e.offsetX !== undefined) {
        form.clk_x = e.offsetX;
        form.clk_y = e.offsetY;
      } else if (typeof $.fn.offset == 'function') {
        var offset = $el.offset();
        form.clk_x = e.pageX - offset.left;
        form.clk_y = e.pageY - offset.top;
      } else {
        form.clk_x = e.pageX - target.offsetLeft;
        form.clk_y = e.pageY - target.offsetTop;
      }
    } // clear form vars


    setTimeout(function () {
      form.clk = form.clk_x = form.clk_y = null;
    }, 100);
  } // ajaxFormUnbind unbinds the event handlers that were bound by ajaxForm


  $.fn.ajaxFormUnbind = function () {
    return this.unbind('submit.form-plugin click.form-plugin');
  };
  /**
   * formToArray() gathers form element data into an array of objects that can
   * be passed to any of the following ajax functions: $.get, $.post, or load.
   * Each object in the array has both a 'name' and 'value' property.  An example of
   * an array for a simple login form might be:
   *
   * [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ]
   *
   * It is this array that is passed to pre-submit callback functions provided to the
   * ajaxSubmit() and ajaxForm() methods.
   */


  $.fn.formToArray = function (semantic, elements) {
    var a = [];

    if (this.length === 0) {
      return a;
    }

    var form = this[0];
    var els = semantic ? form.getElementsByTagName('*') : form.elements;

    if (!els) {
      return a;
    }

    var i, j, n, v, el, max, jmax;

    for (i = 0, max = els.length; i < max; i++) {
      el = els[i];
      n = el.name;

      if (!n) {
        continue;
      }

      if (semantic && form.clk && el.type == "image") {
        // handle image inputs on the fly when semantic == true
        if (!el.disabled && form.clk == el) {
          a.push({
            name: n,
            value: $(el).val(),
            type: el.type
          });
          a.push({
            name: n + '.x',
            value: form.clk_x
          }, {
            name: n + '.y',
            value: form.clk_y
          });
        }

        continue;
      }

      v = $.fieldValue(el, true);

      if (v && v.constructor == Array) {
        if (elements) elements.push(el);

        for (j = 0, jmax = v.length; j < jmax; j++) {
          a.push({
            name: n,
            value: v[j]
          });
        }
      } else if (feature.fileapi && el.type == 'file' && !el.disabled) {
        if (elements) elements.push(el);
        var files = el.files;

        if (files.length) {
          for (j = 0; j < files.length; j++) {
            a.push({
              name: n,
              value: files[j],
              type: el.type
            });
          }
        } else {
          // #180
          a.push({
            name: n,
            value: '',
            type: el.type
          });
        }
      } else if (v !== null && typeof v != 'undefined') {
        if (elements) elements.push(el);
        a.push({
          name: n,
          value: v,
          type: el.type,
          required: el.required
        });
      }
    }

    if (!semantic && form.clk) {
      // input type=='image' are not found in elements array! handle it here
      var $input = $(form.clk),
          input = $input[0];
      n = input.name;

      if (n && !input.disabled && input.type == 'image') {
        a.push({
          name: n,
          value: $input.val()
        });
        a.push({
          name: n + '.x',
          value: form.clk_x
        }, {
          name: n + '.y',
          value: form.clk_y
        });
      }
    }

    return a;
  };
  /**
   * Serializes form data into a 'submittable' string. This method will return a string
   * in the format: name1=value1&amp;name2=value2
   */


  $.fn.formSerialize = function (semantic) {
    //hand off to jQuery.param for proper encoding
    return $.param(this.formToArray(semantic));
  };
  /**
   * Serializes all field elements in the jQuery object into a query string.
   * This method will return a string in the format: name1=value1&amp;name2=value2
   */


  $.fn.fieldSerialize = function (successful) {
    var a = [];
    this.each(function () {
      var n = this.name;

      if (!n) {
        return;
      }

      var v = $.fieldValue(this, successful);

      if (v && v.constructor == Array) {
        for (var i = 0, max = v.length; i < max; i++) {
          a.push({
            name: n,
            value: v[i]
          });
        }
      } else if (v !== null && typeof v != 'undefined') {
        a.push({
          name: this.name,
          value: v
        });
      }
    }); //hand off to jQuery.param for proper encoding

    return $.param(a);
  };
  /**
   * Returns the value(s) of the element in the matched set.  For example, consider the following form:
   *
   *  <form><fieldset>
   *      <input name="A" type="text" />
   *      <input name="A" type="text" />
   *      <input name="B" type="checkbox" value="B1" />
   *      <input name="B" type="checkbox" value="B2"/>
   *      <input name="C" type="radio" value="C1" />
   *      <input name="C" type="radio" value="C2" />
   *  </fieldset></form>
   *
   *  var v = $(':text').fieldValue();
   *  // if no values are entered into the text inputs
   *  v == ['','']
   *  // if values entered into the text inputs are 'foo' and 'bar'
   *  v == ['foo','bar']
   *
   *  var v = $(':checkbox').fieldValue();
   *  // if neither checkbox is checked
   *  v === undefined
   *  // if both checkboxes are checked
   *  v == ['B1', 'B2']
   *
   *  var v = $(':radio').fieldValue();
   *  // if neither radio is checked
   *  v === undefined
   *  // if first radio is checked
   *  v == ['C1']
   *
   * The successful argument controls whether or not the field element must be 'successful'
   * (per http://www.w3.org/TR/html4/interact/forms.html#successful-controls).
   * The default value of the successful argument is true.  If this value is false the value(s)
   * for each element is returned.
   *
   * Note: This method *always* returns an array.  If no valid value can be determined the
   *    array will be empty, otherwise it will contain one or more values.
   */


  $.fn.fieldValue = function (successful) {
    for (var val = [], i = 0, max = this.length; i < max; i++) {
      var el = this[i];
      var v = $.fieldValue(el, successful);

      if (v === null || typeof v == 'undefined' || v.constructor == Array && !v.length) {
        continue;
      }

      if (v.constructor == Array) $.merge(val, v);else val.push(v);
    }

    return val;
  };
  /**
   * Returns the value of the field element.
   */


  $.fieldValue = function (el, successful) {
    var n = el.name,
        t = el.type,
        tag = el.tagName.toLowerCase();

    if (successful === undefined) {
      successful = true;
    }

    if (successful && (!n || el.disabled || t == 'reset' || t == 'button' || (t == 'checkbox' || t == 'radio') && !el.checked || (t == 'submit' || t == 'image') && el.form && el.form.clk != el || tag == 'select' && el.selectedIndex == -1)) {
      return null;
    }

    if (tag == 'select') {
      var index = el.selectedIndex;

      if (index < 0) {
        return null;
      }

      var a = [],
          ops = el.options;
      var one = t == 'select-one';
      var max = one ? index + 1 : ops.length;

      for (var i = one ? index : 0; i < max; i++) {
        var op = ops[i];

        if (op.selected) {
          var v = op.value;

          if (!v) {
            // extra pain for IE...
            v = op.attributes && op.attributes['value'] && !op.attributes['value'].specified ? op.text : op.value;
          }

          if (one) {
            return v;
          }

          a.push(v);
        }
      }

      return a;
    }

    return $(el).val();
  };
  /**
   * Clears the form data.  Takes the following actions on the form's input fields:
   *  - input text fields will have their 'value' property set to the empty string
   *  - select elements will have their 'selectedIndex' property set to -1
   *  - checkbox and radio inputs will have their 'checked' property set to false
   *  - inputs of type submit, button, reset, and hidden will *not* be effected
   *  - button elements will *not* be effected
   */


  $.fn.clearForm = function (includeHidden) {
    return this.each(function () {
      $('input,select,textarea', this).clearFields(includeHidden);
    });
  };
  /**
   * Clears the selected form elements.
   */


  $.fn.clearFields = $.fn.clearInputs = function (includeHidden) {
    var re = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i; // 'hidden' is not in this list

    return this.each(function () {
      var t = this.type,
          tag = this.tagName.toLowerCase();

      if (re.test(t) || tag == 'textarea') {
        this.value = '';
      } else if (t == 'checkbox' || t == 'radio') {
        this.checked = false;
      } else if (tag == 'select') {
        this.selectedIndex = -1;
      } else if (includeHidden) {
        // includeHidden can be the value true, or it can be a selector string
        // indicating a special test; for example:
        //  $('#myForm').clearForm('.special:hidden')
        // the above would clean hidden inputs that have the class of 'special'
        if (includeHidden === true && /hidden/.test(t) || typeof includeHidden == 'string' && $(this).is(includeHidden)) this.value = '';
      }
    });
  };
  /**
   * Resets the form data.  Causes all form elements to be reset to their original value.
   */


  $.fn.resetForm = function () {
    return this.each(function () {
      // guard against an input with the name of 'reset'
      // note that IE reports the reset function as an 'object'
      if (typeof this.reset == 'function' || _typeof(this.reset) == 'object' && !this.reset.nodeType) {
        this.reset();
      }
    });
  };
  /**
   * Enables or disables any matching elements.
   */


  $.fn.enable = function (b) {
    if (b === undefined) {
      b = true;
    }

    return this.each(function () {
      this.disabled = !b;
    });
  };
  /**
   * Checks/unchecks any matching checkboxes or radio buttons and
   * selects/deselects and matching option elements.
   */


  $.fn.selected = function (select) {
    if (select === undefined) {
      select = true;
    }

    return this.each(function () {
      var t = this.type;

      if (t == 'checkbox' || t == 'radio') {
        this.checked = select;
      } else if (this.tagName.toLowerCase() == 'option') {
        var $sel = $(this).parent('select');

        if (select && $sel[0] && $sel[0].type == 'select-one') {
          // deselect all other options
          $sel.find('option').selected(false);
        }

        this.selected = select;
      }
    });
  }; // expose debug var


  $.fn.ajaxSubmit.debug = false; // helper fn for console logging

  function log() {
    if (!$.fn.ajaxSubmit.debug) return;
    var msg = '[jquery.form] ' + Array.prototype.join.call(arguments, '');

    if (window.console && window.console.log) {
      window.console.log(msg);
    } else if (window.opera && window.opera.postError) {
      window.opera.postError(msg);
    }
  }
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery.leanModal.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL
// Updated to prevent divs with duplicate IDs from being rendered.
(function ($) {
  $.fn.extend({
    leanModal: function leanModal(options) {
      var defaults = {
        top: 100,
        overlay: 0.5,
        closeButton: null
      }; // Only append the overlay element if it isn't already present.

      if ($("#lean_overlay").length == 0) {
        var overlay = $("<div id='lean_overlay'></div>");
        $("body").append(overlay);
      }

      options = $.extend(defaults, options);
      return this.each(function () {
        var o = options;
        $(this).click(function (e) {
          var modal_id = $(this).attr("href");
          $("#lean_overlay").click(function () {
            close_modal(modal_id);
          });
          $(o.closeButton).click(function () {
            close_modal(modal_id);
          });
          var modal_height = $(modal_id).outerHeight();
          var modal_width = $(modal_id).outerWidth();
          $("#lean_overlay").css({
            "display": "block",
            opacity: 0
          });
          $("#lean_overlay").fadeTo(200, o.overlay);
          $(modal_id).css({
            "display": "block",
            "position": "fixed",
            "opacity": 0,
            "z-index": 11000,
            "left": 50 + "%",
            "margin-left": -(modal_width / 2) + "px",
            "top": o.top + "px"
          });
          $(modal_id).fadeTo(200, 1);
          e.preventDefault();
        });
      });

      function close_modal(modal_id) {
        $("#lean_overlay").fadeOut(200);
        $(modal_id).css({
          "display": "none"
        });
      }
    }
  });
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/jquery.qtip.min.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/*
* qTip2 - Pretty powerful tooltips
* http://craigsworks.com/projects/qtip2/
*
* Version: nightly
* Copyright 2009-2010 Craig Michael Thompson - http://craigsworks.com
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Mon Apr  2 13:46:17.0000000000 2012
*/

/*jslint browser: true, onevar: true, undef: true, nomen: true, bitwise: true, regexp: true, newcap: true, immed: true, strict: true */

/*global window: false, jQuery: false, console: false, define: false */
(function (a) {
   true ? !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_FACTORY__ = (a),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : a(jQuery);
})(function (a) {
  function z(d) {
    var e = this,
        f = d.elements.tooltip,
        g = d.options.content.ajax,
        h = ".qtip-ajax",
        i = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
        j = b,
        k = c,
        l;
    d.checks.ajax = {
      "^content.ajax": function contentAjax(a, b, c) {
        b === "ajax" && (g = c), b === "once" ? e.init() : g && g.url ? e.load() : f.unbind(h);
      }
    }, a.extend(e, {
      init: function init() {
        g && g.url && f.unbind(h)[g.once ? "one" : "bind"]("tooltipshow" + h, e.load);
        return e;
      },
      load: function load(b, f) {
        function r(a, b, c) {
          !k && a.status !== 0 && d.set("content.text", b + ": " + c);
        }

        function q(b) {
          k || (m && (b = a("<div/>").append(b.replace(i, "")).find(m)), d.set("content.text", b));
        }

        function p() {
          k || (n && (d.show(b.originalEvent), f = c), a.isFunction(g.complete) && g.complete.apply(this, arguments));
        }

        var h = g.url.indexOf(" "),
            j = g.url,
            m,
            n = g.once && !g.loading && f;
        if (n) try {
          b.preventDefault();
        } catch (o) {} else if (b && b.isDefaultPrevented()) return e;
        l && l.abort && l.abort(), h > -1 && (m = j.substr(h), j = j.substr(0, h)), l = a.ajax(a.extend({
          success: q,
          error: r,
          context: d
        }, g, {
          url: j,
          complete: p
        }));
      },
      destroy: function destroy() {
        l && l.abort && l.abort(), k = b;
      }
    }), e.init();
  }

  function y(e, h) {
    var i,
        j,
        k,
        l,
        m,
        n = a(this),
        o = a(document.body),
        p = this === document ? o : n,
        q = n.metadata ? n.metadata(h.metadata) : d,
        r = h.metadata.type === "html5" && q ? q[h.metadata.name] : d,
        s = n.data(h.metadata.name || "qtipopts");

    try {
      s = typeof s === "string" ? new Function("return " + s)() : s;
    } catch (u) {
      v("Unable to parse HTML5 attribute data: " + s);
    }

    l = a.extend(b, {}, f.defaults, h, _typeof(s) === "object" ? w(s) : d, w(r || q)), j = l.position, l.id = e;

    if ("boolean" === typeof l.content.text) {
      k = n.attr(l.content.attr);
      if (l.content.attr !== c && k) l.content.text = k;else {
        v("Unable to locate content for tooltip! Aborting render of tooltip on element: ", n);
        return c;
      }
    }

    j.container.length || (j.container = o), j.target === c && (j.target = p), l.show.target === c && (l.show.target = p), l.show.solo === b && (l.show.solo = j.container.closest("body")), l.hide.target === c && (l.hide.target = p), l.position.viewport === b && (l.position.viewport = j.container), j.container = j.container.eq(0), j.at = new g.Corner(j.at), j.my = new g.Corner(j.my);
    if (a.data(this, "qtip")) if (l.overwrite) n.qtip("destroy");else if (l.overwrite === c) return c;
    l.suppress && (m = a.attr(this, "title")) && a(this).removeAttr("title").attr(t, m), i = new x(n, l, e, !!k), a.data(this, "qtip", i), n.bind("remove.qtip-" + e + " removeqtip.qtip-" + e, function () {
      i.destroy();
    });
    return i;
  }

  function x(r, s, v, x) {
    function Q() {
      var b = [s.show.target[0], s.hide.target[0], y.rendered && F.tooltip[0], s.position.container[0], s.position.viewport[0], window, document];
      y.rendered ? a([]).pushStack(a.grep(b, function (a) {
        return _typeof(a) === "object";
      })).unbind(E) : s.show.target.unbind(E + "-create");
    }

    function P() {
      function o(a) {
        D.is(":visible") && y.reposition(a);
      }

      function n(a) {
        if (D.hasClass(l)) return c;
        clearTimeout(y.timers.inactive), y.timers.inactive = setTimeout(function () {
          y.hide(a);
        }, s.hide.inactive);
      }

      function k(b) {
        if (D.hasClass(l) || B || C) return c;
        var f = a(b.relatedTarget || b.target),
            g = f.closest(m)[0] === D[0],
            h = f[0] === e.show[0];
        clearTimeout(y.timers.show), clearTimeout(y.timers.hide);
        if (d.target === "mouse" && g || s.hide.fixed && /mouse(out|leave|move)/.test(b.type) && (g || h)) try {
          b.preventDefault(), b.stopImmediatePropagation();
        } catch (i) {} else s.hide.delay > 0 ? y.timers.hide = setTimeout(function () {
          y.hide(b);
        }, s.hide.delay) : y.hide(b);
      }

      function j(a) {
        if (D.hasClass(l)) return c;
        clearTimeout(y.timers.show), clearTimeout(y.timers.hide);

        var d = function d() {
          y.toggle(b, a);
        };

        s.show.delay > 0 ? y.timers.show = setTimeout(d, s.show.delay) : d();
      }

      var d = s.position,
          e = {
        show: s.show.target,
        hide: s.hide.target,
        viewport: a(d.viewport),
        document: a(document),
        body: a(document.body),
        window: a(window)
      },
          g = {
        show: a.trim("" + s.show.event).split(" "),
        hide: a.trim("" + s.hide.event).split(" ")
      },
          i = a.browser.msie && parseInt(a.browser.version, 10) === 6;
      D.bind("mouseenter" + E + " mouseleave" + E, function (a) {
        var b = a.type === "mouseenter";
        b && y.focus(a), D.toggleClass(p, b);
      }), s.hide.fixed && (e.hide = e.hide.add(D), D.bind("mouseover" + E, function () {
        D.hasClass(l) || clearTimeout(y.timers.hide);
      })), /mouse(out|leave)/i.test(s.hide.event) ? s.hide.leave === "window" && e.window.bind("mouseout" + E + " blur" + E, function (a) {
        /select|option/.test(a.target) && !a.relatedTarget && y.hide(a);
      }) : /mouse(over|enter)/i.test(s.show.event) && e.hide.bind("mouseleave" + E, function (a) {
        clearTimeout(y.timers.show);
      }), ("" + s.hide.event).indexOf("unfocus") > -1 && d.container.closest("html").bind("mousedown" + E, function (b) {
        var c = a(b.target),
            d = !D.hasClass(l) && D.is(":visible"),
            e = c.parents(m).filter(D[0]).length > 0;
        c[0] !== r[0] && c[0] !== D[0] && !e && !r.has(c[0]).length && !c.attr("disabled") && y.hide(b);
      }), "number" === typeof s.hide.inactive && (e.show.bind("qtip-" + v + "-inactive", n), a.each(f.inactiveEvents, function (a, b) {
        e.hide.add(F.tooltip).bind(b + E + "-inactive", n);
      })), a.each(g.hide, function (b, c) {
        var d = a.inArray(c, g.show),
            f = a(e.hide);
        d > -1 && f.add(e.show).length === f.length || c === "unfocus" ? (e.show.bind(c + E, function (a) {
          D.is(":visible") ? k(a) : j(a);
        }), delete g.show[d]) : e.hide.bind(c + E, k);
      }), a.each(g.show, function (a, b) {
        e.show.bind(b + E, j);
      }), "number" === typeof s.hide.distance && e.show.add(D).bind("mousemove" + E, function (a) {
        var b = G.origin || {},
            c = s.hide.distance,
            d = Math.abs;
        (d(a.pageX - b.pageX) >= c || d(a.pageY - b.pageY) >= c) && y.hide(a);
      }), d.target === "mouse" && (e.show.bind("mousemove" + E, function (a) {
        h = {
          pageX: a.pageX,
          pageY: a.pageY,
          type: "mousemove"
        };
      }), d.adjust.mouse && (s.hide.event && (D.bind("mouseleave" + E, function (a) {
        (a.relatedTarget || a.target) !== e.show[0] && y.hide(a);
      }), F.target.bind("mouseenter" + E + " mouseleave" + E, function (a) {
        G.onTarget = a.type === "mouseenter";
      })), e.document.bind("mousemove" + E, function (a) {
        G.onTarget && !D.hasClass(l) && D.is(":visible") && y.reposition(a || h);
      }))), (d.adjust.resize || e.viewport.length) && (a.event.special.resize ? e.viewport : e.window).bind("resize" + E, o), (e.viewport.length || i && D.css("position") === "fixed") && e.viewport.bind("scroll" + E, o);
    }

    function O(b, d) {
      function g(b) {
        function i(e) {
          e && (delete h[e.src], clearTimeout(y.timers.img[e.src]), a(e).unbind(E)), a.isEmptyObject(h) && (y.redraw(), d !== c && y.reposition(G.event), b());
        }

        var g,
            h = {};
        if ((g = f.find("img[src]:not([height]):not([width])")).length === 0) return i();
        g.each(function (b, c) {
          if (h[c.src] === e) {
            var d = 0,
                f = 3;
            (function g() {
              if (c.height || c.width || d > f) return i(c);
              d += 1, y.timers.img[c.src] = setTimeout(g, 700);
            })(), a(c).bind("error" + E + " load" + E, function () {
              i(this);
            }), h[c.src] = c;
          }
        });
      }

      var f = F.content;
      if (!y.rendered || !b) return c;
      a.isFunction(b) && (b = b.call(r, G.event, y) || ""), b.jquery && b.length > 0 ? f.empty().append(b.css({
        display: "block"
      })) : f.html(b), y.rendered < 0 ? D.queue("fx", g) : (C = 0, g(a.noop));
      return y;
    }

    function N(b, d) {
      var e = F.title;
      if (!y.rendered || !b) return c;
      a.isFunction(b) && (b = b.call(r, G.event, y));
      if (b === c || !b && b !== "") return J(c);
      b.jquery && b.length > 0 ? e.empty().append(b.css({
        display: "block"
      })) : e.html(b), y.redraw(), d !== c && y.rendered && D.is(":visible") && y.reposition(G.event);
    }

    function M(a) {
      var b = F.button,
          d = F.title;
      if (!y.rendered) return c;
      a ? (d || L(), K()) : b.remove();
    }

    function L() {
      var c = A + "-title";
      F.titlebar && J(), F.titlebar = a("<div />", {
        "class": j + "-titlebar " + (s.style.widget ? "ui-widget-header" : "")
      }).append(F.title = a("<div />", {
        id: c,
        "class": j + "-title",
        "aria-atomic": b
      })).insertBefore(F.content).delegate(".ui-tooltip-close", "mousedown keydown mouseup keyup mouseout", function (b) {
        a(this).toggleClass("ui-state-active ui-state-focus", b.type.substr(-4) === "down");
      }).delegate(".ui-tooltip-close", "mouseover mouseout", function (b) {
        a(this).toggleClass("ui-state-hover", b.type === "mouseover");
      }), s.content.title.button ? K() : y.rendered && y.redraw();
    }

    function K() {
      var b = s.content.title.button,
          d = typeof b === "string",
          e = d ? b : "Close tooltip";
      F.button && F.button.remove(), b.jquery ? F.button = b : F.button = a("<a />", {
        "class": "ui-state-default ui-tooltip-close " + (s.style.widget ? "" : j + "-icon"),
        title: e,
        "aria-label": e
      }).prepend(a("<span />", {
        "class": "ui-icon ui-icon-close",
        html: "&times;"
      })), F.button.appendTo(F.titlebar).attr("role", "button").click(function (a) {
        D.hasClass(l) || y.hide(a);
        return c;
      }), y.redraw();
    }

    function J(a) {
      F.title && (F.titlebar.remove(), F.titlebar = F.title = F.button = d, a !== c && y.reposition());
    }

    function I() {
      var a = s.style.widget;
      D.toggleClass(k, a).toggleClass(n, s.style.def && !a), F.content.toggleClass(k + "-content", a), F.titlebar && F.titlebar.toggleClass(k + "-header", a), F.button && F.button.toggleClass(j + "-icon", !a);
    }

    function H(a) {
      var b = 0,
          c,
          d = s,
          e = a.split(".");

      while (d = d[e[b++]]) {
        b < e.length && (c = d);
      }

      return [c || s, e.pop()];
    }

    var y = this,
        z = document.body,
        A = j + "-" + v,
        B = 0,
        C = 0,
        D = a(),
        E = ".qtip-" + v,
        F,
        G;
    y.id = v, y.rendered = c, y.elements = F = {
      target: r
    }, y.timers = {
      img: {}
    }, y.options = s, y.checks = {}, y.plugins = {}, y.cache = G = {
      event: {},
      target: a(),
      disabled: c,
      attr: x,
      onTarget: c
    }, y.checks.builtin = {
      "^id$": function id$(d, e, g) {
        var h = g === b ? f.nextid : g,
            i = j + "-" + h;
        h !== c && h.length > 0 && !a("#" + i).length && (D[0].id = i, F.content[0].id = i + "-content", F.title[0].id = i + "-title");
      },
      "^content.text$": function contentText$(a, b, c) {
        O(c);
      },
      "^content.title.text$": function contentTitleText$(a, b, c) {
        if (!c) return J();
        !F.title && c && L(), N(c);
      },
      "^content.title.button$": function contentTitleButton$(a, b, c) {
        M(c);
      },
      "^position.(my|at)$": function positionMyAt$(a, b, c) {
        "string" === typeof c && (a[b] = new g.Corner(c));
      },
      "^position.container$": function positionContainer$(a, b, c) {
        y.rendered && D.appendTo(c);
      },
      "^show.ready$": function showReady$() {
        y.rendered ? y.toggle(b) : y.render(1);
      },
      "^style.classes$": function styleClasses$(a, b, c) {
        D.attr("class", j + " qtip ui-helper-reset " + c);
      },
      "^style.widget|content.title": I,
      "^events.(render|show|move|hide|focus|blur)$": function eventsRenderShowMoveHideFocusBlur$(b, c, d) {
        D[(a.isFunction(d) ? "" : "un") + "bind"]("tooltip" + c, d);
      },
      "^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)": function showHidePositionEventTargetFixedInactiveLeaveDistanceViewportAdjust() {
        var a = s.position;
        D.attr("tracking", a.target === "mouse" && a.adjust.mouse), Q(), P();
      }
    }, a.extend(y, {
      render: function render(d) {
        if (y.rendered) return y;
        var e = s.content.text,
            f = s.content.title.text,
            h = s.position,
            i = a.Event("tooltiprender");
        a.attr(r[0], "aria-describedby", A), D = F.tooltip = a("<div/>", {
          id: A,
          "class": j + " qtip ui-helper-reset " + n + " " + s.style.classes + " " + j + "-pos-" + s.position.my.abbrev(),
          width: s.style.width || "",
          height: s.style.height || "",
          tracking: h.target === "mouse" && h.adjust.mouse,
          role: "alert",
          "aria-live": "polite",
          "aria-atomic": c,
          "aria-describedby": A + "-content",
          "aria-hidden": b
        }).toggleClass(l, G.disabled).data("qtip", y).appendTo(s.position.container).append(F.content = a("<div />", {
          "class": j + "-content",
          id: A + "-content",
          "aria-atomic": b
        })), y.rendered = -1, B = C = 1, f && (L(), a.isFunction(f) || N(f, c)), a.isFunction(e) || O(e, c), y.rendered = b, I(), a.each(s.events, function (b, c) {
          a.isFunction(c) && D.bind(b === "toggle" ? "tooltipshow tooltiphide" : "tooltip" + b, c);
        }), a.each(g, function () {
          this.initialize === "render" && this(y);
        }), P(), D.queue("fx", function (a) {
          i.originalEvent = G.event, D.trigger(i, [y]), B = C = 0, y.redraw(), (s.show.ready || d) && y.toggle(b, G.event, c), a();
        });
        return y;
      },
      get: function get(a) {
        var b, c;

        switch (a.toLowerCase()) {
          case "dimensions":
            b = {
              height: D.outerHeight(),
              width: D.outerWidth()
            };
            break;

          case "offset":
            b = g.offset(D, s.position.container);
            break;

          default:
            c = H(a.toLowerCase()), b = c[0][c[1]], b = b.precedance ? b.string() : b;
        }

        return b;
      },
      set: function set(e, f) {
        function m(a, b) {
          var c, d, e;

          for (c in k) {
            for (d in k[c]) {
              if (e = new RegExp(d, "i").exec(a)) b.push(e), k[c][d].apply(y, b);
            }
          }
        }

        var g = /^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,
            h = /^content\.(title|attr)|style/i,
            i = c,
            j = c,
            k = y.checks,
            l;
        "string" === typeof e ? (l = e, e = {}, e[l] = f) : e = a.extend(b, {}, e), a.each(e, function (b, c) {
          var d = H(b.toLowerCase()),
              f;
          f = d[0][d[1]], d[0][d[1]] = "object" === _typeof(c) && c.nodeType ? a(c) : c, e[b] = [d[0], d[1], c, f], i = g.test(b) || i, j = h.test(b) || j;
        }), w(s), B = C = 1, a.each(e, m), B = C = 0, D.is(":visible") && y.rendered && (i && y.reposition(s.position.target === "mouse" ? d : G.event), j && y.redraw());
        return y;
      },
      toggle: function toggle(e, f) {
        function r() {
          e ? (a.browser.msie && D[0].style.removeAttribute("filter"), D.css("overflow", ""), "string" === typeof i.autofocus && a(i.autofocus, D).focus(), i.target.trigger("qtip-" + v + "-inactive")) : D.css({
            display: "",
            visibility: "",
            opacity: "",
            left: "",
            top: ""
          }), q = a.Event("tooltip" + (e ? "visible" : "hidden")), q.originalEvent = f ? G.event : d, D.trigger(q, [y]);
        }

        if (!y.rendered) return e ? y.render(1) : y;
        var g = e ? "show" : "hide",
            i = s[g],
            j = D.is(":visible"),
            k = !f || i.target.length < 2 || G.target[0] === f.target,
            l = f && i.target.add(f.target).length !== i.target.length,
            n = s.position,
            o = s.content,
            p,
            q;
        _typeof(e).search("boolean|number") && (e = !j);
        if (!D.is(":animated") && j === e && k) return y;

        if (f) {
          if (/over|enter/.test(f.type) && /out|leave/.test(G.event.type) && s.show.target.add(f.target).length === s.show.target.length && D.has(f.relatedTarget).length) return y;
          G.event = a.extend({}, f);
        }

        q = a.Event("tooltip" + g), q.originalEvent = f ? G.event : d, D.trigger(q, [y, 90]);
        if (q.isDefaultPrevented()) return y;
        a.attr(D[0], "aria-hidden", !e), e ? (G.origin = a.extend({}, h), y.focus(f), a.isFunction(o.text) && O(o.text, c), a.isFunction(o.title.text) && N(o.title.text, c), !u && n.target === "mouse" && n.adjust.mouse && (a(document).bind("mousemove.qtip", function (a) {
          h = {
            pageX: a.pageX,
            pageY: a.pageY,
            type: "mousemove"
          };
        }), u = b), y.reposition(f, arguments[2]), (q.solo = !!i.solo) && a(m, i.solo).not(D).qtip("hide", q)) : (clearTimeout(y.timers.show), delete G.origin, u && !a(m + '[tracking="true"]:visible', i.solo).not(D).length && (a(document).unbind("mousemove.qtip"), u = c), y.blur(f)), D.stop(l, !l), i.effect === c ? (D[g](), r.call(D)) : a.isFunction(i.effect) ? (i.effect.call(D, y), D.queue("fx", function (a) {
          r(), a();
        })) : D.fadeTo(90, e ? 1 : 0, r), e && i.target.trigger("qtip-" + v + "-inactive");
        return y;
      },
      show: function show(a) {
        return y.toggle(b, a);
      },
      hide: function hide(a) {
        return y.toggle(c, a);
      },
      focus: function focus(b) {
        if (!y.rendered) return y;
        var c = a(m),
            d = parseInt(D[0].style.zIndex, 10),
            e = f.zindex + c.length,
            g = a.extend({}, b),
            h,
            i;
        D.hasClass(o) || (i = a.Event("tooltipfocus"), i.originalEvent = g, D.trigger(i, [y, e]), i.isDefaultPrevented() || (d !== e && (c.each(function () {
          this.style.zIndex > d && (this.style.zIndex = this.style.zIndex - 1);
        }), c.filter("." + o).qtip("blur", g)), D.addClass(o)[0].style.zIndex = e));
        return y;
      },
      blur: function blur(b) {
        var c = a.extend({}, b),
            d;
        D.removeClass(o), d = a.Event("tooltipblur"), d.originalEvent = c, D.trigger(d, [y]);
        return y;
      },
      reposition: function reposition(b, d) {
        if (!y.rendered || B) return y;
        B = 1;
        var e = s.position.target,
            f = s.position,
            i = f.my,
            k = f.at,
            l = f.adjust,
            m = l.method.split(" "),
            n = D.outerWidth(),
            o = D.outerHeight(),
            p = 0,
            q = 0,
            r = a.Event("tooltipmove"),
            t = D.css("position") === "fixed",
            u = f.viewport,
            v = {
          left: 0,
          top: 0
        },
            w = f.container,
            x = c,
            A = y.plugins.tip,
            C = {
          horizontal: m[0],
          vertical: m[1] = m[1] || m[0],
          enabled: u.jquery && e[0] !== window && e[0] !== z && l.method !== "none",
          left: function left(a) {
            var b = C.horizontal === "shift",
                c = -w.offset.left + u.offset.left + u.scrollLeft,
                d = i.x === "left" ? n : i.x === "right" ? -n : -n / 2,
                e = k.x === "left" ? p : k.x === "right" ? -p : -p / 2,
                f = A && A.size ? A.size.width || 0 : 0,
                g = A && A.corner && A.corner.precedance === "x" && !b ? f : 0,
                h = c - a + g,
                j = a + n - u.width - c + g,
                m = d - (i.precedance === "x" || i.x === i.y ? e : 0) - (k.x === "center" ? p / 2 : 0),
                o = i.x === "center";
            b ? (g = A && A.corner && A.corner.precedance === "y" ? f : 0, m = (i.x === "left" ? 1 : -1) * d - g, v.left += h > 0 ? h : j > 0 ? -j : 0, v.left = Math.max(-w.offset.left + u.offset.left + (g && A.corner.x === "center" ? A.offset : 0), a - m, Math.min(Math.max(-w.offset.left + u.offset.left + u.width, a + m), v.left))) : (h > 0 && (i.x !== "left" || j > 0) ? v.left -= m : j > 0 && (i.x !== "right" || h > 0) && (v.left -= o ? -m : m), v.left !== a && o && (v.left -= l.x), v.left < c && -v.left > j && (v.left = a));
            return v.left - a;
          },
          top: function top(a) {
            var b = C.vertical === "shift",
                c = -w.offset.top + u.offset.top + u.scrollTop,
                d = i.y === "top" ? o : i.y === "bottom" ? -o : -o / 2,
                e = k.y === "top" ? q : k.y === "bottom" ? -q : -q / 2,
                f = A && A.size ? A.size.height || 0 : 0,
                g = A && A.corner && A.corner.precedance === "y" && !b ? f : 0,
                h = c - a + g,
                j = a + o - u.height - c + g,
                m = d - (i.precedance === "y" || i.x === i.y ? e : 0) - (k.y === "center" ? q / 2 : 0),
                n = i.y === "center";
            b ? (g = A && A.corner && A.corner.precedance === "x" ? f : 0, m = (i.y === "top" ? 1 : -1) * d - g, v.top += h > 0 ? h : j > 0 ? -j : 0, v.top = Math.max(-w.offset.top + u.offset.top + (g && A.corner.x === "center" ? A.offset : 0), a - m, Math.min(Math.max(-w.offset.top + u.offset.top + u.height, a + m), v.top))) : (h > 0 && (i.y !== "top" || j > 0) ? v.top -= m : j > 0 && (i.y !== "bottom" || h > 0) && (v.top -= n ? -m : m), v.top !== a && n && (v.top -= l.y), v.top < 0 && -v.top > j && (v.top = a));
            return v.top - a;
          }
        },
            E;
        if (a.isArray(e) && e.length === 2) k = {
          x: "left",
          y: "top"
        }, v = {
          left: e[0],
          top: e[1]
        };else if (e === "mouse" && (b && b.pageX || G.event.pageX)) k = {
          x: "left",
          y: "top"
        }, b = (b && (b.type === "resize" || b.type === "scroll") ? G.event : b && b.pageX && b.type === "mousemove" ? b : h && h.pageX && (l.mouse || !b || !b.pageX) ? {
          pageX: h.pageX,
          pageY: h.pageY
        } : !l.mouse && G.origin && G.origin.pageX && s.show.distance ? G.origin : b) || b || G.event || h || {}, v = {
          top: b.pageY,
          left: b.pageX
        };else {
          e === "event" ? b && b.target && b.type !== "scroll" && b.type !== "resize" ? e = G.target = a(b.target) : e = G.target : e = G.target = a(e.jquery ? e : F.target), e = a(e).eq(0);
          if (e.length === 0) return y;
          e[0] === document || e[0] === window ? (p = g.iOS ? window.innerWidth : e.width(), q = g.iOS ? window.innerHeight : e.height(), e[0] === window && (v = {
            top: (u || e).scrollTop(),
            left: (u || e).scrollLeft()
          })) : e.is("area") && g.imagemap ? v = g.imagemap(e, k, C.enabled ? m : c) : e[0].namespaceURI === "http://www.w3.org/2000/svg" && g.svg ? v = g.svg(e, k) : (p = e.outerWidth(), q = e.outerHeight(), v = g.offset(e, w)), v.offset && (p = v.width, q = v.height, x = v.flipoffset, v = v.offset);
          if (g.iOS < 4.1 && g.iOS > 3.1 || g.iOS == 4.3 || !g.iOS && t) E = a(window), v.left -= E.scrollLeft(), v.top -= E.scrollTop();
          v.left += k.x === "right" ? p : k.x === "center" ? p / 2 : 0, v.top += k.y === "bottom" ? q : k.y === "center" ? q / 2 : 0;
        }
        v.left += l.x + (i.x === "right" ? -n : i.x === "center" ? -n / 2 : 0), v.top += l.y + (i.y === "bottom" ? -o : i.y === "center" ? -o / 2 : 0), C.enabled ? (u = {
          elem: u,
          height: u[(u[0] === window ? "h" : "outerH") + "eight"](),
          width: u[(u[0] === window ? "w" : "outerW") + "idth"](),
          scrollLeft: t ? 0 : u.scrollLeft(),
          scrollTop: t ? 0 : u.scrollTop(),
          offset: u.offset() || {
            left: 0,
            top: 0
          }
        }, w = {
          elem: w,
          scrollLeft: w.scrollLeft(),
          scrollTop: w.scrollTop(),
          offset: w.offset() || {
            left: 0,
            top: 0
          }
        }, v.adjusted = {
          left: C.horizontal !== "none" ? C.left(v.left) : 0,
          top: C.vertical !== "none" ? C.top(v.top) : 0
        }, v.adjusted.left + v.adjusted.top && D.attr("class", D[0].className.replace(/ui-tooltip-pos-\w+/i, j + "-pos-" + i.abbrev())), x && v.adjusted.left && (v.left += x.left), x && v.adjusted.top && (v.top += x.top)) : v.adjusted = {
          left: 0,
          top: 0
        }, r.originalEvent = a.extend({}, b), D.trigger(r, [y, v, u.elem || u]);
        if (r.isDefaultPrevented()) return y;
        delete v.adjusted, d === c || isNaN(v.left) || isNaN(v.top) || e === "mouse" || !a.isFunction(f.effect) ? D.css(v) : a.isFunction(f.effect) && (f.effect.call(D, y, a.extend({}, v)), D.queue(function (b) {
          a(this).css({
            opacity: "",
            height: ""
          }), a.browser.msie && this.style.removeAttribute("filter"), b();
        })), B = 0;
        return y;
      },
      redraw: function redraw() {
        if (y.rendered < 1 || C) return y;
        var a = s.position.container,
            b,
            c,
            d,
            e;
        C = 1, s.style.height && D.css("height", s.style.height), s.style.width ? D.css("width", s.style.width) : (D.css("width", "").addClass(q), c = D.width() + 1, d = D.css("max-width") || "", e = D.css("min-width") || "", b = (d + e).indexOf("%") > -1 ? a.width() / 100 : 0, d = (d.indexOf("%") > -1 ? b : 1) * parseInt(d, 10) || c, e = (e.indexOf("%") > -1 ? b : 1) * parseInt(e, 10) || 0, c = d + e ? Math.min(Math.max(c, e), d) : c, D.css("width", Math.round(c)).removeClass(q)), C = 0;
        return y;
      },
      disable: function disable(b) {
        "boolean" !== typeof b && (b = !D.hasClass(l) && !G.disabled), y.rendered ? (D.toggleClass(l, b), a.attr(D[0], "aria-disabled", b)) : G.disabled = !!b;
        return y;
      },
      enable: function enable() {
        return y.disable(c);
      },
      destroy: function destroy() {
        var b = r[0],
            c = a.attr(b, t),
            d = r.data("qtip");
        y.rendered && (D.stop(1, 0).remove(), a.each(y.plugins, function () {
          this.destroy && this.destroy();
        })), clearTimeout(y.timers.show), clearTimeout(y.timers.hide), Q();
        if (!d || y === d) a.removeData(b, "qtip"), s.suppress && c && (a.attr(b, "title", c), r.removeAttr(t)), r.removeAttr("aria-describedby");
        r.unbind(".qtip-" + v), delete i[y.id];
        return r;
      }
    });
  }

  function w(b) {
    var e;
    if (!b || "object" !== _typeof(b)) return c;
    if (b.metadata === d || "object" !== _typeof(b.metadata)) b.metadata = {
      type: b.metadata
    };

    if ("content" in b) {
      if (b.content === d || "object" !== _typeof(b.content) || b.content.jquery) b.content = {
        text: b.content
      };
      e = b.content.text || c, !a.isFunction(e) && (!e && !e.attr || e.length < 1 || "object" === _typeof(e) && !e.jquery) && (b.content.text = c);

      if ("title" in b.content) {
        if (b.content.title === d || "object" !== _typeof(b.content.title)) b.content.title = {
          text: b.content.title
        };
        e = b.content.title.text || c, !a.isFunction(e) && (!e && !e.attr || e.length < 1 || "object" === _typeof(e) && !e.jquery) && (b.content.title.text = c);
      }
    }

    if ("position" in b) if (b.position === d || "object" !== _typeof(b.position)) b.position = {
      my: b.position,
      at: b.position
    };
    if ("show" in b) if (b.show === d || "object" !== _typeof(b.show)) b.show.jquery ? b.show = {
      target: b.show
    } : b.show = {
      event: b.show
    };
    if ("hide" in b) if (b.hide === d || "object" !== _typeof(b.hide)) b.hide.jquery ? b.hide = {
      target: b.hide
    } : b.hide = {
      event: b.hide
    };
    if ("style" in b) if (b.style === d || "object" !== _typeof(b.style)) b.style = {
      classes: b.style
    };
    a.each(g, function () {
      this.sanitize && this.sanitize(b);
    });
    return b;
  }

  function v() {
    v.history = v.history || [], v.history.push(arguments);

    if ("object" === (typeof console === "undefined" ? "undefined" : _typeof(console))) {
      var a = console[console.warn ? "warn" : "log"],
          b = Array.prototype.slice.call(arguments),
          c;
      typeof arguments[0] === "string" && (b[0] = "qTip2: " + b[0]), c = a.apply ? a.apply(console, b) : a(b);
    }
  }

  "use strict";

  var b = !0,
      c = !1,
      d = null,
      e,
      f,
      g,
      h,
      i = {},
      j = "ui-tooltip",
      k = "ui-widget",
      l = "ui-state-disabled",
      m = "div.qtip." + j,
      n = j + "-default",
      o = j + "-focus",
      p = j + "-hover",
      q = j + "-fluid",
      r = "-31000px",
      s = "_replacedByqTip",
      t = "oldtitle",
      u;
  f = a.fn.qtip = function (g, h, i) {
    var j = ("" + g).toLowerCase(),
        k = d,
        l = a.makeArray(arguments).slice(1),
        m = l[l.length - 1],
        n = this[0] ? a.data(this[0], "qtip") : d;
    if (!arguments.length && n || j === "api") return n;

    if ("string" === typeof g) {
      this.each(function () {
        var d = a.data(this, "qtip");
        if (!d) return b;
        m && m.timeStamp && (d.cache.event = m);
        if (j !== "option" && j !== "options" || !h) d[j] && d[j].apply(d[j], l);else if (a.isPlainObject(h) || i !== e) d.set(h, i);else {
          k = d.get(h);
          return c;
        }
      });
      return k !== d ? k : this;
    }

    if ("object" === _typeof(g) || !arguments.length) {
      n = w(a.extend(b, {}, g));
      return f.bind.call(this, n, m);
    }
  }, f.bind = function (d, j) {
    return this.each(function (k) {
      function r(b) {
        function d() {
          p.render(_typeof(b) === "object" || l.show.ready), m.show.add(m.hide).unbind(o);
        }

        if (p.cache.disabled) return c;
        p.cache.event = a.extend({}, b), p.cache.target = b ? a(b.target) : [e], l.show.delay > 0 ? (clearTimeout(p.timers.show), p.timers.show = setTimeout(d, l.show.delay), n.show !== n.hide && m.hide.bind(n.hide, function () {
          clearTimeout(p.timers.show);
        })) : d();
      }

      var l, m, n, o, p, q;
      q = a.isArray(d.id) ? d.id[k] : d.id, q = !q || q === c || q.length < 1 || i[q] ? f.nextid++ : i[q] = q, o = ".qtip-" + q + "-create", p = y.call(this, q, d);
      if (p === c) return b;
      l = p.options, a.each(g, function () {
        this.initialize === "initialize" && this(p);
      }), m = {
        show: l.show.target,
        hide: l.hide.target
      }, n = {
        show: a.trim("" + l.show.event).replace(/ /g, o + " ") + o,
        hide: a.trim("" + l.hide.event).replace(/ /g, o + " ") + o
      }, /mouse(over|enter)/i.test(n.show) && !/mouse(out|leave)/i.test(n.hide) && (n.hide += " mouseleave" + o), m.show.bind("mousemove" + o, function (a) {
        h = {
          pageX: a.pageX,
          pageY: a.pageY,
          type: "mousemove"
        }, p.cache.onTarget = b;
      }), m.show.bind(n.show, r), (l.show.ready || l.prerender) && r(j);
    });
  }, g = f.plugins = {
    Corner: function Corner(a) {
      a = ("" + a).replace(/([A-Z])/, " $1").replace(/middle/gi, "center").toLowerCase(), this.x = (a.match(/left|right/i) || a.match(/center/) || ["inherit"])[0].toLowerCase(), this.y = (a.match(/top|bottom|center/i) || ["inherit"])[0].toLowerCase();
      var b = a.charAt(0);
      this.precedance = b === "t" || b === "b" ? "y" : "x", this.string = function () {
        return this.precedance === "y" ? this.y + this.x : this.x + this.y;
      }, this.abbrev = function () {
        var a = this.x.substr(0, 1),
            b = this.y.substr(0, 1);
        return a === b ? a : a === "c" || a !== "c" && b !== "c" ? b + a : a + b;
      }, this.clone = function () {
        return {
          x: this.x,
          y: this.y,
          precedance: this.precedance,
          string: this.string,
          abbrev: this.abbrev,
          clone: this.clone
        };
      };
    },
    offset: function offset(b, c) {
      function j(a, b) {
        d.left += b * a.scrollLeft(), d.top += b * a.scrollTop();
      }

      var d = b.offset(),
          e = b.closest("body")[0],
          f = c,
          g,
          h,
          i;

      if (f) {
        do {
          f.css("position") !== "static" && (h = f.position(), d.left -= h.left + (parseInt(f.css("borderLeftWidth"), 10) || 0) + (parseInt(f.css("marginLeft"), 10) || 0), d.top -= h.top + (parseInt(f.css("borderTopWidth"), 10) || 0) + (parseInt(f.css("marginTop"), 10) || 0), !g && (i = f.css("overflow")) !== "hidden" && i !== "visible" && (g = f));
        } while ((f = a(f[0].offsetParent)).length);

        g && g[0] !== e && j(g, 1);
      }

      return d;
    },
    iOS: parseFloat(("" + (/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ""])[1]).replace("undefined", "3_2").replace("_", ".")) || c,
    fn: {
      attr: function attr(b, c) {
        if (this.length) {
          var d = this[0],
              e = "title",
              f = a.data(d, "qtip");

          if (b === e && f && "object" === _typeof(f) && f.options.suppress) {
            if (arguments.length < 2) return a.attr(d, t);
            f && f.options.content.attr === e && f.cache.attr && f.set("content.text", c);
            return this.attr(t, c);
          }
        }

        return a.fn["attr" + s].apply(this, arguments);
      },
      clone: function clone(b) {
        var c = a([]),
            d = "title",
            e = a.fn["clone" + s].apply(this, arguments);
        b || e.filter("[" + t + "]").attr("title", function () {
          return a.attr(this, t);
        }).removeAttr(t);
        return e;
      }
    }
  }, a.each(g.fn, function (c, d) {
    if (!d || a.fn[c + s]) return b;
    var e = a.fn[c + s] = a.fn[c];

    a.fn[c] = function () {
      return d.apply(this, arguments) || e.apply(this, arguments);
    };
  }), a.ui || (a["cleanData" + s] = a.cleanData, a.cleanData = function (b) {
    for (var c = 0, d; (d = b[c]) !== e; c++) {
      try {
        a(d).triggerHandler("removeqtip");
      } catch (f) {}
    }

    a["cleanData" + s](b);
  }), f.version = "nightly", f.nextid = 0, f.inactiveEvents = "click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "), f.zindex = 15e3, f.defaults = {
    prerender: c,
    id: c,
    overwrite: b,
    suppress: b,
    content: {
      text: b,
      attr: "title",
      title: {
        text: c,
        button: c
      }
    },
    position: {
      my: "top left",
      at: "bottom right",
      target: c,
      container: c,
      viewport: c,
      adjust: {
        x: 0,
        y: 0,
        mouse: b,
        resize: b,
        method: "flip flip"
      },
      effect: function effect(b, d, e) {
        a(this).animate(d, {
          duration: 200,
          queue: c
        });
      }
    },
    show: {
      target: c,
      event: "mouseenter",
      effect: b,
      delay: 90,
      solo: c,
      ready: c,
      autofocus: c
    },
    hide: {
      target: c,
      event: "mouseleave",
      effect: b,
      delay: 0,
      fixed: c,
      inactive: c,
      leave: "window",
      distance: c
    },
    style: {
      classes: "",
      widget: c,
      width: c,
      height: c,
      def: b
    },
    events: {
      render: d,
      move: d,
      show: d,
      hide: d,
      toggle: d,
      visible: d,
      hidden: d,
      focus: d,
      blur: d
    }
  }, g.ajax = function (a) {
    var b = a.plugins.ajax;
    return "object" === _typeof(b) ? b : a.plugins.ajax = new z(a);
  }, g.ajax.initialize = "render", g.ajax.sanitize = function (a) {
    var b = a.content,
        c;
    b && "ajax" in b && (c = b.ajax, _typeof(c) !== "object" && (c = a.content.ajax = {
      url: c
    }), "boolean" !== typeof c.once && c.once && (c.once = !!c.once));
  }, a.extend(b, f.defaults, {
    content: {
      ajax: {
        loading: b,
        once: b
      }
    }
  });
});

/***/ }),

/***/ "./common/static/js/vendor/jquery.smooth-scroll.min.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {/*!
 * Smooth Scroll - v1.4.10 - 2013-03-02
 * https://github.com/kswedberg/jquery-smooth-scroll
 * Copyright (c) 2013 Karl Swedberg
 * Licensed MIT (https://github.com/kswedberg/jquery-smooth-scroll/blob/master/LICENSE-MIT)
 */
(function (l) {
  function t(l) {
    return l.replace(/(:|\.)/g, "\\$1");
  }

  var e = "1.4.10",
      o = {
    exclude: [],
    excludeWithin: [],
    offset: 0,
    direction: "top",
    scrollElement: null,
    scrollTarget: null,
    beforeScroll: function beforeScroll() {},
    afterScroll: function afterScroll() {},
    easing: "swing",
    speed: 400,
    autoCoefficent: 2
  },
      r = function r(t) {
    var e = [],
        o = !1,
        r = t.dir && "left" == t.dir ? "scrollLeft" : "scrollTop";
    return this.each(function () {
      if (this != document && this != window) {
        var t = l(this);
        t[r]() > 0 ? e.push(this) : (t[r](1), o = t[r]() > 0, o && e.push(this), t[r](0));
      }
    }), e.length || this.each(function () {
      "BODY" === this.nodeName && (e = [this]);
    }), "first" === t.el && e.length > 1 && (e = [e[0]]), e;
  };

  l.fn.extend({
    scrollable: function scrollable(l) {
      var t = r.call(this, {
        dir: l
      });
      return this.pushStack(t);
    },
    firstScrollable: function firstScrollable(l) {
      var t = r.call(this, {
        el: "first",
        dir: l
      });
      return this.pushStack(t);
    },
    smoothScroll: function smoothScroll(e) {
      e = e || {};
      var o = l.extend({}, l.fn.smoothScroll.defaults, e),
          r = l.smoothScroll.filterPath(location.pathname);
      return this.unbind("click.smoothscroll").bind("click.smoothscroll", function (e) {
        var n = this,
            s = l(this),
            c = o.exclude,
            i = o.excludeWithin,
            a = 0,
            f = 0,
            h = !0,
            u = {},
            d = location.hostname === n.hostname || !n.hostname,
            m = o.scrollTarget || (l.smoothScroll.filterPath(n.pathname) || r) === r,
            p = t(n.hash);

        if (o.scrollTarget || d && m && p) {
          for (; h && c.length > a;) {
            s.is(t(c[a++])) && (h = !1);
          }

          for (; h && i.length > f;) {
            s.closest(i[f++]).length && (h = !1);
          }
        } else h = !1;

        h && (e.preventDefault(), l.extend(u, o, {
          scrollTarget: o.scrollTarget || p,
          link: n
        }), l.smoothScroll(u));
      }), this;
    }
  }), l.smoothScroll = function (t, e) {
    var o,
        r,
        n,
        s,
        c = 0,
        i = "offset",
        a = "scrollTop",
        f = {},
        h = {};
    "number" == typeof t ? (o = l.fn.smoothScroll.defaults, n = t) : (o = l.extend({}, l.fn.smoothScroll.defaults, t || {}), o.scrollElement && (i = "position", "static" == o.scrollElement.css("position") && o.scrollElement.css("position", "relative"))), o = l.extend({
      link: null
    }, o), a = "left" == o.direction ? "scrollLeft" : a, o.scrollElement ? (r = o.scrollElement, c = r[a]()) : r = l("html, body").firstScrollable(), o.beforeScroll.call(r, o), n = "number" == typeof t ? t : e || l(o.scrollTarget)[i]() && l(o.scrollTarget)[i]()[o.direction] || 0, f[a] = n + c + o.offset, s = o.speed, "auto" === s && (s = f[a] || r.scrollTop(), s /= o.autoCoefficent), h = {
      duration: s,
      easing: o.easing,
      complete: function complete() {
        o.afterScroll.call(o.link, o);
      }
    }, o.step && (h.step = o.step), r.length ? r.stop().animate(f, h) : o.afterScroll.call(o.link, o);
  }, l.smoothScroll.version = e, l.smoothScroll.filterPath = function (l) {
    return l.replace(/^\//, "").replace(/(index|default).[a-zA-Z]{3,4}$/, "").replace(/\/$/, "");
  }, l.fn.smoothScroll.defaults = o;
})(jQuery);
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))

/***/ }),

/***/ "./common/static/js/vendor/timepicker/datepair.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/************************
datepair.js

This is a component of the jquery-timepicker plugin

http://jonthornton.github.com/jquery-timepicker/

requires jQuery 1.6+

version: 1.2.2
************************/
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__("./common/static/js/vendor/jquery-ui.min.js"), __webpack_require__("./common/static/js/vendor/timepicker/jquery.timepicker.js")], __WEBPACK_AMD_DEFINE_RESULT__ = function ($) {
  $(function () {
    $('.datepair input.date').each(function () {
      var $this = $(this);
      $this.datepicker({
        'dateFormat': 'm/d/yy'
      });

      if ($this.hasClass('start') || $this.hasClass('end')) {
        $this.on('changeDate change', doDatepair);
      }
    });
    $('.datepair input.time').each(function () {
      var $this = $(this);
      var opts = {
        'showDuration': true,
        'timeFormat': 'H:i',
        'scrollDefaultNow': true
      };

      if ($this.hasClass('start') || $this.hasClass('end')) {
        opts.onSelect = doDatepair;
      }

      $this.timepicker(opts);
    });
    $('.datepair').each(initDatepair);

    function initDatepair() {
      var container = $(this);
      var startDateInput = container.find('input.start.date');
      var endDateInput = container.find('input.end.date');
      var dateDelta = 0;

      if (startDateInput.length && endDateInput.length) {
        var startDate = new Date(startDateInput.val());
        var endDate = new Date(endDateInput.val());
        dateDelta = endDate.getTime() - startDate.getTime();
        container.data('dateDelta', dateDelta);
      }

      var startTimeInput = container.find('input.start.time');
      var endTimeInput = container.find('input.end.time');

      if (startTimeInput.length && endTimeInput.length) {
        var startInt = startTimeInput.timepicker('getSecondsFromMidnight');
        var endInt = endTimeInput.timepicker('getSecondsFromMidnight');
        container.data('timeDelta', endInt - startInt);

        if (dateDelta < 86400000) {
          endTimeInput.timepicker('option', 'minTime', startInt);
        }
      }
    }

    function doDatepair() {
      var target = $(this);

      if (target.val() == '') {
        return;
      }

      var container = target.closest('.datepair');

      if (target.hasClass('date')) {
        updateDatePair(target, container);
      } else if (target.hasClass('time')) {
        updateTimePair(target, container);
      }
    }

    function updateDatePair(target, container) {
      var start = container.find('input.start.date');
      var end = container.find('input.end.date');

      if (!start.length || !end.length) {
        return;
      }

      var startDate = new Date(start.val());
      var endDate = new Date(end.val());
      var oldDelta = container.data('dateDelta');

      if (oldDelta && target.hasClass('start')) {
        var newEnd = new Date(startDate.getTime() + oldDelta);
        end.val(newEnd.format('m/d/Y'));
        end.datepicker('update');
        return;
      } else {
        var newDelta = endDate.getTime() - startDate.getTime();

        if (newDelta < 0) {
          newDelta = 0;

          if (target.hasClass('start')) {
            end.val(startDate.format('m/d/Y'));
            end.datepicker('update');
          } else if (target.hasClass('end')) {
            start.val(endDate.format('m/d/Y'));
            start.datepicker('update');
          }
        }

        if (newDelta < 86400000) {
          var startTimeVal = container.find('input.start.time').val();

          if (startTimeVal) {
            container.find('input.end.time').timepicker('option', {
              'minTime': startTimeVal
            });
          }
        } else {
          container.find('input.end.time').timepicker('option', {
            'minTime': null
          });
        }

        container.data('dateDelta', newDelta);
      }
    }

    function updateTimePair(target, container) {
      var start = container.find('input.start.time');
      var end = container.find('input.end.time');

      if (!start.length || !end.length) {
        return;
      }

      var startInt = start.timepicker('getSecondsFromMidnight');
      var endInt = end.timepicker('getSecondsFromMidnight');
      var oldDelta = container.data('timeDelta');
      var dateDelta = container.data('dateDelta');

      if (target.hasClass('start') && (!dateDelta || dateDelta < 86400000)) {
        end.timepicker('option', 'minTime', startInt);
      }

      var endDateAdvance = 0;
      var newDelta;

      if (oldDelta && target.hasClass('start')) {
        // lock the duration and advance the end time
        var newEnd = (startInt + oldDelta) % 86400;

        if (newEnd < 0) {
          newEnd += 86400;
        }

        end.timepicker('setTime', newEnd);
        newDelta = newEnd - startInt;
      } else if (startInt !== null && endInt !== null) {
        newDelta = endInt - startInt;
      } else {
        return;
      }

      container.data('timeDelta', newDelta);

      if (newDelta < 0 && (!oldDelta || oldDelta > 0)) {
        // overnight time span. advance the end date 1 day
        var endDateAdvance = 86400000;
      } else if (newDelta > 0 && oldDelta < 0) {
        // switching from overnight to same-day time span. decrease the end date 1 day
        var endDateAdvance = -86400000;
      }

      var startInput = container.find('.start.date');
      var endInput = container.find('.end.date');

      if (startInput.val() && !endInput.val()) {
        endInput.val(startInput.val());
        endInput.datepicker('update');
        dateDelta = 0;
        container.data('dateDelta', 0);
      }

      if (endDateAdvance != 0) {
        if (dateDelta || dateDelta === 0) {
          var endDate = new Date(endInput.val());
          var newEnd = new Date(endDate.getTime() + endDateAdvance);
          endInput.val(newEnd.format('m/d/Y'));
          endInput.datepicker('update');
          container.data('dateDelta', dateDelta + endDateAdvance);
        }
      }
    }
  }); // Simulates PHP's date function

  Date.prototype.format = function (format) {
    var returnStr = '';
    var replace = Date.replaceChars;

    for (var i = 0; i < format.length; i++) {
      var curChar = format.charAt(i);

      if (replace[curChar]) {
        returnStr += replace[curChar].call(this);
      } else {
        returnStr += curChar;
      }
    }

    return returnStr;
  };

  Date.replaceChars = {
    shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    longMonths: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    shortDays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
    longDays: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
    d: function d() {
      return (this.getDate() < 10 ? '0' : '') + this.getDate();
    },
    D: function D() {
      return Date.replaceChars.shortDays[this.getDay()];
    },
    j: function j() {
      return this.getDate();
    },
    l: function l() {
      return Date.replaceChars.longDays[this.getDay()];
    },
    N: function N() {
      return this.getDay() + 1;
    },
    S: function S() {
      return this.getDate() % 10 == 1 && this.getDate() != 11 ? 'st' : this.getDate() % 10 == 2 && this.getDate() != 12 ? 'nd' : this.getDate() % 10 == 3 && this.getDate() != 13 ? 'rd' : 'th';
    },
    w: function w() {
      return this.getDay();
    },
    z: function z() {
      return "Not Yet Supported";
    },
    W: function W() {
      return "Not Yet Supported";
    },
    F: function F() {
      return Date.replaceChars.longMonths[this.getMonth()];
    },
    m: function m() {
      return (this.getMonth() < 9 ? '0' : '') + (this.getMonth() + 1);
    },
    M: function M() {
      return Date.replaceChars.shortMonths[this.getMonth()];
    },
    n: function n() {
      return this.getMonth() + 1;
    },
    t: function t() {
      return "Not Yet Supported";
    },
    L: function L() {
      return this.getFullYear() % 4 == 0 && this.getFullYear() % 100 != 0 || this.getFullYear() % 400 == 0 ? '1' : '0';
    },
    o: function o() {
      return "Not Supported";
    },
    Y: function Y() {
      return this.getFullYear();
    },
    y: function y() {
      return ('' + this.getFullYear()).substr(2);
    },
    a: function a() {
      return this.getHours() < 12 ? 'am' : 'pm';
    },
    A: function A() {
      return this.getHours() < 12 ? 'AM' : 'PM';
    },
    B: function B() {
      return "Not Yet Supported";
    },
    g: function g() {
      return this.getHours() % 12 || 12;
    },
    G: function G() {
      return this.getHours();
    },
    h: function h() {
      return ((this.getHours() % 12 || 12) < 10 ? '0' : '') + (this.getHours() % 12 || 12);
    },
    H: function H() {
      return (this.getHours() < 10 ? '0' : '') + this.getHours();
    },
    i: function i() {
      return (this.getMinutes() < 10 ? '0' : '') + this.getMinutes();
    },
    s: function s() {
      return (this.getSeconds() < 10 ? '0' : '') + this.getSeconds();
    },
    e: function e() {
      return "Not Yet Supported";
    },
    I: function I() {
      return "Not Supported";
    },
    O: function O() {
      return (-this.getTimezoneOffset() < 0 ? '-' : '+') + (Math.abs(this.getTimezoneOffset() / 60) < 10 ? '0' : '') + Math.abs(this.getTimezoneOffset() / 60) + '00';
    },
    P: function P() {
      return (-this.getTimezoneOffset() < 0 ? '-' : '+') + (Math.abs(this.getTimezoneOffset() / 60) < 10 ? '0' : '') + Math.abs(this.getTimezoneOffset() / 60) + ':' + (Math.abs(this.getTimezoneOffset() % 60) < 10 ? '0' : '') + Math.abs(this.getTimezoneOffset() % 60);
    },
    T: function T() {
      var m = this.getMonth();
      this.setMonth(0);
      var result = this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/, '$1');
      this.setMonth(m);
      return result;
    },
    Z: function Z() {
      return -this.getTimezoneOffset() * 60;
    },
    c: function c() {
      return this.format("Y-m-d") + "T" + this.format("H:i:sP");
    },
    r: function r() {
      return this.toString();
    },
    U: function U() {
      return this.getTime() / 1000;
    }
  };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // end define()

/***/ }),

/***/ "./common/static/js/vendor/timepicker/jquery.timepicker.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/************************
jquery-timepicker
http://jonthornton.github.com/jquery-timepicker/

requires jQuery 1.7+
************************/
(function (factory) {
  if (true) {
    // AMD. Register as an anonymous module.
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {
    // Browser globals
    factory(jQuery);
  }
})(function ($) {
  var _baseDate = _generateBaseDate();

  var _ONE_DAY = 86400;

  var _closeEvent = 'ontouchstart' in document ? 'touchstart' : 'mousedown';

  var _defaults = {
    className: null,
    minTime: null,
    maxTime: null,
    durationTime: null,
    step: 30,
    showDuration: false,
    timeFormat: 'g:ia',
    scrollDefaultNow: false,
    scrollDefaultTime: false,
    selectOnBlur: false,
    forceRoundTime: false,
    appendTo: 'body'
  };
  var _lang = {
    decimal: '.',
    mins: 'mins',
    hr: 'hr',
    hrs: 'hrs'
  };
  var globalInit = false;
  var methods = {
    init: function init(options) {
      return this.each(function () {
        var self = $(this); // convert dropdowns to text input

        if (self[0].tagName == 'SELECT') {
          var input = $('<input />');
          var attrs = {
            'type': 'text',
            'value': self.val()
          };
          var raw_attrs = self[0].attributes;

          for (var i = 0; i < raw_attrs.length; i++) {
            attrs[raw_attrs[i].nodeName] = raw_attrs[i].nodeValue;
          }

          input.attr(attrs);
          self.replaceWith(input);
          self = input;
        }

        var settings = $.extend({}, _defaults);

        if (options) {
          settings = $.extend(settings, options);
        }

        if (settings.minTime) {
          settings.minTime = _time2int(settings.minTime);
        }

        if (settings.maxTime) {
          settings.maxTime = _time2int(settings.maxTime);
        }

        if (settings.durationTime) {
          settings.durationTime = _time2int(settings.durationTime);
        }

        if (settings.lang) {
          _lang = $.extend(_lang, settings.lang);
        }

        self.data('timepicker-settings', settings);
        self.attr('autocomplete', 'off');
        self.on('click.timepicker focus.timepicker', methods.show);
        self.on('blur.timepicker', _formatValue);
        self.on('keydown.timepicker', _keyhandler);
        self.addClass('ui-timepicker-input');

        _formatValue.call(self.get(0));

        if (!globalInit) {
          // close the dropdown when container loses focus
          $('body').on(_closeEvent, function (e) {
            var target = $(e.target);
            var input = target.closest('.ui-timepicker-input');

            if (input.length === 0 && target.closest('.ui-timepicker-list').length === 0) {
              methods.hide();
            }
          });
          globalInit = true;
        }
      });
    },
    show: function show(e) {
      var self = $(this);

      if ('ontouchstart' in document) {
        // block the keyboard on mobile devices
        self.blur();
      }

      var list = self.data('timepicker-list'); // check if input is readonly

      if (self.attr('readonly')) {
        return;
      } // check if list needs to be rendered


      if (!list || list.length === 0) {
        _render(self);

        list = self.data('timepicker-list');
      } // check if a flag was set to close this picker


      if (self.hasClass('ui-timepicker-hideme')) {
        self.removeClass('ui-timepicker-hideme');
        list.hide();
        return;
      }

      if (list.is(':visible')) {
        return;
      } // make sure other pickers are hidden


      methods.hide();

      if (self.offset().top + self.outerHeight(true) + list.outerHeight() > $(window).height() + $(window).scrollTop()) {
        // position the dropdown on top
        list.css({
          'left': self.offset().left,
          'top': self.offset().top - list.outerHeight()
        });
      } else {
        // put it under the input
        list.css({
          'left': self.offset().left,
          'top': self.offset().top + self.outerHeight()
        });
      }

      list.show();
      var settings = self.data('timepicker-settings'); // position scrolling

      var selected = list.find('.ui-timepicker-selected');

      if (!selected.length) {
        if (self.val()) {
          selected = _findRow(self, list, _time2int(self.val()));
        } else if (settings.scrollDefaultNow) {
          selected = _findRow(self, list, _time2int(new Date()));
        } else if (settings.scrollDefaultTime !== false) {
          selected = _findRow(self, list, _time2int(settings.scrollDefaultTime));
        }
      }

      if (selected && selected.length) {
        var topOffset = list.scrollTop() + selected.position().top - selected.outerHeight();
        list.scrollTop(topOffset);
      } else {
        list.scrollTop(0);
      }

      self.trigger('showTimepicker');
    },
    hide: function hide(e) {
      $('.ui-timepicker-list:visible').each(function () {
        var list = $(this);
        var self = list.data('timepicker-input');
        var settings = self.data('timepicker-settings');

        if (settings && settings.selectOnBlur) {
          _selectValue(self);
        }

        list.hide();
        self.trigger('hideTimepicker');
      });
    },
    option: function option(key, value) {
      var self = $(this);
      var settings = self.data('timepicker-settings');
      var list = self.data('timepicker-list');

      if (_typeof(key) == 'object') {
        settings = $.extend(settings, key);
      } else if (typeof key == 'string' && typeof value != 'undefined') {
        settings[key] = value;
      } else if (typeof key == 'string') {
        return settings[key];
      }

      if (settings.minTime) {
        settings.minTime = _time2int(settings.minTime);
      }

      if (settings.maxTime) {
        settings.maxTime = _time2int(settings.maxTime);
      }

      if (settings.durationTime) {
        settings.durationTime = _time2int(settings.durationTime);
      }

      self.data('timepicker-settings', settings);

      if (list) {
        list.remove();
        self.data('timepicker-list', false);
      }
    },
    getSecondsFromMidnight: function getSecondsFromMidnight() {
      return _time2int($(this).val());
    },
    getTime: function getTime() {
      return new Date(_baseDate.valueOf() + _time2int($(this).val()) * 1000);
    },
    setTime: function setTime(value) {
      var self = $(this);

      var prettyTime = _int2time(_time2int(value), self.data('timepicker-settings').timeFormat);

      self.val(prettyTime);
    },
    remove: function remove() {
      var self = $(this); // check if this element is a timepicker

      if (!self.hasClass('ui-timepicker-input')) {
        return;
      }

      self.removeAttr('autocomplete', 'off');
      self.removeClass('ui-timepicker-input');
      self.removeData('timepicker-settings');
      self.off('.timepicker'); // timepicker-list won't be present unless the user has interacted with this timepicker

      if (self.data('timepicker-list')) {
        self.data('timepicker-list').remove();
      }

      self.removeData('timepicker-list');
    }
  }; // private methods

  function _render(self) {
    var settings = self.data('timepicker-settings');
    var list = self.data('timepicker-list');

    if (list && list.length) {
      list.remove();
      self.data('timepicker-list', false);
    }

    list = $('<ul />');
    list.attr('tabindex', -1);
    list.addClass('ui-timepicker-list');

    if (settings.className) {
      list.addClass(settings.className);
    }

    list.css({
      'display': 'none',
      'position': 'absolute'
    });

    if ((settings.minTime !== null || settings.durationTime !== null) && settings.showDuration) {
      list.addClass('ui-timepicker-with-duration');
    }

    var durStart = settings.durationTime !== null ? settings.durationTime : settings.minTime;
    var start = settings.minTime !== null ? settings.minTime : 0;
    var end = settings.maxTime !== null ? settings.maxTime : start + _ONE_DAY - 1;

    if (end <= start) {
      // make sure the end time is greater than start time, otherwise there will be no list to show
      end += _ONE_DAY;
    }

    for (var i = start; i <= end; i += settings.step * 60) {
      var timeInt = i;
      var row = $('<li />');
      row.data('time', timeInt);
      row.text(_int2time(timeInt, settings.timeFormat));

      if ((settings.minTime !== null || settings.durationTime !== null) && settings.showDuration) {
        var duration = $('<span />');
        duration.addClass('ui-timepicker-duration');
        duration.text(' (' + _int2duration(i - durStart) + ')');
        row.append(duration);
      }

      list.append(row);
    }

    list.data('timepicker-input', self);
    self.data('timepicker-list', list);
    var appendTo = settings.appendTo;

    if (typeof appendTo === 'string') {
      appendTo = $(appendTo);
    } else if (typeof appendTo === 'function') {
      appendTo = appendTo(self);
    }

    appendTo.append(list);

    _setSelected(self, list);

    list.on('click', 'li', function (e) {
      self.addClass('ui-timepicker-hideme');
      self[0].focus(); // make sure only the clicked row is selected

      list.find('li').removeClass('ui-timepicker-selected');
      $(this).addClass('ui-timepicker-selected');

      _selectValue(self);

      list.hide();
    });
  }

  function _generateBaseDate() {
    var _baseDate = new Date();

    var _currentTimezoneOffset = _baseDate.getTimezoneOffset() * 60000;

    _baseDate.setHours(0);

    _baseDate.setMinutes(0);

    _baseDate.setSeconds(0);

    var _baseDateTimezoneOffset = _baseDate.getTimezoneOffset() * 60000;

    return new Date(_baseDate.valueOf() - _baseDateTimezoneOffset + _currentTimezoneOffset);
  }

  function _findRow(self, list, value) {
    if (!value && value !== 0) {
      return false;
    }

    var settings = self.data('timepicker-settings');
    var out = false;
    var halfStep = settings.step * 30; // loop through the menu items

    list.find('li').each(function (i, obj) {
      var jObj = $(obj);
      var offset = jObj.data('time') - value; // check if the value is less than half a step from each row

      if (Math.abs(offset) < halfStep || offset == halfStep) {
        out = jObj;
        return false;
      }
    });
    return out;
  }

  function _setSelected(self, list) {
    var timeValue = _time2int(self.val());

    var selected = _findRow(self, list, timeValue);

    if (selected) selected.addClass('ui-timepicker-selected');
  }

  function _formatValue() {
    if (this.value === '') {
      return;
    }

    var self = $(this);

    var seconds = _time2int(this.value);

    if (seconds === null) {
      self.trigger('timeFormatError');
      return;
    }

    var settings = self.data('timepicker-settings');

    if (settings.forceRoundTime) {
      var offset = seconds % (settings.step * 60); // step is in minutes

      if (offset >= settings.step * 30) {
        // if offset is larger than a half step, round up
        seconds += settings.step * 60 - offset;
      } else {
        // round down
        seconds -= offset;
      }
    }

    var prettyTime = _int2time(seconds, settings.timeFormat);

    self.val(prettyTime);
  }

  function _keyhandler(e) {
    var self = $(this);
    var list = self.data('timepicker-list');

    if (!list.is(':visible')) {
      if (e.keyCode == 40) {
        self.focus();
      } else {
        return true;
      }
    }

    switch (e.keyCode) {
      case 13:
        // return
        _selectValue(self);

        methods.hide.apply(this);
        e.preventDefault();
        return false;

      case 38:
        // up
        var selected = list.find('.ui-timepicker-selected');

        if (!selected.length) {
          list.children().each(function (i, obj) {
            if ($(obj).position().top > 0) {
              selected = $(obj);
              return false;
            }
          });
          selected.addClass('ui-timepicker-selected');
        } else if (!selected.is(':first-child')) {
          selected.removeClass('ui-timepicker-selected');
          selected.prev().addClass('ui-timepicker-selected');

          if (selected.prev().position().top < selected.outerHeight()) {
            list.scrollTop(list.scrollTop() - selected.outerHeight());
          }
        }

        break;

      case 40:
        // down
        selected = list.find('.ui-timepicker-selected');

        if (selected.length === 0) {
          list.children().each(function (i, obj) {
            if ($(obj).position().top > 0) {
              selected = $(obj);
              return false;
            }
          });
          selected.addClass('ui-timepicker-selected');
        } else if (!selected.is(':last-child')) {
          selected.removeClass('ui-timepicker-selected');
          selected.next().addClass('ui-timepicker-selected');

          if (selected.next().position().top + 2 * selected.outerHeight() > list.outerHeight()) {
            list.scrollTop(list.scrollTop() + selected.outerHeight());
          }
        }

        break;

      case 27:
        // escape
        list.find('li').removeClass('ui-timepicker-selected');
        list.hide();
        break;

      case 9:
        //tab
        methods.hide();
        break;

      case 16:
      case 17:
      case 18:
      case 19:
      case 20:
      case 33:
      case 34:
      case 35:
      case 36:
      case 37:
      case 39:
      case 45:
        return;

      default:
        list.find('li').removeClass('ui-timepicker-selected');
        return;
    }
  }

  function _selectValue(self) {
    var settings = self.data('timepicker-settings');
    var list = self.data('timepicker-list');
    var timeValue = null;
    var cursor = list.find('.ui-timepicker-selected');

    if (cursor.length) {
      // selected value found
      timeValue = cursor.data('time');
    } else if (self.val()) {
      // no selected value; fall back on input value
      timeValue = _time2int(self.val());

      _setSelected(self, list);
    }

    if (timeValue !== null) {
      var timeString = _int2time(timeValue, settings.timeFormat);

      self.attr('value', timeString);
    }

    self.trigger('change').trigger('changeTime');
  }

  function _int2duration(seconds) {
    var minutes = Math.round(seconds / 60);
    var duration;

    if (Math.abs(minutes) < 60) {
      duration = [minutes, _lang.mins];
    } else if (minutes == 60) {
      duration = ['1', _lang.hr];
    } else {
      var hours = (minutes / 60).toFixed(1);
      if (_lang.decimal != '.') hours = hours.replace('.', _lang.decimal);
      duration = [hours, _lang.hrs];
    }

    return duration.join(' ');
  }

  function _int2time(seconds, format) {
    if (seconds === null) {
      return;
    }

    var time = new Date(_baseDate.valueOf() + seconds * 1000);
    var output = '';
    var hour, code;

    for (var i = 0; i < format.length; i++) {
      code = format.charAt(i);

      switch (code) {
        case 'a':
          output += time.getHours() > 11 ? 'pm' : 'am';
          break;

        case 'A':
          output += time.getHours() > 11 ? 'PM' : 'AM';
          break;

        case 'g':
          hour = time.getHours() % 12;
          output += hour === 0 ? '12' : hour;
          break;

        case 'G':
          output += time.getHours();
          break;

        case 'h':
          hour = time.getHours() % 12;

          if (hour !== 0 && hour < 10) {
            hour = '0' + hour;
          }

          output += hour === 0 ? '12' : hour;
          break;

        case 'H':
          hour = time.getHours();
          if (seconds >= _ONE_DAY) hour = Math.floor(seconds / (60 * 60));
          output += hour > 9 ? hour : '0' + hour;
          break;

        case 'i':
          var minutes = time.getMinutes();
          output += minutes > 9 ? minutes : '0' + minutes;
          break;

        case 's':
          seconds = time.getSeconds();
          output += seconds > 9 ? seconds : '0' + seconds;
          break;

        default:
          output += code;
      }
    }

    return output;
  }

  function _time2int(timeString) {
    if (timeString === '') return null;
    if (timeString + 0 == timeString) return timeString;

    if (_typeof(timeString) == 'object') {
      timeString = timeString.getHours() + ':' + timeString.getMinutes() + ':' + timeString.getSeconds();
    }

    var d = new Date(0);
    var time = timeString.toLowerCase().match(/(\d{1,2})(?::(\d{1,2}))?(?::(\d{2}))?\s*([pa]?)/);

    if (!time) {
      return null;
    }

    var hour = parseInt(time[1] * 1, 10);
    var hours;

    if (time[4]) {
      if (hour == 12) {
        hours = time[4] == 'p' ? 12 : 0;
      } else {
        hours = hour + (time[4] == 'p' ? 12 : 0);
      }
    } else {
      hours = hour;
    }

    var minutes = time[2] * 1 || 0;
    var seconds = time[3] * 1 || 0;
    return hours * 3600 + minutes * 60 + seconds;
  } // Plugin entry


  $.fn.timepicker = function (method) {
    if (methods[method]) {
      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    } else if (_typeof(method) === "object" || !method) {
      return methods.init.apply(this, arguments);
    } else {
      $.error("Method " + method + " does not exist on jQuery.timepicker");
    }
  };
});

/***/ }),

/***/ "./common/static/js/vendor/tinymce/js/tinymce/jquery.tinymce.min.js":
/***/ (function(module, exports) {

/*** IMPORTS FROM imports-loader ***/
(function () {
  /**
   * Copyright (c) Tiny Technologies, Inc. All rights reserved.
   * Licensed under the LGPL or a commercial license.
   * For LGPL see License.txt in the project root for license information.
   * For commercial licenses see https://www.tiny.cloud/
   */

  /**
   * Jquery integration plugin.
   *
   * @class tinymce.core.JqueryIntegration
   * @private
   */
  !function () {
    var f,
        c,
        u,
        s = [],
        p = "undefined" != typeof global ? global : window,
        d = p.jQuery,
        v = function v() {
      // Reference to tinymce needs to be lazily evaluated since tinymce
      // might be loaded through the compressor or other means
      return p.tinymce;
    };

    d.fn.tinymce = function (o) {
      var e,
          t,
          i,
          l = this,
          r = ""; // No match then just ignore the call

      if (!l.length) return l; // Get editor instance

      if (!o) return v() ? v().get(l[0].id) : null;
      l.css("visibility", "hidden"); // Hide textarea to avoid flicker

      var n,
          a = function a() {
        var a = [],
            c = 0; // Apply patches to the jQuery object, only once

        u || (m(), u = !0), // Create an editor instance for each matched node
        l.each(function (e, t) {
          var n,
              i = t.id,
              r = o.oninit; // Generate unique id for target element if needed

          i || (t.id = i = v().DOM.uniqueId()), // Only init the editor once
          v().get(i) || ( // Create editor instance and render it
          n = v().createEditor(i, o), a.push(n), n.on("init", function () {
            var e,
                t = r;
            l.css("visibility", ""), // Run this if the oninit setting is defined
            // this logic will fire the oninit callback ones each
            // matched editor instance is initialized
            r && ++c == a.length && ("string" == typeof t && (e = -1 === t.indexOf(".") ? null : v().resolve(t.replace(/\.\w+$/, "")), t = v().resolve(t)), // Call the oninit function with the object
            t.apply(e || v(), a));
          }));
        }), // Render the editor instances in a separate loop since we
        // need to have the full editors array used in the onInit calls
        d.each(a, function (e, t) {
          t.render();
        });
      }; // Load TinyMCE on demand, if we need to


      return p.tinymce || c || !(e = o.script_url) ? // Delay the init call until tinymce is loaded
      1 === c ? s.push(a) : a() : (c = 1, t = e.substring(0, e.lastIndexOf("/")), // Check if it's a dev/src version they want to load then
      // make sure that all plugins, themes etc are loaded in source mode as well
      -1 != e.indexOf(".min") && (r = ".min"), // Setup tinyMCEPreInit object this will later be used by the TinyMCE
      // core script to locate other resources like CSS files, dialogs etc
      // You can also predefined a tinyMCEPreInit object and then it will use that instead
      p.tinymce = p.tinyMCEPreInit || {
        base: t,
        suffix: r
      }, // url contains gzip then we assume it's a compressor
      -1 != e.indexOf("gzip") && (i = o.language || "en", e = e + (/\?/.test(e) ? "&" : "?") + "js=true&core=true&suffix=" + escape(r) + "&themes=" + escape(o.theme || "modern") + "&plugins=" + escape(o.plugins || "") + "&languages=" + (i || ""), // Check if compressor script is already loaded otherwise setup a basic one
      p.tinyMCE_GZ || (p.tinyMCE_GZ = {
        start: function start() {
          var n = function n(e) {
            v().ScriptLoader.markDone(v().baseURI.toAbsolute(e));
          }; // Add core languages


          n("langs/" + i + ".js"), // Add themes with languages
          n("themes/" + o.theme + "/theme" + r + ".js"), n("themes/" + o.theme + "/langs/" + i + ".js"), // Add plugins with languages
          d.each(o.plugins.split(","), function (e, t) {
            t && (n("plugins/" + t + "/plugin" + r + ".js"), n("plugins/" + t + "/langs/" + i + ".js"));
          });
        },
        end: function end() {}
      })), (n = document.createElement("script")).type = "text/javascript", n.onload = n.onreadystatechange = function (e) {
        e = e || window.event, 2 === c || "load" != e.type && !/complete|loaded/.test(n.readyState) || (v().dom.Event.domLoaded = 1, c = 2, // Execute callback after mainscript has been loaded and before the initialization occurs
        o.script_loaded && o.script_loaded(), a(), d.each(s, function (e, t) {
          t();
        }));
      }, n.src = e, document.body.appendChild(n)), l;
    }, // Add :tinymce pseudo selector this will select elements that has been converted into editor instances
    // it's now possible to use things like $('*:tinymce') to get all TinyMCE bound elements.
    d.extend(d.expr[":"], {
      tinymce: function tinymce(e) {
        var t;
        return !!(e.id && "tinymce" in p && (t = v().get(e.id)) && t.editorManager === v());
      }
    }); // This function patches internal jQuery functions so that if
    // you for example remove an div element containing an editor it's
    // automatically destroyed by the TinyMCE API

    var m = function m() {
      // Removes any child editor instances by looking for editor wrapper elements
      var r = function r(e) {
        // If the function is remove
        "remove" === e && this.each(function (e, t) {
          var n = l(t);
          n && n.remove();
        }), this.find("span.mceEditor,div.mceEditor").each(function (e, t) {
          var n = v().get(t.id.replace(/_parent$/, ""));
          n && n.remove();
        });
      },
          o = function o(i) {
        var e,
            t = this; // Handle set value

        /*jshint eqnull:true */

        if (null != i) r.call(t), // Saves the contents before get/set value of textarea/div
        t.each(function (e, t) {
          var n;
          (n = v().get(t.id)) && n.setContent(i);
        });else if (0 < t.length && (e = v().get(t[0].id))) return e.getContent();
      },
          l = function l(e) {
        var t = null;
        return e && e.id && p.tinymce && (t = v().get(e.id)), t;
      },
          u = function u(e) {
        return !!(e && e.length && p.tinymce && e.is(":tinymce"));
      },
          s = {}; // Loads or saves contents from/to textarea if the value
      // argument is defined it will set the TinyMCE internal contents
      // Patch some setter/getter functions these will
      // now be able to set/get the contents of editor instances for
      // example $('#editorid').html('Content'); will update the TinyMCE iframe instance


      d.each(["text", "html", "val"], function (e, t) {
        var a = s[t] = d.fn[t],
            c = "text" === t;

        d.fn[t] = function (e) {
          var t = this;
          if (!u(t)) return a.apply(t, arguments);
          if (e !== f) return o.call(t.filter(":tinymce"), e), a.apply(t.not(":tinymce"), arguments), t; // return original set for chaining

          var i = "",
              r = arguments;
          return (c ? t : t.eq(0)).each(function (e, t) {
            var n = l(t);
            i += n ? c ? n.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g, "") : n.getContent({
              save: !0
            }) : a.apply(d(t), r);
          }), i;
        };
      }), // Makes it possible to use $('#id').append("content"); to append contents to the TinyMCE editor iframe
      d.each(["append", "prepend"], function (e, t) {
        var n = s[t] = d.fn[t],
            r = "prepend" === t;

        d.fn[t] = function (i) {
          var e = this;
          return u(e) ? i !== f ? ("string" == typeof i && e.filter(":tinymce").each(function (e, t) {
            var n = l(t);
            n && n.setContent(r ? i + n.getContent() : n.getContent() + i);
          }), n.apply(e.not(":tinymce"), arguments), e) : void 0 : n.apply(e, arguments);
        };
      }), // Makes sure that the editor instance gets properly destroyed when the parent element is removed
      d.each(["remove", "replaceWith", "replaceAll", "empty"], function (e, t) {
        var n = s[t] = d.fn[t];

        d.fn[t] = function () {
          return r.call(this, t), n.apply(this, arguments);
        };
      }), s.attr = d.fn.attr, // Makes sure that $('#tinymce_id').attr('value') gets the editors current HTML contents
      d.fn.attr = function (e, t) {
        var n = this,
            i = arguments;
        if (!e || "value" !== e || !u(n)) return s.attr.apply(n, i);
        if (t !== f) return o.call(n.filter(":tinymce"), t), s.attr.apply(n.not(":tinymce"), i), n; // return original set for chaining

        var r = n[0],
            a = l(r);
        return a ? a.getContent({
          save: !0
        }) : s.attr.apply(d(r), i);
      };
    };
  }();
}).call(window);

/***/ }),

/***/ "./common/static/js/vendor/tinymce/js/tinymce/tinymce.js":
/***/ (function(module, exports) {

function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}/*** IMPORTS FROM imports-loader ***/(function(){/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.5.1 (2020-10-01)
 */(function(){'use strict';var typeOf=function typeOf(x){if(x===null){return'null';}if(x===undefined){return'undefined';}var t=_typeof(x);if(t==='object'&&(Array.prototype.isPrototypeOf(x)||x.constructor&&x.constructor.name==='Array')){return'array';}if(t==='object'&&(String.prototype.isPrototypeOf(x)||x.constructor&&x.constructor.name==='String')){return'string';}return t;};var isEquatableType=function isEquatableType(x){return['undefined','boolean','number','string','function','xml','null'].indexOf(x)!==-1;};var sort=function sort(xs,compareFn){var clone=Array.prototype.slice.call(xs);return clone.sort(compareFn);};var contramap=function contramap(eqa,f){return eq(function(x,y){return eqa.eq(f(x),f(y));});};var eq=function eq(f){return{eq:f};};var tripleEq=eq(function(x,y){return x===y;});var eqString=tripleEq;var eqArray=function eqArray(eqa){return eq(function(x,y){if(x.length!==y.length){return false;}var len=x.length;for(var i=0;i<len;i++){if(!eqa.eq(x[i],y[i])){return false;}}return true;});};var eqSortedArray=function eqSortedArray(eqa,compareFn){return contramap(eqArray(eqa),function(xs){return sort(xs,compareFn);});};var eqRecord=function eqRecord(eqa){return eq(function(x,y){var kx=Object.keys(x);var ky=Object.keys(y);if(!eqSortedArray(eqString).eq(kx,ky)){return false;}var len=kx.length;for(var i=0;i<len;i++){var q=kx[i];if(!eqa.eq(x[q],y[q])){return false;}}return true;});};var eqAny=eq(function(x,y){if(x===y){return true;}var tx=typeOf(x);var ty=typeOf(y);if(tx!==ty){return false;}if(isEquatableType(tx)){return x===y;}else if(tx==='array'){return eqArray(eqAny).eq(x,y);}else if(tx==='object'){return eqRecord(eqAny).eq(x,y);}return false;});var noop=function noop(){};var compose=function compose(fa,fb){return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}return fa(fb.apply(null,args));};};var compose1=function compose1(fbc,fab){return function(a){return fbc(fab(a));};};var constant=function constant(value){return function(){return value;};};var identity=function identity(x){return x;};function curry(fn){var initialArgs=[];for(var _i=1;_i<arguments.length;_i++){initialArgs[_i-1]=arguments[_i];}return function(){var restArgs=[];for(var _i=0;_i<arguments.length;_i++){restArgs[_i]=arguments[_i];}var all=initialArgs.concat(restArgs);return fn.apply(null,all);};}var not=function not(f){return function(t){return!f(t);};};var die=function die(msg){return function(){throw new Error(msg);};};var never=constant(false);var always=constant(true);var none=function none(){return NONE;};var NONE=function(){var eq=function eq(o){return o.isNone();};var call=function call(thunk){return thunk();};var id=function id(n){return n;};var me={fold:function fold(n,_s){return n();},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function getOrDie(msg){throw new Error(msg||'error: getOrDie called on none.');},getOrNull:constant(null),getOrUndefined:constant(undefined),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function toArray(){return[];},toString:constant('none()')};return me;}();var some=function some(a){var constant_a=constant(a);var self=function self(){return me;};var bind=function bind(f){return f(a);};var me={fold:function fold(n,s){return s(a);},is:function is(v){return a===v;},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function map(f){return some(f(a));},each:function each(f){f(a);},bind:bind,exists:bind,forall:bind,filter:function filter(f){return f(a)?me:NONE;},toArray:function toArray(){return[a];},toString:function toString(){return'some('+a+')';},equals:function equals(o){return o.is(a);},equals_:function equals_(o,elementEq){return o.fold(never,function(b){return elementEq(a,b);});}};return me;};var from=function from(value){return value===null||value===undefined?NONE:some(value);};var Optional={some:some,none:none,from:from};var typeOf$1=function typeOf$1(x){var t=_typeof(x);if(x===null){return'null';}else if(t==='object'&&(Array.prototype.isPrototypeOf(x)||x.constructor&&x.constructor.name==='Array')){return'array';}else if(t==='object'&&(String.prototype.isPrototypeOf(x)||x.constructor&&x.constructor.name==='String')){return'string';}else{return t;}};var isType=function isType(type){return function(value){return typeOf$1(value)===type;};};var isSimpleType=function isSimpleType(type){return function(value){return _typeof(value)===type;};};var eq$1=function eq$1(t){return function(a){return t===a;};};var isString=isType('string');var isObject=isType('object');var isArray=isType('array');var isNull=eq$1(null);var isBoolean=isSimpleType('boolean');var isUndefined=eq$1(undefined);var isNullable=function isNullable(a){return a===null||a===undefined;};var isNonNullable=function isNonNullable(a){return!isNullable(a);};var isFunction=isSimpleType('function');var isNumber=isSimpleType('number');var nativeSlice=Array.prototype.slice;var nativeIndexOf=Array.prototype.indexOf;var nativePush=Array.prototype.push;var rawIndexOf=function rawIndexOf(ts,t){return nativeIndexOf.call(ts,t);};var indexOf=function indexOf(xs,x){var r=rawIndexOf(xs,x);return r===-1?Optional.none():Optional.some(r);};var contains=function contains(xs,x){return rawIndexOf(xs,x)>-1;};var exists=function exists(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i)){return true;}}return false;};var map=function map(xs,f){var len=xs.length;var r=new Array(len);for(var i=0;i<len;i++){var x=xs[i];r[i]=f(x,i);}return r;};var each=function each(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i);}};var eachr=function eachr(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i);}};var partition=function partition(xs,pred){var pass=[];var fail=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];var arr=pred(x,i)?pass:fail;arr.push(x);}return{pass:pass,fail:fail};};var filter=function filter(xs,pred){var r=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i)){r.push(x);}}return r;};var foldr=function foldr(xs,f,acc){eachr(xs,function(x){acc=f(acc,x);});return acc;};var foldl=function foldl(xs,f,acc){each(xs,function(x){acc=f(acc,x);});return acc;};var findUntil=function findUntil(xs,pred,until){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i)){return Optional.some(x);}else if(until(x,i)){break;}}return Optional.none();};var find=function find(xs,pred){return findUntil(xs,pred,never);};var findIndex=function findIndex(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i)){return Optional.some(i);}}return Optional.none();};var flatten=function flatten(xs){var r=[];for(var i=0,len=xs.length;i<len;++i){if(!isArray(xs[i])){throw new Error('Arr.flatten item '+i+' was not an array, input: '+xs);}nativePush.apply(r,xs[i]);}return r;};var bind=function bind(xs,f){return flatten(map(xs,f));};var forall=function forall(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i)!==true){return false;}}return true;};var reverse=function reverse(xs){var r=nativeSlice.call(xs,0);r.reverse();return r;};var difference=function difference(a1,a2){return filter(a1,function(x){return!contains(a2,x);});};var mapToObject=function mapToObject(xs,f){var r={};for(var i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i);}return r;};var sort$1=function sort$1(xs,comparator){var copy=nativeSlice.call(xs,0);copy.sort(comparator);return copy;};var head=function head(xs){return xs.length===0?Optional.none():Optional.some(xs[0]);};var last=function last(xs){return xs.length===0?Optional.none():Optional.some(xs[xs.length-1]);};var from$1=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x);};var keys=Object.keys;var hasOwnProperty=Object.hasOwnProperty;var each$1=function each$1(obj,f){var props=keys(obj);for(var k=0,len=props.length;k<len;k++){var i=props[k];var x=obj[i];f(x,i);}};var map$1=function map$1(obj,f){return tupleMap(obj,function(x,i){return{k:i,v:f(x,i)};});};var tupleMap=function tupleMap(obj,f){var r={};each$1(obj,function(x,i){var tuple=f(x,i);r[tuple.k]=tuple.v;});return r;};var objAcc=function objAcc(r){return function(x,i){r[i]=x;};};var internalFilter=function internalFilter(obj,pred,onTrue,onFalse){var r={};each$1(obj,function(x,i){(pred(x,i)?onTrue:onFalse)(x,i);});return r;};var bifilter=function bifilter(obj,pred){var t={};var f={};internalFilter(obj,pred,objAcc(t),objAcc(f));return{t:t,f:f};};var filter$1=function filter$1(obj,pred){var t={};internalFilter(obj,pred,objAcc(t),noop);return t;};var mapToArray=function mapToArray(obj,f){var r=[];each$1(obj,function(value,name){r.push(f(value,name));});return r;};var values=function values(obj){return mapToArray(obj,function(v){return v;});};var get=function get(obj,key){return has(obj,key)?Optional.from(obj[key]):Optional.none();};var has=function has(obj,key){return hasOwnProperty.call(obj,key);};var equal=function equal(a1,a2,eq){if(eq===void 0){eq=eqAny;}return eqRecord(eq).eq(a1,a2);};var isArray$1=Array.isArray;var toArray=function toArray(obj){if(!isArray$1(obj)){var array=[];for(var i=0,l=obj.length;i<l;i++){array[i]=obj[i];}return array;}else{return obj;}};var each$2=function each$2(o,cb,s){var n,l;if(!o){return false;}s=s||o;if(o.length!==undefined){for(n=0,l=o.length;n<l;n++){if(cb.call(s,o[n],n,o)===false){return false;}}}else{for(n in o){if(o.hasOwnProperty(n)){if(cb.call(s,o[n],n,o)===false){return false;}}}}return true;};var map$2=function map$2(array,callback){var out=[];each$2(array,function(item,index){out.push(callback(item,index,array));});return out;};var filter$2=function filter$2(a,f){var o=[];each$2(a,function(v,index){if(!f||f(v,index,a)){o.push(v);}});return o;};var indexOf$1=function indexOf$1(a,v){if(a){for(var i=0,l=a.length;i<l;i++){if(a[i]===v){return i;}}}return-1;};var reduce=function reduce(collection,iteratee,accumulator,thisArg){var acc=isUndefined(accumulator)?collection[0]:accumulator;for(var i=0;i<collection.length;i++){acc=iteratee.call(thisArg,acc,collection[i],i);}return acc;};var findIndex$1=function findIndex$1(array,predicate,thisArg){var i,l;for(i=0,l=array.length;i<l;i++){if(predicate.call(thisArg,array[i],i,array)){return i;}}return-1;};var last$1=function last$1(collection){return collection[collection.length-1];};var _assign=function __assign(){_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s){if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}}return t;};return _assign.apply(this,arguments);};function __rest(s,e){var t={};for(var p in s){if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];}if(s!=null&&typeof Object.getOwnPropertySymbols==='function')for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]];}return t;}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++){s+=arguments[i].length;}for(var r=Array(s),k=0,i=0;i<il;i++){for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++){r[k]=a[j];}}return r;}var cached=function cached(f){var called=false;var r;return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!called){called=true;r=f.apply(null,args);}return r;};};var DeviceType=function DeviceType(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===true;var isiPhone=os.isiOS()&&!isiPad;var isMobile=os.isiOS()||os.isAndroid();var isTouch=isMobile||mediaMatch('(pointer:coarse)');var isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch('(min-device-width:768px)');var isPhone=isiPhone||isMobile&&!isTablet;var iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===false;var isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)};};var firstMatch=function firstMatch(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s)){return x;}}return undefined;};var find$1=function find$1(regexes,agent){var r=firstMatch(regexes,agent);if(!r){return{major:0,minor:0};}var group=function group(i){return Number(agent.replace(r,'$'+i));};return nu(group(1),group(2));};var detect=function detect(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();if(versionRegexes.length===0){return unknown();}return find$1(versionRegexes,cleanedAgent);};var unknown=function unknown(){return nu(0,0);};var nu=function nu(major,minor){return{major:major,minor:minor};};var Version={nu:nu,detect:detect,unknown:unknown};var detect$1=function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent);});};var detectBrowser=function detectBrowser(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version};});};var detectOs=function detectOs(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version};});};var UaString={detectBrowser:detectBrowser,detectOs:detectOs};var checkRange=function checkRange(str,substr,start){return substr===''||str.length>=substr.length&&str.substr(start,start+substr.length)===substr;};var contains$1=function contains$1(str,substr){return str.indexOf(substr)!==-1;};var startsWith=function startsWith(str,prefix){return checkRange(str,prefix,0);};var blank=function blank(r){return function(s){return s.replace(r,'');};};var trim=blank(/^\s+|\s+$/g);var lTrim=blank(/^\s+/g);var rTrim=blank(/\s+$/g);var normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var checkContains=function checkContains(target){return function(uastring){return contains$1(uastring,target);};};var browsers=[{name:'Edge',versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function search(uastring){return contains$1(uastring,'edge/')&&contains$1(uastring,'chrome')&&contains$1(uastring,'safari')&&contains$1(uastring,'applewebkit');}},{name:'Chrome',versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function search(uastring){return contains$1(uastring,'chrome')&&!contains$1(uastring,'chromeframe');}},{name:'IE',versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function search(uastring){return contains$1(uastring,'msie')||contains$1(uastring,'trident');}},{name:'Opera',versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains('opera')},{name:'Firefox',versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains('firefox')},{name:'Safari',versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function search(uastring){return(contains$1(uastring,'safari')||contains$1(uastring,'mobile/'))&&contains$1(uastring,'applewebkit');}}];var oses=[{name:'Windows',search:checkContains('win'),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:'iOS',search:function search(uastring){return contains$1(uastring,'iphone')||contains$1(uastring,'ipad');},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:'Android',search:checkContains('android'),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:'OSX',search:checkContains('mac os x'),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:'Linux',search:checkContains('linux'),versionRegexes:[]},{name:'Solaris',search:checkContains('sunos'),versionRegexes:[]},{name:'FreeBSD',search:checkContains('freebsd'),versionRegexes:[]},{name:'ChromeOS',search:checkContains('cros'),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}];var PlatformInfo={browsers:constant(browsers),oses:constant(oses)};var edge='Edge';var chrome='Chrome';var ie='IE';var opera='Opera';var firefox='Firefox';var safari='Safari';var unknown$1=function unknown$1(){return nu$1({current:undefined,version:Version.unknown()});};var nu$1=function nu$1(info){var current=info.current;var version=info.version;var isBrowser=function isBrowser(name){return function(){return current===name;};};return{current:current,version:version,isEdge:isBrowser(edge),isChrome:isBrowser(chrome),isIE:isBrowser(ie),isOpera:isBrowser(opera),isFirefox:isBrowser(firefox),isSafari:isBrowser(safari)};};var Browser={unknown:unknown$1,nu:nu$1,edge:constant(edge),chrome:constant(chrome),ie:constant(ie),opera:constant(opera),firefox:constant(firefox),safari:constant(safari)};var windows='Windows';var ios='iOS';var android='Android';var linux='Linux';var osx='OSX';var solaris='Solaris';var freebsd='FreeBSD';var chromeos='ChromeOS';var unknown$2=function unknown$2(){return nu$2({current:undefined,version:Version.unknown()});};var nu$2=function nu$2(info){var current=info.current;var version=info.version;var isOS=function isOS(name){return function(){return current===name;};};return{current:current,version:version,isWindows:isOS(windows),isiOS:isOS(ios),isAndroid:isOS(android),isOSX:isOS(osx),isLinux:isOS(linux),isSolaris:isOS(solaris),isFreeBSD:isOS(freebsd),isChromeOS:isOS(chromeos)};};var OperatingSystem={unknown:unknown$2,nu:nu$2,windows:constant(windows),ios:constant(ios),android:constant(android),linux:constant(linux),osx:constant(osx),solaris:constant(solaris),freebsd:constant(freebsd),chromeos:constant(chromeos)};var detect$2=function detect$2(userAgent,mediaMatch){var browsers=PlatformInfo.browsers();var oses=PlatformInfo.oses();var browser=UaString.detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu);var os=UaString.detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu);var deviceType=DeviceType(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType};};var PlatformDetection={detect:detect$2};var mediaMatch=function mediaMatch(query){return window.matchMedia(query).matches;};var platform=cached(function(){return PlatformDetection.detect(navigator.userAgent,mediaMatch);});var detect$3=function detect$3(){return platform();};var userAgent=navigator.userAgent;var platform$1=detect$3();var browser=platform$1.browser;var os=platform$1.os;var deviceType=platform$1.deviceType;var webkit=/WebKit/.test(userAgent)&&!browser.isEdge();var fileApi='FormData'in window&&'FileReader'in window&&'URL'in window&&!!URL.createObjectURL;var windowsPhone=userAgent.indexOf('Windows Phone')!==-1;var Env={opera:browser.isOpera(),webkit:webkit,ie:browser.isIE()||browser.isEdge()?browser.version.major:false,gecko:browser.isFirefox(),mac:os.isOSX()||os.isiOS(),iOS:deviceType.isiPad()||deviceType.isiPhone(),android:os.isAndroid(),contentEditable:true,transparentSrc:'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',caretAfter:true,range:window.getSelection&&'Range'in window,documentMode:browser.isIE()?document.documentMode||7:10,fileApi:fileApi,ceFalse:true,cacheSuffix:null,container:null,experimentalShadowDom:false,canHaveCSP:!browser.isIE(),desktop:deviceType.isDesktop(),windowsPhone:windowsPhone,browser:{current:browser.current,version:browser.version,isChrome:browser.isChrome,isEdge:browser.isEdge,isFirefox:browser.isFirefox,isIE:browser.isIE,isOpera:browser.isOpera,isSafari:browser.isSafari},os:{current:os.current,version:os.version,isAndroid:os.isAndroid,isChromeOS:os.isChromeOS,isFreeBSD:os.isFreeBSD,isiOS:os.isiOS,isLinux:os.isLinux,isOSX:os.isOSX,isSolaris:os.isSolaris,isWindows:os.isWindows},deviceType:{isDesktop:deviceType.isDesktop,isiPad:deviceType.isiPad,isiPhone:deviceType.isiPhone,isPhone:deviceType.isPhone,isTablet:deviceType.isTablet,isTouch:deviceType.isTouch,isWebView:deviceType.isWebView}};var whiteSpaceRegExp=/^\s*|\s*$/g;var trim$1=function trim$1(str){return str===null||str===undefined?'':(''+str).replace(whiteSpaceRegExp,'');};var is=function is(obj,type){if(!type){return obj!==undefined;}if(type==='array'&&isArray$1(obj)){return true;}return _typeof(obj)===type;};var makeMap=function makeMap(items,delim,map){var i;items=items||[];delim=delim||',';if(typeof items==='string'){items=items.split(delim);}map=map||{};i=items.length;while(i--){map[items[i]]={};}return map;};var hasOwnProperty$1=function hasOwnProperty$1(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);};var create=function create(s,p,root){var self=this;var sp,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);var cn=s[3].match(/(^|\.)(\w+)$/i)[2];var ns=self.createNS(s[3].replace(/\.\w+$/,''),root);if(ns[cn]){return;}if(s[2]==='static'){ns[cn]=p;if(this.onCreate){this.onCreate(s[2],s[3],ns[cn]);}return;}if(!p[cn]){p[cn]=function(){};de=1;}ns[cn]=p[cn];self.extend(ns[cn].prototype,p);if(s[5]){sp=self.resolve(s[5]).prototype;scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de){ns[cn]=function(){return sp[scn].apply(this,arguments);};}else{ns[cn]=function(){this.parent=sp[scn];return c.apply(this,arguments);};}ns[cn].prototype[cn]=ns[cn];self.each(sp,function(f,n){ns[cn].prototype[n]=sp[n];});self.each(p,function(f,n){if(sp[n]){ns[cn].prototype[n]=function(){this.parent=sp[n];return f.apply(this,arguments);};}else{if(n!==cn){ns[cn].prototype[n]=f;}}});}self.each(p["static"],function(f,n){ns[cn][n]=f;});};var extend=function extend(obj){var exts=[];for(var _i=1;_i<arguments.length;_i++){exts[_i-1]=arguments[_i];}for(var i=0;i<exts.length;i++){var ext=exts[i];for(var name_1 in ext){if(ext.hasOwnProperty(name_1)){var value=ext[name_1];if(value!==undefined){obj[name_1]=value;}}}}return obj;};var walk=function walk(o,f,n,s){s=s||this;if(o){if(n){o=o[n];}each$2(o,function(o,i){if(f.call(s,o,i,n)===false){return false;}walk(o,f,n,s);});}};var createNS=function createNS(n,o){var i,v;o=o||window;n=n.split('.');for(i=0;i<n.length;i++){v=n[i];if(!o[v]){o[v]={};}o=o[v];}return o;};var resolve=function resolve(n,o){var i,l;o=o||window;n=n.split('.');for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o){break;}}return o;};var explode=function explode(s,d){if(!s||is(s,'array')){return s;}return map$2(s.split(d||','),trim$1);};var _addCacheSuffix=function _addCacheSuffix(url){var cacheSuffix=Env.cacheSuffix;if(cacheSuffix){url+=(url.indexOf('?')===-1?'?':'&')+cacheSuffix;}return url;};var Tools={trim:trim$1,isArray:isArray$1,is:is,toArray:toArray,makeMap:makeMap,each:each$2,map:map$2,grep:filter$2,inArray:indexOf$1,hasOwn:hasOwnProperty$1,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode,_addCacheSuffix:_addCacheSuffix};var fromHtml=function fromHtml(html,scope){var doc=scope||document;var div=doc.createElement('div');div.innerHTML=html;if(!div.hasChildNodes()||div.childNodes.length>1){console.error('HTML does not have a single root node',html);throw new Error('HTML must have a single root node');}return fromDom(div.childNodes[0]);};var fromTag=function fromTag(tag,scope){var doc=scope||document;var node=doc.createElement(tag);return fromDom(node);};var fromText=function fromText(text,scope){var doc=scope||document;var node=doc.createTextNode(text);return fromDom(node);};var fromDom=function fromDom(node){if(node===null||node===undefined){throw new Error('Node cannot be null or undefined');}return{dom:node};};var fromPoint=function fromPoint(docElm,x,y){return Optional.from(docElm.dom.elementFromPoint(x,y)).map(fromDom);};var SugarElement={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint};var toArray$1=function toArray$1(target,f){var r=[];var recurse=function recurse(e){r.push(e);return f(e);};var cur=f(target);do{cur=cur.bind(recurse);}while(cur.isSome());return r;};var compareDocumentPosition=function compareDocumentPosition(a,b,match){return(a.compareDocumentPosition(b)&match)!==0;};var documentPositionContainedBy=function documentPositionContainedBy(a,b){return compareDocumentPosition(a,b,Node.DOCUMENT_POSITION_CONTAINED_BY);};var COMMENT=8;var DOCUMENT=9;var DOCUMENT_FRAGMENT=11;var ELEMENT=1;var TEXT=3;var is$1=function is$1(element,selector){var dom=element.dom;if(dom.nodeType!==ELEMENT){return false;}else{var elem=dom;if(elem.matches!==undefined){return elem.matches(selector);}else if(elem.msMatchesSelector!==undefined){return elem.msMatchesSelector(selector);}else if(elem.webkitMatchesSelector!==undefined){return elem.webkitMatchesSelector(selector);}else if(elem.mozMatchesSelector!==undefined){return elem.mozMatchesSelector(selector);}else{throw new Error('Browser lacks native selectors');}}};var bypassSelector=function bypassSelector(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT&&dom.nodeType!==DOCUMENT_FRAGMENT||dom.childElementCount===0;};var all=function all(selector,scope){var base=scope===undefined?document:scope.dom;return bypassSelector(base)?[]:map(base.querySelectorAll(selector),SugarElement.fromDom);};var one=function one(selector,scope){var base=scope===undefined?document:scope.dom;return bypassSelector(base)?Optional.none():Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);};var eq$2=function eq$2(e1,e2){return e1.dom===e2.dom;};var regularContains=function regularContains(e1,e2){var d1=e1.dom;var d2=e2.dom;return d1===d2?false:d1.contains(d2);};var ieContains=function ieContains(e1,e2){return documentPositionContainedBy(e1.dom,e2.dom);};var contains$2=function contains$2(e1,e2){return detect$3().browser.isIE()?ieContains(e1,e2):regularContains(e1,e2);};var Global=typeof window!=='undefined'?window:Function('return this;')();var name=function name(element){var r=element.dom.nodeName;return r.toLowerCase();};var type=function type(element){return element.dom.nodeType;};var isType$1=function isType$1(t){return function(element){return type(element)===t;};};var isComment=function isComment(element){return type(element)===COMMENT||name(element)==='#comment';};var isElement=isType$1(ELEMENT);var isText=isType$1(TEXT);var isDocument=isType$1(DOCUMENT);var isDocumentFragment=isType$1(DOCUMENT_FRAGMENT);var owner=function owner(element){return SugarElement.fromDom(element.dom.ownerDocument);};var documentOrOwner=function documentOrOwner(dos){return isDocument(dos)?dos:owner(dos);};var documentElement=function documentElement(element){return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);};var defaultView=function defaultView(element){return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);};var parent=function parent(element){return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);};var parents=function parents(element,isRoot){var stop=isFunction(isRoot)?isRoot:never;var dom=element.dom;var ret=[];while(dom.parentNode!==null&&dom.parentNode!==undefined){var rawParent=dom.parentNode;var p=SugarElement.fromDom(rawParent);ret.push(p);if(stop(p)===true){break;}else{dom=rawParent;}}return ret;};var siblings=function siblings(element){var filterSelf=function filterSelf(elements){return filter(elements,function(x){return!eq$2(element,x);});};return parent(element).map(children).map(filterSelf).getOr([]);};var prevSibling=function prevSibling(element){return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);};var nextSibling=function nextSibling(element){return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);};var prevSiblings=function prevSiblings(element){return reverse(toArray$1(element,prevSibling));};var nextSiblings=function nextSiblings(element){return toArray$1(element,nextSibling);};var children=function children(element){return map(element.dom.childNodes,SugarElement.fromDom);};var child=function child(element,index){var cs=element.dom.childNodes;return Optional.from(cs[index]).map(SugarElement.fromDom);};var firstChild=function firstChild(element){return child(element,0);};var lastChild=function lastChild(element){return child(element,element.dom.childNodes.length-1);};var childNodesCount=function childNodesCount(element){return element.dom.childNodes.length;};var getHead=function getHead(doc){var b=doc.dom.head;if(b===null||b===undefined){throw new Error('Head is not available yet');}return SugarElement.fromDom(b);};var isShadowRoot=function isShadowRoot(dos){return isDocumentFragment(dos);};var supported=isFunction(Element.prototype.attachShadow)&&isFunction(Node.prototype.getRootNode);var isSupported=constant(supported);var getRootNode=supported?function(e){return SugarElement.fromDom(e.dom.getRootNode());}:documentOrOwner;var getStyleContainer=function getStyleContainer(dos){return isShadowRoot(dos)?dos:getHead(documentOrOwner(dos));};var getShadowRoot=function getShadowRoot(e){var r=getRootNode(e);return isShadowRoot(r)?Optional.some(r):Optional.none();};var getShadowHost=function getShadowHost(e){return SugarElement.fromDom(e.dom.host);};var getOriginalEventTarget=function getOriginalEventTarget(event){if(isSupported()&&isNonNullable(event.target)){var el=SugarElement.fromDom(event.target);if(isElement(el)&&isOpenShadowHost(el)){if(event.composed&&event.composedPath){var composedPath=event.composedPath();if(composedPath){return head(composedPath);}}}}return Optional.from(event.target);};var isOpenShadowHost=function isOpenShadowHost(element){return isNonNullable(element.dom.shadowRoot);};var before=function before(marker,element){var parent$1=parent(marker);parent$1.each(function(v){v.dom.insertBefore(element.dom,marker.dom);});};var after=function after(marker,element){var sibling=nextSibling(marker);sibling.fold(function(){var parent$1=parent(marker);parent$1.each(function(v){append(v,element);});},function(v){before(v,element);});};var prepend=function prepend(parent,element){var firstChild$1=firstChild(parent);firstChild$1.fold(function(){append(parent,element);},function(v){parent.dom.insertBefore(element.dom,v.dom);});};var append=function append(parent,element){parent.dom.appendChild(element.dom);};var wrap=function wrap(element,wrapper){before(element,wrapper);append(wrapper,element);};var before$1=function before$1(marker,elements){each(elements,function(x){before(marker,x);});};var append$1=function append$1(parent,elements){each(elements,function(x){append(parent,x);});};var empty=function empty(element){element.dom.textContent='';each(children(element),function(rogue){remove(rogue);});};var remove=function remove(element){var dom=element.dom;if(dom.parentNode!==null){dom.parentNode.removeChild(dom);}};var unwrap=function unwrap(wrapper){var children$1=children(wrapper);if(children$1.length>0){before$1(wrapper,children$1);}remove(wrapper);};var inBody=function inBody(element){var dom=isText(element)?element.dom.parentNode:element.dom;if(dom===undefined||dom===null||dom.ownerDocument===null){return false;}var doc=dom.ownerDocument;return getShadowRoot(SugarElement.fromDom(dom)).fold(function(){return doc.body.contains(dom);},compose1(inBody,getShadowHost));};var r=function r(left,top){var translate=function translate(x,y){return r(left+x,top+y);};return{left:left,top:top,translate:translate};};var SugarPosition=r;var boxPosition=function boxPosition(dom){var box=dom.getBoundingClientRect();return SugarPosition(box.left,box.top);};var firstDefinedOrZero=function firstDefinedOrZero(a,b){if(a!==undefined){return a;}else{return b!==undefined?b:0;}};var absolute=function absolute(element){var doc=element.dom.ownerDocument;var body=doc.body;var win=doc.defaultView;var html=doc.documentElement;if(body===element.dom){return SugarPosition(body.offsetLeft,body.offsetTop);}var scrollTop=firstDefinedOrZero(win===null||win===void 0?void 0:win.pageYOffset,html.scrollTop);var scrollLeft=firstDefinedOrZero(win===null||win===void 0?void 0:win.pageXOffset,html.scrollLeft);var clientTop=firstDefinedOrZero(html.clientTop,body.clientTop);var clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop);};var viewport=function viewport(element){var dom=element.dom;var doc=dom.ownerDocument;var body=doc.body;if(body===dom){return SugarPosition(body.offsetLeft,body.offsetTop);}if(!inBody(element)){return SugarPosition(0,0);}return boxPosition(dom);};var get$1=function get$1(_DOC){var doc=_DOC!==undefined?_DOC.dom:document;var x=doc.body.scrollLeft||doc.documentElement.scrollLeft;var y=doc.body.scrollTop||doc.documentElement.scrollTop;return SugarPosition(x,y);};var to=function to(x,y,_DOC){var doc=_DOC!==undefined?_DOC.dom:document;var win=doc.defaultView;if(win){win.scrollTo(x,y);}};var intoView=function intoView(element,alignToTop){var isSafari=detect$3().browser.isSafari();if(isSafari&&isFunction(element.dom.scrollIntoViewIfNeeded)){element.dom.scrollIntoViewIfNeeded(false);}else{element.dom.scrollIntoView(alignToTop);}};var get$2=function get$2(_win){var win=_win===undefined?window:_win;return Optional.from(win['visualViewport']);};var bounds=function bounds(x,y,width,height){return{x:x,y:y,width:width,height:height,right:x+width,bottom:y+height};};var getBounds=function getBounds(_win){var win=_win===undefined?window:_win;var doc=win.document;var scroll=get$1(SugarElement.fromDom(doc));return get$2(win).fold(function(){var html=win.document.documentElement;var width=html.clientWidth;var height=html.clientHeight;return bounds(scroll.left,scroll.top,width,height);},function(visualViewport){return bounds(Math.max(visualViewport.pageLeft,scroll.left),Math.max(visualViewport.pageTop,scroll.top),visualViewport.width,visualViewport.height);});};var isNodeType=function isNodeType(type){return function(node){return!!node&&node.nodeType===type;};};var isRestrictedNode=function isRestrictedNode(node){return!!node&&!Object.getPrototypeOf(node);};var isElement$1=isNodeType(1);var matchNodeNames=function matchNodeNames(names){var lowercasedNames=names.map(function(s){return s.toLowerCase();});return function(node){if(node&&node.nodeName){var nodeName=node.nodeName.toLowerCase();return contains(lowercasedNames,nodeName);}return false;};};var matchStyleValues=function matchStyleValues(name,values){var items=values.toLowerCase().split(' ');return function(node){var i,cssValue;if(isElement$1(node)){for(i=0;i<items.length;i++){var computed=node.ownerDocument.defaultView.getComputedStyle(node,null);cssValue=computed?computed.getPropertyValue(name):null;if(cssValue===items[i]){return true;}}}return false;};};var hasAttribute=function hasAttribute(attrName){return function(node){return isElement$1(node)&&node.hasAttribute(attrName);};};var hasAttributeValue=function hasAttributeValue(attrName,attrValue){return function(node){return isElement$1(node)&&node.getAttribute(attrName)===attrValue;};};var isBogus=function isBogus(node){return isElement$1(node)&&node.hasAttribute('data-mce-bogus');};var isBogusAll=function isBogusAll(node){return isElement$1(node)&&node.getAttribute('data-mce-bogus')==='all';};var isTable=function isTable(node){return isElement$1(node)&&node.tagName==='TABLE';};var hasContentEditableState=function hasContentEditableState(value){return function(node){if(isElement$1(node)){if(node.contentEditable===value){return true;}if(node.getAttribute('data-mce-contenteditable')===value){return true;}}return false;};};var isTextareaOrInput=matchNodeNames(['textarea','input']);var isText$1=isNodeType(3);var isComment$1=isNodeType(8);var isDocument$1=isNodeType(9);var isDocumentFragment$1=isNodeType(11);var isBr=matchNodeNames(['br']);var isImg=matchNodeNames(['img']);var isContentEditableTrue=hasContentEditableState('true');var isContentEditableFalse=hasContentEditableState('false');var isTableCell=matchNodeNames(['td','th']);var isMedia=matchNodeNames(['video','audio','object','embed']);var isSupported$1=function isSupported$1(dom){return dom.style!==undefined&&isFunction(dom.style.getPropertyValue);};var rawSet=function rawSet(dom,key,value){if(isString(value)||isBoolean(value)||isNumber(value)){dom.setAttribute(key,value+'');}else{console.error('Invalid call to Attribute.set. Key ',key,':: Value ',value,':: Element ',dom);throw new Error('Attribute value was not simple');}};var set=function set(element,key,value){rawSet(element.dom,key,value);};var setAll=function setAll(element,attrs){var dom=element.dom;each$1(attrs,function(v,k){rawSet(dom,k,v);});};var get$3=function get$3(element,key){var v=element.dom.getAttribute(key);return v===null?undefined:v;};var getOpt=function getOpt(element,key){return Optional.from(get$3(element,key));};var has$1=function has$1(element,key){var dom=element.dom;return dom&&dom.hasAttribute?dom.hasAttribute(key):false;};var remove$1=function remove$1(element,key){element.dom.removeAttribute(key);};var clone=function clone(element){return foldl(element.dom.attributes,function(acc,attr){acc[attr.name]=attr.value;return acc;},{});};var internalSet=function internalSet(dom,property,value){if(!isString(value)){console.error('Invalid call to CSS.set. Property ',property,':: Value ',value,':: Element ',dom);throw new Error('CSS value must be a string: '+value);}if(isSupported$1(dom)){dom.style.setProperty(property,value);}};var setAll$1=function setAll$1(element,css){var dom=element.dom;each$1(css,function(v,k){internalSet(dom,k,v);});};var get$4=function get$4(element,property){var dom=element.dom;var styles=window.getComputedStyle(dom);var r=styles.getPropertyValue(property);return r===''&&!inBody(element)?getUnsafeProperty(dom,property):r;};var getUnsafeProperty=function getUnsafeProperty(dom,property){return isSupported$1(dom)?dom.style.getPropertyValue(property):'';};var getRaw=function getRaw(element,property){var dom=element.dom;var raw=getUnsafeProperty(dom,property);return Optional.from(raw).filter(function(r){return r.length>0;});};var getAllRaw=function getAllRaw(element){var css={};var dom=element.dom;if(isSupported$1(dom)){for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName];}}return css;};var reflow=function reflow(e){return e.dom.offsetWidth;};var browser$1=detect$3().browser;var firstElement=function firstElement(nodes){return find(nodes,isElement);};var getTableCaptionDeltaY=function getTableCaptionDeltaY(elm){if(browser$1.isFirefox()&&name(elm)==='table'){return firstElement(children(elm)).filter(function(elm){return name(elm)==='caption';}).bind(function(caption){return firstElement(nextSiblings(caption)).map(function(body){var bodyTop=body.dom.offsetTop;var captionTop=caption.dom.offsetTop;var captionHeight=caption.dom.offsetHeight;return bodyTop<=captionTop?-captionHeight:0;});}).getOr(0);}else{return 0;}};var hasChild=function hasChild(elm,child){return elm.children&&contains(elm.children,child);};var getPos=function getPos(body,elm,rootElm){var x=0,y=0,offsetParent;var doc=body.ownerDocument;var pos;rootElm=rootElm?rootElm:body;if(elm){if(rootElm===body&&elm.getBoundingClientRect&&get$4(SugarElement.fromDom(body),'position')==='static'){pos=elm.getBoundingClientRect();x=pos.left+(doc.documentElement.scrollLeft||body.scrollLeft)-doc.documentElement.clientLeft;y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-doc.documentElement.clientTop;return{x:x,y:y};}offsetParent=elm;while(offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm)){x+=offsetParent.offsetLeft||0;y+=offsetParent.offsetTop||0;offsetParent=offsetParent.offsetParent;}offsetParent=elm.parentNode;while(offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm)){x-=offsetParent.scrollLeft||0;y-=offsetParent.scrollTop||0;offsetParent=offsetParent.parentNode;}y+=getTableCaptionDeltaY(SugarElement.fromDom(elm));}return{x:x,y:y};};var exports$1={},module$1={exports:exports$1};(function(define,exports,module,require){(function(f){if(_typeof(exports)==='object'&&typeof module!=='undefined'){module.exports=f();}else if(typeof define==='function'&&define.amd){define([],f);}else{var g;if(typeof window!=='undefined'){g=window;}else if(typeof global!=='undefined'){g=global;}else if(typeof self!=='undefined'){g=self;}else{g=this;}g.EphoxContactWrapper=f();}})(function(){return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c='function'==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error('Cannot find module \''+i+'\'');throw a.code='MODULE_NOT_FOUND',a;}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r);},p,p.exports,r,e,n,t);}return n[i].exports;}for(var u='function'==typeof require&&require,i=0;i<t.length;i++){o(t[i]);}return o;}return r;}()({1:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error('setTimeout has not been defined');}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined');}(function(){try{if(typeof setTimeout==='function'){cachedSetTimeout=setTimeout;}else{cachedSetTimeout=defaultSetTimout;}}catch(e){cachedSetTimeout=defaultSetTimout;}try{if(typeof clearTimeout==='function'){cachedClearTimeout=clearTimeout;}else{cachedClearTimeout=defaultClearTimeout;}}catch(e){cachedClearTimeout=defaultClearTimeout;}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0);}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0);}try{return cachedSetTimeout(fun,0);}catch(e){try{return cachedSetTimeout.call(null,fun,0);}catch(e){return cachedSetTimeout.call(this,fun,0);}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker);}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker);}try{return cachedClearTimeout(marker);}catch(e){try{return cachedClearTimeout.call(null,marker);}catch(e){return cachedClearTimeout.call(this,marker);}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return;}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue);}else{queueIndex=-1;}if(queue.length){drainQueue();}}function drainQueue(){if(draining){return;}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run();}}queueIndex=-1;len=queue.length;}currentQueue=null;draining=false;runClearTimeout(timeout);}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i];}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue);}};function Item(fun,array){this.fun=fun;this.array=array;}Item.prototype.run=function(){this.fun.apply(null,this.array);};process.title='browser';process.browser=true;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[];};process.binding=function(name){throw new Error('process.binding is not supported');};process.cwd=function(){return'/';};process.chdir=function(dir){throw new Error('process.chdir is not supported');};process.umask=function(){return 0;};},{}],2:[function(require,module,exports){(function(setImmediate){(function(root){var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments);};}function Promise(fn){if(_typeof(this)!=='object')throw new TypeError('Promises must be constructed via new');if(typeof fn!=='function')throw new TypeError('not a function');this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this);}function handle(self,deferred){while(self._state===3){self=self._value;}if(self._state===0){self._deferreds.push(deferred);return;}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return;}var ret;try{ret=cb(self._value);}catch(e){reject(deferred.promise,e);return;}resolve(deferred.promise,ret);});}function resolve(self,newValue){try{if(newValue===self)throw new TypeError('A promise cannot be resolved with itself.');if(newValue&&(_typeof(newValue)==='object'||typeof newValue==='function')){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return;}else if(typeof then==='function'){doResolve(bind(then,newValue),self);return;}}self._state=1;self._value=newValue;finale(self);}catch(e){reject(self,e);}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self);}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value);}});}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i]);}self._deferreds=null;}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==='function'?onFulfilled:null;this.onRejected=typeof onRejected==='function'?onRejected:null;this.promise=promise;}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value);},function(reason){if(done)return;done=true;reject(self,reason);});}catch(ex){if(done)return;done=true;reject(self,ex);}}Promise.prototype['catch']=function(onRejected){return this.then(null,onRejected);};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom;};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(_typeof(val)==='object'||typeof val==='function')){var then=val.then;if(typeof then==='function'){then.call(val,function(val){res(i,val);},reject);return;}}args[i]=val;if(--remaining===0){resolve(args);}}catch(ex){reject(ex);}}for(var i=0;i<args.length;i++){res(i,args[i]);}});};Promise.resolve=function(value){if(value&&_typeof(value)==='object'&&value.constructor===Promise){return value;}return new Promise(function(resolve){resolve(value);});};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value);});};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject);}});};Promise._immediateFn=typeof setImmediate==='function'?function(fn){setImmediate(fn);}:function(fn){setTimeoutFunc(fn,0);};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=='undefined'&&console){console.warn('Possible Unhandled Promise Rejection:',err);}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn;};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn;};if(typeof module!=='undefined'&&module.exports){module.exports=Promise;}else if(!root.Promise){root.Promise=Promise;}})(this);}).call(this,require('timers').setImmediate);},{'timers':3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require('process/browser.js').nextTick;var apply=Function.prototype.apply;var slice=Array.prototype.slice;var immediateIds={};var nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout);};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval);};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close();};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn;}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id);};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs;};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1;};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout(function onTimeout(){if(item._onTimeout)item._onTimeout();},msecs);}};exports.setImmediate=typeof setImmediate==='function'?setImmediate:function(fn){var id=nextImmediateId++;var args=arguments.length<2?false:slice.call(arguments,1);immediateIds[id]=true;nextTick(function onNextTick(){if(immediateIds[id]){if(args){fn.apply(null,args);}else{fn.call(null);}exports.clearImmediate(id);}});return id;};exports.clearImmediate=typeof clearImmediate==='function'?clearImmediate:function(id){delete immediateIds[id];};}).call(this,require('timers').setImmediate,require('timers').clearImmediate);},{'process/browser.js':1,'timers':3}],4:[function(require,module,exports){var promisePolyfill=require('promise-polyfill');var Global=function(){if(typeof window!=='undefined'){return window;}else{return Function('return this;')();}}();module.exports={boltExport:Global.Promise||promisePolyfill};},{'promise-polyfill':2}]},{},[4])(4);});})(undefined,exports$1,module$1,undefined);var Promise=module$1.exports.boltExport;var nu$3=function nu$3(baseFn){var data=Optional.none();var callbacks=[];var map=function map(f){return nu$3(function(nCallback){get(function(data){nCallback(f(data));});});};var get=function get(nCallback){if(isReady()){call(nCallback);}else{callbacks.push(nCallback);}};var set=function set(x){if(!isReady()){data=Optional.some(x);run(callbacks);callbacks=[];}};var isReady=function isReady(){return data.isSome();};var run=function run(cbs){each(cbs,call);};var call=function call(cb){data.each(function(x){setTimeout(function(){cb(x);},0);});};baseFn(set);return{get:get,map:map,isReady:isReady};};var pure=function pure(a){return nu$3(function(callback){callback(a);});};var LazyValue={nu:nu$3,pure:pure};var errorReporter=function errorReporter(err){setTimeout(function(){throw err;},0);};var make=function make(run){var get=function get(callback){run().then(callback,errorReporter);};var map=function map(fab){return make(function(){return run().then(fab);});};var bind=function bind(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise();});});};var anonBind=function anonBind(futureB){return make(function(){return run().then(function(){return futureB.toPromise();});});};var toLazy=function toLazy(){return LazyValue.nu(get);};var toCached=function toCached(){var cache=null;return make(function(){if(cache===null){cache=run();}return cache;});};var toPromise=run;return{map:map,bind:bind,anonBind:anonBind,toLazy:toLazy,toCached:toCached,toPromise:toPromise,get:get};};var nu$4=function nu$4(baseFn){return make(function(){return new Promise(baseFn);});};var pure$1=function pure$1(a){return make(function(){return Promise.resolve(a);});};var Future={nu:nu$4,pure:pure$1};var par=function par(asyncValues,nu){return nu(function(callback){var r=[];var count=0;var cb=function cb(i){return function(value){r[i]=value;count++;if(count>=asyncValues.length){callback(r);}};};if(asyncValues.length===0){callback([]);}else{each(asyncValues,function(asyncValue,i){asyncValue.get(cb(i));});}});};var par$1=function par$1(futures){return par(futures,Future.nu);};var value=function value(o){var is=function is(v){return o===v;};var or=function or(_opt){return value(o);};var orThunk=function orThunk(_f){return value(o);};var map=function map(f){return value(f(o));};var mapError=function mapError(_f){return value(o);};var each=function each(f){f(o);};var bind=function bind(f){return f(o);};var fold=function fold(_,onValue){return onValue(o);};var exists=function exists(f){return f(o);};var forall=function forall(f){return f(o);};var toOptional=function toOptional(){return Optional.some(o);};return{is:is,isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:or,orThunk:orThunk,fold:fold,map:map,mapError:mapError,each:each,bind:bind,exists:exists,forall:forall,toOptional:toOptional};};var error=function error(message){var getOrThunk=function getOrThunk(f){return f();};var getOrDie=function getOrDie(){return die(String(message))();};var or=function or(opt){return opt;};var orThunk=function orThunk(f){return f();};var map=function map(_f){return error(message);};var mapError=function mapError(f){return error(f(message));};var bind=function bind(_f){return error(message);};var fold=function fold(onError,_){return onError(message);};return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:fold,map:map,mapError:mapError,each:noop,bind:bind,exists:never,forall:always,toOptional:Optional.none};};var fromOption=function fromOption(opt,err){return opt.fold(function(){return error(err);},value);};var Result={value:value,error:error,fromOption:fromOption};var generate=function generate(cases){if(!isArray(cases)){throw new Error('cases must be an array');}if(cases.length===0){throw new Error('there must be at least one case');}var constructors=[];var adt={};each(cases,function(acase,count){var keys$1=keys(acase);if(keys$1.length!==1){throw new Error('one and only one name per case');}var key=keys$1[0];var value=acase[key];if(adt[key]!==undefined){throw new Error('duplicate key detected:'+key);}else if(key==='cata'){throw new Error('cannot have a case named cata (sorry)');}else if(!isArray(value)){throw new Error('case arguments must be an array');}constructors.push(key);adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length){throw new Error('Wrong number of arguments to case '+key+'. Expected '+value.length+' ('+value+'), got '+argLength);}var args=new Array(argLength);for(var i=0;i<args.length;i++){args[i]=arguments[i];}var match=function match(branches){var branchKeys=keys(branches);if(constructors.length!==branchKeys.length){throw new Error('Wrong number of arguments to match. Expected: '+constructors.join(',')+'\nActual: '+branchKeys.join(','));}var allReqd=forall(constructors,function(reqKey){return contains(branchKeys,reqKey);});if(!allReqd){throw new Error('Not all branches were specified when using match. Specified: '+branchKeys.join(', ')+'\nRequired: '+constructors.join(', '));}return branches[key].apply(null,args);};return{fold:function fold(){if(arguments.length!==cases.length){throw new Error('Wrong number of arguments to fold. Expected '+cases.length+', got '+arguments.length);}var target=arguments[count];return target.apply(null,args);},match:match,log:function log(label){console.log(label,{constructors:constructors,constructor:key,params:args});}};};});return adt;};var Adt={generate:generate};var comparison=Adt.generate([{bothErrors:['error1','error2']},{firstError:['error1','value2']},{secondError:['value1','error2']},{bothValues:['value1','value2']}]);var unite=function unite(result){return result.fold(identity,identity);};function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Optional.some(scope):isFunction(isRoot)&&isRoot(scope)?Optional.none():ancestor(scope,a,isRoot);}var ancestor=function ancestor(scope,predicate,isRoot){var element=scope.dom;var stop=isFunction(isRoot)?isRoot:never;while(element.parentNode){element=element.parentNode;var el=SugarElement.fromDom(element);if(predicate(el)){return Optional.some(el);}else if(stop(el)){break;}}return Optional.none();};var closest=function closest(scope,predicate,isRoot){var is=function is(s,test){return test(s);};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot);};var ancestor$1=function ancestor$1(scope,selector,isRoot){return ancestor(scope,function(e){return is$1(e,selector);},isRoot);};var descendant=function descendant(scope,selector){return one(selector,scope);};var closest$1=function closest$1(scope,selector,isRoot){var is=function is(element,selector){return is$1(element,selector);};return ClosestOrAncestor(is,ancestor$1,scope,selector,isRoot);};var promise=function promise(){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments);};}var isArray=Array.isArray||function(value){return Object.prototype.toString.call(value)==='[object Array]';};var Promise=function Promise(fn){if(_typeof(this)!=='object'){throw new TypeError('Promises must be constructed via new');}if(typeof fn!=='function'){throw new TypeError('not a function');}this._state=null;this._value=null;this._deferreds=[];doResolve(fn,bind(resolve,this),bind(reject,this));};var asap=Promise.immediateFn||typeof setImmediate==='function'&&setImmediate||function(fn){setTimeout(fn,1);};function handle(deferred){var me=this;if(this._state===null){this._deferreds.push(deferred);return;}asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(cb===null){(me._state?deferred.resolve:deferred.reject)(me._value);return;}var ret;try{ret=cb(me._value);}catch(e){deferred.reject(e);return;}deferred.resolve(ret);});}function resolve(newValue){try{if(newValue===this){throw new TypeError('A promise cannot be resolved with itself.');}if(newValue&&(_typeof(newValue)==='object'||typeof newValue==='function')){var then=newValue.then;if(typeof then==='function'){doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this));return;}}this._state=true;this._value=newValue;finale.call(this);}catch(e){reject.call(this,e);}}function reject(newValue){this._state=false;this._value=newValue;finale.call(this);}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++){handle.call(this,this._deferreds[i]);}this._deferreds=null;}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled=typeof onFulfilled==='function'?onFulfilled:null;this.onRejected=typeof onRejected==='function'?onRejected:null;this.resolve=resolve;this.reject=reject;}function doResolve(fn,onFulfilled,onRejected){var done=false;try{fn(function(value){if(done){return;}done=true;onFulfilled(value);},function(reason){if(done){return;}done=true;onRejected(reason);});}catch(ex){if(done){return;}done=true;onRejected(ex);}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected);};Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject));});};Promise.all=function(){var args=Array.prototype.slice.call(arguments.length===1&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){if(args.length===0){return resolve([]);}var remaining=args.length;function res(i,val){try{if(val&&(_typeof(val)==='object'||typeof val==='function')){var then=val.then;if(typeof then==='function'){then.call(val,function(val){res(i,val);},reject);return;}}args[i]=val;if(--remaining===0){resolve(args);}}catch(ex){reject(ex);}}for(var i=0;i<args.length;i++){res(i,args[i]);}});};Promise.resolve=function(value){if(value&&_typeof(value)==='object'&&value.constructor===Promise){return value;}return new Promise(function(resolve){resolve(value);});};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value);});};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject);}});};return Promise;};var promiseObj=window.Promise?window.Promise:promise();var requestAnimationFramePromise;var _requestAnimationFrame=function requestAnimationFrame(callback,element){var i,requestAnimationFrameFunc=window.requestAnimationFrame;var vendors=['ms','moz','webkit'];var featurefill=function featurefill(callback){window.setTimeout(callback,0);};for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++){requestAnimationFrameFunc=window[vendors[i]+'RequestAnimationFrame'];}if(!requestAnimationFrameFunc){requestAnimationFrameFunc=featurefill;}requestAnimationFrameFunc(callback,element);};var wrappedSetTimeout=function wrappedSetTimeout(callback,time){if(typeof time!=='number'){time=0;}return setTimeout(callback,time);};var wrappedSetInterval=function wrappedSetInterval(callback,time){if(typeof time!=='number'){time=1;}return setInterval(callback,time);};var wrappedClearTimeout=function wrappedClearTimeout(id){return clearTimeout(id);};var wrappedClearInterval=function wrappedClearInterval(id){return clearInterval(id);};var debounce=function debounce(callback,time){var timer;var func=function func(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}clearTimeout(timer);timer=wrappedSetTimeout(function(){callback.apply(this,args);},time);};func.stop=function(){clearTimeout(timer);};return func;};var Delay={requestAnimationFrame:function requestAnimationFrame(callback,element){if(requestAnimationFramePromise){requestAnimationFramePromise.then(callback);return;}requestAnimationFramePromise=new promiseObj(function(resolve){if(!element){element=document.body;}_requestAnimationFrame(resolve,element);}).then(callback);},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function setEditorTimeout(editor,callback,time){return wrappedSetTimeout(function(){if(!editor.removed){callback();}},time);},setEditorInterval:function setEditorInterval(editor,callback,time){var timer=wrappedSetInterval(function(){if(!editor.removed){callback();}else{clearInterval(timer);}},time);return timer;},debounce:debounce,throttle:debounce,clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout};function StyleSheetLoader(documentOrShadowRoot,settings){if(settings===void 0){settings={};}var idCount=0;var loadedStates={};var edos=SugarElement.fromDom(documentOrShadowRoot);var doc=documentOrOwner(edos);var maxLoadTime=settings.maxLoadTime||5000;var _setReferrerPolicy=function _setReferrerPolicy(referrerPolicy){settings.referrerPolicy=referrerPolicy;};var addStyle=function addStyle(element){append(getStyleContainer(edos),element);};var removeStyle=function removeStyle(id){var styleContainer=getStyleContainer(edos);descendant(styleContainer,'#'+id).each(remove);};var getOrCreateState=function getOrCreateState(url){return get(loadedStates,url).getOrThunk(function(){return{id:'mce-u'+idCount++,passed:[],failed:[],count:0};});};var load=function load(url,success,failure){var link;var urlWithSuffix=Tools._addCacheSuffix(url);var state=getOrCreateState(urlWithSuffix);loadedStates[urlWithSuffix]=state;state.count++;var resolve=function resolve(callbacks,status){var i=callbacks.length;while(i--){callbacks[i]();}state.status=status;state.passed=[];state.failed=[];if(link){link.onload=null;link.onerror=null;link=null;}};var passed=function passed(){return resolve(state.passed,2);};var failed=function failed(){return resolve(state.failed,3);};var wait=function wait(testCallback,waitCallback){if(!testCallback()){if(Date.now()-startTime<maxLoadTime){Delay.setTimeout(waitCallback);}else{failed();}}};var waitForWebKitLinkLoaded=function waitForWebKitLinkLoaded(){wait(function(){var styleSheets=documentOrShadowRoot.styleSheets;var i=styleSheets.length;while(i--){var styleSheet=styleSheets[i];var owner=styleSheet.ownerNode;if(owner&&owner.id===link.id){passed();return true;}}return false;},waitForWebKitLinkLoaded);};if(success){state.passed.push(success);}if(failure){state.failed.push(failure);}if(state.status===1){return;}if(state.status===2){passed();return;}if(state.status===3){failed();return;}state.status=1;var linkElem=SugarElement.fromTag('link',doc.dom);setAll(linkElem,{rel:'stylesheet',type:'text/css',id:state.id});var startTime=Date.now();if(settings.contentCssCors){set(linkElem,'crossOrigin','anonymous');}if(settings.referrerPolicy){set(linkElem,'referrerpolicy',settings.referrerPolicy);}link=linkElem.dom;link.onload=waitForWebKitLinkLoaded;link.onerror=failed;addStyle(linkElem);set(linkElem,'href',urlWithSuffix);};var loadF=function loadF(url){return Future.nu(function(resolve){load(url,compose(resolve,constant(Result.value(url))),compose(resolve,constant(Result.error(url))));});};var loadAll=function loadAll(urls,success,failure){par$1(map(urls,loadF)).get(function(result){var parts=partition(result,function(r){return r.isValue();});if(parts.fail.length>0){failure(parts.fail.map(unite));}else{success(parts.pass.map(unite));}});};var unload=function unload(url){var urlWithSuffix=Tools._addCacheSuffix(url);get(loadedStates,urlWithSuffix).each(function(state){var count=--state.count;if(count===0){delete loadedStates[urlWithSuffix];removeStyle(state.id);}});};var unloadAll=function unloadAll(urls){each(urls,function(url){unload(url);});};return{load:load,loadAll:loadAll,unload:unload,unloadAll:unloadAll,_setReferrerPolicy:_setReferrerPolicy};}var create$1=function create$1(){var map=new WeakMap();var forElement=function forElement(referenceElement,settings){var root=getRootNode(referenceElement);var rootDom=root.dom;return Optional.from(map.get(rootDom)).getOrThunk(function(){var sl=StyleSheetLoader(rootDom,settings);map.set(rootDom,sl);return sl;});};return{forElement:forElement};};var instance=create$1();var DomTreeWalker=function(){function DomTreeWalker(startNode,rootNode){this.node=startNode;this.rootNode=rootNode;this.current=this.current.bind(this);this.next=this.next.bind(this);this.prev=this.prev.bind(this);this.prev2=this.prev2.bind(this);}DomTreeWalker.prototype.current=function(){return this.node;};DomTreeWalker.prototype.next=function(shallow){this.node=this.findSibling(this.node,'firstChild','nextSibling',shallow);return this.node;};DomTreeWalker.prototype.prev=function(shallow){this.node=this.findSibling(this.node,'lastChild','previousSibling',shallow);return this.node;};DomTreeWalker.prototype.prev2=function(shallow){this.node=this.findPreviousNode(this.node,'lastChild','previousSibling',shallow);return this.node;};DomTreeWalker.prototype.findSibling=function(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName]){return node[startName];}if(node!==this.rootNode){sibling=node[siblingName];if(sibling){return sibling;}for(parent=node.parentNode;parent&&parent!==this.rootNode;parent=parent.parentNode){sibling=parent[siblingName];if(sibling){return sibling;}}}}};DomTreeWalker.prototype.findPreviousNode=function(node,startName,siblingName,shallow){var sibling,parent,child;if(node){sibling=node[siblingName];if(this.rootNode&&sibling===this.rootNode){return;}if(sibling){if(!shallow){for(child=sibling[startName];child;child=child[startName]){if(!child[startName]){return child;}}}return sibling;}parent=node.parentNode;if(parent&&parent!==this.rootNode){return parent;}}};return DomTreeWalker;}();var blocks=['article','aside','details','div','dt','figcaption','footer','form','fieldset','header','hgroup','html','main','nav','section','summary','body','p','dl','multicol','dd','figure','address','center','blockquote','h1','h2','h3','h4','h5','h6','listing','xmp','pre','plaintext','menu','dir','ul','ol','li','hr','table','tbody','thead','tfoot','th','tr','td','caption'];var tableCells=['td','th'];var tableSections=['thead','tbody','tfoot'];var textBlocks=['h1','h2','h3','h4','h5','h6','p','div','address','pre','form','blockquote','center','dir','fieldset','header','footer','article','section','hgroup','aside','nav','figure'];var headings=['h1','h2','h3','h4','h5','h6'];var listItems=['li','dd','dt'];var lists=['ul','ol','dl'];var wsElements=['pre','script','textarea','style'];var lazyLookup=function lazyLookup(items){var lookup;return function(node){lookup=lookup?lookup:mapToObject(items,always);return lookup.hasOwnProperty(name(node));};};var isHeading=lazyLookup(headings);var isBlock=lazyLookup(blocks);var isTable$1=function isTable$1(node){return name(node)==='table';};var isInline=function isInline(node){return isElement(node)&&!isBlock(node);};var isBr$1=function isBr$1(node){return isElement(node)&&name(node)==='br';};var isTextBlock=lazyLookup(textBlocks);var isList=lazyLookup(lists);var isListItem=lazyLookup(listItems);var isTableSection=lazyLookup(tableSections);var isTableCell$1=lazyLookup(tableCells);var isWsPreserveElement=lazyLookup(wsElements);var ancestor$2=function ancestor$2(scope,selector,isRoot){return ancestor$1(scope,selector,isRoot).isSome();};var zeroWidth="\uFEFF";var nbsp='\xA0';var isZwsp=function isZwsp(_char){return _char===zeroWidth;};var removeZwsp=function removeZwsp(s){return s.replace(/\uFEFF/g,'');};var ZWSP=zeroWidth;var isZwsp$1=isZwsp;var trim$2=removeZwsp;var isElement$2=isElement$1;var isText$2=isText$1;var isCaretContainerBlock=function isCaretContainerBlock(node){if(isText$2(node)){node=node.parentNode;}return isElement$2(node)&&node.hasAttribute('data-mce-caret');};var isCaretContainerInline=function isCaretContainerInline(node){return isText$2(node)&&isZwsp$1(node.data);};var isCaretContainer=function isCaretContainer(node){return isCaretContainerBlock(node)||isCaretContainerInline(node);};var hasContent=function hasContent(node){return node.firstChild!==node.lastChild||!isBr(node.firstChild);};var insertInline=function insertInline(node,before){var sibling;var doc=node.ownerDocument;var textNode=doc.createTextNode(ZWSP);var parentNode=node.parentNode;if(!before){sibling=node.nextSibling;if(isText$2(sibling)){if(isCaretContainer(sibling)){return sibling;}if(startsWithCaretContainer(sibling)){sibling.splitText(1);return sibling;}}if(node.nextSibling){parentNode.insertBefore(textNode,node.nextSibling);}else{parentNode.appendChild(textNode);}}else{sibling=node.previousSibling;if(isText$2(sibling)){if(isCaretContainer(sibling)){return sibling;}if(endsWithCaretContainer(sibling)){return sibling.splitText(sibling.data.length-1);}}parentNode.insertBefore(textNode,node);}return textNode;};var isBeforeInline=function isBeforeInline(pos){var container=pos.container();if(!isText$1(container)){return false;}return container.data.charAt(pos.offset())===ZWSP||pos.isAtStart()&&isCaretContainerInline(container.previousSibling);};var isAfterInline=function isAfterInline(pos){var container=pos.container();if(!isText$1(container)){return false;}return container.data.charAt(pos.offset()-1)===ZWSP||pos.isAtEnd()&&isCaretContainerInline(container.nextSibling);};var createBogusBr=function createBogusBr(){var br=document.createElement('br');br.setAttribute('data-mce-bogus','1');return br;};var insertBlock=function insertBlock(blockName,node,before){var doc=node.ownerDocument;var blockNode=doc.createElement(blockName);blockNode.setAttribute('data-mce-caret',before?'before':'after');blockNode.setAttribute('data-mce-bogus','all');blockNode.appendChild(createBogusBr());var parentNode=node.parentNode;if(!before){if(node.nextSibling){parentNode.insertBefore(blockNode,node.nextSibling);}else{parentNode.appendChild(blockNode);}}else{parentNode.insertBefore(blockNode,node);}return blockNode;};var startsWithCaretContainer=function startsWithCaretContainer(node){return isText$2(node)&&node.data[0]===ZWSP;};var endsWithCaretContainer=function endsWithCaretContainer(node){return isText$2(node)&&node.data[node.data.length-1]===ZWSP;};var trimBogusBr=function trimBogusBr(elm){var brs=elm.getElementsByTagName('br');var lastBr=brs[brs.length-1];if(isBogus(lastBr)){lastBr.parentNode.removeChild(lastBr);}};var showCaretContainerBlock=function showCaretContainerBlock(caretContainer){if(caretContainer&&caretContainer.hasAttribute('data-mce-caret')){trimBogusBr(caretContainer);caretContainer.removeAttribute('data-mce-caret');caretContainer.removeAttribute('data-mce-bogus');caretContainer.removeAttribute('style');caretContainer.removeAttribute('_moz_abspos');return caretContainer;}return null;};var isRangeInCaretContainerBlock=function isRangeInCaretContainerBlock(range){return isCaretContainerBlock(range.startContainer);};var isContentEditableTrue$1=isContentEditableTrue;var isContentEditableFalse$1=isContentEditableFalse;var isBr$2=isBr;var isText$3=isText$1;var isInvalidTextElement=matchNodeNames(['script','style','textarea']);var isAtomicInline=matchNodeNames(['img','input','textarea','hr','iframe','video','audio','object','embed']);var isTable$2=matchNodeNames(['table']);var isCaretContainer$1=isCaretContainer;var isCaretCandidate=function isCaretCandidate(node){if(isCaretContainer$1(node)){return false;}if(isText$3(node)){return!isInvalidTextElement(node.parentNode);}return isAtomicInline(node)||isBr$2(node)||isTable$2(node)||isNonUiContentEditableFalse(node);};var isUnselectable=function isUnselectable(node){return isElement$1(node)&&node.getAttribute('unselectable')==='true';};var isNonUiContentEditableFalse=function isNonUiContentEditableFalse(node){return isUnselectable(node)===false&&isContentEditableFalse$1(node);};var isInEditable=function isInEditable(node,root){for(node=node.parentNode;node&&node!==root;node=node.parentNode){if(isNonUiContentEditableFalse(node)){return false;}if(isContentEditableTrue$1(node)){return true;}}return true;};var isAtomicContentEditableFalse=function isAtomicContentEditableFalse(node){if(!isNonUiContentEditableFalse(node)){return false;}return foldl(from$1(node.getElementsByTagName('*')),function(result,elm){return result||isContentEditableTrue$1(elm);},false)!==true;};var isAtomic=function isAtomic(node){return isAtomicInline(node)||isAtomicContentEditableFalse(node);};var isEditableCaretCandidate=function isEditableCaretCandidate(node,root){return isCaretCandidate(node)&&isInEditable(node,root);};var whiteSpaceRegExp$1=/^[ \t\r\n]*$/;var isWhitespaceText=function isWhitespaceText(text){return whiteSpaceRegExp$1.test(text);};var hasWhitespacePreserveParent=function hasWhitespacePreserveParent(node,rootNode){var rootElement=SugarElement.fromDom(rootNode);var startNode=SugarElement.fromDom(node);return ancestor$2(startNode,'pre,code',curry(eq$2,rootElement));};var isWhitespace=function isWhitespace(node,rootNode){return isText$1(node)&&isWhitespaceText(node.data)&&hasWhitespacePreserveParent(node,rootNode)===false;};var isNamedAnchor=function isNamedAnchor(node){return isElement$1(node)&&node.nodeName==='A'&&!node.hasAttribute('href')&&(node.hasAttribute('name')||node.hasAttribute('id'));};var isContent=function isContent(node,rootNode){return isCaretCandidate(node)&&isWhitespace(node,rootNode)===false||isNamedAnchor(node)||isBookmark(node);};var isBookmark=hasAttribute('data-mce-bookmark');var isBogus$1=hasAttribute('data-mce-bogus');var isBogusAll$1=hasAttributeValue('data-mce-bogus','all');var isEmptyNode=function isEmptyNode(targetNode,skipBogus){var node,brCount=0;if(isContent(targetNode,targetNode)){return false;}else{node=targetNode.firstChild;if(!node){return true;}var walker=new DomTreeWalker(node,targetNode);do{if(skipBogus){if(isBogusAll$1(node)){node=walker.next(true);continue;}if(isBogus$1(node)){node=walker.next();continue;}}if(isBr(node)){brCount++;node=walker.next();continue;}if(isContent(node,targetNode)){return false;}node=walker.next();}while(node);return brCount<=1;}};var isEmpty=function isEmpty(elm,skipBogus){if(skipBogus===void 0){skipBogus=true;}return isEmptyNode(elm.dom,skipBogus);};var isSpan=function isSpan(node){return node.nodeName.toLowerCase()==='span';};var isInlineContent=function isInlineContent(node,root){return isNonNullable(node)&&(isContent(node,root)||isInline(SugarElement.fromDom(node)));};var surroundedByInlineContent=function surroundedByInlineContent(node,root){var prev=new DomTreeWalker(node,root).prev(false);var next=new DomTreeWalker(node,root).next(false);var prevIsInline=isUndefined(prev)||isInlineContent(prev,root);var nextIsInline=isUndefined(next)||isInlineContent(next,root);return prevIsInline&&nextIsInline;};var isBookmarkNode=function isBookmarkNode(node){return isSpan(node)&&node.getAttribute('data-mce-type')==='bookmark';};var isKeepTextNode=function isKeepTextNode(node,root){return isText$1(node)&&node.data.length>0&&surroundedByInlineContent(node,root);};var isKeepElement=function isKeepElement(node){return isElement$1(node)?node.childNodes.length>0:false;};var isDocument$2=function isDocument$2(node){return isDocumentFragment$1(node)||isDocument$1(node);};var trimNode=function trimNode(dom,node,root){var rootNode=root||node;if(isElement$1(node)&&isBookmarkNode(node)){return node;}var children=node.childNodes;for(var i=children.length-1;i>=0;i--){trimNode(dom,children[i],rootNode);}if(isElement$1(node)){var currentChildren=node.childNodes;if(currentChildren.length===1&&isBookmarkNode(currentChildren[0])){node.parentNode.insertBefore(currentChildren[0],node);}}if(!isDocument$2(node)&&!isContent(node,rootNode)&&!isKeepElement(node)&&!isKeepTextNode(node,rootNode)){dom.remove(node);}return node;};var makeMap$1=Tools.makeMap;var attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var rawCharsRegExp=/[<>&\"\']/g;var entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi;var asciiMap={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};var baseEntities={'"':'&quot;','\'':'&#39;','<':'&lt;','>':'&gt;','&':'&amp;','`':'&#96;'};var reverseEntities={'&lt;':'<','&gt;':'>','&amp;':'&','&quot;':'"','&apos;':'\''};var nativeDecode=function nativeDecode(text){var elm=SugarElement.fromTag('div').dom;elm.innerHTML=text;return elm.textContent||elm.innerText||text;};var buildEntitiesLookup=function buildEntitiesLookup(items,radix){var i,chr,entity;var lookup={};if(items){items=items.split(',');radix=radix||10;for(i=0;i<items.length;i+=2){chr=String.fromCharCode(parseInt(items[i],radix));if(!baseEntities[chr]){entity='&'+items[i+1]+';';lookup[chr]=entity;lookup[entity]=chr;}}return lookup;}};var namedEntities=buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,'+'5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,'+'5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,'+'5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,'+'68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,'+'6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,'+'6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,'+'75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,'+'7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,'+'7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,'+'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,'+'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,'+'t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,'+'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,'+'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,'+'81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,'+'8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,'+'8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,'+'8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,'+'8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,'+'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,'+'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,'+'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,'+'80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,'+'811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro',32);var encodeRaw=function encodeRaw(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr;});};var encodeAllRaw=function encodeAllRaw(text){return(''+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr;});};var encodeNumeric=function encodeNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(chr.length>1){return'&#'+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+';';}return baseEntities[chr]||'&#'+chr.charCodeAt(0)+';';});};var encodeNamed=function encodeNamed(text,attr,entities){entities=entities||namedEntities;return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr;});};var getEncodeFunc=function getEncodeFunc(name,entities){var entitiesMap=buildEntitiesLookup(entities)||namedEntities;var encodeNamedAndNumeric=function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(baseEntities[chr]!==undefined){return baseEntities[chr];}if(entitiesMap[chr]!==undefined){return entitiesMap[chr];}if(chr.length>1){return'&#'+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+';';}return'&#'+chr.charCodeAt(0)+';';});};var encodeCustomNamed=function encodeCustomNamed(text,attr){return encodeNamed(text,attr,entitiesMap);};var nameMap=makeMap$1(name.replace(/\+/g,','));if(nameMap.named&&nameMap.numeric){return encodeNamedAndNumeric;}if(nameMap.named){if(entities){return encodeCustomNamed;}return encodeNamed;}if(nameMap.numeric){return encodeNumeric;}return encodeRaw;};var decode=function decode(text){return text.replace(entityRegExp,function(all,numeric){if(numeric){if(numeric.charAt(0).toLowerCase()==='x'){numeric=parseInt(numeric.substr(1),16);}else{numeric=parseInt(numeric,10);}if(numeric>65535){numeric-=65536;return String.fromCharCode(55296+(numeric>>10),56320+(numeric&1023));}return asciiMap[numeric]||String.fromCharCode(numeric);}return reverseEntities[all]||namedEntities[all]||nativeDecode(all);});};var Entities={encodeRaw:encodeRaw,encodeAllRaw:encodeAllRaw,encodeNumeric:encodeNumeric,encodeNamed:encodeNamed,getEncodeFunc:getEncodeFunc,decode:decode};var mapCache={},dummyObj={};var makeMap$2=Tools.makeMap,each$3=Tools.each,extend$1=Tools.extend,explode$1=Tools.explode,inArray=Tools.inArray;var split=function split(items,delim){items=Tools.trim(items);return items?items.split(delim||' '):[];};var compileSchema=function compileSchema(type){var schema={};var globalAttributes,blockContent;var phrasingContent,flowContent,html4BlockContent,html4PhrasingContent;var add=function add(name,attributes,children){var ni,attributesOrder,element;var arrayToMap=function arrayToMap(array,obj){var map={};var i,l;for(i=0,l=array.length;i<l;i++){map[array[i]]=obj||{};}return map;};children=children||[];attributes=attributes||'';if(typeof children==='string'){children=split(children);}var names=split(name);ni=names.length;while(ni--){attributesOrder=split([globalAttributes,attributes].join(' '));element={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)};schema[names[ni]]=element;}};var addAttrs=function addAttrs(name,attributes){var ni,schemaItem,i,l;var names=split(name);ni=names.length;var attrs=split(attributes);while(ni--){schemaItem=schema[names[ni]];for(i=0,l=attrs.length;i<l;i++){schemaItem.attributes[attrs[i]]={};schemaItem.attributesOrder.push(attrs[i]);}}};if(mapCache[type]){return mapCache[type];}globalAttributes='id accesskey class dir lang style tabindex title role';blockContent='address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';phrasingContent='a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd '+'label map noscript object q s samp script select small span strong sub sup '+'textarea u var #text #comment';if(type!=='html4'){globalAttributes+=' contenteditable contextmenu draggable dropzone '+'hidden spellcheck translate';blockContent+=' article aside details dialog figure main header footer hgroup section nav';phrasingContent+=' audio canvas command datalist mark meter output picture '+'progress time wbr video ruby bdi keygen';}if(type!=='html5-strict'){globalAttributes+=' xml:lang';html4PhrasingContent='acronym applet basefont big font strike tt';phrasingContent=[phrasingContent,html4PhrasingContent].join(' ');each$3(split(html4PhrasingContent),function(name){add(name,'',phrasingContent);});html4BlockContent='center dir isindex noframes';blockContent=[blockContent,html4BlockContent].join(' ');flowContent=[blockContent,phrasingContent].join(' ');each$3(split(html4BlockContent),function(name){add(name,'',flowContent);});}flowContent=flowContent||[blockContent,phrasingContent].join(' ');add('html','manifest','head body');add('head','','base command link meta noscript script style title');add('title hr noscript br');add('base','href target');add('link','href rel media hreflang type sizes hreflang');add('meta','name http-equiv content charset');add('style','media type scoped');add('script','src async defer type charset');add('body','onafterprint onbeforeprint onbeforeunload onblur onerror onfocus '+'onhashchange onload onmessage onoffline ononline onpagehide onpageshow '+'onpopstate onresize onscroll onstorage onunload',flowContent);add('address dt dd div caption','',flowContent);add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn','',phrasingContent);add('blockquote','cite',flowContent);add('ol','reversed start type','li');add('ul','','li');add('li','value',flowContent);add('dl','','dt dd');add('a','href target rel media hreflang type',phrasingContent);add('q','cite',phrasingContent);add('ins del','cite datetime',flowContent);add('img','src sizes srcset alt usemap ismap width height');add('iframe','src name width height',flowContent);add('embed','src type width height');add('object','data type typemustmatch name usemap form width height',[flowContent,'param'].join(' '));add('param','name value');add('map','name',[flowContent,'area'].join(' '));add('area','alt coords shape href target rel media hreflang type');add('table','border','caption colgroup thead tfoot tbody tr'+(type==='html4'?' col':''));add('colgroup','span','col');add('col','span');add('tbody thead tfoot','','tr');add('tr','','td th');add('td','colspan rowspan headers',flowContent);add('th','colspan rowspan headers scope abbr',flowContent);add('form','accept-charset action autocomplete enctype method name novalidate target',flowContent);add('fieldset','disabled form name',[flowContent,'legend'].join(' '));add('label','form for',phrasingContent);add('input','accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate '+'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');add('button','disabled form formaction formenctype formmethod formnovalidate formtarget name type value',type==='html4'?flowContent:phrasingContent);add('select','disabled form multiple name required size','option optgroup');add('optgroup','disabled label','option');add('option','disabled label selected value');add('textarea','cols dirname disabled form maxlength name readonly required rows wrap');add('menu','type label',[flowContent,'li'].join(' '));add('noscript','',flowContent);if(type!=='html4'){add('wbr');add('ruby','',[phrasingContent,'rt rp'].join(' '));add('figcaption','',flowContent);add('mark rt rp summary bdi','',phrasingContent);add('canvas','width height',flowContent);add('video','src crossorigin poster preload autoplay mediagroup loop '+'muted controls width height buffered',[flowContent,'track source'].join(' '));add('audio','src crossorigin preload autoplay mediagroup loop muted controls '+'buffered volume',[flowContent,'track source'].join(' '));add('picture','','img source');add('source','src srcset type media sizes');add('track','kind src srclang label default');add('datalist','',[phrasingContent,'option'].join(' '));add('article section nav aside main header footer','',flowContent);add('hgroup','','h1 h2 h3 h4 h5 h6');add('figure','',[flowContent,'figcaption'].join(' '));add('time','datetime',phrasingContent);add('dialog','open',flowContent);add('command','type label icon disabled checked radiogroup command');add('output','for form name',phrasingContent);add('progress','value max',phrasingContent);add('meter','value min max low high optimum',phrasingContent);add('details','open',[flowContent,'summary'].join(' '));add('keygen','autofocus challenge disabled form keytype name');}if(type!=='html5-strict'){addAttrs('script','language xml:space');addAttrs('style','xml:space');addAttrs('object','declare classid code codebase codetype archive standby align border hspace vspace');addAttrs('embed','align name hspace vspace');addAttrs('param','valuetype type');addAttrs('a','charset name rev shape coords');addAttrs('br','clear');addAttrs('applet','codebase archive code object alt name width height align hspace vspace');addAttrs('img','name longdesc align border hspace vspace');addAttrs('iframe','longdesc frameborder marginwidth marginheight scrolling align');addAttrs('font basefont','size color face');addAttrs('input','usemap align');addAttrs('select');addAttrs('textarea');addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption','align');addAttrs('ul','type compact');addAttrs('li','type');addAttrs('ol dl menu dir','compact');addAttrs('pre','width xml:space');addAttrs('hr','align noshade size width');addAttrs('isindex','prompt');addAttrs('table','summary width frame rules cellspacing cellpadding align bgcolor');addAttrs('col','width align char charoff valign');addAttrs('colgroup','width align char charoff valign');addAttrs('thead','align char charoff valign');addAttrs('tr','align char charoff valign bgcolor');addAttrs('th','axis align char charoff valign nowrap bgcolor width height');addAttrs('form','accept');addAttrs('td','abbr axis scope align char charoff valign nowrap bgcolor width height');addAttrs('tfoot','align char charoff valign');addAttrs('tbody','align char charoff valign');addAttrs('area','nohref');addAttrs('body','background bgcolor text link vlink alink');}if(type!=='html4'){addAttrs('input button select textarea','autofocus');addAttrs('input textarea','placeholder');addAttrs('a','download');addAttrs('link script img','crossorigin');addAttrs('img','loading');addAttrs('iframe','sandbox seamless allowfullscreen loading');}each$3(split('a form meter progress dfn'),function(name){if(schema[name]){delete schema[name].children[name];}});delete schema.caption.children.table;delete schema.script;mapCache[type]=schema;return schema;};var compileElementMap=function compileElementMap(value,mode){var styles;if(value){styles={};if(typeof value==='string'){value={'*':value};}each$3(value,function(value,key){styles[key]=styles[key.toUpperCase()]=mode==='map'?makeMap$2(value,/[, ]/):explode$1(value,/[, ]/);});}return styles;};function Schema(settings){var elements={};var children={};var patternElements=[];var customElementsMap={},specialElements={};var createLookupTable=function createLookupTable(option,defaultValue,extendWith){var value=settings[option];if(!value){value=mapCache[option];if(!value){value=makeMap$2(defaultValue,' ',makeMap$2(defaultValue.toUpperCase(),' '));value=extend$1(value,extendWith);mapCache[option]=value;}}else{value=makeMap$2(value,/[, ]/,makeMap$2(value.toUpperCase(),/[, ]/));}return value;};settings=settings||{};var schemaItems=compileSchema(settings.schema);if(settings.verify_html===false){settings.valid_elements='*[*]';}var validStyles=compileElementMap(settings.valid_styles);var invalidStyles=compileElementMap(settings.invalid_styles,'map');var validClasses=compileElementMap(settings.valid_classes,'map');var whiteSpaceElementsMap=createLookupTable('whitespace_elements','pre script noscript style textarea video audio iframe object code');var selfClosingElementsMap=createLookupTable('self_closing_elements','colgroup dd dt li option p td tfoot th thead tr');var shortEndedElementsMap=createLookupTable('short_ended_elements','area base basefont br col frame hr img input isindex link '+'meta param embed source wbr track');var boolAttrMap=createLookupTable('boolean_attributes','checked compact declare defer disabled ismap multiple nohref noresize '+'noshade nowrap readonly selected autoplay loop controls');var nonEmptyOrMoveCaretBeforeOnEnter='td th iframe video audio object script code';var nonEmptyElementsMap=createLookupTable('non_empty_elements',nonEmptyOrMoveCaretBeforeOnEnter+' pre',shortEndedElementsMap);var moveCaretBeforeOnEnterElementsMap=createLookupTable('move_caret_before_on_enter_elements',nonEmptyOrMoveCaretBeforeOnEnter+' table',shortEndedElementsMap);var textBlockElementsMap=createLookupTable('text_block_elements','h1 h2 h3 h4 h5 h6 p div address pre form '+'blockquote center dir fieldset header footer article section hgroup aside main nav figure');var blockElementsMap=createLookupTable('block_elements','hr table tbody thead tfoot '+'th tr td li ol ul caption dl dt dd noscript menu isindex option '+'datalist select optgroup figcaption details summary',textBlockElementsMap);var textInlineElementsMap=createLookupTable('text_inline_elements','span strong b em i font strike u var cite '+'dfn code mark q sup sub samp');each$3((settings.special||'script noscript iframe noframes noembed title style textarea xmp').split(' '),function(name){specialElements[name]=new RegExp('</'+name+'[^>]*>','gi');});var patternToRegExp=function patternToRegExp(str){return new RegExp('^'+str.replace(/([?+*])/g,'.$1')+'$');};var addValidElements=function addValidElements(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,value;var elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements){var validElementsArr=split(validElements,',');if(elements['@']){globalAttributes=elements['@'].attributes;globalAttributesOrder=elements['@'].attributesOrder;}for(ei=0,el=validElementsArr.length;ei<el;ei++){matches=elementRuleRegExp.exec(validElementsArr[ei]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[5];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==='#'){element.paddEmpty=true;}if(prefix==='-'){element.removeEmpty=true;}if(matches[4]==='!'){element.removeEmptyAttrs=true;}if(globalAttributes){each$1(globalAttributes,function(value,key){attributes[key]=value;});attributesOrder.push.apply(attributesOrder,globalAttributesOrder);}if(attrData){attrData=split(attrData,'|');for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/[\\:]:/g,':');prefix=matches[3];value=matches[4];if(attrType==='!'){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true;}if(attrType==='-'){delete attributes[attrName];attributesOrder.splice(inArray(attributesOrder,attrName),1);continue;}if(prefix){if(prefix==='='){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value;}if(prefix===':'){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value;}if(prefix==='<'){attr.validValues=makeMap$2(value,'?');}}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=patternToRegExp(attrName);element.attributePatterns.push(attr);}else{if(!attributes[attrName]){attributesOrder.push(attrName);}attributes[attrName]=attr;}}}}if(!globalAttributes&&elementName==='@'){globalAttributes=attributes;globalAttributesOrder=attributesOrder;}if(outputName){element.outputName=elementName;elements[outputName]=element;}if(hasPatternsRegExp.test(elementName)){element.pattern=patternToRegExp(elementName);patternElements.push(element);}else{elements[elementName]=element;}}}}};var setValidElements=function setValidElements(validElements){elements={};patternElements=[];addValidElements(validElements);each$3(schemaItems,function(element,name){children[name]=element.children;});};var addCustomElements=function addCustomElements(customElements){var customElementRegExp=/^(~)?(.+)$/;if(customElements){mapCache.text_block_elements=mapCache.block_elements=null;each$3(split(customElements,','),function(rule){var matches=customElementRegExp.exec(rule),inline=matches[1]==='~',cloneName=inline?'span':'div',name=matches[2];children[name]=children[cloneName];customElementsMap[name]=cloneName;if(!inline){blockElementsMap[name.toUpperCase()]={};blockElementsMap[name]={};}if(!elements[name]){var customRule=elements[cloneName];customRule=extend$1({},customRule);delete customRule.removeEmptyAttrs;delete customRule.removeEmpty;elements[name]=customRule;}each$3(children,function(element,elmName){if(element[cloneName]){children[elmName]=element=extend$1({},children[elmName]);element[name]=element[cloneName];}});});}};var addValidChildren=function addValidChildren(validChildren){var childRuleRegExp=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;mapCache[settings.schema]=null;if(validChildren){each$3(split(validChildren,','),function(rule){var matches=childRuleRegExp.exec(rule);var parent,prefix;if(matches){prefix=matches[1];if(prefix){parent=children[matches[2]];}else{parent=children[matches[2]]={'#comment':{}};}parent=children[matches[2]];each$3(split(matches[3],'|'),function(child){if(prefix==='-'){delete parent[child];}else{parent[child]={};}});}});}};var getElementRule=function getElementRule(name){var element=elements[name],i;if(element){return element;}i=patternElements.length;while(i--){element=patternElements[i];if(element.pattern.test(name)){return element;}}};if(!settings.valid_elements){each$3(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder};children[name]=element.children;});if(settings.schema!=='html5'){each$3(split('strong/b em/i'),function(item){var items=split(item,'/');elements[items[1]].outputName=items[0];});}each$3(split('ol ul sub sup blockquote span font a table tbody tr strong em b i'),function(name){if(elements[name]){elements[name].removeEmpty=true;}});each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'),function(name){elements[name].paddEmpty=true;});each$3(split('span'),function(name){elements[name].removeEmptyAttrs=true;});}else{setValidElements(settings.valid_elements);}addCustomElements(settings.custom_elements);addValidChildren(settings.valid_children);addValidElements(settings.extended_valid_elements);addValidChildren('+ol[ul|ol],+ul[ul|ol]');each$3({dd:'dl',dt:'dl',li:'ul ol',td:'tr',th:'tr',tr:'tbody thead tfoot',tbody:'table',thead:'table',tfoot:'table',legend:'fieldset',area:'map',param:'video audio object'},function(parents,item){if(elements[item]){elements[item].parentsRequired=split(parents);}});if(settings.invalid_elements){each$3(explode$1(settings.invalid_elements),function(item){if(elements[item]){delete elements[item];}});}if(!getElementRule('span')){addValidElements('span[!data-mce-type|*]');}var getValidStyles=function getValidStyles(){return validStyles;};var getInvalidStyles=function getInvalidStyles(){return invalidStyles;};var getValidClasses=function getValidClasses(){return validClasses;};var getBoolAttrs=function getBoolAttrs(){return boolAttrMap;};var getBlockElements=function getBlockElements(){return blockElementsMap;};var getTextBlockElements=function getTextBlockElements(){return textBlockElementsMap;};var getTextInlineElements=function getTextInlineElements(){return textInlineElementsMap;};var getShortEndedElements=function getShortEndedElements(){return shortEndedElementsMap;};var getSelfClosingElements=function getSelfClosingElements(){return selfClosingElementsMap;};var getNonEmptyElements=function getNonEmptyElements(){return nonEmptyElementsMap;};var getMoveCaretBeforeOnEnterElements=function getMoveCaretBeforeOnEnterElements(){return moveCaretBeforeOnEnterElementsMap;};var getWhiteSpaceElements=function getWhiteSpaceElements(){return whiteSpaceElementsMap;};var getSpecialElements=function getSpecialElements(){return specialElements;};var isValidChild=function isValidChild(name,child){var parent=children[name.toLowerCase()];return!!(parent&&parent[child.toLowerCase()]);};var isValid=function isValid(name,attr){var attrPatterns,i;var rule=getElementRule(name);if(rule){if(attr){if(rule.attributes[attr]){return true;}attrPatterns=rule.attributePatterns;if(attrPatterns){i=attrPatterns.length;while(i--){if(attrPatterns[i].pattern.test(name)){return true;}}}}else{return true;}}return false;};var getCustomElements=function getCustomElements(){return customElementsMap;};return{children:children,elements:elements,getValidStyles:getValidStyles,getValidClasses:getValidClasses,getBlockElements:getBlockElements,getInvalidStyles:getInvalidStyles,getShortEndedElements:getShortEndedElements,getTextBlockElements:getTextBlockElements,getTextInlineElements:getTextInlineElements,getBoolAttrs:getBoolAttrs,getElementRule:getElementRule,getSelfClosingElements:getSelfClosingElements,getNonEmptyElements:getNonEmptyElements,getMoveCaretBeforeOnEnterElements:getMoveCaretBeforeOnEnterElements,getWhiteSpaceElements:getWhiteSpaceElements,getSpecialElements:getSpecialElements,isValidChild:isValidChild,isValid:isValid,getCustomElements:getCustomElements,addValidElements:addValidElements,setValidElements:setValidElements,addCustomElements:addCustomElements,addValidChildren:addValidChildren};}var _toHex=function toHex(match,r,g,b){var hex=function hex(val){val=parseInt(val,10).toString(16);return val.length>1?val:'0'+val;};return'#'+hex(r)+hex(g)+hex(b);};var Styles=function Styles(settings,schema){var rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi;var urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi;var styleRegExp=/\s*([^:]+):\s*([^;]+);?/g;var trimRightRegExp=/\s+$/;var i;var encodingLookup={};var validStyles;var invalidStyles;var invisibleChar=zeroWidth;settings=settings||{};if(schema){validStyles=schema.getValidStyles();invalidStyles=schema.getInvalidStyles();}var encodingItems=('\\" \\\' \\; \\: ; : '+invisibleChar).split(' ');for(i=0;i<encodingItems.length;i++){encodingLookup[encodingItems[i]]=invisibleChar+i;encodingLookup[invisibleChar+i]=encodingItems[i];}return{toHex:function toHex(color){return color.replace(rgbRegExp,_toHex);},parse:function parse(css){var styles={};var matches,name,value,isEncoded;var urlConverter=settings.url_converter;var urlConverterScope=settings.url_converter_scope||this;var compress=function compress(prefix,suffix,noJoin){var top=styles[prefix+'-top'+suffix];if(!top){return;}var right=styles[prefix+'-right'+suffix];if(!right){return;}var bottom=styles[prefix+'-bottom'+suffix];if(!bottom){return;}var left=styles[prefix+'-left'+suffix];if(!left){return;}var box=[top,right,bottom,left];i=box.length-1;while(i--){if(box[i]!==box[i+1]){break;}}if(i>-1&&noJoin){return;}styles[prefix+suffix]=i===-1?box[0]:box.join(' ');delete styles[prefix+'-top'+suffix];delete styles[prefix+'-right'+suffix];delete styles[prefix+'-bottom'+suffix];delete styles[prefix+'-left'+suffix];};var canCompress=function canCompress(key){var value=styles[key],i;if(!value){return;}value=value.split(' ');i=value.length;while(i--){if(value[i]!==value[0]){return false;}}styles[key]=value[0];return true;};var compress2=function compress2(target,a,b,c){if(!canCompress(a)){return;}if(!canCompress(b)){return;}if(!canCompress(c)){return;}styles[target]=styles[a]+' '+styles[b]+' '+styles[c];delete styles[a];delete styles[b];delete styles[c];};var encode=function encode(str){isEncoded=true;return encodingLookup[str];};var decode=function decode(str,keepSlashes){if(isEncoded){str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str];});}if(!keepSlashes){str=str.replace(/\\([\'\";:])/g,'$1');}return str;};var decodeSingleHexSequence=function decodeSingleHexSequence(escSeq){return String.fromCharCode(parseInt(escSeq.slice(1),16));};var decodeHexSequences=function decodeHexSequences(value){return value.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence);};var processUrl=function processUrl(match,url,url2,url3,str,str2){str=str||str2;if(str){str=decode(str);return'\''+str.replace(/\'/g,'\\\'')+'\'';}url=decode(url||url2||url3);if(!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/g,'');if(/(java|vb)script:/i.test(scriptUrl)){return'';}if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl)){return'';}}if(urlConverter){url=urlConverter.call(urlConverterScope,url,'style');}return'url(\''+url.replace(/\'/g,'\\\'')+'\')';};if(css){css=css.replace(/[\u0000-\u001F]/g,'');css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode);});while(matches=styleRegExp.exec(css)){styleRegExp.lastIndex=matches.index+matches[0].length;name=matches[1].replace(trimRightRegExp,'').toLowerCase();value=matches[2].replace(trimRightRegExp,'');if(name&&value){name=decodeHexSequences(name);value=decodeHexSequences(value);if(name.indexOf(invisibleChar)!==-1||name.indexOf('"')!==-1){continue;}if(!settings.allow_script_urls&&(name==='behavior'||/expression\s*\(|\/\*|\*\//.test(value))){continue;}if(name==='font-weight'&&value==='700'){value='bold';}else if(name==='color'||name==='background-color'){value=value.toLowerCase();}value=value.replace(rgbRegExp,_toHex);value=value.replace(urlOrStrRegExp,processUrl);styles[name]=isEncoded?decode(value,true):value;}}compress('border','',true);compress('border','-width');compress('border','-color');compress('border','-style');compress('padding','');compress('margin','');compress2('border','border-width','border-style','border-color');if(styles.border==='medium none'){delete styles.border;}if(styles['border-image']==='none'){delete styles['border-image'];}}return styles;},serialize:function serialize(styles,elementName){var css='';var serializeStyles=function serializeStyles(name){var value;var styleList=validStyles[name];if(styleList){for(var i_1=0,l=styleList.length;i_1<l;i_1++){name=styleList[i_1];value=styles[name];if(value){css+=(css.length>0?' ':'')+name+': '+value+';';}}}};var isValid=function isValid(name,elementName){var styleMap=invalidStyles['*'];if(styleMap&&styleMap[name]){return false;}styleMap=invalidStyles[elementName];return!(styleMap&&styleMap[name]);};if(elementName&&validStyles){serializeStyles('*');serializeStyles(elementName);}else{each$1(styles,function(value,name){if(value&&(!invalidStyles||isValid(name,elementName))){css+=(css.length>0?' ':'')+name+': '+value+';';}});}return css;}};};var eventExpandoPrefix='mce-data-';var mouseEventRe=/^(?:mouse|contextmenu)|click/;var deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1};var hasIsDefaultPrevented=function hasIsDefaultPrevented(event){return event.isDefaultPrevented===returnTrue||event.isDefaultPrevented===returnFalse;};var returnFalse=function returnFalse(){return false;};var returnTrue=function returnTrue(){return true;};var addEvent=function addEvent(target,name,callback,capture){if(target.addEventListener){target.addEventListener(name,callback,capture||false);}else if(target.attachEvent){target.attachEvent('on'+name,callback);}};var removeEvent=function removeEvent(target,name,callback,capture){if(target.removeEventListener){target.removeEventListener(name,callback,capture||false);}else if(target.detachEvent){target.detachEvent('on'+name,callback);}};var isMouseEvent=function isMouseEvent(event){return mouseEventRe.test(event.type);};var fix=function fix(originalEvent,data){var name;var event=data||{};for(name in originalEvent){if(!deprecated[name]){event[name]=originalEvent[name];}}if(!event.target){event.target=event.srcElement||document;}if(event.composedPath){event.composedPath=function(){return originalEvent.composedPath();};}if(originalEvent&&isMouseEvent(originalEvent)&&originalEvent.pageX===undefined&&originalEvent.clientX!==undefined){var eventDoc=event.target.ownerDocument||document;var doc=eventDoc.documentElement;var body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}event.preventDefault=function(){event.isDefaultPrevented=returnTrue;if(originalEvent){if(originalEvent.preventDefault){originalEvent.preventDefault();}else{originalEvent.returnValue=false;}}};event.stopPropagation=function(){event.isPropagationStopped=returnTrue;if(originalEvent){if(originalEvent.stopPropagation){originalEvent.stopPropagation();}else{originalEvent.cancelBubble=true;}}};event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue;event.stopPropagation();};if(hasIsDefaultPrevented(event)===false){event.isDefaultPrevented=returnFalse;event.isPropagationStopped=returnFalse;event.isImmediatePropagationStopped=returnFalse;}if(typeof event.metaKey==='undefined'){event.metaKey=false;}return event;};var bindOnReady=function bindOnReady(win,callback,eventUtils){var doc=win.document,event={type:'ready'};if(eventUtils.domLoaded){callback(event);return;}var isDocReady=function isDocReady(){return doc.readyState==='complete'||doc.readyState==='interactive'&&doc.body;};var readyHandler=function readyHandler(){removeEvent(win,'DOMContentLoaded',readyHandler);removeEvent(win,'load',readyHandler);if(!eventUtils.domLoaded){eventUtils.domLoaded=true;callback(event);}};if(isDocReady()){readyHandler();}else{addEvent(win,'DOMContentLoaded',readyHandler);}addEvent(win,'load',readyHandler);};var EventUtils=function(){function EventUtils(){this.domLoaded=false;this.events={};this.count=1;this.expando=eventExpandoPrefix+(+new Date()).toString(32);this.hasMouseEnterLeave='onmouseenter'in document.documentElement;this.hasFocusIn='onfocusin'in document.documentElement;this.count=1;}EventUtils.prototype.bind=function(target,names,callback,scope){var self=this;var id,callbackList,i,name,fakeName,nativeHandler,capture;var win=window;var defaultNativeHandler=function defaultNativeHandler(evt){self.executeHandlers(fix(evt||win.event),id);};if(!target||target.nodeType===3||target.nodeType===8){return;}if(!target[self.expando]){id=self.count++;target[self.expando]=id;self.events[id]={};}else{id=target[self.expando];}scope=scope||target;var namesList=names.split(' ');i=namesList.length;while(i--){name=namesList[i];nativeHandler=defaultNativeHandler;fakeName=capture=false;if(name==='DOMContentLoaded'){name='ready';}if(self.domLoaded&&name==='ready'&&target.readyState==='complete'){callback.call(scope,fix({type:name}));continue;}if(!self.hasMouseEnterLeave){fakeName=self.mouseEnterLeave[name];if(fakeName){nativeHandler=function nativeHandler(evt){var current=evt.currentTarget;var related=evt.relatedTarget;if(related&&current.contains){related=current.contains(related);}else{while(related&&related!==current){related=related.parentNode;}}if(!related){evt=fix(evt||win.event);evt.type=evt.type==='mouseout'?'mouseleave':'mouseenter';evt.target=current;self.executeHandlers(evt,id);}};}}if(!self.hasFocusIn&&(name==='focusin'||name==='focusout')){capture=true;fakeName=name==='focusin'?'focus':'blur';nativeHandler=function nativeHandler(evt){evt=fix(evt||win.event);evt.type=evt.type==='focus'?'focusin':'focusout';self.executeHandlers(evt,id);};}callbackList=self.events[id][name];if(!callbackList){self.events[id][name]=callbackList=[{func:callback,scope:scope}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(name==='ready'){bindOnReady(target,nativeHandler,self);}else{addEvent(target,fakeName||name,nativeHandler,capture);}}else{if(name==='ready'&&self.domLoaded){callback(fix({type:name}));}else{callbackList.push({func:callback,scope:scope});}}}target=callbackList=null;return callback;};EventUtils.prototype.unbind=function(target,names,callback){var callbackList,i,ci,name,eventMap;if(!target||target.nodeType===3||target.nodeType===8){return this;}var id=target[this.expando];if(id){eventMap=this.events[id];if(names){var namesList=names.split(' ');i=namesList.length;while(i--){name=namesList[i];callbackList=eventMap[name];if(callbackList){if(callback){ci=callbackList.length;while(ci--){if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler;var fakeName=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1));callbackList.nativeHandler=nativeHandler;callbackList.fakeName=fakeName;callbackList.capture=capture;eventMap[name]=callbackList;}}}if(!callback||callbackList.length===0){delete eventMap[name];removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);}}}}else{each$1(eventMap,function(callbackList,name){removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);});eventMap={};}for(name in eventMap){if(has(eventMap,name)){return this;}}delete this.events[id];try{delete target[this.expando];}catch(ex){target[this.expando]=null;}}return this;};EventUtils.prototype.fire=function(target,name,args){var id;if(!target||target.nodeType===3||target.nodeType===8){return this;}var event=fix(null,args);event.type=name;event.target=target;do{id=target[this.expando];if(id){this.executeHandlers(event,id);}target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow;}while(target&&!event.isPropagationStopped());return this;};EventUtils.prototype.clean=function(target){var i,children;if(!target||target.nodeType===3||target.nodeType===8){return this;}if(target[this.expando]){this.unbind(target);}if(!target.getElementsByTagName){target=target.document;}if(target&&target.getElementsByTagName){this.unbind(target);children=target.getElementsByTagName('*');i=children.length;while(i--){target=children[i];if(target[this.expando]){this.unbind(target);}}}return this;};EventUtils.prototype.destroy=function(){this.events={};};EventUtils.prototype.cancel=function(e){if(e){e.preventDefault();e.stopImmediatePropagation();}return false;};EventUtils.prototype.executeHandlers=function(evt,id){var container=this.events[id];var callbackList=container&&container[evt.type];if(callbackList){for(var i=0,l=callbackList.length;i<l;i++){var callback=callbackList[i];if(callback&&callback.func.call(callback.scope,evt)===false){evt.preventDefault();}if(evt.isImmediatePropagationStopped()){return;}}}};EventUtils.Event=new EventUtils();return EventUtils;}();var support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document$1,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains$3,expando='sizzle'+-new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function sortOrder(a,b){if(a===b){hasDuplicate=true;}return 0;},strundefined=typeof undefined==="undefined"?"undefined":_typeof(undefined),MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf$2=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i;}}return-1;},booleans='checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',whitespace='[\\x20\\t\\r\\n\\f]',identifier='(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+',attributes='\\['+whitespace+'*('+identifier+')(?:'+whitespace+'*([*^$|!~]?=)'+whitespace+'*(?:\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)"|('+identifier+'))|)'+whitespace+'*\\]',pseudos=':('+identifier+')(?:\\(('+'(\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)")|'+'((?:\\\\.|[^\\\\()[\\]]|'+attributes+')*)|'+'.*'+')\\)|)',rtrim=new RegExp('^'+whitespace+'+|((?:^|[^\\\\])(?:\\\\.)*)'+whitespace+'+$','g'),rcomma=new RegExp('^'+whitespace+'*,'+whitespace+'*'),rcombinators=new RegExp('^'+whitespace+'*([>+~]|'+whitespace+')'+whitespace+'*'),rattributeQuotes=new RegExp('='+whitespace+'*([^\\]\'"]*?)'+whitespace+'*\\]','g'),rpseudo=new RegExp(pseudos),ridentifier=new RegExp('^'+identifier+'$'),matchExpr={ID:new RegExp('^#('+identifier+')'),CLASS:new RegExp('^\\.('+identifier+')'),TAG:new RegExp('^('+identifier+'|[*])'),ATTR:new RegExp('^'+attributes),PSEUDO:new RegExp('^'+pseudos),CHILD:new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\('+whitespace+'*(even|odd|(([+-]|)(\\d*)n|)'+whitespace+'*(?:([+-]|)'+whitespace+'*(\\d+)|))'+whitespace+'*\\)|)','i'),bool:new RegExp('^(?:'+booleans+')$','i'),needsContext:new RegExp('^'+whitespace+'*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\('+whitespace+'*((?:-\\d)?\\d*)'+whitespace+'*\\)|)(?=[^-]|$)','i')},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp('\\\\([\\da-f]{1,6}'+whitespace+'?|('+whitespace+')|.)','ig'),funescape=function funescape(_,escaped,escapedWhitespace){var high='0x'+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320);};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1;}};}var Sizzle=function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document$1){setDocument(context);}context=context||document$1;results=results||[];if(!selector||typeof selector!=='string'){return results;}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[];}if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains$3(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=='object'){groups=tokenize(selector);if(old=context.getAttribute('id')){nid=old.replace(rescape,'\\$&');}else{context.setAttribute('id',nid);}nid='[id=\''+nid+'\'] ';i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(',');}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute('id');}}}}}return select(selector.replace(rtrim,'$1'),context,results,seed);};function createCache(){var keys=[];function cache(key,value){if(keys.push(key+' ')>Expr.cacheLength){delete cache[keys.shift()];}return cache[key+' ']=value;}return cache;}function markFunction(fn){fn[expando]=true;return fn;}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1;}}}return a?1:-1;}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==='input'&&elem.type===type;};}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==='input'||name==='button')&&elem.type===type;};}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j]);}}});});}function testContext(context){return context&&_typeof(context.getElementsByTagName)!==strundefined&&context;}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=='HTML':false;};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;function getTop(win){try{return win.top;}catch(ex){}return null;}if(doc===document$1||doc.nodeType!==9||!doc.documentElement){return document$1;}document$1=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==getTop(parent)){if(parent.addEventListener){parent.addEventListener('unload',function(){setDocument();},false);}else if(parent.attachEvent){parent.attachEvent('onunload',function(){setDocument();});}}support.attributes=true;support.getElementsByTagName=true;support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=true;Expr.find.ID=function(id,context){if(_typeof(context.getElementById)!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute('id')===attrId;};};Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(_typeof(context.getElementsByTagName)!==strundefined){return context.getElementsByTagName(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==='*'){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem);}}return tmp;}return results;};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];support.disconnectedMatch=true;rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join('|'));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join('|'));hasCompare=rnative.test(docElem.compareDocumentPosition);contains$3=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true;}}}return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains$3(preferredDoc,a)){return-1;}if(b===doc||b.ownerDocument===preferredDoc&&contains$3(preferredDoc,b)){return 1;}return sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0;}return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0;}else if(aup===bup){return siblingCheck(a,b);}cur=a;while(cur=cur.parentNode){ap.unshift(cur);}cur=b;while(cur=cur.parentNode){bp.unshift(cur);}while(ap[i]===bp[i]){i++;}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document$1){setDocument(elem);}expr=expr.replace(rattributeQuotes,'=\'$1\']');if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}return Sizzle(expr,document$1,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document$1){setDocument(context);}return contains$3(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document$1){setDocument(elem);}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.error=function(msg){throw new Error('Syntax error, unrecognized expression: '+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i);}}while(j--){results.splice(duplicates[j],1);}}sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret='',i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==='string'){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{'>':{dir:'parentNode',first:true},' ':{dir:'parentNode'},'+':{dir:'previousSibling',first:true},'~':{dir:'previousSibling'}},preFilter:{ATTR:function ATTR(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||'').replace(runescape,funescape);if(match[2]==='~='){match[3]=' '+match[3]+' ';}return match.slice(0,4);},CHILD:function CHILD(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==='nth'){if(!match[3]){Sizzle.error(match[0]);}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==='even'||match[3]==='odd'));match[5]=+(match[7]+match[8]||match[3]==='odd');}else if(match[3]){Sizzle.error(match[0]);}return match;},PSEUDO:function PSEUDO(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr.CHILD.test(match[0])){return null;}if(match[3]){match[2]=match[4]||match[5]||'';}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(')',unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}return match.slice(0,3);}},filter:{TAG:function TAG(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==='*'?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},CLASS:function CLASS(className){var pattern=classCache[className+' '];return pattern||(pattern=new RegExp('(^|'+whitespace+')'+className+'('+whitespace+'|$)'))&&classCache(className,function(elem){return pattern.test(typeof elem.className==='string'&&elem.className||_typeof(elem.getAttribute)!==strundefined&&elem.getAttribute('class')||'');});},ATTR:function ATTR(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==='!=';}if(!operator){return true;}result+='';return operator==='='?result===check:operator==='!='?result!==check:operator==='^='?check&&result.indexOf(check)===0:operator==='*='?check&&result.indexOf(check)>-1:operator==='$='?check&&result.slice(-check.length)===check:operator==='~='?(' '+result+' ').indexOf(check)>-1:operator==='|='?result===check||result.slice(0,check.length+1)===check+'-':false;};},CHILD:function CHILD(type,what,argument,first,last){var simple=type.slice(0,3)!=='nth',forward=type.slice(-4)!=='last',ofType=what==='of-type';return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?'nextSibling':'previousSibling',parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}start=dir=type==='only'&&!start&&'nextSibling';}return true;}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}if(node===elem){break;}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0;}};},PSEUDO:function PSEUDO(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error('unsupported pseudo: '+pseudo);if(fn[expando]){return fn(argument);}if(fn.length>1){args=[pseudo,pseudo,'',argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf$2.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}return fn;}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,'$1'));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop();};}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),lang:markFunction(function(lang){if(!ridentifier.test(lang||'')){Sizzle.error('unsupported lang: '+lang);}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute('xml:lang')||elem.getAttribute('lang')){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+'-')===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),target:function target(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},root:function root(elem){return elem===docElem;},focus:function focus(elem){return elem===document$1.activeElement&&(!document$1.hasFocus||document$1.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},enabled:function enabled(elem){return elem.disabled===false;},disabled:function disabled(elem){return elem.disabled===true;},checked:function checked(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==='input'&&!!elem.checked||nodeName==='option'&&!!elem.selected;},selected:function selected(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}return elem.selected===true;},empty:function empty(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}return true;},parent:function parent(elem){return!Expr.pseudos.empty(elem);},header:function header(elem){return rheader.test(elem.nodeName);},input:function input(elem){return rinputs.test(elem.nodeName);},button:function button(elem){var name=elem.nodeName.toLowerCase();return name==='input'&&elem.type==='button'||name==='button';},text:function text(elem){var attr;return elem.nodeName.toLowerCase()==='input'&&elem.type==='text'&&((attr=elem.getAttribute('type'))==null||attr.toLowerCase()==='text');},first:createPositionalPseudo(function(){return[0];}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1];}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}return matchIndexes;}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}return matchIndexes;})}};Expr.pseudos.nth=Expr.pseudos.eq;each(['radio','checkbox','file','password','image'],function(i){Expr.pseudos[i]=createInputPseudo(i);});each(['submit','reset'],function(i){Expr.pseudos[i]=createButtonPseudo(i);});function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+' '];if(cached){return parseOnly?0:cached.slice(0);}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}groups.push(tokens=[]);}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim,' ')});soFar=soFar.slice(matched.length);}for(type in Expr.filter){if(!Expr.filter.hasOwnProperty(type)){continue;}if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}if(!matched){break;}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector='';for(;i<len;i++){selector+=tokens[i].value;}return selector;}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==='parentNode',doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2];}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true;}}}}}};}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}return true;}:matchers[0];}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}return results;}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}return newUnmatched;}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||'*',context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem);}}postFinder(null,matcherOut=[],temp,xml);}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf$2.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[' '],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf$2.call(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===' '?'*':''})).replace(rtrim,'$1'),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens));}matchers.push(matcher);}}return elementMatcher(matchers);}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function superMatcher(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i='0',unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG('*',outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||0.1,len=elems.length;if(outermost){outermostContext=context!==document$1&&context;}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break;}}if(outermost){dirruns=dirrunsUnique;}}if(bySet){if(elem=!matcher&&elem){matchedCount--;}if(seed){unmatched.push(elem);}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml);}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}setMatched=condense(setMatched);}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results);}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+' '];if(!cached){if(!match){match=tokenize(selector);}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==='function'&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==='ID'&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}selector=selector.slice(tokens.shift().value.length);}i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break;}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}break;}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split('').sort(sortOrder).join('')===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=true;var doc=document,push$1=Array.prototype.push,slice$1=Array.prototype.slice;var rquickExpr$1=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;var Event=EventUtils.Event;var skipUniques=Tools.makeMap('children,contents,next,prev');var isDefined=function isDefined(obj){return typeof obj!=='undefined';};var isString$1=function isString$1(obj){return typeof obj==='string';};var isWindow=function isWindow(obj){return obj&&obj===obj.window;};var createFragment=function createFragment(html,fragDoc){fragDoc=fragDoc||doc;var container=fragDoc.createElement('div');var frag=fragDoc.createDocumentFragment();container.innerHTML=html;var node;while(node=container.firstChild){frag.appendChild(node);}return frag;};var domManipulate=function domManipulate(targetNodes,sourceItem,callback,reverse){var i;if(isString$1(sourceItem)){sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]));}else if(sourceItem.length&&!sourceItem.nodeType){sourceItem=DomQuery.makeArray(sourceItem);if(reverse){for(i=sourceItem.length-1;i>=0;i--){domManipulate(targetNodes,sourceItem[i],callback,reverse);}}else{for(i=0;i<sourceItem.length;i++){domManipulate(targetNodes,sourceItem[i],callback,reverse);}}return targetNodes;}if(sourceItem.nodeType){i=targetNodes.length;while(i--){callback.call(targetNodes[i],sourceItem);}}return targetNodes;};var _hasClass=function hasClass(node,className){return node&&className&&(' '+node.className+' ').indexOf(' '+className+' ')!==-1;};var wrap$1=function wrap$1(elements,wrapper,all){var lastParent,newWrapper;wrapper=DomQuery(wrapper)[0];elements.each(function(){var self=this;if(!all||lastParent!==self.parentNode){lastParent=self.parentNode;newWrapper=wrapper.cloneNode(false);self.parentNode.insertBefore(newWrapper,self);newWrapper.appendChild(self);}else{newWrapper.appendChild(self);}});return elements;};var numericCssMap=Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom',' ');var booleanMap=Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected',' ');var propFix={"for":'htmlFor',"class":'className',readonly:'readOnly'};var cssFix={"float":'cssFloat'};var attrHooks={},cssHooks={};var DomQueryConstructor=function DomQueryConstructor(selector,context){return new DomQuery.fn.init(selector,context);};var inArray$1=function inArray$1(item,array){var i;if(array.indexOf){return array.indexOf(item);}i=array.length;while(i--){if(array[i]===item){return i;}}return-1;};var whiteSpaceRegExp$2=/^\s*|\s*$/g;var trim$3=function trim$3(str){return str===null||str===undefined?'':(''+str).replace(whiteSpaceRegExp$2,'');};var each$4=function each$4(obj,callback){var length,key,i,value;if(obj){length=obj.length;if(length===undefined){for(key in obj){if(obj.hasOwnProperty(key)){value=obj[key];if(callback.call(value,key,value)===false){break;}}}}else{for(i=0;i<length;i++){value=obj[i];if(callback.call(value,i,value)===false){break;}}}}return obj;};var grep=function grep(array,callback){var out=[];each$4(array,function(i,item){if(callback(item,i)){out.push(item);}});return out;};var getElementDocument=function getElementDocument(element){if(!element){return doc;}if(element.nodeType===9){return element;}return element.ownerDocument;};DomQueryConstructor.fn=DomQueryConstructor.prototype={constructor:DomQueryConstructor,selector:'',context:null,length:0,init:function init(selector,context){var self=this;var match,node;if(!selector){return self;}if(selector.nodeType){self.context=self[0]=selector;self.length=1;return self;}if(context&&context.nodeType){self.context=context;}else{if(context){return DomQuery(selector).attr(context);}self.context=context=document;}if(isString$1(selector)){self.selector=selector;if(selector.charAt(0)==='<'&&selector.charAt(selector.length-1)==='>'&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr$1.exec(selector);}if(match){if(match[1]){node=createFragment(selector,getElementDocument(context)).firstChild;while(node){push$1.call(self,node);node=node.nextSibling;}}else{node=getElementDocument(context).getElementById(match[2]);if(!node){return self;}if(node.id!==match[2]){return self.find(selector);}self.length=1;self[0]=node;}}else{return DomQuery(context).find(selector);}}else{this.add(selector,false);}return self;},toArray:function toArray(){return Tools.toArray(this);},add:function add(items,sort){var self=this;var nodes,i;if(isString$1(items)){return self.add(DomQuery(items));}if(sort!==false){nodes=DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));self.length=nodes.length;for(i=0;i<nodes.length;i++){self[i]=nodes[i];}}else{push$1.apply(self,DomQuery.makeArray(items));}return self;},attr:function attr(name,value){var self=this;var hook;if(_typeof(name)==='object'){each$4(name,function(name,value){self.attr(name,value);});}else if(isDefined(value)){this.each(function(){var hook;if(this.nodeType===1){hook=attrHooks[name];if(hook&&hook.set){hook.set(this,value);return;}if(value===null){this.removeAttribute(name,2);}else{this.setAttribute(name,value,2);}}});}else{if(self[0]&&self[0].nodeType===1){hook=attrHooks[name];if(hook&&hook.get){return hook.get(self[0],name);}if(booleanMap[name]){return self.prop(name)?name:undefined;}value=self[0].getAttribute(name,2);if(value===null){value=undefined;}}return value;}return self;},removeAttr:function removeAttr(name){return this.attr(name,null);},prop:function prop(name,value){var self=this;name=propFix[name]||name;if(_typeof(name)==='object'){each$4(name,function(name,value){self.prop(name,value);});}else if(isDefined(value)){this.each(function(){if(this.nodeType===1){this[name]=value;}});}else{if(self[0]&&self[0].nodeType&&name in self[0]){return self[0][name];}return value;}return self;},css:function css(name,value){var self=this;var elm,hook;var camel=function camel(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase();});};var dashed=function dashed(name){return name.replace(/[A-Z]/g,function(a){return'-'+a;});};if(_typeof(name)==='object'){each$4(name,function(name,value){self.css(name,value);});}else{if(isDefined(value)){name=camel(name);if(typeof value==='number'&&!numericCssMap[name]){value=value.toString()+'px';}self.each(function(){var style=this.style;hook=cssHooks[name];if(hook&&hook.set){hook.set(this,value);return;}try{this.style[cssFix[name]||name]=value;}catch(ex){}if(value===null||value===''){if(style.removeProperty){style.removeProperty(dashed(name));}else{style.removeAttribute(name);}}});}else{elm=self[0];hook=cssHooks[name];if(hook&&hook.get){return hook.get(elm);}if(elm.ownerDocument.defaultView){try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name));}catch(ex){return undefined;}}else if(elm.currentStyle){return elm.currentStyle[camel(name)];}else{return'';}}}return self;},remove:function remove(){var self=this;var node,i=this.length;while(i--){node=self[i];Event.clean(node);if(node.parentNode){node.parentNode.removeChild(node);}}return this;},empty:function empty(){var self=this;var node,i=this.length;while(i--){node=self[i];while(node.firstChild){node.removeChild(node.firstChild);}}return this;},html:function html(value){var self=this;var i;if(isDefined(value)){i=self.length;try{while(i--){self[i].innerHTML=value;}}catch(ex){DomQuery(self[i]).empty().append(value);}return self;}return self[0]?self[0].innerHTML:'';},text:function text(value){var self=this;var i;if(isDefined(value)){i=self.length;while(i--){if('innerText'in self[i]){self[i].innerText=value;}else{self[0].textContent=value;}}return self;}return self[0]?self[0].innerText||self[0].textContent:'';},append:function append(){return domManipulate(this,arguments,function(node){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.appendChild(node);}});},prepend:function prepend(){return domManipulate(this,arguments,function(node){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.insertBefore(node,this.firstChild);}},true);},before:function before(){var self=this;if(self[0]&&self[0].parentNode){return domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this);});}return self;},after:function after(){var self=this;if(self[0]&&self[0].parentNode){return domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling);},true);}return self;},appendTo:function appendTo(val){DomQuery(val).append(this);return this;},prependTo:function prependTo(val){DomQuery(val).prepend(this);return this;},replaceWith:function replaceWith(content){return this.before(content).remove();},wrap:function wrap(content){return wrap$1(this,content);},wrapAll:function wrapAll(content){return wrap$1(this,content,true);},wrapInner:function wrapInner(content){this.each(function(){DomQuery(this).contents().wrapAll(content);});return this;},unwrap:function unwrap(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes);});},clone:function clone(){var result=[];this.each(function(){result.push(this.cloneNode(true));});return DomQuery(result);},addClass:function addClass(className){return this.toggleClass(className,true);},removeClass:function removeClass(className){return this.toggleClass(className,false);},toggleClass:function toggleClass(className,state){var self=this;if(typeof className!=='string'){return self;}if(className.indexOf(' ')!==-1){each$4(className.split(' '),function(){self.toggleClass(this,state);});}else{self.each(function(index,node){var classState=_hasClass(node,className);if(classState!==state){var existingClassName=node.className;if(classState){node.className=trim$3((' '+existingClassName+' ').replace(' '+className+' ',' '));}else{node.className+=existingClassName?' '+className:className;}}});}return self;},hasClass:function hasClass(className){return _hasClass(this[0],className);},each:function each(callback){return each$4(this,callback);},on:function on(name,callback){return this.each(function(){Event.bind(this,name,callback);});},off:function off(name,callback){return this.each(function(){Event.unbind(this,name,callback);});},trigger:function trigger(name){return this.each(function(){if(_typeof(name)==='object'){Event.fire(this,name.type,name);}else{Event.fire(this,name);}});},show:function show(){return this.css('display','');},hide:function hide(){return this.css('display','none');},slice:function slice(){return new DomQuery(slice$1.apply(this,arguments));},eq:function eq(index){return index===-1?this.slice(index):this.slice(index,+index+1);},first:function first(){return this.eq(0);},last:function last(){return this.eq(-1);},find:function find(selector){var i,l;var ret=[];for(i=0,l=this.length;i<l;i++){DomQuery.find(selector,this[i],ret);}return DomQuery(ret);},filter:function filter(selector){if(typeof selector==='function'){return DomQuery(grep(this.toArray(),function(item,i){return selector(i,item);}));}return DomQuery(DomQuery.filter(selector,this.toArray()));},closest:function closest(selector){var result=[];if(selector instanceof DomQuery){selector=selector[0];}this.each(function(i,node){while(node){if(typeof selector==='string'&&DomQuery(node).is(selector)){result.push(node);break;}else if(node===selector){result.push(node);break;}node=node.parentNode;}});return DomQuery(result);},offset:function offset(_offset){var elm,doc,docElm;var x=0,y=0,pos;if(!_offset){elm=this[0];if(elm){doc=elm.ownerDocument;docElm=doc.documentElement;if(elm.getBoundingClientRect){pos=elm.getBoundingClientRect();x=pos.left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft;y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop;}}return{left:x,top:y};}return this.css(_offset);},push:push$1,sort:Array.prototype.sort,splice:Array.prototype.splice};Tools.extend(DomQueryConstructor,{extend:Tools.extend,makeArray:function makeArray(object){if(isWindow(object)||object.nodeType){return[object];}return Tools.toArray(object);},inArray:inArray$1,isArray:Tools.isArray,each:each$4,trim:trim$3,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function filter(expr,elems,not){var i=elems.length;if(not){expr=':not('+expr+')';}while(i--){if(elems[i].nodeType!==1){elems.splice(i,1);}}if(elems.length===1){elems=DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[];}else{elems=DomQuery.find.matches(expr,elems);}return elems;}});var dir=function dir(el,prop,until){var matched=[];var cur=el[prop];if(typeof until!=='string'&&until instanceof DomQuery){until=until[0];}while(cur&&cur.nodeType!==9){if(until!==undefined){if(cur===until){break;}if(typeof until==='string'&&DomQuery(cur).is(until)){break;}}if(cur.nodeType===1){matched.push(cur);}cur=cur[prop];}return matched;};var sibling=function sibling(node,siblingName,nodeType,until){var result=[];if(until instanceof DomQuery){until=until[0];}for(;node;node=node[siblingName]){if(nodeType&&node.nodeType!==nodeType){continue;}if(until!==undefined){if(node===until){break;}if(typeof until==='string'&&DomQuery(node).is(until)){break;}}result.push(node);}return result;};var firstSibling=function firstSibling(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName]){if(node.nodeType===nodeType){return node;}}return null;};each$4({parent:function parent(node){var parent=node.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function parents(node){return dir(node,'parentNode');},next:function next(node){return firstSibling(node,'nextSibling',1);},prev:function prev(node){return firstSibling(node,'previousSibling',1);},children:function children(node){return sibling(node.firstChild,'nextSibling',1);},contents:function contents(node){return Tools.toArray((node.nodeName==='iframe'?node.contentDocument||node.contentWindow.document:node).childNodes);}},function(name,fn){DomQueryConstructor.fn[name]=function(selector){var self=this;var result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);if(nodes){if(DomQuery.isArray(nodes)){result.push.apply(result,nodes);}else{result.push(nodes);}}});if(this.length>1){if(!skipUniques[name]){result=DomQuery.unique(result);}if(name.indexOf('parents')===0){result=result.reverse();}}var wrappedResult=DomQuery(result);if(selector){return wrappedResult.filter(selector);}return wrappedResult;};});each$4({parentsUntil:function parentsUntil(node,until){return dir(node,'parentNode',until);},nextUntil:function nextUntil(node,until){return sibling(node,'nextSibling',1,until).slice(1);},prevUntil:function prevUntil(node,until){return sibling(node,'previousSibling',1,until).slice(1);}},function(name,fn){DomQueryConstructor.fn[name]=function(selector,filter){var self=this;var result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);if(nodes){if(DomQuery.isArray(nodes)){result.push.apply(result,nodes);}else{result.push(nodes);}}});if(this.length>1){result=DomQuery.unique(result);if(name.indexOf('parents')===0||name==='prevUntil'){result=result.reverse();}}var wrappedResult=DomQuery(result);if(filter){return wrappedResult.filter(filter);}return wrappedResult;};});DomQueryConstructor.fn.is=function(selector){return!!selector&&this.filter(selector).length>0;};DomQueryConstructor.fn.init.prototype=DomQueryConstructor.fn;DomQueryConstructor.overrideDefaults=function(callback){var defaults;var sub=function sub(selector,context){defaults=defaults||callback();if(arguments.length===0){selector=defaults.element;}if(!context){context=defaults.context;}return new sub.fn.init(selector,context);};DomQuery.extend(sub,this);return sub;};DomQueryConstructor.attrHooks=attrHooks;DomQueryConstructor.cssHooks=cssHooks;var DomQuery=DomQueryConstructor;var each$5=Tools.each;var grep$1=Tools.grep;var isIE=Env.ie;var simpleSelectorRe=/^([a-z0-9],?)+$/i;var setupAttrHooks=function setupAttrHooks(styles,settings,getContext){var keepValues=settings.keep_values;var keepUrlHook={set:function set($elm,value,name){if(settings.url_converter){value=settings.url_converter.call(settings.url_converter_scope||getContext(),value,name,$elm[0]);}$elm.attr('data-mce-'+name,value).attr(name,value);},get:function get($elm,name){return $elm.attr('data-mce-'+name)||$elm.attr(name);}};var attrHooks={style:{set:function set($elm,value){if(value!==null&&_typeof(value)==='object'){$elm.css(value);return;}if(keepValues){$elm.attr('data-mce-style',value);}if(value!==null&&typeof value==='string'){$elm.removeAttr('style');$elm.css(styles.parse(value));}else{$elm.attr('style',value);}},get:function get($elm){var value=$elm.attr('data-mce-style')||$elm.attr('style');value=styles.serialize(styles.parse(value),$elm[0].nodeName);return value;}}};if(keepValues){attrHooks.href=attrHooks.src=keepUrlHook;}return attrHooks;};var updateInternalStyleAttr=function updateInternalStyleAttr(styles,$elm){var rawValue=$elm.attr('style');var value=styles.serialize(styles.parse(rawValue),$elm[0].nodeName);if(!value){value=null;}$elm.attr('data-mce-style',value);};var findNodeIndex=function findNodeIndex(node,normalized){var idx=0,lastNodeType,nodeType;if(node){for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling){nodeType=node.nodeType;if(normalized&&nodeType===3){if(nodeType===lastNodeType||!node.nodeValue.length){continue;}}idx++;lastNodeType=nodeType;}}return idx;};function DOMUtils(doc,settings){var _this=this;if(settings===void 0){settings={};}var addedStyles={};var win=window;var files={};var counter=0;var stdMode=true;var boxModel=true;var styleSheetLoader=instance.forElement(SugarElement.fromDom(doc),{contentCssCors:settings.contentCssCors,referrerPolicy:settings.referrerPolicy});var boundEvents=[];var schema=settings.schema?settings.schema:Schema({});var styles=Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema);var events=settings.ownEvents?new EventUtils():EventUtils.Event;var blockElementsMap=schema.getBlockElements();var $=DomQuery.overrideDefaults(function(){return{context:doc,element:self.getRoot()};});var isBlock=function isBlock(node){if(typeof node==='string'){return!!blockElementsMap[node];}else if(node){var type=node.nodeType;if(type){return!!(type===1&&blockElementsMap[node.nodeName]);}}return false;};var get=function get(elm){return elm&&doc&&isString(elm)?doc.getElementById(elm):elm;};var $$=function $$(elm){return $(typeof elm==='string'?get(elm):elm);};var getAttrib=function getAttrib(elm,name,defaultVal){var hook,value;var $elm=$$(elm);if($elm.length){hook=attrHooks[name];if(hook&&hook.get){value=hook.get($elm,name);}else{value=$elm.attr(name);}}if(typeof value==='undefined'){value=defaultVal||'';}return value;};var getAttribs=function getAttribs(elm){var node=get(elm);if(!node){return[];}return node.attributes;};var setAttrib=function setAttrib(elm,name,value){if(value===''){value=null;}var $elm=$$(elm);var originalValue=$elm.attr(name);if(!$elm.length){return;}var hook=attrHooks[name];if(hook&&hook.set){hook.set($elm,value,name);}else{$elm.attr(name,value);}if(originalValue!==value&&settings.onSetAttrib){settings.onSetAttrib({attrElm:$elm,attrName:name,attrValue:value});}};var clone=function clone(node,deep){if(!isIE||node.nodeType!==1||deep){return node.cloneNode(deep);}else{var clone_1=doc.createElement(node.nodeName);each$5(getAttribs(node),function(attr){setAttrib(clone_1,attr.nodeName,getAttrib(node,attr.nodeName));});return clone_1;}};var getRoot=function getRoot(){return settings.root_element||doc.body;};var getViewPort=function getViewPort(argWin){var vp=getBounds(argWin);return{x:vp.x,y:vp.y,w:vp.width,h:vp.height};};var getPos$1=function getPos$1(elm,rootElm){return getPos(doc.body,get(elm),rootElm);};var setStyle=function setStyle(elm,name,value){var $elm=isString(name)?$$(elm).css(name,value):$$(elm).css(name);if(settings.update_styles){updateInternalStyleAttr(styles,$elm);}};var setStyles=function setStyles(elm,stylesArg){var $elm=$$(elm).css(stylesArg);if(settings.update_styles){updateInternalStyleAttr(styles,$elm);}};var getStyle=function getStyle(elm,name,computed){var $elm=$$(elm);if(computed){return $elm.css(name);}name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase();});if(name==='float'){name=Env.browser.isIE()?'styleFloat':'cssFloat';}return $elm[0]&&$elm[0].style?$elm[0].style[name]:undefined;};var getSize=function getSize(elm){var w,h;elm=get(elm);w=getStyle(elm,'width');h=getStyle(elm,'height');if(w.indexOf('px')===-1){w=0;}if(h.indexOf('px')===-1){h=0;}return{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight};};var getRect=function getRect(elm){elm=get(elm);var pos=getPos$1(elm);var size=getSize(elm);return{x:pos.x,y:pos.y,w:size.w,h:size.h};};var is=function is(elm,selector){var i;if(!elm){return false;}if(!Array.isArray(elm)){if(selector==='*'){return elm.nodeType===1;}if(simpleSelectorRe.test(selector)){var selectors=selector.toLowerCase().split(/,/);var elmName=elm.nodeName.toLowerCase();for(i=selectors.length-1;i>=0;i--){if(selectors[i]===elmName){return true;}}return false;}if(elm.nodeType&&elm.nodeType!==1){return false;}}var elms=!Array.isArray(elm)?[elm]:elm;return Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length>0;};var getParents=function getParents(elm,selector,root,collect){var result=[];var selectorVal;var node=get(elm);collect=collect===undefined;root=root||(getRoot().nodeName!=='BODY'?getRoot().parentNode:null);if(Tools.is(selector,'string')){selectorVal=selector;if(selector==='*'){selector=function selector(node){return node.nodeType===1;};}else{selector=function selector(node){return is(node,selectorVal);};}}while(node){if(node===root||!node.nodeType||node.nodeType===9){break;}if(!selector||typeof selector==='function'&&selector(node)){if(collect){result.push(node);}else{return[node];}}node=node.parentNode;}return collect?result:null;};var getParent=function getParent(node,selector,root){var parents=getParents(node,selector,root,false);return parents&&parents.length>0?parents[0]:null;};var _findSib=function _findSib(node,selector,name){var func=selector;if(node){if(typeof selector==='string'){func=function func(node){return is(node,selector);};}for(node=node[name];node;node=node[name]){if(typeof func==='function'&&func(node)){return node;}}}return null;};var getNext=function getNext(node,selector){return _findSib(node,selector,'nextSibling');};var getPrev=function getPrev(node,selector){return _findSib(node,selector,'previousSibling');};var select=function select(selector,scope){return Sizzle(selector,get(scope)||settings.root_element||doc,[]);};var run=function run(elm,func,scope){var result;var node=typeof elm==='string'?get(elm):elm;if(!node){return false;}if(Tools.isArray(node)&&(node.length||node.length===0)){result=[];each$5(node,function(elm,i){if(elm){result.push(func.call(scope,typeof elm==='string'?get(elm):elm,i));}});return result;}var context=scope?scope:_this;return func.call(context,node);};var setAttribs=function setAttribs(elm,attrs){$$(elm).each(function(i,node){each$5(attrs,function(value,name){setAttrib(node,name,value);});});};var setHTML=function setHTML(elm,html){var $elm=$$(elm);if(isIE){$elm.each(function(i,target){if(target.canHaveHTML===false){return;}while(target.firstChild){target.removeChild(target.firstChild);}try{target.innerHTML='<br>'+html;target.removeChild(target.firstChild);}catch(ex){DomQuery('<div></div>').html('<br>'+html).contents().slice(1).appendTo(target);}return html;});}else{$elm.html(html);}};var add=function add(parentElm,name,attrs,html,create){return run(parentElm,function(parentElm){var newElm=typeof name==='string'?doc.createElement(name):name;setAttribs(newElm,attrs);if(html){if(typeof html!=='string'&&html.nodeType){newElm.appendChild(html);}else if(typeof html==='string'){setHTML(newElm,html);}}return!create?parentElm.appendChild(newElm):newElm;});};var create=function create(name,attrs,html){return add(doc.createElement(name),name,attrs,html,true);};var decode=Entities.decode;var encode=Entities.encodeAllRaw;var createHTML=function createHTML(name,attrs,html){var outHtml='',key;outHtml+='<'+name;for(key in attrs){if(attrs.hasOwnProperty(key)&&attrs[key]!==null&&typeof attrs[key]!=='undefined'){outHtml+=' '+key+'="'+encode(attrs[key])+'"';}}if(typeof html!=='undefined'){return outHtml+'>'+html+'</'+name+'>';}return outHtml+' />';};var createFragment=function createFragment(html){var node;var container=doc.createElement('div');var frag=doc.createDocumentFragment();frag.appendChild(container);if(html){container.innerHTML=html;}while(node=container.firstChild){frag.appendChild(node);}frag.removeChild(container);return frag;};var remove=function remove(node,keepChildren){var $node=$$(node);if(keepChildren){$node.each(function(){var child;while(child=this.firstChild){if(child.nodeType===3&&child.data.length===0){this.removeChild(child);}else{this.parentNode.insertBefore(child,this);}}}).remove();}else{$node.remove();}return $node.length>1?$node.toArray():$node[0];};var removeAllAttribs=function removeAllAttribs(e){return run(e,function(e){var i;var attrs=e.attributes;for(i=attrs.length-1;i>=0;i--){e.removeAttributeNode(attrs.item(i));}});};var parseStyle=function parseStyle(cssText){return styles.parse(cssText);};var serializeStyle=function serializeStyle(stylesArg,name){return styles.serialize(stylesArg,name);};var addStyle=function addStyle(cssText){var head,styleElm;if(self!==DOMUtils.DOM&&doc===document){if(addedStyles[cssText]){return;}addedStyles[cssText]=true;}styleElm=doc.getElementById('mceDefaultStyles');if(!styleElm){styleElm=doc.createElement('style');styleElm.id='mceDefaultStyles';styleElm.type='text/css';head=doc.getElementsByTagName('head')[0];if(head.firstChild){head.insertBefore(styleElm,head.firstChild);}else{head.appendChild(styleElm);}}if(styleElm.styleSheet){styleElm.styleSheet.cssText+=cssText;}else{styleElm.appendChild(doc.createTextNode(cssText));}};var loadCSS=function loadCSS(urls){if(!urls){urls='';}each(urls.split(','),function(url){files[url]=true;styleSheetLoader.load(url,noop);});};var toggleClass=function toggleClass(elm,cls,state){$$(elm).toggleClass(cls,state).each(function(){if(this.className===''){DomQuery(this).attr('class',null);}});};var addClass=function addClass(elm,cls){$$(elm).addClass(cls);};var removeClass=function removeClass(elm,cls){toggleClass(elm,cls,false);};var hasClass=function hasClass(elm,cls){return $$(elm).hasClass(cls);};var show=function show(elm){$$(elm).show();};var hide=function hide(elm){$$(elm).hide();};var isHidden=function isHidden(elm){return $$(elm).css('display')==='none';};var uniqueId=function uniqueId(prefix){return(!prefix?'mce_':prefix)+counter++;};var getOuterHTML=function getOuterHTML(elm){var node=typeof elm==='string'?get(elm):elm;return isElement$1(node)?node.outerHTML:DomQuery('<div></div>').append(DomQuery(node).clone()).html();};var setOuterHTML=function setOuterHTML(elm,html){$$(elm).each(function(){try{if('outerHTML'in this){this.outerHTML=html;return;}}catch(ex){}remove(DomQuery(this).html(html),true);});};var insertAfter=function insertAfter(node,reference){var referenceNode=get(reference);return run(node,function(node){var parent=referenceNode.parentNode;var nextSibling=referenceNode.nextSibling;if(nextSibling){parent.insertBefore(node,nextSibling);}else{parent.appendChild(node);}return node;});};var replace=function replace(newElm,oldElm,keepChildren){return run(oldElm,function(oldElm){if(Tools.is(oldElm,'array')){newElm=newElm.cloneNode(true);}if(keepChildren){each$5(grep$1(oldElm.childNodes),function(node){newElm.appendChild(node);});}return oldElm.parentNode.replaceChild(newElm,oldElm);});};var rename=function rename(elm,name){var newElm;if(elm.nodeName!==name.toUpperCase()){newElm=create(name);each$5(getAttribs(elm),function(attrNode){setAttrib(newElm,attrNode.nodeName,getAttrib(elm,attrNode.nodeName));});replace(newElm,elm,true);}return newElm||elm;};var findCommonAncestor=function findCommonAncestor(a,b){var ps=a,pe;while(ps){pe=b;while(pe&&ps!==pe){pe=pe.parentNode;}if(ps===pe){break;}ps=ps.parentNode;}if(!ps&&a.ownerDocument){return a.ownerDocument.documentElement;}return ps;};var toHex=function toHex(rgbVal){return styles.toHex(Tools.trim(rgbVal));};var isNonEmptyElement=function isNonEmptyElement(node){if(isElement$1(node)){var isNamedAnchor=node.nodeName.toLowerCase()==='a'&&!getAttrib(node,'href')&&getAttrib(node,'id');if(getAttrib(node,'name')||getAttrib(node,'data-mce-bookmark')||isNamedAnchor){return true;}}return false;};var isEmpty=function isEmpty(node,elements){var type,name,brCount=0;if(isNonEmptyElement(node)){return false;}node=node.firstChild;if(node){var walker=new DomTreeWalker(node,node.parentNode);var whitespace=schema?schema.getWhiteSpaceElements():{};elements=elements||(schema?schema.getNonEmptyElements():null);do{type=node.nodeType;if(isElement$1(node)){var bogusVal=node.getAttribute('data-mce-bogus');if(bogusVal){node=walker.next(bogusVal==='all');continue;}name=node.nodeName.toLowerCase();if(elements&&elements[name]){if(name==='br'){brCount++;node=walker.next();continue;}return false;}if(isNonEmptyElement(node)){return false;}}if(type===8){return false;}if(type===3&&!isWhitespaceText(node.nodeValue)){return false;}if(type===3&&node.parentNode&&whitespace[node.parentNode.nodeName]&&isWhitespaceText(node.nodeValue)){return false;}node=walker.next();}while(node);}return brCount<=1;};var createRng=function createRng(){return doc.createRange();};var split=function split(parentElm,splitElm,replacementElm){var range=createRng();var beforeFragment;var afterFragment;var parentNode;if(parentElm&&splitElm){range.setStart(parentElm.parentNode,findNodeIndex(parentElm));range.setEnd(splitElm.parentNode,findNodeIndex(splitElm));beforeFragment=range.extractContents();range=createRng();range.setStart(splitElm.parentNode,findNodeIndex(splitElm)+1);range.setEnd(parentElm.parentNode,findNodeIndex(parentElm)+1);afterFragment=range.extractContents();parentNode=parentElm.parentNode;parentNode.insertBefore(trimNode(self,beforeFragment),parentElm);if(replacementElm){parentNode.insertBefore(replacementElm,parentElm);}else{parentNode.insertBefore(splitElm,parentElm);}parentNode.insertBefore(trimNode(self,afterFragment),parentElm);remove(parentElm);return replacementElm||splitElm;}};var bind=function bind(target,name,func,scope){if(Tools.isArray(target)){var i=target.length;var rv=[];while(i--){rv[i]=bind(target[i],name,func,scope);}return rv;}if(settings.collect&&(target===doc||target===win)){boundEvents.push([target,name,func,scope]);}var output=events.bind(target,name,func,scope||self);return output;};var unbind=function unbind(target,name,func){if(Tools.isArray(target)){var i=target.length;var rv=[];while(i--){rv[i]=unbind(target[i],name,func);}return rv;}else{if(boundEvents.length>0&&(target===doc||target===win)){var i=boundEvents.length;while(i--){var item=boundEvents[i];if(target===item[0]&&(!name||name===item[1])&&(!func||func===item[2])){events.unbind(item[0],item[1],item[2]);}}}return events.unbind(target,name,func);}};var fire=function fire(target,name,evt){return events.fire(target,name,evt);};var getContentEditable=function getContentEditable(node){if(node&&isElement$1(node)){var contentEditable=node.getAttribute('data-mce-contenteditable');if(contentEditable&&contentEditable!=='inherit'){return contentEditable;}return node.contentEditable!=='inherit'?node.contentEditable:null;}else{return null;}};var getContentEditableParent=function getContentEditableParent(node){var root=getRoot();var state=null;for(;node&&node!==root;node=node.parentNode){state=getContentEditable(node);if(state!==null){break;}}return state;};var destroy=function destroy(){if(boundEvents.length>0){var i=boundEvents.length;while(i--){var item=boundEvents[i];events.unbind(item[0],item[1],item[2]);}}each$1(files,function(_,url){styleSheetLoader.unload(url);delete files[url];});if(Sizzle.setDocument){Sizzle.setDocument();}};var isChildOf=function isChildOf(node,parent){while(node){if(parent===node){return true;}node=node.parentNode;}return false;};var dumpRng=function dumpRng(r){return'startContainer: '+r.startContainer.nodeName+', startOffset: '+r.startOffset+', endContainer: '+r.endContainer.nodeName+', endOffset: '+r.endOffset;};var self={doc:doc,settings:settings,win:win,files:files,stdMode:stdMode,boxModel:boxModel,styleSheetLoader:styleSheetLoader,boundEvents:boundEvents,styles:styles,schema:schema,events:events,isBlock:isBlock,$:$,$$:$$,root:null,clone:clone,getRoot:getRoot,getViewPort:getViewPort,getRect:getRect,getSize:getSize,getParent:getParent,getParents:getParents,get:get,getNext:getNext,getPrev:getPrev,select:select,is:is,add:add,create:create,createHTML:createHTML,createFragment:createFragment,remove:remove,setStyle:setStyle,getStyle:getStyle,setStyles:setStyles,removeAllAttribs:removeAllAttribs,setAttrib:setAttrib,setAttribs:setAttribs,getAttrib:getAttrib,getPos:getPos$1,parseStyle:parseStyle,serializeStyle:serializeStyle,addStyle:addStyle,loadCSS:loadCSS,addClass:addClass,removeClass:removeClass,hasClass:hasClass,toggleClass:toggleClass,show:show,hide:hide,isHidden:isHidden,uniqueId:uniqueId,setHTML:setHTML,getOuterHTML:getOuterHTML,setOuterHTML:setOuterHTML,decode:decode,encode:encode,insertAfter:insertAfter,replace:replace,rename:rename,findCommonAncestor:findCommonAncestor,toHex:toHex,run:run,getAttribs:getAttribs,isEmpty:isEmpty,createRng:createRng,nodeIndex:findNodeIndex,split:split,bind:bind,unbind:unbind,fire:fire,getContentEditable:getContentEditable,getContentEditableParent:getContentEditableParent,destroy:destroy,isChildOf:isChildOf,dumpRng:dumpRng};var attrHooks=setupAttrHooks(styles,settings,function(){return self;});return self;}(function(DOMUtils){DOMUtils.DOM=DOMUtils(document);DOMUtils.nodeIndex=findNodeIndex;})(DOMUtils||(DOMUtils={}));var DOMUtils$1=DOMUtils;var DOM=DOMUtils$1.DOM;var each$6=Tools.each,grep$2=Tools.grep;var QUEUED=0;var LOADING=1;var LOADED=2;var FAILED=3;var ScriptLoader=function(){function ScriptLoader(settings){if(settings===void 0){settings={};}this.states={};this.queue=[];this.scriptLoadedCallbacks={};this.queueLoadedCallbacks=[];this.loading=0;this.settings=settings;}ScriptLoader.prototype._setReferrerPolicy=function(referrerPolicy){this.settings.referrerPolicy=referrerPolicy;};ScriptLoader.prototype.loadScript=function(url,success,failure){var dom=DOM;var elm;var done=function done(){dom.remove(id);if(elm){elm.onreadystatechange=elm.onload=elm=null;}success();};var error=function error(){if(isFunction(failure)){failure();}else{if(typeof console!=='undefined'&&console.log){console.log('Failed to load script: '+url);}}};var id=dom.uniqueId();elm=document.createElement('script');elm.id=id;elm.type='text/javascript';elm.src=Tools._addCacheSuffix(url);if(this.settings.referrerPolicy){dom.setAttrib(elm,'referrerpolicy',this.settings.referrerPolicy);}elm.onload=done;elm.onerror=error;(document.getElementsByTagName('head')[0]||document.body).appendChild(elm);};ScriptLoader.prototype.isDone=function(url){return this.states[url]===LOADED;};ScriptLoader.prototype.markDone=function(url){this.states[url]=LOADED;};ScriptLoader.prototype.add=function(url,success,scope,failure){var state=this.states[url];if(state===undefined){this.queue.push(url);this.states[url]=QUEUED;}if(success){if(!this.scriptLoadedCallbacks[url]){this.scriptLoadedCallbacks[url]=[];}this.scriptLoadedCallbacks[url].push({success:success,failure:failure,scope:scope||this});}};ScriptLoader.prototype.load=function(url,success,scope,failure){return this.add(url,success,scope,failure);};ScriptLoader.prototype.remove=function(url){delete this.states[url];delete this.scriptLoadedCallbacks[url];};ScriptLoader.prototype.loadQueue=function(success,scope,failure){this.loadScripts(this.queue,success,scope,failure);};ScriptLoader.prototype.loadScripts=function(scripts,success,scope,failure){var self=this;var failures=[];var execCallbacks=function execCallbacks(name,url){each$6(self.scriptLoadedCallbacks[url],function(callback){if(isFunction(callback[name])){callback[name].call(callback.scope);}});self.scriptLoadedCallbacks[url]=undefined;};self.queueLoadedCallbacks.push({success:success,failure:failure,scope:scope||this});var loadScripts=function loadScripts(){var loadingScripts=grep$2(scripts);scripts.length=0;each$6(loadingScripts,function(url){if(self.states[url]===LOADED){execCallbacks('success',url);return;}if(self.states[url]===FAILED){execCallbacks('failure',url);return;}if(self.states[url]!==LOADING){self.states[url]=LOADING;self.loading++;self.loadScript(url,function(){self.states[url]=LOADED;self.loading--;execCallbacks('success',url);loadScripts();},function(){self.states[url]=FAILED;self.loading--;failures.push(url);execCallbacks('failure',url);loadScripts();});}});if(!self.loading){var notifyCallbacks=self.queueLoadedCallbacks.slice(0);self.queueLoadedCallbacks.length=0;each$6(notifyCallbacks,function(callback){if(failures.length===0){if(isFunction(callback.success)){callback.success.call(callback.scope);}}else{if(isFunction(callback.failure)){callback.failure.call(callback.scope,failures);}}});}};loadScripts();};ScriptLoader.ScriptLoader=new ScriptLoader();return ScriptLoader;}();var Cell=function Cell(initial){var value=initial;var get=function get(){return value;};var set=function set(v){value=v;};return{get:get,set:set};};var isRaw=function isRaw(str){return isObject(str)&&has(str,'raw');};var isTokenised=function isTokenised(str){return isArray(str)&&str.length>1;};var data={};var currentCode=Cell('en');var getLanguageData=function getLanguageData(){return get(data,currentCode.get());};var getData=function getData(){return map$1(data,function(value){return _assign({},value);});};var setCode=function setCode(newCode){if(newCode){currentCode.set(newCode);}};var getCode=function getCode(){return currentCode.get();};var add=function add(code,items){var langData=data[code];if(!langData){data[code]=langData={};}each$1(items,function(translation,name){langData[name.toLowerCase()]=translation;});};var translate=function translate(text){var langData=getLanguageData().getOr({});var toString=function toString(obj){if(isFunction(obj)){return Object.prototype.toString.call(obj);}return!isEmpty(obj)?''+obj:'';};var isEmpty=function isEmpty(text){return text===''||text===null||text===undefined;};var getLangData=function getLangData(text){var textstr=toString(text);return get(langData,textstr.toLowerCase()).map(toString).getOr(textstr);};var removeContext=function removeContext(str){return str.replace(/{context:\w+}$/,'');};if(isEmpty(text)){return'';}if(isRaw(text)){return toString(text.raw);}if(isTokenised(text)){var values_1=text.slice(1);var substitued=getLangData(text[0]).replace(/\{([0-9]+)\}/g,function($1,$2){return has(values_1,$2)?toString(values_1[$2]):$1;});return removeContext(substitued);}return removeContext(getLangData(text));};var isRtl=function isRtl(){return getLanguageData().bind(function(items){return get(items,'_dir');}).exists(function(dir){return dir==='rtl';});};var hasCode=function hasCode(code){return has(data,code);};var I18n={getData:getData,setCode:setCode,getCode:getCode,add:add,translate:translate,isRtl:isRtl,hasCode:hasCode};function AddOnManager(){var _this=this;var items=[];var urls={};var lookup={};var _listeners=[];var runListeners=function runListeners(name,state){var matchedListeners=filter(_listeners,function(listener){return listener.name===name&&listener.state===state;});each(matchedListeners,function(listener){return listener.callback();});};var get=function get(name){if(lookup[name]){return lookup[name].instance;}return undefined;};var dependencies=function dependencies(name){var result;if(lookup[name]){result=lookup[name].dependencies;}return result||[];};var requireLangPack=function requireLangPack(name,languages){if(AddOnManager.languageLoad!==false){waitFor(name,function(){var language=I18n.getCode();var wrappedLanguages=','+(languages||'')+',';if(!language||languages&&wrappedLanguages.indexOf(','+language+',')===-1){return;}ScriptLoader.ScriptLoader.add(urls[name]+'/langs/'+language+'.js');},'loaded');}};var add=function add(id,addOn,dependencies){var addOnConstructor=addOn;items.push(addOnConstructor);lookup[id]={instance:addOnConstructor,dependencies:dependencies};runListeners(id,'added');return addOnConstructor;};var remove=function remove(name){delete urls[name];delete lookup[name];};var createUrl=function createUrl(baseUrl,dep){if(_typeof(dep)==='object'){return dep;}return typeof baseUrl==='string'?{prefix:'',resource:dep,suffix:''}:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix};};var addComponents=function addComponents(pluginName,scripts){var pluginUrl=_this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+'/'+script);});};var loadDependencies=function loadDependencies(name,addOnUrl,success,scope){var deps=dependencies(name);each(deps,function(dep){var newUrl=createUrl(addOnUrl,dep);load(newUrl.resource,newUrl,undefined,undefined);});if(success){if(scope){success.call(scope);}else{success.call(ScriptLoader);}}};var load=function load(name,addOnUrl,success,scope,failure){if(urls[name]){return;}var urlString=typeof addOnUrl==='string'?addOnUrl:addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix;if(urlString.indexOf('/')!==0&&urlString.indexOf('://')===-1){urlString=AddOnManager.baseURL+'/'+urlString;}urls[name]=urlString.substring(0,urlString.lastIndexOf('/'));var done=function done(){runListeners(name,'loaded');loadDependencies(name,addOnUrl,success,scope);};if(lookup[name]){done();}else{ScriptLoader.ScriptLoader.add(urlString,done,scope,failure);}};var waitFor=function waitFor(name,callback,state){if(state===void 0){state='added';}if(has(lookup,name)&&state==='added'){callback();}else if(has(urls,name)&&state==='loaded'){callback();}else{_listeners.push({name:name,state:state,callback:callback});}};return{items:items,urls:urls,lookup:lookup,_listeners:_listeners,get:get,dependencies:dependencies,requireLangPack:requireLangPack,add:add,remove:remove,createUrl:createUrl,addComponents:addComponents,load:load,waitFor:waitFor};}(function(AddOnManager){AddOnManager.PluginManager=AddOnManager();AddOnManager.ThemeManager=AddOnManager();})(AddOnManager||(AddOnManager={}));var AddOnManager$1=AddOnManager;var first=function first(fn,rate){var timer=null;var cancel=function cancel(){if(timer!==null){clearTimeout(timer);timer=null;}};var throttle=function throttle(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(timer===null){timer=setTimeout(function(){fn.apply(null,args);timer=null;},rate);}};return{cancel:cancel,throttle:throttle};};var last$2=function last$2(fn,rate){var timer=null;var cancel=function cancel(){if(timer!==null){clearTimeout(timer);timer=null;}};var throttle=function throttle(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(timer!==null){clearTimeout(timer);}timer=setTimeout(function(){fn.apply(null,args);timer=null;},rate);};return{cancel:cancel,throttle:throttle};};var read=function read(element,attr){var value=get$3(element,attr);return value===undefined||value===''?[]:value.split(' ');};var add$1=function add$1(element,attr,id){var old=read(element,attr);var nu=old.concat([id]);set(element,attr,nu.join(' '));return true;};var remove$2=function remove$2(element,attr,id){var nu=filter(read(element,attr),function(v){return v!==id;});if(nu.length>0){set(element,attr,nu.join(' '));}else{remove$1(element,attr);}return false;};var supports=function supports(element){return element.dom.classList!==undefined;};var get$5=function get$5(element){return read(element,'class');};var add$2=function add$2(element,clazz){return add$1(element,'class',clazz);};var remove$3=function remove$3(element,clazz){return remove$2(element,'class',clazz);};var add$3=function add$3(element,clazz){if(supports(element)){element.dom.classList.add(clazz);}else{add$2(element,clazz);}};var cleanClass=function cleanClass(element){var classList=supports(element)?element.dom.classList:get$5(element);if(classList.length===0){remove$1(element,'class');}};var remove$4=function remove$4(element,clazz){if(supports(element)){var classList=element.dom.classList;classList.remove(clazz);}else{remove$3(element,clazz);}cleanClass(element);};var has$2=function has$2(element,clazz){return supports(element)&&element.dom.classList.contains(clazz);};var descendants=function descendants(scope,predicate){var result=[];each(children(scope),function(x){if(predicate(x)){result=result.concat([x]);}result=result.concat(descendants(x,predicate));});return result;};var descendants$1=function descendants$1(scope,selector){return all(selector,scope);};var annotation=constant('mce-annotation');var dataAnnotation=constant('data-mce-annotation');var dataAnnotationId=constant('data-mce-annotation-uid');var identify=function identify(editor,annotationName){var rng=editor.selection.getRng();var start=SugarElement.fromDom(rng.startContainer);var root=SugarElement.fromDom(editor.getBody());var selector=annotationName.fold(function(){return'.'+annotation();},function(an){return'['+dataAnnotation()+'="'+an+'"]';});var newStart=child(start,rng.startOffset).getOr(start);var closest=closest$1(newStart,selector,function(n){return eq$2(n,root);});var getAttr=function getAttr(c,property){if(has$1(c,property)){return Optional.some(get$3(c,property));}else{return Optional.none();}};return closest.bind(function(c){return getAttr(c,''+dataAnnotationId()).bind(function(uid){return getAttr(c,''+dataAnnotation()).map(function(name){var elements=findMarkers(editor,uid);return{uid:uid,name:name,elements:elements};});});});};var isAnnotation=function isAnnotation(elem){return isElement(elem)&&has$2(elem,annotation());};var findMarkers=function findMarkers(editor,uid){var body=SugarElement.fromDom(editor.getBody());return descendants$1(body,'['+dataAnnotationId()+'="'+uid+'"]');};var findAll=function findAll(editor,name){var body=SugarElement.fromDom(editor.getBody());var markers=descendants$1(body,'['+dataAnnotation()+'="'+name+'"]');var directory={};each(markers,function(m){var uid=get$3(m,dataAnnotationId());var nodesAlready=directory.hasOwnProperty(uid)?directory[uid]:[];directory[uid]=nodesAlready.concat([m]);});return directory;};var setup=function setup(editor,_registry){var changeCallbacks=Cell({});var initData=function initData(){return{listeners:[],previous:Cell(Optional.none())};};var withCallbacks=function withCallbacks(name,f){updateCallbacks(name,function(data){f(data);return data;});};var updateCallbacks=function updateCallbacks(name,f){var callbackMap=changeCallbacks.get();var data=callbackMap.hasOwnProperty(name)?callbackMap[name]:initData();var outputData=f(data);callbackMap[name]=outputData;changeCallbacks.set(callbackMap);};var fireCallbacks=function fireCallbacks(name,uid,elements){withCallbacks(name,function(data){each(data.listeners,function(f){return f(true,name,{uid:uid,nodes:map(elements,function(elem){return elem.dom;})});});});};var fireNoAnnotation=function fireNoAnnotation(name){withCallbacks(name,function(data){each(data.listeners,function(f){return f(false,name);});});};var onNodeChange=last$2(function(){var callbackMap=changeCallbacks.get();var annotations=sort$1(keys(callbackMap));each(annotations,function(name){updateCallbacks(name,function(data){var prev=data.previous.get();identify(editor,Optional.some(name)).fold(function(){if(prev.isSome()){fireNoAnnotation(name);data.previous.set(Optional.none());}},function(_a){var uid=_a.uid,name=_a.name,elements=_a.elements;if(!prev.is(uid)){fireCallbacks(name,uid,elements);data.previous.set(Optional.some(uid));}});return{previous:data.previous,listeners:data.listeners};});});},30);editor.on('remove',function(){onNodeChange.cancel();});editor.on('NodeChange',function(){onNodeChange.throttle();});var addListener=function addListener(name,f){updateCallbacks(name,function(data){return{previous:data.previous,listeners:data.listeners.concat([f])};});};return{addListener:addListener};};var setup$1=function setup$1(editor,registry){var identifyParserNode=function identifyParserNode(span){return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);};editor.on('init',function(){editor.serializer.addNodeFilter('span',function(spans){each(spans,function(span){identifyParserNode(span).each(function(settings){if(settings.persistent===false){span.unwrap();}});});});});};var create$2=function create$2(){var annotations={};var register=function register(name,settings){annotations[name]={name:name,settings:settings};};var lookup=function lookup(name){return annotations.hasOwnProperty(name)?Optional.from(annotations[name]).map(function(a){return a.settings;}):Optional.none();};return{register:register,lookup:lookup};};var unique=0;var generate$1=function generate$1(prefix){var date=new Date();var time=date.getTime();var random=Math.floor(Math.random()*1000000000);unique++;return prefix+'_'+random+unique+String(time);};var add$4=function add$4(element,classes){each(classes,function(x){add$3(element,x);});};var fromHtml$1=function fromHtml$1(html,scope){var doc=scope||document;var div=doc.createElement('div');div.innerHTML=html;return children(SugarElement.fromDom(div));};var get$6=function get$6(element){return element.dom.innerHTML;};var set$1=function set$1(element,content){var owner$1=owner(element);var docDom=owner$1.dom;var fragment=SugarElement.fromDom(docDom.createDocumentFragment());var contentElements=fromHtml$1(content,docDom);append$1(fragment,contentElements);empty(element);append(element,fragment);};var clone$1=function clone$1(original,isDeep){return SugarElement.fromDom(original.dom.cloneNode(isDeep));};var shallow=function shallow(original){return clone$1(original,false);};var deep=function deep(original){return clone$1(original,true);};var TextWalker=function TextWalker(startNode,rootNode,isBoundary){if(isBoundary===void 0){isBoundary=never;}var walker=new DomTreeWalker(startNode,rootNode);var walk=function walk(direction){var next;do{next=walker[direction]();}while(next&&!isText$1(next)&&!isBoundary(next));return Optional.from(next).filter(isText$1);};return{current:function current(){return Optional.from(walker.current()).filter(isText$1);},next:function next(){return walk('next');},prev:function prev(){return walk('prev');},prev2:function prev2(){return walk('prev2');}};};var TextSeeker=function TextSeeker(dom,isBoundary){var isBlockBoundary=isBoundary?isBoundary:function(node){return dom.isBlock(node)||isBr(node)||isContentEditableFalse(node);};var walk=function walk(node,offset,walker,process){if(isText$1(node)){var newOffset=process(node,offset,node.data);if(newOffset!==-1){return Optional.some({container:node,offset:newOffset});}}return walker().bind(function(next){return walk(next.container,next.offset,walker,process);});};var backwards=function backwards(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.prev().map(function(prev){return{container:prev,offset:prev.length};});},process).getOrNull();};var forwards=function forwards(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.next().map(function(next){return{container:next,offset:0};});},process).getOrNull();};return{backwards:backwards,forwards:forwards};};var cat=function cat(arr){var r=[];var push=function push(x){r.push(x);};for(var i=0;i<arr.length;i++){arr[i].each(push);}return r;};var lift2=function lift2(oa,ob,f){return oa.isSome()&&ob.isSome()?Optional.some(f(oa.getOrDie(),ob.getOrDie())):Optional.none();};var lift3=function lift3(oa,ob,oc,f){return oa.isSome()&&ob.isSome()&&oc.isSome()?Optional.some(f(oa.getOrDie(),ob.getOrDie(),oc.getOrDie())):Optional.none();};var someIf=function someIf(b,a){return b?Optional.some(a):Optional.none();};var round=Math.round;var clone$2=function clone$2(rect){if(!rect){return{left:0,top:0,bottom:0,right:0,width:0,height:0};}return{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)};};var collapse=function collapse(rect,toStart){rect=clone$2(rect);if(toStart){rect.right=rect.left;}else{rect.left=rect.left+rect.width;rect.right=rect.left;}rect.width=0;return rect;};var isEqual=function isEqual(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right;};var isValidOverflow=function isValidOverflow(overflowY,rect1,rect2){return overflowY>=0&&overflowY<=Math.min(rect1.height,rect2.height)/2;};var isAbove=function isAbove(rect1,rect2){var halfHeight=Math.min(rect2.height/2,rect1.height/2);if(rect1.bottom-halfHeight<rect2.top){return true;}if(rect1.top>rect2.bottom){return false;}return isValidOverflow(rect2.top-rect1.bottom,rect1,rect2);};var isBelow=function isBelow(rect1,rect2){if(rect1.top>rect2.bottom){return true;}if(rect1.bottom<rect2.top){return false;}return isValidOverflow(rect2.bottom-rect1.top,rect1,rect2);};var containsXY=function containsXY(rect,clientX,clientY){return clientX>=rect.left&&clientX<=rect.right&&clientY>=rect.top&&clientY<=rect.bottom;};var getSelectedNode=function getSelectedNode(range){var startContainer=range.startContainer,startOffset=range.startOffset;if(startContainer.hasChildNodes()&&range.endOffset===startOffset+1){return startContainer.childNodes[startOffset];}return null;};var getNode=function getNode(container,offset){if(container.nodeType===1&&container.hasChildNodes()){if(offset>=container.childNodes.length){offset=container.childNodes.length-1;}container=container.childNodes[offset];}return container;};var extendingChars=new RegExp("[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A"+"\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0"+"\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C"+"\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2-\u09E3"+"\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC"+"\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B57"+"\u0B62-\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56"+"\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0D01\u0D3E\u0D41-\u0D44"+"\u0D4D\u0D57\u0D62-\u0D63\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9"+"\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97"+"\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074"+"\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5"+"\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18"+"\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABE\u1B00-\u1B03\u1B34"+"\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9"+"\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9"+"\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u20D0-\u20DC\u20DD-\u20E0\u20E1\u20E2-\u20E4\u20E5-\u20F0\u2CEF-\u2CF1"+"\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u302E-\u302F\u3099-\u309A\uA66F\uA670-\uA672\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1"+"\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC"+"\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1"+"\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E-\uFF9F]");var isExtendingChar=function isExtendingChar(ch){return typeof ch==='string'&&ch.charCodeAt(0)>=768&&extendingChars.test(ch);};var or=function or(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}return function(x){for(var i=0;i<args.length;i++){if(args[i](x)){return true;}}return false;};};var and=function and(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}return function(x){for(var i=0;i<args.length;i++){if(!args[i](x)){return false;}}return true;};};var isElement$3=isElement$1;var isCaretCandidate$1=isCaretCandidate;var isBlock$1=matchStyleValues('display','block table');var isFloated=matchStyleValues('float','left right');var isValidElementCaretCandidate=and(isElement$3,isCaretCandidate$1,not(isFloated));var isNotPre=not(matchStyleValues('white-space','pre pre-line pre-wrap'));var isText$4=isText$1;var isBr$3=isBr;var nodeIndex=DOMUtils$1.nodeIndex;var resolveIndex=getNode;var createRange=function createRange(doc){return'createRange'in doc?doc.createRange():DOMUtils$1.DOM.createRng();};var isWhiteSpace=function isWhiteSpace(chr){return chr&&/[\r\n\t ]/.test(chr);};var isRange=function isRange(rng){return!!rng.setStart&&!!rng.setEnd;};var isHiddenWhiteSpaceRange=function isHiddenWhiteSpaceRange(range){var container=range.startContainer;var offset=range.startOffset;var text;if(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)&&isText$1(container)){text=container.data;if(isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])){return true;}}return false;};var getBrClientRect=function getBrClientRect(brNode){var doc=brNode.ownerDocument;var rng=createRange(doc);var nbsp$1=doc.createTextNode(nbsp);var parentNode=brNode.parentNode;parentNode.insertBefore(nbsp$1,brNode);rng.setStart(nbsp$1,0);rng.setEnd(nbsp$1,1);var clientRect=clone$2(rng.getBoundingClientRect());parentNode.removeChild(nbsp$1);return clientRect;};var getBoundingClientRectWebKitText=function getBoundingClientRectWebKitText(rng){var sc=rng.startContainer;var ec=rng.endContainer;var so=rng.startOffset;var eo=rng.endOffset;if(sc===ec&&isText$1(ec)&&so===0&&eo===1){var newRng=rng.cloneRange();newRng.setEndAfter(ec);return getBoundingClientRect(newRng);}else{return null;}};var isZeroRect=function isZeroRect(r){return r.left===0&&r.right===0&&r.top===0&&r.bottom===0;};var getBoundingClientRect=function getBoundingClientRect(item){var clientRect;var clientRects=item.getClientRects();if(clientRects.length>0){clientRect=clone$2(clientRects[0]);}else{clientRect=clone$2(item.getBoundingClientRect());}if(!isRange(item)&&isBr$3(item)&&isZeroRect(clientRect)){return getBrClientRect(item);}if(isZeroRect(clientRect)&&isRange(item)){return getBoundingClientRectWebKitText(item);}return clientRect;};var collapseAndInflateWidth=function collapseAndInflateWidth(clientRect,toStart){var newClientRect=collapse(clientRect,toStart);newClientRect.width=1;newClientRect.right=newClientRect.left+1;return newClientRect;};var getCaretPositionClientRects=function getCaretPositionClientRects(caretPosition){var clientRects=[];var beforeNode,node;var addUniqueAndValidRect=function addUniqueAndValidRect(clientRect){if(clientRect.height===0){return;}if(clientRects.length>0){if(isEqual(clientRect,clientRects[clientRects.length-1])){return;}}clientRects.push(clientRect);};var addCharacterOffset=function addCharacterOffset(container,offset){var range=createRange(container.ownerDocument);if(offset<container.data.length){if(isExtendingChar(container.data[offset])){return clientRects;}if(isExtendingChar(container.data[offset-1])){range.setStart(container,offset);range.setEnd(container,offset+1);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),false));return clientRects;}}}if(offset>0){range.setStart(container,offset-1);range.setEnd(container,offset);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),false));}}if(offset<container.data.length){range.setStart(container,offset);range.setEnd(container,offset+1);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),true));}}};if(isText$4(caretPosition.container())){addCharacterOffset(caretPosition.container(),caretPosition.offset());return clientRects;}if(isElement$3(caretPosition.container())){if(caretPosition.isAtEnd()){node=resolveIndex(caretPosition.container(),caretPosition.offset());if(isText$4(node)){addCharacterOffset(node,node.data.length);}if(isValidElementCaretCandidate(node)&&!isBr$3(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),false));}}else{node=resolveIndex(caretPosition.container(),caretPosition.offset());if(isText$4(node)){addCharacterOffset(node,0);}if(isValidElementCaretCandidate(node)&&caretPosition.isAtEnd()){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),false));return clientRects;}beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1);if(isValidElementCaretCandidate(beforeNode)&&!isBr$3(beforeNode)){if(isBlock$1(beforeNode)||isBlock$1(node)||!isValidElementCaretCandidate(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),false));}}if(isValidElementCaretCandidate(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),true));}}}return clientRects;};function CaretPosition(container,offset,clientRects){var isAtStart=function isAtStart(){if(isText$4(container)){return offset===0;}return offset===0;};var isAtEnd=function isAtEnd(){if(isText$4(container)){return offset>=container.data.length;}return offset>=container.childNodes.length;};var toRange=function toRange(){var range=createRange(container.ownerDocument);range.setStart(container,offset);range.setEnd(container,offset);return range;};var getClientRects=function getClientRects(){if(!clientRects){clientRects=getCaretPositionClientRects(CaretPosition(container,offset));}return clientRects;};var isVisible=function isVisible(){return getClientRects().length>0;};var isEqual=function isEqual(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset();};var getNode=function getNode(before){return resolveIndex(container,before?offset-1:offset);};return{container:constant(container),offset:constant(offset),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual,getNode:getNode};}(function(CaretPosition){CaretPosition.fromRangeStart=function(range){return CaretPosition(range.startContainer,range.startOffset);};CaretPosition.fromRangeEnd=function(range){return CaretPosition(range.endContainer,range.endOffset);};CaretPosition.after=function(node){return CaretPosition(node.parentNode,nodeIndex(node)+1);};CaretPosition.before=function(node){return CaretPosition(node.parentNode,nodeIndex(node));};CaretPosition.isAbove=function(pos1,pos2){return lift2(head(pos2.getClientRects()),last(pos1.getClientRects()),isAbove).getOr(false);};CaretPosition.isBelow=function(pos1,pos2){return lift2(last(pos2.getClientRects()),head(pos1.getClientRects()),isBelow).getOr(false);};CaretPosition.isAtStart=function(pos){return pos?pos.isAtStart():false;};CaretPosition.isAtEnd=function(pos){return pos?pos.isAtEnd():false;};CaretPosition.isTextPosition=function(pos){return pos?isText$1(pos.container()):false;};CaretPosition.isElementPosition=function(pos){return CaretPosition.isTextPosition(pos)===false;};})(CaretPosition||(CaretPosition={}));var CaretPosition$1=CaretPosition;var trimEmptyTextNode=function trimEmptyTextNode(dom,node){if(isText$1(node)&&node.data.length===0){dom.remove(node);}};var insertNode=function insertNode(dom,rng,node){rng.insertNode(node);trimEmptyTextNode(dom,node.previousSibling);trimEmptyTextNode(dom,node.nextSibling);};var insertFragment=function insertFragment(dom,rng,frag){var firstChild=Optional.from(frag.firstChild);var lastChild=Optional.from(frag.lastChild);rng.insertNode(frag);firstChild.each(function(child){return trimEmptyTextNode(dom,child.previousSibling);});lastChild.each(function(child){return trimEmptyTextNode(dom,child.nextSibling);});};var rangeInsertNode=function rangeInsertNode(dom,rng,node){if(isDocumentFragment$1(node)){insertFragment(dom,rng,node);}else{insertNode(dom,rng,node);}};var isText$5=isText$1;var isBogus$2=isBogus;var nodeIndex$1=DOMUtils$1.nodeIndex;var normalizedParent=function normalizedParent(node){var parentNode=node.parentNode;if(isBogus$2(parentNode)){return normalizedParent(parentNode);}return parentNode;};var getChildNodes=function getChildNodes(node){if(!node){return[];}return reduce(node.childNodes,function(result,node){if(isBogus$2(node)&&node.nodeName!=='BR'){result=result.concat(getChildNodes(node));}else{result.push(node);}return result;},[]);};var normalizedTextOffset=function normalizedTextOffset(node,offset){while(node=node.previousSibling){if(!isText$5(node)){break;}offset+=node.data.length;}return offset;};var equal$1=function equal$1(a){return function(b){return a===b;};};var normalizedNodeIndex=function normalizedNodeIndex(node){var nodes,index;nodes=getChildNodes(normalizedParent(node));index=findIndex$1(nodes,equal$1(node),node);nodes=nodes.slice(0,index+1);var numTextFragments=reduce(nodes,function(result,node,i){if(isText$5(node)&&isText$5(nodes[i-1])){result++;}return result;},0);nodes=filter$2(nodes,matchNodeNames([node.nodeName]));index=findIndex$1(nodes,equal$1(node),node);return index-numTextFragments;};var createPathItem=function createPathItem(node){var name;if(isText$5(node)){name='text()';}else{name=node.nodeName.toLowerCase();}return name+'['+normalizedNodeIndex(node)+']';};var parentsUntil=function parentsUntil(root,node,predicate){var parents=[];for(node=node.parentNode;node!==root;node=node.parentNode){if(predicate&&predicate(node)){break;}parents.push(node);}return parents;};var create$3=function create$3(root,caretPosition){var container,offset,path=[],outputOffset,childNodes,parents;container=caretPosition.container();offset=caretPosition.offset();if(isText$5(container)){outputOffset=normalizedTextOffset(container,offset);}else{childNodes=container.childNodes;if(offset>=childNodes.length){outputOffset='after';offset=childNodes.length-1;}else{outputOffset='before';}container=childNodes[offset];}path.push(createPathItem(container));parents=parentsUntil(root,container);parents=filter$2(parents,not(isBogus));path=path.concat(map$2(parents,function(node){return createPathItem(node);}));return path.reverse().join('/')+','+outputOffset;};var resolvePathItem=function resolvePathItem(node,name,index){var nodes=getChildNodes(node);nodes=filter$2(nodes,function(node,index){return!isText$5(node)||!isText$5(nodes[index-1]);});nodes=filter$2(nodes,matchNodeNames([name]));return nodes[index];};var findTextPosition=function findTextPosition(container,offset){var node=container,targetOffset=0,dataLen;while(isText$5(node)){dataLen=node.data.length;if(offset>=targetOffset&&offset<=targetOffset+dataLen){container=node;offset=offset-targetOffset;break;}if(!isText$5(node.nextSibling)){container=node;offset=dataLen;break;}targetOffset+=dataLen;node=node.nextSibling;}if(isText$5(container)&&offset>container.data.length){offset=container.data.length;}return CaretPosition$1(container,offset);};var resolve$1=function resolve$1(root,path){var offset;if(!path){return null;}var parts=path.split(',');var paths=parts[0].split('/');offset=parts.length>1?parts[1]:'before';var container=reduce(paths,function(result,value){var match=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value);if(!match){return null;}if(match[1]==='text()'){match[1]='#text';}return resolvePathItem(result,match[1],parseInt(match[2],10));},root);if(!container){return null;}if(!isText$5(container)){if(offset==='after'){offset=nodeIndex$1(container)+1;}else{offset=nodeIndex$1(container);}return CaretPosition$1(container.parentNode,offset);}return findTextPosition(container,parseInt(offset,10));};var isContentEditableFalse$2=isContentEditableFalse;var getNormalizedTextOffset=function getNormalizedTextOffset(trim,container,offset){var node,trimmedOffset;trimmedOffset=trim(container.data.slice(0,offset)).length;for(node=container.previousSibling;node&&isText$1(node);node=node.previousSibling){trimmedOffset+=trim(node.data).length;}return trimmedOffset;};var getPoint=function getPoint(dom,trim,normalized,rng,start){var container=rng[start?'startContainer':'endContainer'];var offset=rng[start?'startOffset':'endOffset'];var point=[];var childNodes,after=0;var root=dom.getRoot();if(isText$1(container)){point.push(normalized?getNormalizedTextOffset(trim,container,offset):offset);}else{childNodes=container.childNodes;if(offset>=childNodes.length&&childNodes.length){after=1;offset=Math.max(0,childNodes.length-1);}point.push(dom.nodeIndex(childNodes[offset],normalized)+after);}for(;container&&container!==root;container=container.parentNode){point.push(dom.nodeIndex(container,normalized));}return point;};var getLocation=function getLocation(trim,selection,normalized,rng){var dom=selection.dom,bookmark={};bookmark.start=getPoint(dom,trim,normalized,rng,true);if(!selection.isCollapsed()){bookmark.end=getPoint(dom,trim,normalized,rng,false);}return bookmark;};var findIndex$2=function findIndex$2(dom,name,element){var count=0;Tools.each(dom.select(name),function(node){if(node.getAttribute('data-mce-bogus')==='all'){return;}if(node===element){return false;}count++;});return count;};var moveEndPoint=function moveEndPoint(rng,start){var container,offset,childNodes;var prefix=start?'start':'end';container=rng[prefix+'Container'];offset=rng[prefix+'Offset'];if(isElement$1(container)&&container.nodeName==='TR'){childNodes=container.childNodes;container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)];if(container){offset=start?0:container.childNodes.length;rng['set'+(start?'Start':'End')](container,offset);}}};var normalizeTableCellSelection=function normalizeTableCellSelection(rng){moveEndPoint(rng,true);moveEndPoint(rng,false);return rng;};var findSibling=function findSibling(node,offset){var sibling;if(isElement$1(node)){node=getNode(node,offset);if(isContentEditableFalse$2(node)){return node;}}if(isCaretContainer(node)){if(isText$1(node)&&isCaretContainerBlock(node)){node=node.parentNode;}sibling=node.previousSibling;if(isContentEditableFalse$2(sibling)){return sibling;}sibling=node.nextSibling;if(isContentEditableFalse$2(sibling)){return sibling;}}};var findAdjacentContentEditableFalseElm=function findAdjacentContentEditableFalseElm(rng){return findSibling(rng.startContainer,rng.startOffset)||findSibling(rng.endContainer,rng.endOffset);};var getOffsetBookmark=function getOffsetBookmark(trim,normalized,selection){var element=selection.getNode();var name=element?element.nodeName:null;var rng=selection.getRng();if(isContentEditableFalse$2(element)||name==='IMG'){return{name:name,index:findIndex$2(selection.dom,name,element)};}var sibling=findAdjacentContentEditableFalseElm(rng);if(sibling){name=sibling.tagName;return{name:name,index:findIndex$2(selection.dom,name,sibling)};}return getLocation(trim,selection,normalized,rng);};var getCaretBookmark=function getCaretBookmark(selection){var rng=selection.getRng();return{start:create$3(selection.dom.getRoot(),CaretPosition$1.fromRangeStart(rng)),end:create$3(selection.dom.getRoot(),CaretPosition$1.fromRangeEnd(rng))};};var getRangeBookmark=function getRangeBookmark(selection){return{rng:selection.getRng()};};var createBookmarkSpan=function createBookmarkSpan(dom,id,filled){var args={'data-mce-type':'bookmark',id:id,'style':'overflow:hidden;line-height:0px'};return filled?dom.create('span',args,'&#xFEFF;'):dom.create('span',args);};var getPersistentBookmark=function getPersistentBookmark(selection,filled){var dom=selection.dom;var rng=selection.getRng();var id=dom.uniqueId();var collapsed=selection.isCollapsed();var element=selection.getNode();var name=element.nodeName;if(name==='IMG'){return{name:name,index:findIndex$2(dom,name,element)};}var rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(false);var endBookmarkNode=createBookmarkSpan(dom,id+'_end',filled);rangeInsertNode(dom,rng2,endBookmarkNode);}rng=normalizeTableCellSelection(rng);rng.collapse(true);var startBookmarkNode=createBookmarkSpan(dom,id+'_start',filled);rangeInsertNode(dom,rng,startBookmarkNode);selection.moveToBookmark({id:id,keep:true});return{id:id};};var getBookmark=function getBookmark(selection,type,normalized){if(type===2){return getOffsetBookmark(trim$2,normalized,selection);}else if(type===3){return getCaretBookmark(selection);}else if(type){return getRangeBookmark(selection);}else{return getPersistentBookmark(selection,false);}};var getUndoBookmark=curry(getOffsetBookmark,identity,true);var DOM$1=DOMUtils$1.DOM;var defaultPreviewStyles='font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';var getBodySetting=function getBodySetting(editor,name,defaultValue){var value=editor.getParam(name,defaultValue);if(value.indexOf('=')!==-1){var bodyObj=editor.getParam(name,'','hash');return bodyObj.hasOwnProperty(editor.id)?bodyObj[editor.id]:defaultValue;}else{return value;}};var getIframeAttrs=function getIframeAttrs(editor){return editor.getParam('iframe_attrs',{});};var getDocType=function getDocType(editor){return editor.getParam('doctype','<!DOCTYPE html>');};var getDocumentBaseUrl=function getDocumentBaseUrl(editor){return editor.getParam('document_base_url','');};var getBodyId=function getBodyId(editor){return getBodySetting(editor,'body_id','tinymce');};var getBodyClass=function getBodyClass(editor){return getBodySetting(editor,'body_class','');};var getContentSecurityPolicy=function getContentSecurityPolicy(editor){return editor.getParam('content_security_policy','');};var shouldPutBrInPre=function shouldPutBrInPre(editor){return editor.getParam('br_in_pre',true);};var getForcedRootBlock=function getForcedRootBlock(editor){if(editor.getParam('force_p_newlines',false)){return'p';}var block=editor.getParam('forced_root_block','p');if(block===false){return'';}else if(block===true){return'p';}else{return block;}};var getForcedRootBlockAttrs=function getForcedRootBlockAttrs(editor){return editor.getParam('forced_root_block_attrs',{});};var getBrNewLineSelector=function getBrNewLineSelector(editor){return editor.getParam('br_newline_selector','.mce-toc h2,figcaption,caption');};var getNoNewLineSelector=function getNoNewLineSelector(editor){return editor.getParam('no_newline_selector','');};var shouldKeepStyles=function shouldKeepStyles(editor){return editor.getParam('keep_styles',true);};var shouldEndContainerOnEmptyBlock=function shouldEndContainerOnEmptyBlock(editor){return editor.getParam('end_container_on_empty_block',false);};var getFontStyleValues=function getFontStyleValues(editor){return Tools.explode(editor.getParam('font_size_style_values','xx-small,x-small,small,medium,large,x-large,xx-large'));};var getFontSizeClasses=function getFontSizeClasses(editor){return Tools.explode(editor.getParam('font_size_classes',''));};var getImagesDataImgFilter=function getImagesDataImgFilter(editor){return editor.getParam('images_dataimg_filter',always,'function');};var isAutomaticUploadsEnabled=function isAutomaticUploadsEnabled(editor){return editor.getParam('automatic_uploads',true,'boolean');};var shouldReuseFileName=function shouldReuseFileName(editor){return editor.getParam('images_reuse_filename',false,'boolean');};var shouldReplaceBlobUris=function shouldReplaceBlobUris(editor){return editor.getParam('images_replace_blob_uris',true,'boolean');};var getIconPackName=function getIconPackName(editor){return editor.getParam('icons','','string');};var getIconsUrl=function getIconsUrl(editor){return editor.getParam('icons_url','','string');};var getImageUploadUrl=function getImageUploadUrl(editor){return editor.getParam('images_upload_url','','string');};var getImageUploadBasePath=function getImageUploadBasePath(editor){return editor.getParam('images_upload_base_path','','string');};var getImagesUploadCredentials=function getImagesUploadCredentials(editor){return editor.getParam('images_upload_credentials',false,'boolean');};var getImagesUploadHandler=function getImagesUploadHandler(editor){return editor.getParam('images_upload_handler',null,'function');};var shouldUseContentCssCors=function shouldUseContentCssCors(editor){return editor.getParam('content_css_cors',false,'boolean');};var getReferrerPolicy=function getReferrerPolicy(editor){return editor.getParam('referrer_policy','','string');};var getLanguageCode=function getLanguageCode(editor){return editor.getParam('language','en','string');};var getLanguageUrl=function getLanguageUrl(editor){return editor.getParam('language_url','','string');};var shouldIndentUseMargin=function shouldIndentUseMargin(editor){return editor.getParam('indent_use_margin',false);};var getIndentation=function getIndentation(editor){return editor.getParam('indentation','40px','string');};var getContentCss=function getContentCss(editor){var contentCss=editor.getParam('content_css');if(isString(contentCss)){return map(contentCss.split(','),trim);}else if(isArray(contentCss)){return contentCss;}else if(contentCss===false||editor.inline){return[];}else{return['default'];}};var getDirectionality=function getDirectionality(editor){return editor.getParam('directionality',I18n.isRtl()?'rtl':undefined);};var getInlineBoundarySelector=function getInlineBoundarySelector(editor){return editor.getParam('inline_boundaries_selector','a[href],code,.mce-annotation','string');};var getObjectResizing=function getObjectResizing(editor){var selector=editor.getParam('object_resizing');if(selector===false||Env.iOS){return false;}else{return isString(selector)?selector:'table,img,figure.image,div';}};var getResizeImgProportional=function getResizeImgProportional(editor){return editor.getParam('resize_img_proportional',true,'boolean');};var getPlaceholder=function getPlaceholder(editor){return editor.getParam('placeholder',DOM$1.getAttrib(editor.getElement(),'placeholder'),'string');};var getEventRoot=function getEventRoot(editor){return editor.getParam('event_root');};var getServiceMessage=function getServiceMessage(editor){return editor.getParam('service_message');};var getTheme=function getTheme(editor){return editor.getParam('theme');};var shouldValidate=function shouldValidate(editor){return editor.getParam('validate');};var isInlineBoundariesEnabled=function isInlineBoundariesEnabled(editor){return editor.getParam('inline_boundaries')!==false;};var getFormats=function getFormats(editor){return editor.getParam('formats');};var getPreviewStyles=function getPreviewStyles(editor){var style=editor.getParam('preview_styles',defaultPreviewStyles);if(isString(style)){return style;}else{return'';}};var getCustomUiSelector=function getCustomUiSelector(editor){return editor.getParam('custom_ui_selector','','string');};var getThemeUrl=function getThemeUrl(editor){return editor.getParam('theme_url');};var isInline$1=function isInline$1(editor){return editor.getParam('inline');};var hasHiddenInput=function hasHiddenInput(editor){return editor.getParam('hidden_input');};var shouldPatchSubmit=function shouldPatchSubmit(editor){return editor.getParam('submit_patch');};var isEncodingXml=function isEncodingXml(editor){return editor.getParam('encoding')==='xml';};var shouldAddFormSubmitTrigger=function shouldAddFormSubmitTrigger(editor){return editor.getParam('add_form_submit_trigger');};var shouldAddUnloadTrigger=function shouldAddUnloadTrigger(editor){return editor.getParam('add_unload_trigger');};var hasForcedRootBlock=function hasForcedRootBlock(editor){return getForcedRootBlock(editor)!=='';};var getCustomUndoRedoLevels=function getCustomUndoRedoLevels(editor){return editor.getParam('custom_undo_redo_levels',0,'number');};var shouldDisableNodeChange=function shouldDisableNodeChange(editor){return editor.getParam('disable_nodechange');};var isReadOnly=function isReadOnly(editor){return editor.getParam('readonly');};var hasContentCssCors=function hasContentCssCors(editor){return editor.getParam('content_css_cors');};var getPlugins=function getPlugins(editor){return editor.getParam('plugins','','string');};var getExternalPlugins=function getExternalPlugins(editor){return editor.getParam('external_plugins');};var shouldBlockUnsupportedDrop=function shouldBlockUnsupportedDrop(editor){return editor.getParam('block_unsupported_drop',true,'boolean');};var isElement$4=isElement$1;var isText$6=isText$1;var removeNode=function removeNode(node){var parentNode=node.parentNode;if(parentNode){parentNode.removeChild(node);}};var trimCount=function trimCount(text){var trimmedText=trim$2(text);return{count:text.length-trimmedText.length,text:trimmedText};};var deleteZwspChars=function deleteZwspChars(caretContainer){var idx;while((idx=caretContainer.data.lastIndexOf(ZWSP))!==-1){caretContainer.deleteData(idx,1);}};var removeUnchanged=function removeUnchanged(caretContainer,pos){remove$5(caretContainer);return pos;};var removeTextAndReposition=function removeTextAndReposition(caretContainer,pos){var before=trimCount(caretContainer.data.substr(0,pos.offset()));var after=trimCount(caretContainer.data.substr(pos.offset()));var text=before.text+after.text;if(text.length>0){deleteZwspChars(caretContainer);return CaretPosition$1(caretContainer,pos.offset()-before.count);}else{return pos;}};var removeElementAndReposition=function removeElementAndReposition(caretContainer,pos){var parentNode=pos.container();var newPosition=indexOf(from$1(parentNode.childNodes),caretContainer).map(function(index){return index<pos.offset()?CaretPosition$1(parentNode,pos.offset()-1):pos;}).getOr(pos);remove$5(caretContainer);return newPosition;};var removeTextCaretContainer=function removeTextCaretContainer(caretContainer,pos){return isText$6(caretContainer)&&pos.container()===caretContainer?removeTextAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos);};var removeElementCaretContainer=function removeElementCaretContainer(caretContainer,pos){return pos.container()===caretContainer.parentNode?removeElementAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos);};var removeAndReposition=function removeAndReposition(container,pos){return CaretPosition$1.isTextPosition(pos)?removeTextCaretContainer(container,pos):removeElementCaretContainer(container,pos);};var remove$5=function remove$5(caretContainerNode){if(isElement$4(caretContainerNode)&&isCaretContainer(caretContainerNode)){if(hasContent(caretContainerNode)){caretContainerNode.removeAttribute('data-mce-caret');}else{removeNode(caretContainerNode);}}if(isText$6(caretContainerNode)){deleteZwspChars(caretContainerNode);if(caretContainerNode.data.length===0){removeNode(caretContainerNode);}}};var browser$2=detect$3().browser;var isContentEditableFalse$3=isContentEditableFalse;var isMedia$1=isMedia;var isTableCell$2=isTableCell;var inlineFakeCaretSelector='*[contentEditable=false],video,audio,embed,object';var getAbsoluteClientRect=function getAbsoluteClientRect(root,element,before){var clientRect=collapse(element.getBoundingClientRect(),before);var docElm,scrollX,scrollY,margin,rootRect;if(root.tagName==='BODY'){docElm=root.ownerDocument.documentElement;scrollX=root.scrollLeft||docElm.scrollLeft;scrollY=root.scrollTop||docElm.scrollTop;}else{rootRect=root.getBoundingClientRect();scrollX=root.scrollLeft-rootRect.left;scrollY=root.scrollTop-rootRect.top;}clientRect.left+=scrollX;clientRect.right+=scrollX;clientRect.top+=scrollY;clientRect.bottom+=scrollY;clientRect.width=1;margin=element.offsetWidth-element.clientWidth;if(margin>0){if(before){margin*=-1;}clientRect.left+=margin;clientRect.right+=margin;}return clientRect;};var trimInlineCaretContainers=function trimInlineCaretContainers(root){var fakeCaretTargetNodes=descendants$1(SugarElement.fromDom(root),inlineFakeCaretSelector);for(var i=0;i<fakeCaretTargetNodes.length;i++){var node=fakeCaretTargetNodes[i].dom;var sibling=node.previousSibling;if(endsWithCaretContainer(sibling)){var data=sibling.data;if(data.length===1){sibling.parentNode.removeChild(sibling);}else{sibling.deleteData(data.length-1,1);}}sibling=node.nextSibling;if(startsWithCaretContainer(sibling)){var data=sibling.data;if(data.length===1){sibling.parentNode.removeChild(sibling);}else{sibling.deleteData(0,1);}}}};var FakeCaret=function FakeCaret(editor,root,isBlock,hasFocus){var lastVisualCaret=Cell(Optional.none());var cursorInterval,caretContainerNode;var rootBlock=getForcedRootBlock(editor);var caretBlock=rootBlock.length>0?rootBlock:'p';var show=function show(before,element){var clientRect,rng;hide();if(isTableCell$2(element)){return null;}if(isBlock(element)){caretContainerNode=insertBlock(caretBlock,element,before);clientRect=getAbsoluteClientRect(root,element,before);DomQuery(caretContainerNode).css('top',clientRect.top);var caret=DomQuery('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(root)[0];lastVisualCaret.set(Optional.some({caret:caret,element:element,before:before}));lastVisualCaret.get().each(function(caretState){if(before){DomQuery(caretState.caret).addClass('mce-visual-caret-before');}});startBlink();rng=element.ownerDocument.createRange();rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0);}else{caretContainerNode=insertInline(element,before);rng=element.ownerDocument.createRange();if(isInlineFakeCaretTarget(caretContainerNode.nextSibling)){rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0);}else{rng.setStart(caretContainerNode,1);rng.setEnd(caretContainerNode,1);}return rng;}return rng;};var hide=function hide(){trimInlineCaretContainers(root);if(caretContainerNode){remove$5(caretContainerNode);caretContainerNode=null;}lastVisualCaret.get().each(function(caretState){DomQuery(caretState.caret).remove();lastVisualCaret.set(Optional.none());});if(cursorInterval){Delay.clearInterval(cursorInterval);cursorInterval=null;}};var startBlink=function startBlink(){cursorInterval=Delay.setInterval(function(){if(hasFocus()){DomQuery('div.mce-visual-caret',root).toggleClass('mce-visual-caret-hidden');}else{DomQuery('div.mce-visual-caret',root).addClass('mce-visual-caret-hidden');}},500);};var reposition=function reposition(){lastVisualCaret.get().each(function(caretState){var clientRect=getAbsoluteClientRect(root,caretState.element,caretState.before);DomQuery(caretState.caret).css(_assign({},clientRect));});};var destroy=function destroy(){return Delay.clearInterval(cursorInterval);};var getCss=function getCss(){return'.mce-visual-caret {'+'position: absolute;'+'background-color: black;'+'background-color: currentcolor;'+'}'+'.mce-visual-caret-hidden {'+'display: none;'+'}'+'*[data-mce-caret] {'+'position: absolute;'+'left: -1000px;'+'right: auto;'+'top: 0;'+'margin: 0;'+'padding: 0;'+'}';};return{show:show,hide:hide,getCss:getCss,reposition:reposition,destroy:destroy};};var isFakeCaretTableBrowser=function isFakeCaretTableBrowser(){return browser$2.isIE()||browser$2.isEdge()||browser$2.isFirefox();};var isInlineFakeCaretTarget=function isInlineFakeCaretTarget(node){return isContentEditableFalse$3(node)||isMedia$1(node);};var isFakeCaretTarget=function isFakeCaretTarget(node){return isInlineFakeCaretTarget(node)||isTable(node)&&isFakeCaretTableBrowser();};var isContentEditableFalse$4=isContentEditableFalse;var isMedia$2=isMedia;var isBlockLike=matchStyleValues('display','block table table-cell table-caption list-item');var isCaretContainer$2=isCaretContainer;var isCaretContainerBlock$1=isCaretContainerBlock;var isElement$5=isElement$1;var isCaretCandidate$2=isCaretCandidate;var isForwards=function isForwards(direction){return direction>0;};var isBackwards=function isBackwards(direction){return direction<0;};var skipCaretContainers=function skipCaretContainers(walk,shallow){var node;while(node=walk(shallow)){if(!isCaretContainerBlock$1(node)){return node;}}return null;};var findNode=function findNode(node,direction,predicateFn,rootNode,shallow){var walker=new DomTreeWalker(node,rootNode);var isCefOrCaretContainer=isContentEditableFalse$4(node)||isCaretContainerBlock$1(node);if(isBackwards(direction)){if(isCefOrCaretContainer){node=skipCaretContainers(walker.prev,true);if(predicateFn(node)){return node;}}while(node=skipCaretContainers(walker.prev,shallow)){if(predicateFn(node)){return node;}}}if(isForwards(direction)){if(isCefOrCaretContainer){node=skipCaretContainers(walker.next,true);if(predicateFn(node)){return node;}}while(node=skipCaretContainers(walker.next,shallow)){if(predicateFn(node)){return node;}}}return null;};var getParentBlock=function getParentBlock(node,rootNode){while(node&&node!==rootNode){if(isBlockLike(node)){return node;}node=node.parentNode;}return null;};var isInSameBlock=function isInSameBlock(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)===getParentBlock(caretPosition2.container(),rootNode);};var getChildNodeAtRelativeOffset=function getChildNodeAtRelativeOffset(relativeOffset,caretPosition){if(!caretPosition){return null;}var container=caretPosition.container();var offset=caretPosition.offset();if(!isElement$5(container)){return null;}return container.childNodes[offset+relativeOffset];};var beforeAfter=function beforeAfter(before,node){var range=node.ownerDocument.createRange();if(before){range.setStartBefore(node);range.setEndBefore(node);}else{range.setStartAfter(node);range.setEndAfter(node);}return range;};var isNodesInSameBlock=function isNodesInSameBlock(root,node1,node2){return getParentBlock(node1,root)===getParentBlock(node2,root);};var lean=function lean(left,root,node){var sibling,siblingName;if(left){siblingName='previousSibling';}else{siblingName='nextSibling';}while(node&&node!==root){sibling=node[siblingName];if(isCaretContainer$2(sibling)){sibling=sibling[siblingName];}if(isContentEditableFalse$4(sibling)||isMedia$2(sibling)){if(isNodesInSameBlock(root,sibling,node)){return sibling;}break;}if(isCaretCandidate$2(sibling)){break;}node=node.parentNode;}return null;};var before$2=curry(beforeAfter,true);var after$1=curry(beforeAfter,false);var normalizeRange=function normalizeRange(direction,root,range){var node,container,location;var leanLeft=curry(lean,true,root);var leanRight=curry(lean,false,root);container=range.startContainer;var offset=range.startOffset;if(isCaretContainerBlock(container)){if(!isElement$5(container)){container=container.parentNode;}location=container.getAttribute('data-mce-caret');if(location==='before'){node=container.nextSibling;if(isFakeCaretTarget(node)){return before$2(node);}}if(location==='after'){node=container.previousSibling;if(isFakeCaretTarget(node)){return after$1(node);}}}if(!range.collapsed){return range;}if(isText$1(container)){if(isCaretContainer$2(container)){if(direction===1){node=leanRight(container);if(node){return before$2(node);}node=leanLeft(container);if(node){return after$1(node);}}if(direction===-1){node=leanLeft(container);if(node){return after$1(node);}node=leanRight(container);if(node){return before$2(node);}}return range;}if(endsWithCaretContainer(container)&&offset>=container.data.length-1){if(direction===1){node=leanRight(container);if(node){return before$2(node);}}return range;}if(startsWithCaretContainer(container)&&offset<=1){if(direction===-1){node=leanLeft(container);if(node){return after$1(node);}}return range;}if(offset===container.data.length){node=leanRight(container);if(node){return before$2(node);}return range;}if(offset===0){node=leanLeft(container);if(node){return after$1(node);}return range;}}return range;};var getRelativeCefElm=function getRelativeCefElm(forward,caretPosition){return Optional.from(getChildNodeAtRelativeOffset(forward?0:-1,caretPosition)).filter(isContentEditableFalse$4);};var getNormalizedRangeEndPoint=function getNormalizedRangeEndPoint(direction,root,range){var normalizedRange=normalizeRange(direction,root,range);if(direction===-1){return CaretPosition.fromRangeStart(normalizedRange);}return CaretPosition.fromRangeEnd(normalizedRange);};var getElementFromPosition=function getElementFromPosition(pos){return Optional.from(pos.getNode()).map(SugarElement.fromDom);};var getElementFromPrevPosition=function getElementFromPrevPosition(pos){return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);};var getVisualCaretPosition=function getVisualCaretPosition(walkFn,caretPosition){while(caretPosition=walkFn(caretPosition)){if(caretPosition.isVisible()){return caretPosition;}}return caretPosition;};var isMoveInsideSameBlock=function isMoveInsideSameBlock(from,to){var inSameBlock=isInSameBlock(from,to);if(!inSameBlock&&isBr(from.getNode())){return true;}return inSameBlock;};var HDirection;(function(HDirection){HDirection[HDirection['Backwards']=-1]='Backwards';HDirection[HDirection['Forwards']=1]='Forwards';})(HDirection||(HDirection={}));var isContentEditableFalse$5=isContentEditableFalse;var isText$7=isText$1;var isElement$6=isElement$1;var isBr$4=isBr;var isCaretCandidate$3=isCaretCandidate;var isAtomic$1=isAtomic;var isEditableCaretCandidate$1=isEditableCaretCandidate;var getParents=function getParents(node,root){var parents=[];while(node&&node!==root){parents.push(node);node=node.parentNode;}return parents;};var nodeAtIndex=function nodeAtIndex(container,offset){if(container.hasChildNodes()&&offset<container.childNodes.length){return container.childNodes[offset];}return null;};var getCaretCandidatePosition=function getCaretCandidatePosition(direction,node){if(isForwards(direction)){if(isCaretCandidate$3(node.previousSibling)&&!isText$7(node.previousSibling)){return CaretPosition$1.before(node);}if(isText$7(node)){return CaretPosition$1(node,0);}}if(isBackwards(direction)){if(isCaretCandidate$3(node.nextSibling)&&!isText$7(node.nextSibling)){return CaretPosition$1.after(node);}if(isText$7(node)){return CaretPosition$1(node,node.data.length);}}if(isBackwards(direction)){if(isBr$4(node)){return CaretPosition$1.before(node);}return CaretPosition$1.after(node);}return CaretPosition$1.before(node);};var moveForwardFromBr=function moveForwardFromBr(root,nextNode){var nextSibling=nextNode.nextSibling;if(nextSibling&&isCaretCandidate$3(nextSibling)){if(isText$7(nextSibling)){return CaretPosition$1(nextSibling,0);}else{return CaretPosition$1.before(nextSibling);}}else{return findCaretPosition(HDirection.Forwards,CaretPosition$1.after(nextNode),root);}};var findCaretPosition=function findCaretPosition(direction,startPos,root){var node,nextNode,innerNode;var caretPosition;if(!isElement$6(root)||!startPos){return null;}if(startPos.isEqual(CaretPosition$1.after(root))&&root.lastChild){caretPosition=CaretPosition$1.after(root.lastChild);if(isBackwards(direction)&&isCaretCandidate$3(root.lastChild)&&isElement$6(root.lastChild)){return isBr$4(root.lastChild)?CaretPosition$1.before(root.lastChild):caretPosition;}}else{caretPosition=startPos;}var container=caretPosition.container();var offset=caretPosition.offset();if(isText$7(container)){if(isBackwards(direction)&&offset>0){return CaretPosition$1(container,--offset);}if(isForwards(direction)&&offset<container.length){return CaretPosition$1(container,++offset);}node=container;}else{if(isBackwards(direction)&&offset>0){nextNode=nodeAtIndex(container,offset-1);if(isCaretCandidate$3(nextNode)){if(!isAtomic$1(nextNode)){innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode);if(innerNode){if(isText$7(innerNode)){return CaretPosition$1(innerNode,innerNode.data.length);}return CaretPosition$1.after(innerNode);}}if(isText$7(nextNode)){return CaretPosition$1(nextNode,nextNode.data.length);}return CaretPosition$1.before(nextNode);}}if(isForwards(direction)&&offset<container.childNodes.length){nextNode=nodeAtIndex(container,offset);if(isCaretCandidate$3(nextNode)){if(isBr$4(nextNode)){return moveForwardFromBr(root,nextNode);}if(!isAtomic$1(nextNode)){innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode);if(innerNode){if(isText$7(innerNode)){return CaretPosition$1(innerNode,0);}return CaretPosition$1.before(innerNode);}}if(isText$7(nextNode)){return CaretPosition$1(nextNode,0);}return CaretPosition$1.after(nextNode);}}node=nextNode?nextNode:caretPosition.getNode();}if(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart()){node=findNode(node,direction,always,root,true);if(isEditableCaretCandidate$1(node,root)){return getCaretCandidatePosition(direction,node);}}nextNode=findNode(node,direction,isEditableCaretCandidate$1,root);var rootContentEditableFalseElm=last$1(filter(getParents(container,root),isContentEditableFalse$5));if(rootContentEditableFalseElm&&(!nextNode||!rootContentEditableFalseElm.contains(nextNode))){if(isForwards(direction)){caretPosition=CaretPosition$1.after(rootContentEditableFalseElm);}else{caretPosition=CaretPosition$1.before(rootContentEditableFalseElm);}return caretPosition;}if(nextNode){return getCaretCandidatePosition(direction,nextNode);}return null;};var CaretWalker=function CaretWalker(root){return{next:function next(caretPosition){return findCaretPosition(HDirection.Forwards,caretPosition,root);},prev:function prev(caretPosition){return findCaretPosition(HDirection.Backwards,caretPosition,root);}};};var walkToPositionIn=function walkToPositionIn(forward,root,start){var position=forward?CaretPosition$1.before(start):CaretPosition$1.after(start);return fromPosition(forward,root,position);};var afterElement=function afterElement(node){return isBr(node)?CaretPosition$1.before(node):CaretPosition$1.after(node);};var isBeforeOrStart=function isBeforeOrStart(position){if(CaretPosition$1.isTextPosition(position)){return position.offset()===0;}else{return isCaretCandidate(position.getNode());}};var isAfterOrEnd=function isAfterOrEnd(position){if(CaretPosition$1.isTextPosition(position)){var container=position.container();return position.offset()===container.data.length;}else{return isCaretCandidate(position.getNode(true));}};var isBeforeAfterSameElement=function isBeforeAfterSameElement(from,to){return!CaretPosition$1.isTextPosition(from)&&!CaretPosition$1.isTextPosition(to)&&from.getNode()===to.getNode(true);};var isAtBr=function isAtBr(position){return!CaretPosition$1.isTextPosition(position)&&isBr(position.getNode());};var shouldSkipPosition=function shouldSkipPosition(forward,from,to){if(forward){return!isBeforeAfterSameElement(from,to)&&!isAtBr(from)&&isAfterOrEnd(from)&&isBeforeOrStart(to);}else{return!isBeforeAfterSameElement(to,from)&&isBeforeOrStart(from)&&isAfterOrEnd(to);}};var fromPosition=function fromPosition(forward,root,pos){var walker=CaretWalker(root);return Optional.from(forward?walker.next(pos):walker.prev(pos));};var navigate=function navigate(forward,root,from){return fromPosition(forward,root,from).bind(function(to){if(isInSameBlock(from,to,root)&&shouldSkipPosition(forward,from,to)){return fromPosition(forward,root,to);}else{return Optional.some(to);}});};var navigateIgnore=function navigateIgnore(forward,root,from,ignoreFilter){return navigate(forward,root,from).bind(function(pos){return ignoreFilter(pos)?navigateIgnore(forward,root,pos,ignoreFilter):Optional.some(pos);});};var positionIn=function positionIn(forward,element){var startNode=forward?element.firstChild:element.lastChild;if(isText$1(startNode)){return Optional.some(CaretPosition$1(startNode,forward?0:startNode.data.length));}else if(startNode){if(isCaretCandidate(startNode)){return Optional.some(forward?CaretPosition$1.before(startNode):afterElement(startNode));}else{return walkToPositionIn(forward,element,startNode);}}else{return Optional.none();}};var nextPosition=curry(fromPosition,true);var prevPosition=curry(fromPosition,false);var firstPositionIn=curry(positionIn,true);var lastPositionIn=curry(positionIn,false);var CARET_ID='_mce_caret';var isCaretNode=function isCaretNode(node){return isElement$1(node)&&node.id===CARET_ID;};var getParentCaretContainer=function getParentCaretContainer(body,node){while(node&&node!==body){if(node.id===CARET_ID){return node;}node=node.parentNode;}return null;};var isStringPathBookmark=function isStringPathBookmark(bookmark){return typeof bookmark.start==='string';};var isRangeBookmark=function isRangeBookmark(bookmark){return bookmark.hasOwnProperty('rng');};var isIdBookmark=function isIdBookmark(bookmark){return bookmark.hasOwnProperty('id');};var isIndexBookmark=function isIndexBookmark(bookmark){return bookmark.hasOwnProperty('name');};var isPathBookmark=function isPathBookmark(bookmark){return Tools.isArray(bookmark.start);};var addBogus=function addBogus(dom,node){if(isElement$1(node)&&dom.isBlock(node)&&!node.innerHTML&&!Env.ie){node.innerHTML='<br data-mce-bogus="1" />';}return node;};var resolveCaretPositionBookmark=function resolveCaretPositionBookmark(dom,bookmark){var pos;var rng=dom.createRng();pos=resolve$1(dom.getRoot(),bookmark.start);rng.setStart(pos.container(),pos.offset());pos=resolve$1(dom.getRoot(),bookmark.end);rng.setEnd(pos.container(),pos.offset());return rng;};var insertZwsp=function insertZwsp(node,rng){var textNode=node.ownerDocument.createTextNode(ZWSP);node.appendChild(textNode);rng.setStart(textNode,0);rng.setEnd(textNode,0);};var isEmpty$1=function isEmpty$1(node){return node.hasChildNodes()===false;};var tryFindRangePosition=function tryFindRangePosition(node,rng){return lastPositionIn(node).fold(function(){return false;},function(pos){rng.setStart(pos.container(),pos.offset());rng.setEnd(pos.container(),pos.offset());return true;});};var padEmptyCaretContainer=function padEmptyCaretContainer(root,node,rng){if(isEmpty$1(node)&&getParentCaretContainer(root,node)){insertZwsp(node,rng);return true;}else{return false;}};var setEndPoint=function setEndPoint(dom,start,bookmark,rng){var point=bookmark[start?'start':'end'];var i,node,offset,children;var root=dom.getRoot();if(point){offset=point[0];for(node=root,i=point.length-1;i>=1;i--){children=node.childNodes;if(padEmptyCaretContainer(root,node,rng)){return true;}if(point[i]>children.length-1){if(padEmptyCaretContainer(root,node,rng)){return true;}return tryFindRangePosition(node,rng);}node=children[point[i]];}if(node.nodeType===3){offset=Math.min(point[0],node.nodeValue.length);}if(node.nodeType===1){offset=Math.min(point[0],node.childNodes.length);}if(start){rng.setStart(node,offset);}else{rng.setEnd(node,offset);}}return true;};var isValidTextNode=function isValidTextNode(node){return isText$1(node)&&node.data.length>0;};var restoreEndPoint=function restoreEndPoint(dom,suffix,bookmark){var marker=dom.get(bookmark.id+'_'+suffix),node,idx,next,prev;var keep=bookmark.keep;var container,offset;if(marker){node=marker.parentNode;if(suffix==='start'){if(!keep){idx=dom.nodeIndex(marker);}else{if(marker.hasChildNodes()){node=marker.firstChild;idx=1;}else if(isValidTextNode(marker.nextSibling)){node=marker.nextSibling;idx=0;}else if(isValidTextNode(marker.previousSibling)){node=marker.previousSibling;idx=marker.previousSibling.data.length;}else{node=marker.parentNode;idx=dom.nodeIndex(marker)+1;}}container=node;offset=idx;}else{if(!keep){idx=dom.nodeIndex(marker);}else{if(marker.hasChildNodes()){node=marker.firstChild;idx=1;}else if(isValidTextNode(marker.previousSibling)){node=marker.previousSibling;idx=marker.previousSibling.data.length;}else{node=marker.parentNode;idx=dom.nodeIndex(marker);}}container=node;offset=idx;}if(!keep){prev=marker.previousSibling;next=marker.nextSibling;Tools.each(Tools.grep(marker.childNodes),function(node){if(isText$1(node)){node.nodeValue=node.nodeValue.replace(/\uFEFF/g,'');}});while(marker=dom.get(bookmark.id+'_'+suffix)){dom.remove(marker,true);}if(prev&&next&&prev.nodeType===next.nodeType&&isText$1(prev)&&!Env.opera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);dom.remove(next);container=prev;offset=idx;}}return Optional.some(CaretPosition$1(container,offset));}else{return Optional.none();}};var resolvePaths=function resolvePaths(dom,bookmark){var rng=dom.createRng();if(setEndPoint(dom,true,bookmark,rng)&&setEndPoint(dom,false,bookmark,rng)){return Optional.some(rng);}else{return Optional.none();}};var resolveId=function resolveId(dom,bookmark){var startPos=restoreEndPoint(dom,'start',bookmark);var endPos=restoreEndPoint(dom,'end',bookmark);return lift2(startPos,endPos.or(startPos),function(spos,epos){var rng=dom.createRng();rng.setStart(addBogus(dom,spos.container()),spos.offset());rng.setEnd(addBogus(dom,epos.container()),epos.offset());return rng;});};var resolveIndex$1=function resolveIndex$1(dom,bookmark){return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function(elm){var rng=dom.createRng();rng.selectNode(elm);return rng;});};var resolve$2=function resolve$2(selection,bookmark){var dom=selection.dom;if(bookmark){if(isPathBookmark(bookmark)){return resolvePaths(dom,bookmark);}else if(isStringPathBookmark(bookmark)){return Optional.some(resolveCaretPositionBookmark(dom,bookmark));}else if(isIdBookmark(bookmark)){return resolveId(dom,bookmark);}else if(isIndexBookmark(bookmark)){return resolveIndex$1(dom,bookmark);}else if(isRangeBookmark(bookmark)){return Optional.some(bookmark.rng);}}return Optional.none();};var getBookmark$1=function getBookmark$1(selection,type,normalized){return getBookmark(selection,type,normalized);};var moveToBookmark=function moveToBookmark(selection,bookmark){resolve$2(selection,bookmark).each(function(rng){selection.setRng(rng);});};var isBookmarkNode$1=function isBookmarkNode$1(node){return isElement$1(node)&&node.tagName==='SPAN'&&node.getAttribute('data-mce-type')==='bookmark';};var is$2=function is$2(expected){return function(actual){return expected===actual;};};var isNbsp=is$2(nbsp);var isWhiteSpace$1=function isWhiteSpace$1(chr){return chr!==''&&' \f\n\r\t\x0B'.indexOf(chr)!==-1;};var isContent$1=function isContent$1(chr){return!isWhiteSpace$1(chr)&&!isNbsp(chr);};var isNode=function isNode(node){return!!node.nodeType;};var isInlineBlock=function isInlineBlock(node){return node&&/^(IMG)$/.test(node.nodeName);};var moveStart=function moveStart(dom,selection,rng){var offset=rng.startOffset;var container=rng.startContainer,walker,node,nodes;if(rng.startContainer===rng.endContainer){if(isInlineBlock(rng.startContainer.childNodes[rng.startOffset])){return;}}if(container.nodeType===1){nodes=container.childNodes;if(offset<nodes.length){container=nodes[offset];walker=new DomTreeWalker(container,dom.getParent(container,dom.isBlock));}else{container=nodes[nodes.length-1];walker=new DomTreeWalker(container,dom.getParent(container,dom.isBlock));walker.next(true);}for(node=walker.current();node;node=walker.next()){if(node.nodeType===3&&!isWhiteSpaceNode(node)){rng.setStart(node,0);selection.setRng(rng);return;}}}};var getNonWhiteSpaceSibling=function getNonWhiteSpaceSibling(node,next,inc){if(node){var nextName=next?'nextSibling':'previousSibling';for(node=inc?node:node[nextName];node;node=node[nextName]){if(node.nodeType===1||!isWhiteSpaceNode(node)){return node;}}}};var isTextBlock$1=function isTextBlock$1(editor,name){if(isNode(name)){name=name.nodeName;}return!!editor.schema.getTextBlockElements()[name.toLowerCase()];};var isValid=function isValid(ed,parent,child){return ed.schema.isValidChild(parent,child);};var isWhiteSpaceNode=function isWhiteSpaceNode(node){return node&&isText$1(node)&&/^([\t \r\n]+|)$/.test(node.nodeValue);};var isEmptyTextNode=function isEmptyTextNode(node){return node&&isText$1(node)&&node.length===0;};var replaceVars=function replaceVars(value,vars){if(typeof value!=='string'){value=value(vars);}else if(vars){value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str;});}return value;};var isEq=function isEq(str1,str2){str1=str1||'';str2=str2||'';str1=''+(str1.nodeName||str1);str2=''+(str2.nodeName||str2);return str1.toLowerCase()===str2.toLowerCase();};var normalizeStyleValue=function normalizeStyleValue(dom,value,name){if(name==='color'||name==='backgroundColor'){value=dom.toHex(value);}if(name==='fontWeight'&&value===700){value='bold';}if(name==='fontFamily'){value=value.replace(/[\'\"]/g,'').replace(/,\s+/g,',');}return''+value;};var getStyle=function getStyle(dom,node,name){return normalizeStyleValue(dom,dom.getStyle(node,name),name);};var getTextDecoration=function getTextDecoration(dom,node){var decoration;dom.getParent(node,function(n){decoration=dom.getStyle(n,'text-decoration');return decoration&&decoration!=='none';});return decoration;};var getParents$1=function getParents$1(dom,node,selector){return dom.getParents(node,selector,dom.getRoot());};var isVariableFormatName=function isVariableFormatName(editor,formatName){var hasVariableValues=function hasVariableValues(format){var isVariableValue=function isVariableValue(val){return val.length>1&&val.charAt(0)==='%';};return exists(['styles','attributes'],function(key){return get(format,key).exists(function(field){var fieldValues=isArray(field)?field:values(field);return exists(fieldValues,isVariableValue);});});};return exists(editor.formatter.get(formatName),hasVariableValues);};var areSimilarFormats=function areSimilarFormats(editor,formatName,otherFormatName){var validKeys=['inline','block','selector','attributes','styles','classes'];var filterObj=function filterObj(format){return filter$1(format,function(_,key){return exists(validKeys,function(validKey){return validKey===key;});});};return exists(editor.formatter.get(formatName),function(fmt1){var filteredFmt1=filterObj(fmt1);return exists(editor.formatter.get(otherFormatName),function(fmt2){var filteredFmt2=filterObj(fmt2);return equal(filteredFmt1,filteredFmt2);});});};var isBookmarkNode$2=isBookmarkNode$1;var getParents$2=getParents$1;var isWhiteSpaceNode$1=isWhiteSpaceNode;var isTextBlock$2=isTextBlock$1;var isBogusBr=function isBogusBr(node){return node.nodeName==='BR'&&node.getAttribute('data-mce-bogus')&&!node.nextSibling;};var findParentContentEditable=function findParentContentEditable(dom,node){var parent=node;while(parent){if(isElement$1(parent)&&dom.getContentEditable(parent)){return dom.getContentEditable(parent)==='false'?parent:node;}parent=parent.parentNode;}return node;};var walkText=function walkText(start,node,offset,predicate){var str=node.data;for(var i=offset;start?i>=0:i<str.length;start?i--:i++){if(predicate(str.charAt(i))){return start?i+1:i;}}return-1;};var findSpace=function findSpace(start,node,offset){return walkText(start,node,offset,function(c){return isNbsp(c)||isWhiteSpace$1(c);});};var findContent=function findContent(start,node,offset){return walkText(start,node,offset,isContent$1);};var findWordEndPoint=function findWordEndPoint(dom,body,container,offset,start,includeTrailingSpaces){var lastTextNode;var rootNode=dom.getParent(container,dom.isBlock)||body;var walk=function walk(container,offset,pred){var textSeeker=TextSeeker(dom);var walker=start?textSeeker.backwards:textSeeker.forwards;return Optional.from(walker(container,offset,function(text,textOffset){if(isBookmarkNode$2(text.parentNode)){return-1;}else{lastTextNode=text;return pred(start,text,textOffset);}},rootNode));};var spaceResult=walk(container,offset,findSpace);return spaceResult.bind(function(result){return includeTrailingSpaces?walk(result.container,result.offset+(start?-1:0),findContent):Optional.some(result);}).orThunk(function(){return lastTextNode?Optional.some({container:lastTextNode,offset:start?0:lastTextNode.length}):Optional.none();});};var findSelectorEndPoint=function findSelectorEndPoint(dom,format,rng,container,siblingName){if(isText$1(container)&&container.nodeValue.length===0&&container[siblingName]){container=container[siblingName];}var parents=getParents$2(dom,container);for(var i=0;i<parents.length;i++){for(var y=0;y<format.length;y++){var curFormat=format[y];if('collapsed'in curFormat&&curFormat.collapsed!==rng.collapsed){continue;}if(dom.is(parents[i],curFormat.selector)){return parents[i];}}}return container;};var findBlockEndPoint=function findBlockEndPoint(editor,format,container,siblingName){var node;var dom=editor.dom;var root=dom.getRoot();if(!format[0].wrapper){node=dom.getParent(container,format[0].block,root);}if(!node){var scopeRoot=dom.getParent(container,'LI,TD,TH');node=dom.getParent(isText$1(container)?container.parentNode:container,function(node){return node!==root&&isTextBlock$2(editor,node);},scopeRoot);}if(node&&format[0].wrapper){node=getParents$2(dom,node,'ul,ol').reverse()[0]||node;}if(!node){node=container;while(node[siblingName]&&!dom.isBlock(node[siblingName])){node=node[siblingName];if(isEq(node,'br')){break;}}}return node||container;};var findParentContainer=function findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,start){var container,parent,sibling;container=parent=start?startContainer:endContainer;var siblingName=start?'previousSibling':'nextSibling';var root=dom.getRoot();if(isText$1(container)&&!isWhiteSpaceNode$1(container)){if(start?startOffset>0:endOffset<container.nodeValue.length){return container;}}while(true){if(!format[0].block_expand&&dom.isBlock(parent)){return parent;}for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName]){if(!isBookmarkNode$2(sibling)&&!isWhiteSpaceNode$1(sibling)&&!isBogusBr(sibling)){return parent;}}if(parent===root||parent.parentNode===root){container=parent;break;}parent=parent.parentNode;}return container;};var expandRng=function expandRng(editor,rng,format,includeTrailingSpace){if(includeTrailingSpace===void 0){includeTrailingSpace=false;}var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;var dom=editor.dom;if(isElement$1(startContainer)&&startContainer.hasChildNodes()){startContainer=getNode(startContainer,startOffset);if(isText$1(startContainer)){startOffset=0;}}if(isElement$1(endContainer)&&endContainer.hasChildNodes()){endContainer=getNode(endContainer,rng.collapsed?endOffset:endOffset-1);if(isText$1(endContainer)){endOffset=endContainer.nodeValue.length;}}startContainer=findParentContentEditable(dom,startContainer);endContainer=findParentContentEditable(dom,endContainer);if(isBookmarkNode$2(startContainer.parentNode)||isBookmarkNode$2(startContainer)){startContainer=isBookmarkNode$2(startContainer)?startContainer:startContainer.parentNode;if(rng.collapsed){startContainer=startContainer.previousSibling||startContainer;}else{startContainer=startContainer.nextSibling||startContainer;}if(isText$1(startContainer)){startOffset=rng.collapsed?startContainer.length:0;}}if(isBookmarkNode$2(endContainer.parentNode)||isBookmarkNode$2(endContainer)){endContainer=isBookmarkNode$2(endContainer)?endContainer:endContainer.parentNode;if(rng.collapsed){endContainer=endContainer.nextSibling||endContainer;}else{endContainer=endContainer.previousSibling||endContainer;}if(isText$1(endContainer)){endOffset=rng.collapsed?0:endContainer.length;}}if(rng.collapsed){var startPoint=findWordEndPoint(dom,editor.getBody(),startContainer,startOffset,true,includeTrailingSpace);startPoint.each(function(_a){var container=_a.container,offset=_a.offset;startContainer=container;startOffset=offset;});var endPoint=findWordEndPoint(dom,editor.getBody(),endContainer,endOffset,false,includeTrailingSpace);endPoint.each(function(_a){var container=_a.container,offset=_a.offset;endContainer=container;endOffset=offset;});}if(format[0].inline||format[0].block_expand){if(!format[0].inline||!isText$1(startContainer)||startOffset===0){startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,true);}if(!format[0].inline||!isText$1(endContainer)||endOffset===endContainer.nodeValue.length){endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,false);}}if(format[0].selector&&format[0].expand!==false&&!format[0].inline){startContainer=findSelectorEndPoint(dom,format,rng,startContainer,'previousSibling');endContainer=findSelectorEndPoint(dom,format,rng,endContainer,'nextSibling');}if(format[0].block||format[0].selector){startContainer=findBlockEndPoint(editor,format,startContainer,'previousSibling');endContainer=findBlockEndPoint(editor,format,endContainer,'nextSibling');if(format[0].block){if(!dom.isBlock(startContainer)){startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,true);}if(!dom.isBlock(endContainer)){endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,false);}}}if(isElement$1(startContainer)){startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode;}if(isElement$1(endContainer)){endOffset=dom.nodeIndex(endContainer)+1;endContainer=endContainer.parentNode;}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset};};var clampToExistingChildren=function clampToExistingChildren(container,index){var childNodes=container.childNodes;if(index>=childNodes.length){index=childNodes.length-1;}else if(index<0){index=0;}return childNodes[index]||container;};var getEndChild=function getEndChild(container,index){return clampToExistingChildren(container,index-1);};var walk$1=function walk$1(dom,rng,callback){var startContainer=rng.startContainer;var startOffset=rng.startOffset;var endContainer=rng.endContainer;var endOffset=rng.endOffset;var exclude=function exclude(nodes){var node;node=nodes[0];if(node.nodeType===3&&node===startContainer&&startOffset>=node.nodeValue.length){nodes.splice(0,1);}node=nodes[nodes.length-1];if(endOffset===0&&nodes.length>0&&node===endContainer&&node.nodeType===3){nodes.splice(nodes.length-1,1);}return nodes;};var collectSiblings=function collectSiblings(node,name,endNode){var siblings=[];for(;node&&node!==endNode;node=node[name]){siblings.push(node);}return siblings;};var findEndPoint=function findEndPoint(node,root){do{if(node.parentNode===root){return node;}node=node.parentNode;}while(node);};var walkBoundary=function walkBoundary(startNode,endNode,next){var siblingName=next?'nextSibling':'previousSibling';for(var node=startNode,parent_1=node.parentNode;node&&node!==endNode;node=parent_1){parent_1=node.parentNode;var siblings_1=collectSiblings(node===startNode?node:node[siblingName],siblingName);if(siblings_1.length){if(!next){siblings_1.reverse();}callback(exclude(siblings_1));}}};if(startContainer.nodeType===1&&startContainer.hasChildNodes()){startContainer=clampToExistingChildren(startContainer,startOffset);}if(endContainer.nodeType===1&&endContainer.hasChildNodes()){endContainer=getEndChild(endContainer,endOffset);}if(startContainer===endContainer){return callback(exclude([startContainer]));}var ancestor=dom.findCommonAncestor(startContainer,endContainer);for(var node=startContainer;node;node=node.parentNode){if(node===endContainer){return walkBoundary(startContainer,ancestor,true);}if(node===ancestor){break;}}for(var node=endContainer;node;node=node.parentNode){if(node===startContainer){return walkBoundary(endContainer,ancestor);}if(node===ancestor){break;}}var startPoint=findEndPoint(startContainer,ancestor)||startContainer;var endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,true);var siblings=collectSiblings(startPoint===startContainer?startPoint:startPoint.nextSibling,'nextSibling',endPoint===endContainer?endPoint.nextSibling:endPoint);if(siblings.length){callback(exclude(siblings));}walkBoundary(endContainer,endPoint);};var getRanges=function getRanges(selection){var ranges=[];if(selection){for(var i=0;i<selection.rangeCount;i++){ranges.push(selection.getRangeAt(i));}}return ranges;};var getSelectedNodes=function getSelectedNodes(ranges){return bind(ranges,function(range){var node=getSelectedNode(range);return node?[SugarElement.fromDom(node)]:[];});};var hasMultipleRanges=function hasMultipleRanges(selection){return getRanges(selection).length>1;};var getCellsFromRanges=function getCellsFromRanges(ranges){return filter(getSelectedNodes(ranges),isTableCell$1);};var getCellsFromElement=function getCellsFromElement(elm){return descendants$1(elm,'td[data-mce-selected],th[data-mce-selected]');};var getCellsFromElementOrRanges=function getCellsFromElementOrRanges(ranges,element){var selectedCells=getCellsFromElement(element);return selectedCells.length>0?selectedCells:getCellsFromRanges(ranges);};var getCellsFromEditor=function getCellsFromEditor(editor){return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()),SugarElement.fromDom(editor.getBody()));};var getStartNode=function getStartNode(rng){var sc=rng.startContainer,so=rng.startOffset;if(isText$1(sc)){return so===0?Optional.some(SugarElement.fromDom(sc)):Optional.none();}else{return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);}};var getEndNode=function getEndNode(rng){var ec=rng.endContainer,eo=rng.endOffset;if(isText$1(ec)){return eo===ec.data.length?Optional.some(SugarElement.fromDom(ec)):Optional.none();}else{return Optional.from(ec.childNodes[eo-1]).map(SugarElement.fromDom);}};var getFirstChildren=function getFirstChildren(node){return firstChild(node).fold(constant([node]),function(child){return[node].concat(getFirstChildren(child));});};var getLastChildren=function getLastChildren(node){return lastChild(node).fold(constant([node]),function(child){if(name(child)==='br'){return prevSibling(child).map(function(sibling){return[node].concat(getLastChildren(sibling));}).getOr([]);}else{return[node].concat(getLastChildren(child));}});};var hasAllContentsSelected=function hasAllContentsSelected(elm,rng){return lift2(getStartNode(rng),getEndNode(rng),function(startNode,endNode){var start=find(getFirstChildren(elm),curry(eq$2,startNode));var end=find(getLastChildren(elm),curry(eq$2,endNode));return start.isSome()&&end.isSome();}).getOr(false);};var moveEndPoint$1=function moveEndPoint$1(dom,rng,node,start){var root=node,walker=new DomTreeWalker(node,root);var moveCaretBeforeOnEnterElementsMap=filter$1(dom.schema.getMoveCaretBeforeOnEnterElements(),function(_,name){return!contains(['td','th','table'],name.toLowerCase());});do{if(isText$1(node)&&Tools.trim(node.nodeValue).length!==0){if(start){rng.setStart(node,0);}else{rng.setEnd(node,node.nodeValue.length);}return;}if(moveCaretBeforeOnEnterElementsMap[node.nodeName]){if(start){rng.setStartBefore(node);}else{if(node.nodeName==='BR'){rng.setEndBefore(node);}else{rng.setEndAfter(node);}}return;}}while(node=start?walker.next():walker.prev());if(root.nodeName==='BODY'){if(start){rng.setStart(root,0);}else{rng.setEnd(root,root.childNodes.length);}}};var hasAnyRanges=function hasAnyRanges(editor){var sel=editor.selection.getSel();return sel&&sel.rangeCount>0;};var runOnRanges=function runOnRanges(editor,executor){var fakeSelectionNodes=getCellsFromEditor(editor);if(fakeSelectionNodes.length>0){each(fakeSelectionNodes,function(elem){var node=elem.dom;var fakeNodeRng=editor.dom.createRng();fakeNodeRng.setStartBefore(node);fakeNodeRng.setEndAfter(node);executor(fakeNodeRng,true);});}else{executor(editor.selection.getRng(),false);}};var preserve=function preserve(selection,fillBookmark,executor){var bookmark=getPersistentBookmark(selection,fillBookmark);executor(bookmark);selection.moveToBookmark(bookmark);};function NodeValue(is,name){var get=function get(element){if(!is(element)){throw new Error('Can only get '+name+' value of a '+name+' node');}return getOption(element).getOr('');};var getOption=function getOption(element){return is(element)?Optional.from(element.dom.nodeValue):Optional.none();};var set=function set(element,value){if(!is(element)){throw new Error('Can only set raw '+name+' value of a '+name+' node');}element.dom.nodeValue=value;};return{get:get,getOption:getOption,set:set};}var api=NodeValue(isText,'text');var get$7=function get$7(element){return api.get(element);};var isZeroWidth=function isZeroWidth(elem){return isText(elem)&&get$7(elem)===ZWSP;};var context=function context(editor,elem,wrapName,nodeName){return parent(elem).fold(function(){return'skipping';},function(parent){if(nodeName==='br'||isZeroWidth(elem)){return'valid';}else if(isAnnotation(elem)){return'existing';}else if(isCaretNode(elem.dom)){return'caret';}else if(!isValid(editor,wrapName,nodeName)||!isValid(editor,name(parent),wrapName)){return'invalid-child';}else{return'valid';}});};var applyWordGrab=function applyWordGrab(editor,rng){var r=expandRng(editor,rng,[{inline:true}]);rng.setStart(r.startContainer,r.startOffset);rng.setEnd(r.endContainer,r.endOffset);editor.selection.setRng(rng);};var makeAnnotation=function makeAnnotation(eDoc,_a,annotationName,decorate){var _b=_a.uid,uid=_b===void 0?generate$1('mce-annotation'):_b,data=__rest(_a,['uid']);var master=SugarElement.fromTag('span',eDoc);add$3(master,annotation());set(master,''+dataAnnotationId(),uid);set(master,''+dataAnnotation(),annotationName);var _c=decorate(uid,data),_d=_c.attributes,attributes=_d===void 0?{}:_d,_e=_c.classes,classes=_e===void 0?[]:_e;setAll(master,attributes);add$4(master,classes);return master;};var annotate=function annotate(editor,rng,annotationName,decorate,data){var newWrappers=[];var master=makeAnnotation(editor.getDoc(),data,annotationName,decorate);var wrapper=Cell(Optional.none());var finishWrapper=function finishWrapper(){wrapper.set(Optional.none());};var getOrOpenWrapper=function getOrOpenWrapper(){return wrapper.get().getOrThunk(function(){var nu=shallow(master);newWrappers.push(nu);wrapper.set(Optional.some(nu));return nu;});};var processElements=function processElements(elems){each(elems,processElement);};var processElement=function processElement(elem){var ctx=context(editor,elem,'span',name(elem));switch(ctx){case'invalid-child':{finishWrapper();var children$1=children(elem);processElements(children$1);finishWrapper();break;}case'valid':{var w=getOrOpenWrapper();wrap(elem,w);break;}}};var processNodes=function processNodes(nodes){var elems=map(nodes,SugarElement.fromDom);processElements(elems);};walk$1(editor.dom,rng,function(nodes){finishWrapper();processNodes(nodes);});return newWrappers;};var annotateWithBookmark=function annotateWithBookmark(editor,name,settings,data){editor.undoManager.transact(function(){var selection=editor.selection;var initialRng=selection.getRng();var hasFakeSelection=getCellsFromEditor(editor).length>0;if(initialRng.collapsed&&!hasFakeSelection){applyWordGrab(editor,initialRng);}if(selection.getRng().collapsed&&!hasFakeSelection){var wrapper=makeAnnotation(editor.getDoc(),data,name,settings.decorate);set$1(wrapper,nbsp);selection.getRng().insertNode(wrapper.dom);selection.select(wrapper.dom);}else{preserve(selection,false,function(){runOnRanges(editor,function(selectionRng){annotate(editor,selectionRng,name,settings.decorate,data);});});}});};var Annotator=function Annotator(editor){var registry=create$2();setup$1(editor,registry);var changes=setup(editor);return{register:function register(name,settings){registry.register(name,settings);},annotate:function annotate(name,data){registry.lookup(name).each(function(settings){annotateWithBookmark(editor,name,settings,data);});},annotationChanged:function annotationChanged(name,callback){changes.addListener(name,callback);},remove:function remove(name){identify(editor,Optional.some(name)).each(function(_a){var elements=_a.elements;each(elements,unwrap);});},getAll:function getAll(name){var directory=findAll(editor,name);return map$1(directory,function(elems){return map(elems,function(elem){return elem.dom;});});}};};function BookmarkManager(selection){return{getBookmark:curry(getBookmark$1,selection),moveToBookmark:curry(moveToBookmark,selection)};}(function(BookmarkManager){BookmarkManager.isBookmarkNode=isBookmarkNode$1;})(BookmarkManager||(BookmarkManager={}));var BookmarkManager$1=BookmarkManager;var getContentEditableRoot=function getContentEditableRoot(root,node){while(node&&node!==root){if(isContentEditableTrue(node)||isContentEditableFalse(node)){return node;}node=node.parentNode;}return null;};var isXYWithinRange=function isXYWithinRange(clientX,clientY,range){if(range.collapsed){return false;}if(Env.browser.isIE()&&range.startOffset===range.endOffset-1&&range.startContainer===range.endContainer){var elm=range.startContainer.childNodes[range.startOffset];if(isElement$1(elm)){return exists(elm.getClientRects(),function(rect){return containsXY(rect,clientX,clientY);});}}return exists(range.getClientRects(),function(rect){return containsXY(rect,clientX,clientY);});};var firePreProcess=function firePreProcess(editor,args){return editor.fire('PreProcess',args);};var firePostProcess=function firePostProcess(editor,args){return editor.fire('PostProcess',args);};var fireRemove=function fireRemove(editor){return editor.fire('remove');};var fireDetach=function fireDetach(editor){return editor.fire('detach');};var fireSwitchMode=function fireSwitchMode(editor,mode){return editor.fire('SwitchMode',{mode:mode});};var fireObjectResizeStart=function fireObjectResizeStart(editor,target,width,height,origin){editor.fire('ObjectResizeStart',{target:target,width:width,height:height,origin:origin});};var fireObjectResized=function fireObjectResized(editor,target,width,height,origin){editor.fire('ObjectResized',{target:target,width:width,height:height,origin:origin});};var firePreInit=function firePreInit(editor){return editor.fire('PreInit');};var firePostRender=function firePostRender(editor){return editor.fire('PostRender');};var fireInit=function fireInit(editor){return editor.fire('Init');};var firePlaceholderToggle=function firePlaceholderToggle(editor,state){return editor.fire('PlaceholderToggle',{state:state});};var fireError=function fireError(editor,errorType,error){return editor.fire(errorType,error);};var VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function modifierPressed(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e);},metaKeyPressed:function metaKeyPressed(e){return Env.mac?e.metaKey:e.ctrlKey&&!e.altKey;}};var isContentEditableFalse$6=isContentEditableFalse;var ControlSelection=function ControlSelection(selection,editor){var dom=editor.dom,each=Tools.each;var selectedElm,selectedElmGhost,resizeHelper,selectedHandle;var startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted;var width,height;var editableDoc=editor.getDoc(),rootDocument=document;var abs=Math.abs,round=Math.round,rootElement=editor.getBody();var startScrollWidth,startScrollHeight;var resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var isImage=function isImage(elm){return elm&&(elm.nodeName==='IMG'||editor.dom.is(elm,'figure.image'));};var isEventOnImageOutsideRange=function isEventOnImageOutsideRange(evt,range){if(evt.type==='longpress'||evt.type.indexOf('touch')===0){var touch=evt.touches[0];return isImage(evt.target)&&!isXYWithinRange(touch.clientX,touch.clientY,range);}else{return isImage(evt.target)&&!isXYWithinRange(evt.clientX,evt.clientY,range);}};var contextMenuSelectImage=function contextMenuSelectImage(evt){var target=evt.target;if(isEventOnImageOutsideRange(evt,editor.selection.getRng())&&!evt.isDefaultPrevented()){editor.selection.select(target);}};var getResizeTarget=function getResizeTarget(elm){return editor.dom.is(elm,'figure.image')?elm.querySelector('img'):elm;};var isResizable=function isResizable(elm){var selector=getObjectResizing(editor);if(!selector){return false;}if(elm.getAttribute('data-mce-resize')==='false'){return false;}if(elm===editor.getBody()){return false;}return is$1(SugarElement.fromDom(elm),selector);};var setGhostElmSize=function setGhostElmSize(ghostElm,width,height){dom.setStyles(getResizeTarget(ghostElm),{width:width,height:height});};var resizeGhostElement=function resizeGhostElement(e){var deltaX,deltaY,proportional;var resizeHelperX,resizeHelperY;deltaX=e.screenX-startX;deltaY=e.screenY-startY;width=deltaX*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;width=width<5?5:width;height=height<5?5:height;if(isImage(selectedElm)&&getResizeImgProportional(editor)!==false){proportional=!VK.modifierPressed(e);}else{proportional=VK.modifierPressed(e);}if(proportional){if(abs(deltaX)>abs(deltaY)){height=round(width*ratio);width=round(height/ratio);}else{width=round(height/ratio);height=round(width*ratio);}}setGhostElmSize(selectedElmGhost,width,height);resizeHelperX=selectedHandle.startPos.x+deltaX;resizeHelperY=selectedHandle.startPos.y+deltaY;resizeHelperX=resizeHelperX>0?resizeHelperX:0;resizeHelperY=resizeHelperY>0?resizeHelperY:0;dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:'block'});resizeHelper.innerHTML=width+' &times; '+height;if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width){dom.setStyle(selectedElmGhost,'left',selectedElmX+(startW-width));}if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height){dom.setStyle(selectedElmGhost,'top',selectedElmY+(startH-height));}deltaX=rootElement.scrollWidth-startScrollWidth;deltaY=rootElement.scrollHeight-startScrollHeight;if(deltaX+deltaY!==0){dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY});}if(!resizeStarted){fireObjectResizeStart(editor,selectedElm,startW,startH,'corner-'+selectedHandle.name);resizeStarted=true;}};var endGhostResize=function endGhostResize(){var wasResizeStarted=resizeStarted;resizeStarted=false;var setSizeProp=function setSizeProp(name,value){if(value){if(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)){dom.setStyle(getResizeTarget(selectedElm),name,value);}else{dom.setAttrib(getResizeTarget(selectedElm),name,''+value);}}};if(wasResizeStarted){setSizeProp('width',width);setSizeProp('height',height);}dom.unbind(editableDoc,'mousemove',resizeGhostElement);dom.unbind(editableDoc,'mouseup',endGhostResize);if(rootDocument!==editableDoc){dom.unbind(rootDocument,'mousemove',resizeGhostElement);dom.unbind(rootDocument,'mouseup',endGhostResize);}dom.remove(selectedElmGhost);dom.remove(resizeHelper);showResizeRect(selectedElm);if(wasResizeStarted){fireObjectResized(editor,selectedElm,width,height,'corner-'+selectedHandle.name);dom.setAttrib(selectedElm,'style',dom.getAttrib(selectedElm,'style'));}editor.nodeChanged();};var showResizeRect=function showResizeRect(targetElm){hideResizeRect();unbindResizeHandleEvents();var position=dom.getPos(targetElm,rootElement);var selectedElmX=position.x;var selectedElmY=position.y;var rect=targetElm.getBoundingClientRect();var targetWidth=rect.width||rect.right-rect.left;var targetHeight=rect.height||rect.bottom-rect.top;if(selectedElm!==targetElm){selectedElm=targetElm;width=height=0;}var e=editor.fire('ObjectSelected',{target:targetElm});if(isResizable(targetElm)&&!e.isDefaultPrevented()){each(resizeHandles,function(handle,name){var handleElm;var startDrag=function startDrag(e){startX=e.screenX;startY=e.screenY;startW=getResizeTarget(selectedElm).clientWidth;startH=getResizeTarget(selectedElm).clientHeight;ratio=startH/startW;selectedHandle=handle;selectedHandle.name=name;selectedHandle.startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY};startScrollWidth=rootElement.scrollWidth;startScrollHeight=rootElement.scrollHeight;selectedElmGhost=selectedElm.cloneNode(true);dom.addClass(selectedElmGhost,'mce-clonedresizable');dom.setAttrib(selectedElmGhost,'data-mce-bogus','all');selectedElmGhost.contentEditable=false;selectedElmGhost.unSelectabe=true;dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});setGhostElmSize(selectedElmGhost,targetWidth,targetHeight);selectedElmGhost.removeAttribute('data-mce-selected');rootElement.appendChild(selectedElmGhost);dom.bind(editableDoc,'mousemove',resizeGhostElement);dom.bind(editableDoc,'mouseup',endGhostResize);if(rootDocument!==editableDoc){dom.bind(rootDocument,'mousemove',resizeGhostElement);dom.bind(rootDocument,'mouseup',endGhostResize);}resizeHelper=dom.add(rootElement,'div',{'class':'mce-resize-helper','data-mce-bogus':'all'},startW+' &times; '+startH);};handleElm=dom.get('mceResizeHandle'+name);if(handleElm){dom.remove(handleElm);}handleElm=dom.add(rootElement,'div',{'id':'mceResizeHandle'+name,'data-mce-bogus':'all','class':'mce-resizehandle','unselectable':true,'style':'cursor:'+name+'-resize; margin:0; padding:0'});if(Env.ie===11){handleElm.contentEditable=false;}dom.bind(handleElm,'mousedown',function(e){e.stopImmediatePropagation();e.preventDefault();startDrag(e);});handle.elm=handleElm;dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2});});}else{hideResizeRect();}selectedElm.setAttribute('data-mce-selected','1');};var hideResizeRect=function hideResizeRect(){unbindResizeHandleEvents();if(selectedElm){selectedElm.removeAttribute('data-mce-selected');}each$1(resizeHandles,function(value,name){var handleElm=dom.get('mceResizeHandle'+name);if(handleElm){dom.unbind(handleElm);dom.remove(handleElm);}});};var updateResizeRect=function updateResizeRect(e){var startElm,controlElm;var isChildOrEqual=function isChildOrEqual(node,parent){if(node){do{if(node===parent){return true;}}while(node=node.parentNode);}};if(resizeStarted||editor.removed){return;}each(dom.select('img[data-mce-selected],hr[data-mce-selected]'),function(img){img.removeAttribute('data-mce-selected');});controlElm=e.type==='mousedown'?e.target:selection.getNode();controlElm=dom.$(controlElm).closest('table,img,figure.image,hr')[0];if(isChildOrEqual(controlElm,rootElement)){disableGeckoResize();startElm=selection.getStart(true);if(isChildOrEqual(startElm,controlElm)&&isChildOrEqual(selection.getEnd(true),controlElm)){showResizeRect(controlElm);return;}}hideResizeRect();};var isWithinContentEditableFalse=function isWithinContentEditableFalse(elm){return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(),elm));};var unbindResizeHandleEvents=function unbindResizeHandleEvents(){each$1(resizeHandles,function(handle){if(handle.elm){dom.unbind(handle.elm);delete handle.elm;}});};var disableGeckoResize=function disableGeckoResize(){try{editor.getDoc().execCommand('enableObjectResizing',false,'false');}catch(ex){}};editor.on('init',function(){disableGeckoResize();if(Env.browser.isIE()||Env.browser.isEdge()){editor.on('mousedown click',function(e){var target=e.target,nodeName=target.nodeName;if(!resizeStarted&&/^(TABLE|IMG|HR)$/.test(nodeName)&&!isWithinContentEditableFalse(target)){if(e.button!==2){editor.selection.select(target,nodeName==='TABLE');}if(e.type==='mousedown'){editor.nodeChanged();}}});var handleMSControlSelect_1=function handleMSControlSelect_1(e){var delayedSelect=function delayedSelect(node){Delay.setEditorTimeout(editor,function(){return editor.selection.select(node);});};if(isWithinContentEditableFalse(e.target)||isMedia(e.target)){e.preventDefault();delayedSelect(e.target);return;}if(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)){e.preventDefault();if(e.target.tagName==='IMG'){delayedSelect(e.target);}}};dom.bind(rootElement,'mscontrolselect',handleMSControlSelect_1);editor.on('remove',function(){return dom.unbind(rootElement,'mscontrolselect',handleMSControlSelect_1);});}var throttledUpdateResizeRect=Delay.throttle(function(e){if(!editor.composing){updateResizeRect(e);}});editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged',throttledUpdateResizeRect);editor.on('keyup compositionend',function(e){if(selectedElm&&selectedElm.nodeName==='TABLE'){throttledUpdateResizeRect(e);}});editor.on('hide blur',hideResizeRect);editor.on('contextmenu longpress',contextMenuSelectImage,true);});editor.on('remove',unbindResizeHandleEvents);var destroy=function destroy(){selectedElm=selectedElmGhost=null;};return{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:destroy};};var hasCeProperty=function hasCeProperty(node){return isContentEditableTrue(node)||isContentEditableFalse(node);};var findParent=function findParent(node,rootNode,predicate){while(node&&node!==rootNode){if(predicate(node)){return node;}node=node.parentNode;}return null;};var findClosestIeRange=function findClosestIeRange(clientX,clientY,doc){var rects;var element=doc.elementFromPoint(clientX,clientY);var rng=doc.body.createTextRange();if(!element||element.tagName==='HTML'){element=doc.body;}rng.moveToElementText(element);rects=Tools.toArray(rng.getClientRects());rects=rects.sort(function(a,b){a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY));b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY));return a-b;});if(rects.length>0){clientY=(rects[0].bottom+rects[0].top)/2;try{rng.moveToPoint(clientX,clientY);rng.collapse(true);return rng;}catch(ex){}}return null;};var moveOutOfContentEditableFalse=function moveOutOfContentEditableFalse(rng,rootNode){var parentElement=rng&&rng.parentElement?rng.parentElement():null;return isContentEditableFalse(findParent(parentElement,rootNode,hasCeProperty))?null:rng;};var fromPoint$1=function fromPoint$1(clientX,clientY,doc){var rng,point;var pointDoc=doc;if(pointDoc.caretPositionFromPoint){point=pointDoc.caretPositionFromPoint(clientX,clientY);if(point){rng=doc.createRange();rng.setStart(point.offsetNode,point.offset);rng.collapse(true);}}else if(doc.caretRangeFromPoint){rng=doc.caretRangeFromPoint(clientX,clientY);}else if(pointDoc.body.createTextRange){rng=pointDoc.body.createTextRange();try{rng.moveToPoint(clientX,clientY);rng.collapse(true);}catch(ex){rng=findClosestIeRange(clientX,clientY,doc);}return moveOutOfContentEditableFalse(rng,doc.body);}return rng;};var isEq$1=function isEq$1(rng1,rng2){return rng1&&rng2&&rng1.startContainer===rng2.startContainer&&rng1.startOffset===rng2.startOffset&&rng1.endContainer===rng2.endContainer&&rng1.endOffset===rng2.endOffset;};var findParent$1=function findParent$1(node,rootNode,predicate){while(node&&node!==rootNode){if(predicate(node)){return node;}node=node.parentNode;}return null;};var hasParent=function hasParent(node,rootNode,predicate){return findParent$1(node,rootNode,predicate)!==null;};var hasParentWithName=function hasParentWithName(node,rootNode,name){return hasParent(node,rootNode,function(node){return node.nodeName===name;});};var isTable$3=function isTable$3(node){return node&&node.nodeName==='TABLE';};var isTableCell$3=function isTableCell$3(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName);};var isCeFalseCaretContainer=function isCeFalseCaretContainer(node,rootNode){return isCaretContainer(node)&&hasParent(node,rootNode,isCaretNode)===false;};var hasBrBeforeAfter=function hasBrBeforeAfter(dom,node,left){var walker=new DomTreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||dom.getRoot());while(node=walker[left?'prev':'next']()){if(isBr(node)){return true;}}};var isPrevNode=function isPrevNode(node,name){return node.previousSibling&&node.previousSibling.nodeName===name;};var hasContentEditableFalseParent=function hasContentEditableFalseParent(body,node){while(node&&node!==body){if(isContentEditableFalse(node)){return true;}node=node.parentNode;}return false;};var findTextNodeRelative=function findTextNodeRelative(dom,isAfterNode,collapsed,left,startNode){var lastInlineElement;var body=dom.getRoot();var node;var nonEmptyElementsMap=dom.schema.getNonEmptyElements();var parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body;if(left&&isBr(startNode)&&isAfterNode&&dom.isEmpty(parentBlockContainer)){return Optional.some(CaretPosition(startNode.parentNode,dom.nodeIndex(startNode)));}var walker=new DomTreeWalker(startNode,parentBlockContainer);while(node=walker[left?'prev':'next']()){if(dom.getContentEditableParent(node)==='false'||isCeFalseCaretContainer(node,body)){return Optional.none();}if(isText$1(node)&&node.nodeValue.length>0){if(hasParentWithName(node,body,'A')===false){return Optional.some(CaretPosition(node,left?node.nodeValue.length:0));}return Optional.none();}if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()]){return Optional.none();}lastInlineElement=node;}if(collapsed&&lastInlineElement){return Optional.some(CaretPosition(lastInlineElement,0));}return Optional.none();};var normalizeEndPoint=function normalizeEndPoint(dom,collapsed,start,rng){var container,offset;var body=dom.getRoot();var node;var directionLeft,normalized=false;container=rng[(start?'start':'end')+'Container'];offset=rng[(start?'start':'end')+'Offset'];var isAfterNode=isElement$1(container)&&offset===container.childNodes.length;var nonEmptyElementsMap=dom.schema.getNonEmptyElements();directionLeft=start;if(isCaretContainer(container)){return Optional.none();}if(isElement$1(container)&&offset>container.childNodes.length-1){directionLeft=false;}if(isDocument$1(container)){container=body;offset=0;}if(container===body){if(directionLeft){node=container.childNodes[offset>0?offset-1:0];if(node){if(isCaretContainer(node)){return Optional.none();}if(nonEmptyElementsMap[node.nodeName]||isTable$3(node)){return Optional.none();}}}if(container.hasChildNodes()){offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1);container=container.childNodes[offset];offset=isText$1(container)&&isAfterNode?container.data.length:0;if(!collapsed&&container===body.lastChild&&isTable$3(container)){return Optional.none();}if(hasContentEditableFalseParent(body,container)||isCaretContainer(container)){return Optional.none();}if(container.hasChildNodes()&&isTable$3(container)===false){node=container;var walker=new DomTreeWalker(container,body);do{if(isContentEditableFalse(node)||isCaretContainer(node)){normalized=false;break;}if(isText$1(node)&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length;container=node;normalized=true;break;}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell$3(node)){offset=dom.nodeIndex(node);container=node.parentNode;if(!directionLeft){offset++;}normalized=true;break;}}while(node=directionLeft?walker.next():walker.prev());}}}if(collapsed){if(isText$1(container)&&offset===0){findTextNodeRelative(dom,isAfterNode,collapsed,true,container).each(function(pos){container=pos.container();offset=pos.offset();normalized=true;});}if(isElement$1(container)){node=container.childNodes[offset];if(!node){node=container.childNodes[offset-1];}if(node&&isBr(node)&&!isPrevNode(node,'A')&&!hasBrBeforeAfter(dom,node,false)&&!hasBrBeforeAfter(dom,node,true)){findTextNodeRelative(dom,isAfterNode,collapsed,true,node).each(function(pos){container=pos.container();offset=pos.offset();normalized=true;});}}}if(directionLeft&&!collapsed&&isText$1(container)&&offset===container.nodeValue.length){findTextNodeRelative(dom,isAfterNode,collapsed,false,container).each(function(pos){container=pos.container();offset=pos.offset();normalized=true;});}return normalized?Optional.some(CaretPosition(container,offset)):Optional.none();};var normalize=function normalize(dom,rng){var collapsed=rng.collapsed,normRng=rng.cloneRange();var startPos=CaretPosition.fromRangeStart(rng);normalizeEndPoint(dom,collapsed,true,normRng).each(function(pos){if(!collapsed||!CaretPosition.isAbove(startPos,pos)){normRng.setStart(pos.container(),pos.offset());}});if(!collapsed){normalizeEndPoint(dom,collapsed,false,normRng).each(function(pos){normRng.setEnd(pos.container(),pos.offset());});}if(collapsed){normRng.collapse(true);}return isEq$1(rng,normRng)?Optional.none():Optional.some(normRng);};var splitText=function splitText(node,offset){return node.splitText(offset);};var split$1=function split$1(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(startContainer===endContainer&&isText$1(startContainer)){if(startOffset>0&&startOffset<startContainer.nodeValue.length){endContainer=splitText(startContainer,startOffset);startContainer=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;startContainer=endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0;}else{endOffset=0;}}}else{if(isText$1(startContainer)&&startOffset>0&&startOffset<startContainer.nodeValue.length){startContainer=splitText(startContainer,startOffset);startOffset=0;}if(isText$1(endContainer)&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;}}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset};};function RangeUtils(dom){var walk=function walk(rng,callback){return walk$1(dom,rng,callback);};var split=split$1;var normalize$1=function normalize$1(rng){return normalize(dom,rng).fold(never,function(normalizedRng){rng.setStart(normalizedRng.startContainer,normalizedRng.startOffset);rng.setEnd(normalizedRng.endContainer,normalizedRng.endOffset);return true;});};return{walk:walk,split:split,normalize:normalize$1};}(function(RangeUtils){RangeUtils.compareRanges=isEq$1;RangeUtils.getCaretRangeFromPoint=fromPoint$1;RangeUtils.getSelectedNode=getSelectedNode;RangeUtils.getNode=getNode;})(RangeUtils||(RangeUtils={}));var RangeUtils$1=RangeUtils;function Dimension(name,getOffset){var set=function set(element,h){if(!isNumber(h)&&!h.match(/^[0-9]+$/)){throw new Error(name+'.set accepts only positive integer values. Value was '+h);}var dom=element.dom;if(isSupported$1(dom)){dom.style[name]=h+'px';}};var get=function get(element){var r=getOffset(element);if(r<=0||r===null){var css=get$4(element,name);return parseFloat(css)||0;}return r;};var getOuter=get;var aggregate=function aggregate(element,properties){return foldl(properties,function(acc,property){var val=get$4(element,property);var value=val===undefined?0:parseInt(val,10);return isNaN(value)?acc:acc+value;},0);};var max=function max(element,value,properties){var cumulativeInclusions=aggregate(element,properties);var absoluteMax=value>cumulativeInclusions?value-cumulativeInclusions:0;return absoluteMax;};return{set:set,get:get,getOuter:getOuter,aggregate:aggregate,max:max};}var api$1=Dimension('height',function(element){var dom=element.dom;return inBody(element)?dom.getBoundingClientRect().height:dom.offsetHeight;});var get$8=function get$8(element){return api$1.get(element);};var walkUp=function walkUp(navigation,doc){var frame=navigation.view(doc);return frame.fold(constant([]),function(f){var parent=navigation.owner(f);var rest=walkUp(navigation,parent);return[f].concat(rest);});};var pathTo=function pathTo(element,navigation){var d=navigation.owner(element);return walkUp(navigation,d);};var view=function view(doc){var _a;var element=doc.dom===document?Optional.none():Optional.from((_a=doc.dom.defaultView)===null||_a===void 0?void 0:_a.frameElement);return element.map(SugarElement.fromDom);};var owner$1=function owner$1(element){return documentOrOwner(element);};var Navigation=/*#__PURE__*/Object.freeze({__proto__:null,view:view,owner:owner$1});var find$2=function find$2(element){var doc=SugarElement.fromDom(document);var scroll=get$1(doc);var frames=pathTo(element,Navigation);var offset=viewport(element);var r=foldr(frames,function(b,a){var loc=viewport(a);return{left:b.left+loc.left,top:b.top+loc.top};},{left:0,top:0});return SugarPosition(r.left+offset.left+scroll.left,r.top+offset.top+scroll.top);};var excludeFromDescend=function excludeFromDescend(element){return name(element)==='textarea';};var fireScrollIntoViewEvent=function fireScrollIntoViewEvent(editor,data){var scrollEvent=editor.fire('ScrollIntoView',data);return scrollEvent.isDefaultPrevented();};var fireAfterScrollIntoViewEvent=function fireAfterScrollIntoViewEvent(editor,data){editor.fire('AfterScrollIntoView',data);};var descend=function descend(element,offset){var children$1=children(element);if(children$1.length===0||excludeFromDescend(element)){return{element:element,offset:offset};}else if(offset<children$1.length&&!excludeFromDescend(children$1[offset])){return{element:children$1[offset],offset:0};}else{var last=children$1[children$1.length-1];if(excludeFromDescend(last)){return{element:element,offset:offset};}else{if(name(last)==='img'){return{element:last,offset:1};}else if(isText(last)){return{element:last,offset:get$7(last).length};}else{return{element:last,offset:children(last).length};}}}};var markerInfo=function markerInfo(element,cleanupFun){var pos=absolute(element);var height=get$8(element);return{element:element,bottom:pos.top+height,height:height,pos:pos,cleanup:cleanupFun};};var createMarker=function createMarker(element,offset){var startPoint=descend(element,offset);var span=SugarElement.fromHtml('<span data-mce-bogus="all">'+ZWSP+'</span>');before(startPoint.element,span);return markerInfo(span,function(){return remove(span);});};var elementMarker=function elementMarker(element){return markerInfo(SugarElement.fromDom(element),noop);};var withMarker=function withMarker(editor,f,rng,alignToTop){preserveWith(editor,function(_s,_e){return applyWithMarker(editor,f,rng,alignToTop);},rng);};var withScrollEvents=function withScrollEvents(editor,doc,f,marker,alignToTop){var data={elm:marker.element.dom,alignToTop:alignToTop};if(fireScrollIntoViewEvent(editor,data)){return;}var scrollTop=get$1(doc).top;f(doc,scrollTop,marker,alignToTop);fireAfterScrollIntoViewEvent(editor,data);};var applyWithMarker=function applyWithMarker(editor,f,rng,alignToTop){var body=SugarElement.fromDom(editor.getBody());var doc=SugarElement.fromDom(editor.getDoc());reflow(body);var marker=createMarker(SugarElement.fromDom(rng.startContainer),rng.startOffset);withScrollEvents(editor,doc,f,marker,alignToTop);marker.cleanup();};var withElement=function withElement(editor,element,f,alignToTop){var doc=SugarElement.fromDom(editor.getDoc());withScrollEvents(editor,doc,f,elementMarker(element),alignToTop);};var preserveWith=function preserveWith(editor,f,rng){var startElement=rng.startContainer;var startOffset=rng.startOffset;var endElement=rng.endContainer;var endOffset=rng.endOffset;f(SugarElement.fromDom(startElement),SugarElement.fromDom(endElement));var newRng=editor.dom.createRng();newRng.setStart(startElement,startOffset);newRng.setEnd(endElement,endOffset);editor.selection.setRng(rng);};var scrollToMarker=function scrollToMarker(marker,viewHeight,alignToTop,doc){var pos=marker.pos;if(alignToTop){to(pos.left,pos.top,doc);}else{var y=pos.top-viewHeight+marker.height;to(pos.left,y,doc);}};var intoWindowIfNeeded=function intoWindowIfNeeded(doc,scrollTop,viewHeight,marker,alignToTop){var viewportBottom=viewHeight+scrollTop;var markerTop=marker.pos.top;var markerBottom=marker.bottom;var largerThanViewport=markerBottom-markerTop>=viewHeight;if(markerTop<scrollTop){scrollToMarker(marker,viewHeight,alignToTop!==false,doc);}else if(markerTop>viewportBottom){var align=largerThanViewport?alignToTop!==false:alignToTop===true;scrollToMarker(marker,viewHeight,align,doc);}else if(markerBottom>viewportBottom&&!largerThanViewport){scrollToMarker(marker,viewHeight,alignToTop===true,doc);}};var intoWindow=function intoWindow(doc,scrollTop,marker,alignToTop){var viewHeight=doc.dom.defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,viewHeight,marker,alignToTop);};var intoFrame=function intoFrame(doc,scrollTop,marker,alignToTop){var frameViewHeight=doc.dom.defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,frameViewHeight,marker,alignToTop);var op=find$2(marker.element);var viewportBounds=getBounds(window);if(op.top<viewportBounds.y){intoView(marker.element,alignToTop!==false);}else if(op.top>viewportBounds.bottom){intoView(marker.element,alignToTop===true);}};var rangeIntoWindow=function rangeIntoWindow(editor,rng,alignToTop){return withMarker(editor,intoWindow,rng,alignToTop);};var elementIntoWindow=function elementIntoWindow(editor,element,alignToTop){return withElement(editor,element,intoWindow,alignToTop);};var rangeIntoFrame=function rangeIntoFrame(editor,rng,alignToTop){return withMarker(editor,intoFrame,rng,alignToTop);};var elementIntoFrame=function elementIntoFrame(editor,element,alignToTop){return withElement(editor,element,intoFrame,alignToTop);};var scrollElementIntoView=function scrollElementIntoView(editor,element,alignToTop){var scroller=editor.inline?elementIntoWindow:elementIntoFrame;scroller(editor,element,alignToTop);};var scrollRangeIntoView=function scrollRangeIntoView(editor,rng,alignToTop){var scroller=editor.inline?rangeIntoWindow:rangeIntoFrame;scroller(editor,rng,alignToTop);};var getDocument=function getDocument(){return SugarElement.fromDom(document);};var focus=function focus(element){return element.dom.focus();};var hasFocus=function hasFocus(element){var root=getRootNode(element).dom;return element.dom===root.activeElement;};var active=function active(root){if(root===void 0){root=getDocument();}return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);};var search=function search(element){return active(getRootNode(element)).filter(function(e){return element.dom.contains(e.dom);});};var create$4=function create$4(start,soffset,finish,foffset){return{start:start,soffset:soffset,finish:finish,foffset:foffset};};var SimRange={create:create$4};var adt=Adt.generate([{before:['element']},{on:['element','offset']},{after:['element']}]);var cata=function cata(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter);};var getStart=function getStart(situ){return situ.fold(identity,identity,identity);};var before$3=adt.before;var on=adt.on;var after$2=adt.after;var Situ={before:before$3,on:on,after:after$2,cata:cata,getStart:getStart};var adt$1=Adt.generate([{domRange:['rng']},{relative:['startSitu','finishSitu']},{exact:['start','soffset','finish','foffset']}]);var exactFromRange=function exactFromRange(simRange){return adt$1.exact(simRange.start,simRange.soffset,simRange.finish,simRange.foffset);};var getStart$1=function getStart$1(selection){return selection.match({domRange:function domRange(rng){return SugarElement.fromDom(rng.startContainer);},relative:function relative(startSitu,_finishSitu){return Situ.getStart(startSitu);},exact:function exact(start,_soffset,_finish,_foffset){return start;}});};var domRange=adt$1.domRange;var relative=adt$1.relative;var exact=adt$1.exact;var getWin=function getWin(selection){var start=getStart$1(selection);return defaultView(start);};var range=SimRange.create;var SimSelection={domRange:domRange,relative:relative,exact:exact,exactFromRange:exactFromRange,getWin:getWin,range:range};var browser$3=detect$3().browser;var clamp=function clamp(offset,element){var max=isText(element)?get$7(element).length:children(element).length+1;if(offset>max){return max;}else if(offset<0){return 0;}return offset;};var normalizeRng=function normalizeRng(rng){return SimSelection.range(rng.start,clamp(rng.soffset,rng.start),rng.finish,clamp(rng.foffset,rng.finish));};var isOrContains=function isOrContains(root,elm){return!isRestrictedNode(elm.dom)&&(contains$2(root,elm)||eq$2(root,elm));};var isRngInRoot=function isRngInRoot(root){return function(rng){return isOrContains(root,rng.start)&&isOrContains(root,rng.finish);};};var shouldStore=function shouldStore(editor){return editor.inline===true||browser$3.isIE();};var nativeRangeToSelectionRange=function nativeRangeToSelectionRange(r){return SimSelection.range(SugarElement.fromDom(r.startContainer),r.startOffset,SugarElement.fromDom(r.endContainer),r.endOffset);};var readRange=function readRange(win){var selection=win.getSelection();var rng=!selection||selection.rangeCount===0?Optional.none():Optional.from(selection.getRangeAt(0));return rng.map(nativeRangeToSelectionRange);};var getBookmark$2=function getBookmark$2(root){var win=defaultView(root);return readRange(win.dom).filter(isRngInRoot(root));};var validate=function validate(root,bookmark){return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);};var bookmarkToNativeRng=function bookmarkToNativeRng(bookmark){var rng=document.createRange();try{rng.setStart(bookmark.start.dom,bookmark.soffset);rng.setEnd(bookmark.finish.dom,bookmark.foffset);return Optional.some(rng);}catch(_){return Optional.none();}};var store=function store(editor){var newBookmark=shouldStore(editor)?getBookmark$2(SugarElement.fromDom(editor.getBody())):Optional.none();editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark;};var storeNative=function storeNative(editor,rng){var root=SugarElement.fromDom(editor.getBody());var range=shouldStore(editor)?Optional.from(rng):Optional.none();var newBookmark=range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark;};var getRng=function getRng(editor){var bookmark=editor.bookmark?editor.bookmark:Optional.none();return bookmark.bind(function(x){return validate(SugarElement.fromDom(editor.getBody()),x);}).bind(bookmarkToNativeRng);};var restore=function restore(editor){getRng(editor).each(function(rng){return editor.selection.setRng(rng);});};var isEditorUIElement=function isEditorUIElement(elm){var className=elm.className.toString();return className.indexOf('tox-')!==-1||className.indexOf('mce-')!==-1;};var FocusManager={isEditorUIElement:isEditorUIElement};var isManualNodeChange=function isManualNodeChange(e){return e.type==='nodechange'&&e.selectionChange;};var registerPageMouseUp=function registerPageMouseUp(editor,throttledStore){var mouseUpPage=function mouseUpPage(){throttledStore.throttle();};DOMUtils$1.DOM.bind(document,'mouseup',mouseUpPage);editor.on('remove',function(){DOMUtils$1.DOM.unbind(document,'mouseup',mouseUpPage);});};var registerFocusOut=function registerFocusOut(editor){editor.on('focusout',function(){store(editor);});};var registerMouseUp=function registerMouseUp(editor,throttledStore){editor.on('mouseup touchend',function(_e){throttledStore.throttle();});};var registerEditorEvents=function registerEditorEvents(editor,throttledStore){var browser=detect$3().browser;if(browser.isIE()){registerFocusOut(editor);}else{registerMouseUp(editor,throttledStore);}editor.on('keyup NodeChange',function(e){if(!isManualNodeChange(e)){store(editor);}});};var register=function register(editor){var throttledStore=first(function(){store(editor);},0);editor.on('init',function(){if(editor.inline){registerPageMouseUp(editor,throttledStore);}registerEditorEvents(editor,throttledStore);});editor.on('remove',function(){throttledStore.cancel();});};var documentFocusInHandler;var DOM$2=DOMUtils$1.DOM;var isEditorUIElement$1=function isEditorUIElement$1(elm){return FocusManager.isEditorUIElement(elm);};var isEditorContentAreaElement=function isEditorContentAreaElement(elm){var classList=elm.classList;if(classList!==undefined){return classList.contains('tox-edit-area')||classList.contains('tox-edit-area__iframe')||classList.contains('mce-content-body');}else{return false;}};var isUIElement=function isUIElement(editor,elm){var customSelector=getCustomUiSelector(editor);var parent=DOM$2.getParent(elm,function(elm){return isEditorUIElement$1(elm)||(customSelector?editor.dom.is(elm,customSelector):false);});return parent!==null;};var getActiveElement=function getActiveElement(editor){try{var root=getRootNode(SugarElement.fromDom(editor.getElement()));return active(root).fold(function(){return document.body;},function(x){return x.dom;});}catch(ex){return document.body;}};var registerEvents=function registerEvents(editorManager,e){var editor=e.editor;register(editor);editor.on('focusin',function(){var self=this;var focusedEditor=editorManager.focusedEditor;if(focusedEditor!==self){if(focusedEditor){focusedEditor.fire('blur',{focusedEditor:self});}editorManager.setActive(self);editorManager.focusedEditor=self;self.fire('focus',{blurredEditor:focusedEditor});self.focus(true);}});editor.on('focusout',function(){var self=this;Delay.setEditorTimeout(self,function(){var focusedEditor=editorManager.focusedEditor;if(!isUIElement(self,getActiveElement(self))&&focusedEditor===self){self.fire('blur',{focusedEditor:null});editorManager.focusedEditor=null;}});});if(!documentFocusInHandler){documentFocusInHandler=function documentFocusInHandler(e){var activeEditor=editorManager.activeEditor;if(activeEditor){getOriginalEventTarget(e).each(function(target){if(target.ownerDocument===document){if(target!==document.body&&!isUIElement(activeEditor,target)&&editorManager.focusedEditor===activeEditor){activeEditor.fire('blur',{focusedEditor:null});editorManager.focusedEditor=null;}}});}};DOM$2.bind(document,'focusin',documentFocusInHandler);}};var unregisterDocumentEvents=function unregisterDocumentEvents(editorManager,e){if(editorManager.focusedEditor===e.editor){editorManager.focusedEditor=null;}if(!editorManager.activeEditor){DOM$2.unbind(document,'focusin',documentFocusInHandler);documentFocusInHandler=null;}};var setup$2=function setup$2(editorManager){editorManager.on('AddEditor',curry(registerEvents,editorManager));editorManager.on('RemoveEditor',curry(unregisterDocumentEvents,editorManager));};var getContentEditableHost=function getContentEditableHost(editor,node){return editor.dom.getParent(node,function(node){return editor.dom.getContentEditable(node)==='true';});};var getCollapsedNode=function getCollapsedNode(rng){return rng.collapsed?Optional.from(getNode(rng.startContainer,rng.startOffset)).map(SugarElement.fromDom):Optional.none();};var getFocusInElement=function getFocusInElement(root,rng){return getCollapsedNode(rng).bind(function(node){if(isTableSection(node)){return Optional.some(node);}else if(contains$2(root,node)===false){return Optional.some(root);}else{return Optional.none();}});};var normalizeSelection=function normalizeSelection(editor,rng){getFocusInElement(SugarElement.fromDom(editor.getBody()),rng).bind(function(elm){return firstPositionIn(elm.dom);}).fold(function(){editor.selection.normalize();return;},function(caretPos){return editor.selection.setRng(caretPos.toRange());});};var focusBody=function focusBody(body){if(body.setActive){try{body.setActive();}catch(ex){body.focus();}}else{body.focus();}};var hasElementFocus=function hasElementFocus(elm){return hasFocus(elm)||search(elm).isSome();};var hasIframeFocus=function hasIframeFocus(editor){return editor.iframeElement&&hasFocus(SugarElement.fromDom(editor.iframeElement));};var hasInlineFocus=function hasInlineFocus(editor){var rawBody=editor.getBody();return rawBody&&hasElementFocus(SugarElement.fromDom(rawBody));};var hasUiFocus=function hasUiFocus(editor){return active().filter(function(elem){return!isEditorContentAreaElement(elem.dom)&&isUIElement(editor,elem.dom);}).isSome();};var hasFocus$1=function hasFocus$1(editor){return editor.inline?hasInlineFocus(editor):hasIframeFocus(editor);};var hasEditorOrUiFocus=function hasEditorOrUiFocus(editor){return hasFocus$1(editor)||hasUiFocus(editor);};var focusEditor=function focusEditor(editor){var selection=editor.selection;var body=editor.getBody();var rng=selection.getRng();editor.quirks.refreshContentEditable();if(editor.bookmark!==undefined&&hasFocus$1(editor)===false){getRng(editor).each(function(bookmarkRng){editor.selection.setRng(bookmarkRng);rng=bookmarkRng;});}var contentEditableHost=getContentEditableHost(editor,selection.getNode());if(editor.$.contains(body,contentEditableHost)){focusBody(contentEditableHost);normalizeSelection(editor,rng);activateEditor(editor);return;}if(!editor.inline){if(!Env.opera){focusBody(body);}editor.getWin().focus();}if(Env.gecko||editor.inline){focusBody(body);normalizeSelection(editor,rng);}activateEditor(editor);};var activateEditor=function activateEditor(editor){return editor.editorManager.setActive(editor);};var focus$1=function focus$1(editor,skipFocus){if(editor.removed){return;}skipFocus?activateEditor(editor):focusEditor(editor);};var getEndpointElement=function getEndpointElement(root,rng,start,real,resolve){var container=start?rng.startContainer:rng.endContainer;var offset=start?rng.startOffset:rng.endOffset;return Optional.from(container).map(SugarElement.fromDom).map(function(elm){return!real||!rng.collapsed?child(elm,resolve(elm,offset)).getOr(elm):elm;}).bind(function(elm){return isElement(elm)?Optional.some(elm):parent(elm).filter(isElement);}).map(function(elm){return elm.dom;}).getOr(root);};var getStart$2=function getStart$2(root,rng,real){return getEndpointElement(root,rng,true,real,function(elm,offset){return Math.min(childNodesCount(elm),offset);});};var getEnd=function getEnd(root,rng,real){return getEndpointElement(root,rng,false,real,function(elm,offset){return offset>0?offset-1:offset;});};var skipEmptyTextNodes=function skipEmptyTextNodes(node,forwards){var orig=node;while(node&&isText$1(node)&&node.length===0){node=forwards?node.nextSibling:node.previousSibling;}return node||orig;};var getNode$1=function getNode$1(root,rng){var elm,startContainer,endContainer;if(!rng){return root;}startContainer=rng.startContainer;endContainer=rng.endContainer;var startOffset=rng.startOffset;var endOffset=rng.endOffset;elm=rng.commonAncestorContainer;if(!rng.collapsed){if(startContainer===endContainer){if(endOffset-startOffset<2){if(startContainer.hasChildNodes()){elm=startContainer.childNodes[startOffset];}}}if(startContainer.nodeType===3&&endContainer.nodeType===3){if(startContainer.length===startOffset){startContainer=skipEmptyTextNodes(startContainer.nextSibling,true);}else{startContainer=startContainer.parentNode;}if(endOffset===0){endContainer=skipEmptyTextNodes(endContainer.previousSibling,false);}else{endContainer=endContainer.parentNode;}if(startContainer&&startContainer===endContainer){return startContainer;}}}if(elm&&elm.nodeType===3){return elm.parentNode;}return elm;};var getSelectedBlocks=function getSelectedBlocks(dom,rng,startElm,endElm){var node;var selectedBlocks=[];var root=dom.getRoot();startElm=dom.getParent(startElm||getStart$2(root,rng,rng.collapsed),dom.isBlock);endElm=dom.getParent(endElm||getEnd(root,rng,rng.collapsed),dom.isBlock);if(startElm&&startElm!==root){selectedBlocks.push(startElm);}if(startElm&&endElm&&startElm!==endElm){node=startElm;var walker=new DomTreeWalker(startElm,root);while((node=walker.next())&&node!==endElm){if(dom.isBlock(node)){selectedBlocks.push(node);}}}if(endElm&&startElm!==endElm&&endElm!==root){selectedBlocks.push(endElm);}return selectedBlocks;};var select$1=function select$1(dom,node,content){return Optional.from(node).map(function(node){var idx=dom.nodeIndex(node);var rng=dom.createRng();rng.setStart(node.parentNode,idx);rng.setEnd(node.parentNode,idx+1);if(content){moveEndPoint$1(dom,rng,node,true);moveEndPoint$1(dom,rng,node,false);}return rng;});};var processRanges=function processRanges(editor,ranges){return map(ranges,function(range){var evt=editor.fire('GetSelectionRange',{range:range});return evt.range!==range?evt.range:range;});};var typeLookup={'#text':3,'#comment':8,'#cdata':4,'#pi':7,'#doctype':10,'#document-fragment':11};var walk$2=function walk$2(node,root,prev){var startName=prev?'lastChild':'firstChild';var siblingName=prev?'prev':'next';if(node[startName]){return node[startName];}if(node!==root){var sibling=node[siblingName];if(sibling){return sibling;}for(var parent_1=node.parent;parent_1&&parent_1!==root;parent_1=parent_1.parent){sibling=parent_1[siblingName];if(sibling){return sibling;}}}};var isEmptyTextNode$1=function isEmptyTextNode$1(node){if(!isWhitespaceText(node.value)){return false;}var parentNode=node.parent;if(parentNode&&(parentNode.name!=='span'||parentNode.attr('style'))&&/^[ ]+$/.test(node.value)){return false;}return true;};var isNonEmptyElement=function isNonEmptyElement(node){var isNamedAnchor=node.name==='a'&&!node.attr('href')&&node.attr('id');return node.attr('name')||node.attr('id')&&!node.firstChild||node.attr('data-mce-bookmark')||isNamedAnchor;};var AstNode=function(){function AstNode(name,type){this.name=name;this.type=type;if(type===1){this.attributes=[];this.attributes.map={};}}AstNode.create=function(name,attrs){var node=new AstNode(name,typeLookup[name]||1);if(attrs){each$1(attrs,function(value,attrName){node.attr(attrName,value);});}return node;};AstNode.prototype.replace=function(node){var self=this;if(node.parent){node.remove();}self.insert(node,self);self.remove();return self;};AstNode.prototype.attr=function(name,value){var self=this;var attrs;if(typeof name!=='string'){if(name!==undefined&&name!==null){each$1(name,function(value,key){self.attr(key,value);});}return self;}if(attrs=self.attributes){if(value!==undefined){if(value===null){if(name in attrs.map){delete attrs.map[name];var i=attrs.length;while(i--){if(attrs[i].name===name){attrs.splice(i,1);return self;}}}return self;}if(name in attrs.map){var i=attrs.length;while(i--){if(attrs[i].name===name){attrs[i].value=value;break;}}}else{attrs.push({name:name,value:value});}attrs.map[name]=value;return self;}return attrs.map[name];}};AstNode.prototype.clone=function(){var self=this;var clone=new AstNode(self.name,self.type);var selfAttrs;if(selfAttrs=self.attributes){var cloneAttrs=[];cloneAttrs.map={};for(var i=0,l=selfAttrs.length;i<l;i++){var selfAttr=selfAttrs[i];if(selfAttr.name!=='id'){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value;}}clone.attributes=cloneAttrs;}clone.value=self.value;clone.shortEnded=self.shortEnded;return clone;};AstNode.prototype.wrap=function(wrapper){var self=this;self.parent.insert(wrapper,self);wrapper.append(self);return self;};AstNode.prototype.unwrap=function(){var self=this;for(var node=self.firstChild;node;){var next=node.next;self.insert(node,self,true);node=next;}self.remove();};AstNode.prototype.remove=function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;if(parent){if(parent.firstChild===self){parent.firstChild=next;if(next){next.prev=null;}}else{prev.next=next;}if(parent.lastChild===self){parent.lastChild=prev;if(prev){prev.next=null;}}else{next.prev=prev;}self.parent=self.next=self.prev=null;}return self;};AstNode.prototype.append=function(node){var self=this;if(node.parent){node.remove();}var last=self.lastChild;if(last){last.next=node;node.prev=last;self.lastChild=node;}else{self.lastChild=self.firstChild=node;}node.parent=self;return node;};AstNode.prototype.insert=function(node,refNode,before){if(node.parent){node.remove();}var parent=refNode.parent||this;if(before){if(refNode===parent.firstChild){parent.firstChild=node;}else{refNode.prev.next=node;}node.prev=refNode.prev;node.next=refNode;refNode.prev=node;}else{if(refNode===parent.lastChild){parent.lastChild=node;}else{refNode.next.prev=node;}node.next=refNode.next;node.prev=refNode;refNode.next=node;}node.parent=parent;return node;};AstNode.prototype.getAll=function(name){var self=this;var collection=[];for(var node=self.firstChild;node;node=walk$2(node,self)){if(node.name===name){collection.push(node);}}return collection;};AstNode.prototype.empty=function(){var self=this;if(self.firstChild){var nodes=[];for(var node=self.firstChild;node;node=walk$2(node,self)){nodes.push(node);}var i=nodes.length;while(i--){var node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null;}}self.firstChild=self.lastChild=null;return self;};AstNode.prototype.isEmpty=function(elements,whitespace,predicate){if(whitespace===void 0){whitespace={};}var self=this;var node=self.firstChild;if(isNonEmptyElement(self)){return false;}if(node){do{if(node.type===1){if(node.attr('data-mce-bogus')){continue;}if(elements[node.name]){return false;}if(isNonEmptyElement(node)){return false;}}if(node.type===8){return false;}if(node.type===3&&!isEmptyTextNode$1(node)){return false;}if(node.type===3&&node.parent&&whitespace[node.parent.name]&&isWhitespaceText(node.value)){return false;}if(predicate&&predicate(node)){return false;}}while(node=walk$2(node,self));}return true;};AstNode.prototype.walk=function(prev){return walk$2(this,null,prev);};return AstNode;}();var makeMap$3=Tools.makeMap;var Writer=function Writer(settings){var html=[];settings=settings||{};var indent=settings.indent;var indentBefore=makeMap$3(settings.indent_before||'');var indentAfter=makeMap$3(settings.indent_after||'');var encode=Entities.getEncodeFunc(settings.entity_encoding||'raw',settings.entities);var htmlOutput=settings.element_format==='html';return{start:function start(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=='\n'){html.push('\n');}}html.push('<',name);if(attrs){for(i=0,l=attrs.length;i<l;i++){attr=attrs[i];html.push(' ',attr.name,'="',encode(attr.value,true),'"');}}if(!empty||htmlOutput){html[html.length]='>';}else{html[html.length]=' />';}if(empty&&indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=='\n'){html.push('\n');}}},end:function end(name){var value;html.push('</',name,'>');if(indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=='\n'){html.push('\n');}}},text:function text(_text,raw){if(_text.length>0){html[html.length]=raw?_text:encode(_text);}},cdata:function cdata(text){html.push('<![CDATA[',text,']]>');},comment:function comment(text){html.push('<!--',text,'-->');},pi:function pi(name,text){if(text){html.push('<?',name,' ',encode(text),'?>');}else{html.push('<?',name,'?>');}if(indent){html.push('\n');}},doctype:function doctype(text){html.push('<!DOCTYPE',text,'>',indent?'\n':'');},reset:function reset(){html.length=0;},getContent:function getContent(){return html.join('').replace(/\n$/,'');}};};var HtmlSerializer=function HtmlSerializer(settings,schema){if(schema===void 0){schema=Schema();}var writer=Writer(settings);settings=settings||{};settings.validate='validate'in settings?settings.validate:true;var serialize=function serialize(node){var validate=settings.validate;var handlers={3:function _(node){writer.text(node.value,node.raw);},8:function _(node){writer.comment(node.value);},7:function _(node){writer.pi(node.name,node.value);},10:function _(node){writer.doctype(node.value);},4:function _(node){writer.cdata(node.value);},11:function _(node){if(node=node.firstChild){do{walk(node);}while(node=node.next);}}};writer.reset();var walk=function walk(node){var handler=handlers[node.type];var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!handler){name=node.name;isEmpty=node.shortEnded;attrs=node.attributes;if(validate&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=schema.getElementRule(node.name);if(elementRule){for(i=0,l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue});}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue});}}attrs=sortedAttrs;}}writer.start(node.name,attrs,isEmpty);if(!isEmpty){if(node=node.firstChild){do{walk(node);}while(node=node.next);}writer.end(name);}}else{handler(node);}};if(node.type===1&&!settings.inner){walk(node);}else{handlers[11](node);}return writer.getContent();};return{serialize:serialize};};var extractBase64DataUris=function extractBase64DataUris(html){var dataImageUri=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi;var chunks=[];var uris={};var prefix=generate$1('img');var matches;var index=0;var count=0;while(matches=dataImageUri.exec(html)){var uri=matches[0];var imageId=prefix+'_'+count++;uris[imageId]=uri;if(index<matches.index){chunks.push(html.substr(index,matches.index-index));}chunks.push(imageId);index=matches.index+uri.length;}if(index===0){return{prefix:prefix,uris:uris,html:html};}else{if(index<html.length){chunks.push(html.substr(index));}return{prefix:prefix,uris:uris,html:chunks.join('')};}};var restoreDataUris=function restoreDataUris(html,result){return html.replace(new RegExp(result.prefix+'_[0-9]+','g'),function(imageId){return get(result.uris,imageId).getOr(imageId);});};var parseDataUri=function parseDataUri(uri){var matches=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(uri);if(matches){return Optional.some({type:matches[1],data:decodeURIComponent(matches[2])});}else{return Optional.none();}};var isValidPrefixAttrName=function isValidPrefixAttrName(name){return name.indexOf('data-')===0||name.indexOf('aria-')===0;};var isInvalidUri=function isInvalidUri(settings,uri){if(settings.allow_html_data_urls){return false;}else if(/^data:image\//i.test(uri)){return settings.allow_svg_data_urls===false&&/^data:image\/svg\+xml/i.test(uri);}else{return /^data:/i.test(uri);}};var findEndTagIndex=function findEndTagIndex(schema,html,startIndex){var count=1,index,matches;var shortEndedElements=schema.getShortEndedElements();var tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;tokenRegExp.lastIndex=index=startIndex;while(matches=tokenRegExp.exec(html)){index=tokenRegExp.lastIndex;if(matches[1]==='/'){count--;}else if(!matches[1]){if(matches[2]in shortEndedElements){continue;}count++;}if(count===0){break;}}return index;};var isConditionalComment=function isConditionalComment(html,startIndex){return /^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(html.substr(startIndex));};var findCommentEndIndex=function findCommentEndIndex(html,isBogus,startIndex){if(startIndex===void 0){startIndex=0;}var lcHtml=html.toLowerCase();if(lcHtml.indexOf('[if ',startIndex)!==-1&&isConditionalComment(lcHtml,startIndex)){var endIfIndex=lcHtml.indexOf('[endif]',startIndex);return lcHtml.indexOf('>',endIfIndex);}else{if(isBogus){var endIndex=lcHtml.indexOf('>',startIndex);return endIndex!==-1?endIndex:lcHtml.length;}else{var endCommentRegexp=/--!?>/;endCommentRegexp.lastIndex=startIndex;var match=endCommentRegexp.exec(html);return match?match.index+match[0].length:lcHtml.length;}}};var checkBogusAttribute=function checkBogusAttribute(regExp,attrString){var matches=regExp.exec(attrString);if(matches){var name_1=matches[1];var value=matches[2];return typeof name_1==='string'&&name_1.toLowerCase()==='data-mce-bogus'?value:null;}else{return null;}};function SaxParser(settings,schema){if(schema===void 0){schema=Schema();}var noop=function noop(){};settings=settings||{};if(settings.fix_self_closing!==false){settings.fix_self_closing=true;}var comment=settings.comment?settings.comment:noop;var cdata=settings.cdata?settings.cdata:noop;var text=settings.text?settings.text:noop;var start=settings.start?settings.start:noop;var end=settings.end?settings.end:noop;var pi=settings.pi?settings.pi:noop;var doctype=settings.doctype?settings.doctype:noop;var parseInternal=function parseInternal(base64Extract,format){if(format===void 0){format='html';}var html=base64Extract.html;var matches,index=0,value,endRegExp;var stack=[];var attrList,i,textData,name;var isInternalElement,isShortEnded;var elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns;var attributesRequired,attributesDefault,attributesForced;var anyAttributesRequired,attrValue,idCount=0;var decode=Entities.decode;var filteredUrlAttrs=Tools.makeMap('src,href,data,background,formaction,poster,xlink:href');var scriptUriRegExp=/((java|vb)script|mhtml):/i;var parsingMode=format==='html'?0:1;var processEndTag=function processEndTag(name){var pos,i;pos=stack.length;while(pos--){if(stack[pos].name===name){break;}}if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid){end(name.name);}}stack.length=pos;}};var processText=function processText(value,raw){return text(restoreDataUris(value,base64Extract),raw);};var processComment=function processComment(value){if(value===''){return;}if(value.charAt(0)==='>'){value=' '+value;}if(!settings.allow_conditional_comments&&value.substr(0,3).toLowerCase()==='[if'){value=' '+value;}comment(restoreDataUris(value,base64Extract));};var processAttr=function processAttr(value){return get(base64Extract.uris,value).getOr(value);};var processMalformedComment=function processMalformedComment(value,startIndex){var startTag=value||'';var isBogus=!startsWith(startTag,'--');var endIndex=findCommentEndIndex(html,isBogus,startIndex);value=html.substr(startIndex,endIndex-startIndex);processComment(isBogus?startTag+value:value);return endIndex+1;};var parseAttribute=function parseAttribute(match,name,value,val2,val3){var attrRule,i;var trimRegExp=/[\s\u0000-\u001F]+/g;name=name.toLowerCase();value=processAttr(name in fillAttrsMap?name:decode(value||val2||val3||''));if(validate&&!isInternalElement&&isValidPrefixAttrName(name)===false){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name)){break;}}if(i===-1){attrRule=null;}}if(!attrRule){return;}if(attrRule.validValues&&!(value in attrRule.validValues)){return;}}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,'');try{uri=decodeURIComponent(uri);}catch(ex){uri=unescape(uri);}if(scriptUriRegExp.test(uri)){return;}if(isInvalidUri(settings,uri)){return;}}if(isInternalElement&&(name in filteredUrlAttrs||name.indexOf('on')===0)){return;}attrList.map[name]=value;attrList.push({name:name,value:value});};var tokenRegExp=new RegExp('<(?:'+'(?:!--([\\w\\W]*?)--!?>)|'+'(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|'+'(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|'+'(?:!(--)?)|'+'(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|'+'(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|'+'(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\\/|\\s+)>)'+')','g');var attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;var shortEndedElements=schema.getShortEndedElements();var selfClosing=settings.self_closing_elements||schema.getSelfClosingElements();var fillAttrsMap=schema.getBoolAttrs();var validate=settings.validate;var removeInternalElements=settings.remove_internals;var fixSelfClosing=settings.fix_self_closing;var specialElements=schema.getSpecialElements();var processHtml=html+'>';while(matches=tokenRegExp.exec(processHtml)){var matchText=matches[0];if(index<matches.index){processText(decode(html.substr(index,matches.index-index)));}if(value=matches[7]){value=value.toLowerCase();if(value.charAt(0)===':'){value=value.substr(1);}processEndTag(value);}else if(value=matches[8]){if(matches.index+matchText.length>html.length){processText(decode(html.substr(matches.index)));index=matches.index+matchText.length;continue;}value=value.toLowerCase();if(value.charAt(0)===':'){value=value.substr(1);}isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value){processEndTag(value);}var bogusValue=checkBogusAttribute(attrRegExp,matches[9]);if(bogusValue!==null){if(bogusValue==='all'){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex);tokenRegExp.lastIndex=index;continue;}isValidElement=false;}if(!validate||(elementRule=schema.getElementRule(value))){isValidElement=true;if(validate){validAttributesMap=elementRule.attributes;validAttributePatterns=elementRule.attributePatterns;}if(attribsValue=matches[9]){isInternalElement=attribsValue.indexOf('data-mce-type')!==-1;if(isInternalElement&&removeInternalElements){isValidElement=false;}attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute);}else{attrList=[];attrList.map={};}if(validate&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;anyAttributesRequired=elementRule.removeEmptyAttrs;if(anyAttributesRequired&&!attrList.length){isValidElement=false;}if(attributesForced){i=attributesForced.length;while(i--){attr=attributesForced[i];name=attr.name;attrValue=attr.value;if(attrValue==='{$uid}'){attrValue='mce_'+idCount++;}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue});}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];name=attr.name;if(!(name in attrList.map)){attrValue=attr.value;if(attrValue==='{$uid}'){attrValue='mce_'+idCount++;}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue});}}}if(attributesRequired){i=attributesRequired.length;while(i--){if(attributesRequired[i]in attrList.map){break;}}if(i===-1){isValidElement=false;}}if(attr=attrList.map['data-mce-bogus']){if(attr==='all'){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex);tokenRegExp.lastIndex=index;continue;}isValidElement=false;}}if(isValidElement){start(value,attrList,isShortEnded);}}else{isValidElement=false;}if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matchText.length;if(matches=endRegExp.exec(html)){if(isValidElement){textData=html.substr(index,matches.index-index);}index=matches.index+matches[0].length;}else{textData=html.substr(index);index=html.length;}if(isValidElement){if(textData.length>0){processText(textData,true);}end(value);}tokenRegExp.lastIndex=index;continue;}if(!isShortEnded){if(!attribsValue||attribsValue.indexOf('/')!==attribsValue.length-1){stack.push({name:value,valid:isValidElement});}else if(isValidElement){end(value);}}}else if(value=matches[1]){processComment(value);}else if(value=matches[2]){var isValidCdataSection=parsingMode===1||settings.preserve_cdata||stack.length>0&&schema.isValidChild(stack[stack.length-1].name,'#cdata');if(isValidCdataSection){cdata(value);}else{index=processMalformedComment('',matches.index+2);tokenRegExp.lastIndex=index;continue;}}else if(value=matches[3]){doctype(value);}else if((value=matches[4])||matchText==='<!'){index=processMalformedComment(value,matches.index+matchText.length);tokenRegExp.lastIndex=index;continue;}else if(value=matches[5]){if(parsingMode===1){pi(value,matches[6]);}else{index=processMalformedComment('?',matches.index+2);tokenRegExp.lastIndex=index;continue;}}index=matches.index+matchText.length;}if(index<html.length){processText(decode(html.substr(index)));}for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid){end(value.name);}}};var parse=function parse(html,format){if(format===void 0){format='html';}parseInternal(extractBase64DataUris(html),format);};return{parse:parse};}(function(SaxParser){SaxParser.findEndTag=findEndTagIndex;})(SaxParser||(SaxParser={}));var SaxParser$1=SaxParser;var trimHtml=function trimHtml(tempAttrs,html){var trimContentRegExp=new RegExp(['\\s?('+tempAttrs.join('|')+')="[^"]+"'].join('|'),'gi');return html.replace(trimContentRegExp,'');};var trimInternal=function trimInternal(serializer,html){var content=html;var bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g;var endTagIndex,index,matchLength,matches;var schema=serializer.schema;content=trimHtml(serializer.getTempAttrs(),content);var shortEndedElements=schema.getShortEndedElements();while(matches=bogusAllRegExp.exec(content)){index=bogusAllRegExp.lastIndex;matchLength=matches[0].length;if(shortEndedElements[matches[1]]){endTagIndex=index;}else{endTagIndex=SaxParser$1.findEndTag(schema,content,index);}content=content.substring(0,index-matchLength)+content.substring(endTagIndex);bogusAllRegExp.lastIndex=index-matchLength;}return trim$2(content);};var trimExternal=trimInternal;var trimEmptyContents=function trimEmptyContents(editor,html){var blockName=getForcedRootBlock(editor);var emptyRegExp=new RegExp('^(<'+blockName+'[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/'+blockName+'>[\r\n]*|<br \\/>[\r\n]*)$');return html.replace(emptyRegExp,'');};var getContentFromBody=function getContentFromBody(editor,args,format,body){var content;args.format=format;args.get=true;args.getInner=true;if(!args.no_events){editor.fire('BeforeGetContent',args);}if(args.format==='raw'){content=Tools.trim(trimExternal(editor.serializer,body.innerHTML));}else if(args.format==='text'){content=trim$2(body.innerText||body.textContent);}else if(args.format==='tree'){return editor.serializer.serialize(body,args);}else{content=trimEmptyContents(editor,editor.serializer.serialize(body,args));}if(args.format!=='text'&&!isWsPreserveElement(SugarElement.fromDom(body))){args.content=Tools.trim(content);}else{args.content=content;}if(!args.no_events){editor.fire('GetContent',args);}return args.content;};var getContentInternal=function getContentInternal(editor,args,format){return Optional.from(editor.getBody()).fold(constant(args.format==='tree'?new AstNode('body',11):''),function(body){return getContentFromBody(editor,args,format,body);});};var each$7=Tools.each;var ElementUtils=function ElementUtils(dom){this.compare=function(node1,node2){if(node1.nodeName!==node2.nodeName){return false;}var getAttribs=function getAttribs(node){var attribs={};each$7(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();if(name.indexOf('_')!==0&&name!=='style'&&name.indexOf('data-')!==0){attribs[name]=dom.getAttrib(node,name);}});return attribs;};var compareObjects=function compareObjects(obj1,obj2){var value,name;for(name in obj1){if(obj1.hasOwnProperty(name)){value=obj2[name];if(typeof value==='undefined'){return false;}if(obj1[name]!==value){return false;}delete obj2[name];}}for(name in obj2){if(obj2.hasOwnProperty(name)){return false;}}return true;};if(!compareObjects(getAttribs(node1),getAttribs(node2))){return false;}if(!compareObjects(dom.parseStyle(dom.getAttrib(node1,'style')),dom.parseStyle(dom.getAttrib(node2,'style')))){return false;}return!isBookmarkNode$1(node1)&&!isBookmarkNode$1(node2);};};var isChar=function isChar(forward,predicate,pos){return Optional.from(pos.container()).filter(isText$1).exists(function(text){var delta=forward?0:-1;return predicate(text.data.charAt(pos.offset()+delta));});};var isBeforeSpace=curry(isChar,true,isWhiteSpace$1);var isAfterSpace=curry(isChar,false,isWhiteSpace$1);var isEmptyText=function isEmptyText(pos){var container=pos.container();return isText$1(container)&&(container.data.length===0||isZwsp$1(container.data)&&BookmarkManager$1.isBookmarkNode(container.parentNode));};var matchesElementPosition=function matchesElementPosition(before,predicate){return function(pos){return Optional.from(getChildNodeAtRelativeOffset(before?0:-1,pos)).filter(predicate).isSome();};};var isImageBlock=function isImageBlock(node){return isImg(node)&&get$4(SugarElement.fromDom(node),'display')==='block';};var isCefNode=function isCefNode(node){return isContentEditableFalse(node)&&!isBogusAll(node);};var isBeforeImageBlock=matchesElementPosition(true,isImageBlock);var isAfterImageBlock=matchesElementPosition(false,isImageBlock);var isBeforeMedia=matchesElementPosition(true,isMedia);var isAfterMedia=matchesElementPosition(false,isMedia);var isBeforeTable=matchesElementPosition(true,isTable);var isAfterTable=matchesElementPosition(false,isTable);var isBeforeContentEditableFalse=matchesElementPosition(true,isCefNode);var isAfterContentEditableFalse=matchesElementPosition(false,isCefNode);var getLastChildren$1=function getLastChildren$1(elm){var children=[];var rawNode=elm.dom;while(rawNode){children.push(SugarElement.fromDom(rawNode));rawNode=rawNode.lastChild;}return children;};var removeTrailingBr=function removeTrailingBr(elm){var allBrs=descendants$1(elm,'br');var brs=filter(getLastChildren$1(elm).slice(-1),isBr$1);if(allBrs.length===brs.length){each(brs,remove);}};var fillWithPaddingBr=function fillWithPaddingBr(elm){empty(elm);append(elm,SugarElement.fromHtml('<br data-mce-bogus="1">'));};var trimBlockTrailingBr=function trimBlockTrailingBr(elm){lastChild(elm).each(function(lastChild){prevSibling(lastChild).each(function(lastChildPrevSibling){if(isBlock(elm)&&isBr$1(lastChild)&&isBlock(lastChildPrevSibling)){remove(lastChild);}});});};var dropLast=function dropLast(xs){return xs.slice(0,-1);};var parentsUntil$1=function parentsUntil$1(start,root,predicate){if(contains$2(root,start)){return dropLast(parents(start,function(elm){return predicate(elm)||eq$2(elm,root);}));}else{return[];}};var parents$1=function parents$1(start,root){return parentsUntil$1(start,root,never);};var parentsAndSelf=function parentsAndSelf(start,root){return[start].concat(parents$1(start,root));};var navigateIgnoreEmptyTextNodes=function navigateIgnoreEmptyTextNodes(forward,root,from){return navigateIgnore(forward,root,from,isEmptyText);};var getClosestBlock=function getClosestBlock(root,pos){return find(parentsAndSelf(SugarElement.fromDom(pos.container()),root),isBlock);};var isAtBeforeAfterBlockBoundary=function isAtBeforeAfterBlockBoundary(forward,root,pos){return navigateIgnoreEmptyTextNodes(forward,root.dom,pos).forall(function(newPos){return getClosestBlock(root,pos).fold(function(){return isInSameBlock(newPos,pos,root.dom)===false;},function(fromBlock){return isInSameBlock(newPos,pos,root.dom)===false&&contains$2(fromBlock,SugarElement.fromDom(newPos.container()));});});};var isAtBlockBoundary=function isAtBlockBoundary(forward,root,pos){return getClosestBlock(root,pos).fold(function(){return navigateIgnoreEmptyTextNodes(forward,root.dom,pos).forall(function(newPos){return isInSameBlock(newPos,pos,root.dom)===false;});},function(parent){return navigateIgnoreEmptyTextNodes(forward,parent.dom,pos).isNone();});};var isAtStartOfBlock=curry(isAtBlockBoundary,false);var isAtEndOfBlock=curry(isAtBlockBoundary,true);var isBeforeBlock=curry(isAtBeforeAfterBlockBoundary,false);var isAfterBlock=curry(isAtBeforeAfterBlockBoundary,true);var isBr$5=function isBr$5(pos){return getElementFromPosition(pos).exists(isBr$1);};var findBr=function findBr(forward,root,pos){var parentBlocks=filter(parentsAndSelf(SugarElement.fromDom(pos.container()),root),isBlock);var scope=head(parentBlocks).getOr(root);return fromPosition(forward,scope.dom,pos).filter(isBr$5);};var isBeforeBr=function isBeforeBr(root,pos){return getElementFromPosition(pos).exists(isBr$1)||findBr(true,root,pos).isSome();};var isAfterBr=function isAfterBr(root,pos){return getElementFromPrevPosition(pos).exists(isBr$1)||findBr(false,root,pos).isSome();};var findPreviousBr=curry(findBr,false);var findNextBr=curry(findBr,true);var isInMiddleOfText=function isInMiddleOfText(pos){return CaretPosition.isTextPosition(pos)&&!pos.isAtStart()&&!pos.isAtEnd();};var getClosestBlock$1=function getClosestBlock$1(root,pos){var parentBlocks=filter(parentsAndSelf(SugarElement.fromDom(pos.container()),root),isBlock);return head(parentBlocks).getOr(root);};var hasSpaceBefore=function hasSpaceBefore(root,pos){if(isInMiddleOfText(pos)){return isAfterSpace(pos);}else{return isAfterSpace(pos)||prevPosition(getClosestBlock$1(root,pos).dom,pos).exists(isAfterSpace);}};var hasSpaceAfter=function hasSpaceAfter(root,pos){if(isInMiddleOfText(pos)){return isBeforeSpace(pos);}else{return isBeforeSpace(pos)||nextPosition(getClosestBlock$1(root,pos).dom,pos).exists(isBeforeSpace);}};var isPreValue=function isPreValue(value){return contains(['pre','pre-wrap'],value);};var isInPre=function isInPre(pos){return getElementFromPosition(pos).bind(function(elm){return closest(elm,isElement);}).exists(function(elm){return isPreValue(get$4(elm,'white-space'));});};var isAtBeginningOfBody=function isAtBeginningOfBody(root,pos){return prevPosition(root.dom,pos).isNone();};var isAtEndOfBody=function isAtEndOfBody(root,pos){return nextPosition(root.dom,pos).isNone();};var isAtLineBoundary=function isAtLineBoundary(root,pos){return isAtBeginningOfBody(root,pos)||isAtEndOfBody(root,pos)||isAtStartOfBlock(root,pos)||isAtEndOfBlock(root,pos)||isAfterBr(root,pos)||isBeforeBr(root,pos);};var needsToHaveNbsp=function needsToHaveNbsp(root,pos){if(isInPre(pos)){return false;}else{return isAtLineBoundary(root,pos)||hasSpaceBefore(root,pos)||hasSpaceAfter(root,pos);}};var needsToBeNbspLeft=function needsToBeNbspLeft(root,pos){if(isInPre(pos)){return false;}else{return isAtStartOfBlock(root,pos)||isBeforeBlock(root,pos)||isAfterBr(root,pos)||hasSpaceBefore(root,pos);}};var leanRight=function leanRight(pos){var container=pos.container();var offset=pos.offset();if(isText$1(container)&&offset<container.data.length){return CaretPosition(container,offset+1);}else{return pos;}};var needsToBeNbspRight=function needsToBeNbspRight(root,pos){if(isInPre(pos)){return false;}else{return isAtEndOfBlock(root,pos)||isAfterBlock(root,pos)||isBeforeBr(root,pos)||hasSpaceAfter(root,pos);}};var needsToBeNbsp=function needsToBeNbsp(root,pos){return needsToBeNbspLeft(root,pos)||needsToBeNbspRight(root,leanRight(pos));};var isNbspAt=function isNbspAt(text,offset){return isNbsp(text.charAt(offset));};var hasNbsp=function hasNbsp(pos){var container=pos.container();return isText$1(container)&&contains$1(container.data,nbsp);};var normalizeNbspMiddle=function normalizeNbspMiddle(text){var chars=text.split('');return map(chars,function(chr,i){if(isNbsp(chr)&&i>0&&i<chars.length-1&&isContent$1(chars[i-1])&&isContent$1(chars[i+1])){return' ';}else{return chr;}}).join('');};var normalizeNbspAtStart=function normalizeNbspAtStart(root,node){var text=node.data;var firstPos=CaretPosition(node,0);if(isNbspAt(text,0)&&!needsToBeNbsp(root,firstPos)){node.data=' '+text.slice(1);return true;}else{return false;}};var normalizeNbspInMiddleOfTextNode=function normalizeNbspInMiddleOfTextNode(node){var text=node.data;var newText=normalizeNbspMiddle(text);if(newText!==text){node.data=newText;return true;}else{return false;}};var normalizeNbspAtEnd=function normalizeNbspAtEnd(root,node){var text=node.data;var lastPos=CaretPosition(node,text.length-1);if(isNbspAt(text,text.length-1)&&!needsToBeNbsp(root,lastPos)){node.data=text.slice(0,-1)+' ';return true;}else{return false;}};var normalizeNbsps=function normalizeNbsps(root,pos){return Optional.some(pos).filter(hasNbsp).bind(function(pos){var container=pos.container();var normalized=normalizeNbspAtStart(root,container)||normalizeNbspInMiddleOfTextNode(container)||normalizeNbspAtEnd(root,container);return normalized?Optional.some(pos):Optional.none();});};var normalizeNbspsInEditor=function normalizeNbspsInEditor(editor){var root=SugarElement.fromDom(editor.getBody());if(editor.selection.isCollapsed()){normalizeNbsps(root,CaretPosition.fromRangeStart(editor.selection.getRng())).each(function(pos){editor.selection.setRng(pos.toRange());});}};var normalizeContent=function normalizeContent(content,isStartOfContent,isEndOfContent){var result=foldl(content,function(acc,c){if(isWhiteSpace$1(c)||isNbsp(c)){if(acc.previousCharIsSpace||acc.str===''&&isStartOfContent||acc.str.length===content.length-1&&isEndOfContent){return{previousCharIsSpace:false,str:acc.str+nbsp};}else{return{previousCharIsSpace:true,str:acc.str+' '};}}else{return{previousCharIsSpace:false,str:acc.str+c};}},{previousCharIsSpace:false,str:''});return result.str;};var normalize$1=function normalize$1(node,offset,count){if(count===0){return;}var elm=SugarElement.fromDom(node);var root=ancestor(elm,isBlock).getOr(elm);var whitespace=node.data.slice(offset,offset+count);var isEndOfContent=offset+count>=node.data.length&&needsToBeNbspRight(root,CaretPosition$1(node,node.data.length));var isStartOfContent=offset===0&&needsToBeNbspLeft(root,CaretPosition$1(node,0));node.replaceData(offset,count,normalizeContent(whitespace,isStartOfContent,isEndOfContent));};var normalizeWhitespaceAfter=function normalizeWhitespaceAfter(node,offset){var content=node.data.slice(offset);var whitespaceCount=content.length-lTrim(content).length;return normalize$1(node,offset,whitespaceCount);};var normalizeWhitespaceBefore=function normalizeWhitespaceBefore(node,offset){var content=node.data.slice(0,offset);var whitespaceCount=content.length-rTrim(content).length;return normalize$1(node,offset-whitespaceCount,whitespaceCount);};var mergeTextNodes=function mergeTextNodes(prevNode,nextNode,normalizeWhitespace,mergeToPrev){if(mergeToPrev===void 0){mergeToPrev=true;}var whitespaceOffset=rTrim(prevNode.data).length;var newNode=mergeToPrev?prevNode:nextNode;var removeNode=mergeToPrev?nextNode:prevNode;if(mergeToPrev){newNode.appendData(removeNode.data);}else{newNode.insertData(0,removeNode.data);}remove(SugarElement.fromDom(removeNode));if(normalizeWhitespace){normalizeWhitespaceAfter(newNode,whitespaceOffset);}return newNode;};var needsReposition=function needsReposition(pos,elm){var container=pos.container();var offset=pos.offset();return CaretPosition$1.isTextPosition(pos)===false&&container===elm.parentNode&&offset>CaretPosition$1.before(elm).offset();};var reposition=function reposition(elm,pos){return needsReposition(pos,elm)?CaretPosition$1(pos.container(),pos.offset()-1):pos;};var beforeOrStartOf=function beforeOrStartOf(node){return isText$1(node)?CaretPosition$1(node,0):CaretPosition$1.before(node);};var afterOrEndOf=function afterOrEndOf(node){return isText$1(node)?CaretPosition$1(node,node.data.length):CaretPosition$1.after(node);};var getPreviousSiblingCaretPosition=function getPreviousSiblingCaretPosition(elm){if(isCaretCandidate(elm.previousSibling)){return Optional.some(afterOrEndOf(elm.previousSibling));}else{return elm.previousSibling?lastPositionIn(elm.previousSibling):Optional.none();}};var getNextSiblingCaretPosition=function getNextSiblingCaretPosition(elm){if(isCaretCandidate(elm.nextSibling)){return Optional.some(beforeOrStartOf(elm.nextSibling));}else{return elm.nextSibling?firstPositionIn(elm.nextSibling):Optional.none();}};var findCaretPositionBackwardsFromElm=function findCaretPositionBackwardsFromElm(rootElement,elm){var startPosition=CaretPosition$1.before(elm.previousSibling?elm.previousSibling:elm.parentNode);return prevPosition(rootElement,startPosition).fold(function(){return nextPosition(rootElement,CaretPosition$1.after(elm));},Optional.some);};var findCaretPositionForwardsFromElm=function findCaretPositionForwardsFromElm(rootElement,elm){return nextPosition(rootElement,CaretPosition$1.after(elm)).fold(function(){return prevPosition(rootElement,CaretPosition$1.before(elm));},Optional.some);};var findCaretPositionBackwards=function findCaretPositionBackwards(rootElement,elm){return getPreviousSiblingCaretPosition(elm).orThunk(function(){return getNextSiblingCaretPosition(elm);}).orThunk(function(){return findCaretPositionBackwardsFromElm(rootElement,elm);});};var findCaretPositionForward=function findCaretPositionForward(rootElement,elm){return getNextSiblingCaretPosition(elm).orThunk(function(){return getPreviousSiblingCaretPosition(elm);}).orThunk(function(){return findCaretPositionForwardsFromElm(rootElement,elm);});};var findCaretPosition$1=function findCaretPosition$1(forward,rootElement,elm){return forward?findCaretPositionForward(rootElement,elm):findCaretPositionBackwards(rootElement,elm);};var findCaretPosOutsideElmAfterDelete=function findCaretPosOutsideElmAfterDelete(forward,rootElement,elm){return findCaretPosition$1(forward,rootElement,elm).map(curry(reposition,elm));};var setSelection=function setSelection(editor,forward,pos){pos.fold(function(){editor.focus();},function(pos){editor.selection.setRng(pos.toRange(),forward);});};var eqRawNode=function eqRawNode(rawNode){return function(elm){return elm.dom===rawNode;};};var isBlock$2=function isBlock$2(editor,elm){return elm&&has(editor.schema.getBlockElements(),name(elm));};var paddEmptyBlock=function paddEmptyBlock(elm){if(isEmpty(elm)){var br=SugarElement.fromHtml('<br data-mce-bogus="1">');empty(elm);append(elm,br);return Optional.some(CaretPosition$1.before(br.dom));}else{return Optional.none();}};var deleteNormalized=function deleteNormalized(elm,afterDeletePosOpt,normalizeWhitespace){var prevTextOpt=prevSibling(elm).filter(isText);var nextTextOpt=nextSibling(elm).filter(isText);remove(elm);return lift3(prevTextOpt,nextTextOpt,afterDeletePosOpt,function(prev,next,pos){var prevNode=prev.dom,nextNode=next.dom;var offset=prevNode.data.length;mergeTextNodes(prevNode,nextNode,normalizeWhitespace);return pos.container()===nextNode?CaretPosition$1(prevNode,offset):pos;}).orThunk(function(){if(normalizeWhitespace){prevTextOpt.each(function(elm){return normalizeWhitespaceBefore(elm.dom,elm.dom.length);});nextTextOpt.each(function(elm){return normalizeWhitespaceAfter(elm.dom,0);});}return afterDeletePosOpt;});};var isInlineElement=function isInlineElement(editor,element){return has(editor.schema.getTextInlineElements(),name(element));};var deleteElement=function deleteElement(editor,forward,elm,moveCaret){if(moveCaret===void 0){moveCaret=true;}var afterDeletePos=findCaretPosOutsideElmAfterDelete(forward,editor.getBody(),elm.dom);var parentBlock=ancestor(elm,curry(isBlock$2,editor),eqRawNode(editor.getBody()));var normalizedAfterDeletePos=deleteNormalized(elm,afterDeletePos,isInlineElement(editor,elm));if(editor.dom.isEmpty(editor.getBody())){editor.setContent('');editor.selection.setCursorLocation();}else{parentBlock.bind(paddEmptyBlock).fold(function(){if(moveCaret){setSelection(editor,forward,normalizedAfterDeletePos);}},function(paddPos){if(moveCaret){setSelection(editor,forward,Optional.some(paddPos));}});}};var tableCellRng=function tableCellRng(start,end){return{start:start,end:end};};var tableSelection=function tableSelection(rng,table,cells){return{rng:rng,table:table,cells:cells};};var deleteAction=Adt.generate([{removeTable:['element']},{emptyCells:['cells']},{deleteCellSelection:['rng','cell']}]);var isRootFromElement=function isRootFromElement(root){return function(cur){return eq$2(root,cur);};};var getClosestCell=function getClosestCell(container,isRoot){return closest$1(SugarElement.fromDom(container),'td,th',isRoot);};var getClosestTable=function getClosestTable(cell,isRoot){return ancestor$1(cell,'table',isRoot);};var isExpandedCellRng=function isExpandedCellRng(cellRng){return!eq$2(cellRng.start,cellRng.end);};var getTableFromCellRng=function getTableFromCellRng(cellRng,isRoot){return getClosestTable(cellRng.start,isRoot).bind(function(startParentTable){return getClosestTable(cellRng.end,isRoot).bind(function(endParentTable){return someIf(eq$2(startParentTable,endParentTable),startParentTable);});});};var isSingleCellTable=function isSingleCellTable(cellRng,isRoot){return!isExpandedCellRng(cellRng)&&getTableFromCellRng(cellRng,isRoot).exists(function(table){var rows=table.dom.rows;return rows.length===1&&rows[0].cells.length===1;});};var getTableCells=function getTableCells(table){return descendants$1(table,'td,th');};var getCellRng=function getCellRng(rng,isRoot){var startCell=getClosestCell(rng.startContainer,isRoot);var endCell=getClosestCell(rng.endContainer,isRoot);return lift2(startCell,endCell,tableCellRng);};var getCellRangeFromStartTable=function getCellRangeFromStartTable(cellRng,isRoot){return getClosestTable(cellRng.start,isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(cellRng.start,endCell);});});};var partialSelection=function partialSelection(isRoot,rng){var startCell=getClosestCell(rng.startContainer,isRoot);var endCell=getClosestCell(rng.endContainer,isRoot);return rng.collapsed?Optional.none():lift2(startCell,endCell,tableCellRng).fold(function(){return startCell.fold(function(){return endCell.bind(function(endCell){return getClosestTable(endCell,isRoot).bind(function(table){return head(getTableCells(table)).map(function(startCell){return tableCellRng(startCell,endCell);});});});},function(startCell){return getClosestTable(startCell,isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(startCell,endCell);});});});},function(cellRng){return isWithinSameTable(isRoot,cellRng)?Optional.none():getCellRangeFromStartTable(cellRng,isRoot);});};var isWithinSameTable=function isWithinSameTable(isRoot,cellRng){return getTableFromCellRng(cellRng,isRoot).isSome();};var getTableSelectionFromCellRng=function getTableSelectionFromCellRng(cellRng,isRoot){return getTableFromCellRng(cellRng,isRoot).map(function(table){return tableSelection(cellRng,table,getTableCells(table));});};var getTableSelection=function getTableSelection(optCellRng,rng,isRoot){return optCellRng.filter(function(cellRng){return isExpandedCellRng(cellRng)&&isWithinSameTable(isRoot,cellRng);}).orThunk(function(){return partialSelection(isRoot,rng);}).bind(function(cRng){return getTableSelectionFromCellRng(cRng,isRoot);});};var getCellIndex=function getCellIndex(cells,cell){return findIndex(cells,function(x){return eq$2(x,cell);});};var getSelectedCells=function getSelectedCells(tableSelection){return lift2(getCellIndex(tableSelection.cells,tableSelection.rng.start),getCellIndex(tableSelection.cells,tableSelection.rng.end),function(startIndex,endIndex){return tableSelection.cells.slice(startIndex,endIndex+1);});};var isSingleCellTableContentSelected=function isSingleCellTableContentSelected(optCellRng,rng,isRoot){return optCellRng.filter(function(cellRng){return isSingleCellTable(cellRng,isRoot)&&hasAllContentsSelected(cellRng.start,rng);}).map(function(cellRng){return cellRng.start;});};var getAction=function getAction(tableSelection){return getSelectedCells(tableSelection).map(function(selected){var cells=tableSelection.cells;return selected.length===cells.length?deleteAction.removeTable(tableSelection.table):deleteAction.emptyCells(selected);});};var getActionFromRange=function getActionFromRange(root,rng){var isRoot=isRootFromElement(root);var optCellRng=getCellRng(rng,isRoot);return isSingleCellTableContentSelected(optCellRng,rng,isRoot).map(function(cell){return deleteAction.deleteCellSelection(rng,cell);}).orThunk(function(){return getTableSelection(optCellRng,rng,isRoot).bind(getAction);});};var freefallRtl=function freefallRtl(root){var child=isComment(root)?prevSibling(root):lastChild(root);return child.bind(freefallRtl).orThunk(function(){return Optional.some(root);});};var emptyCells=function emptyCells(editor,cells){each(cells,fillWithPaddingBr);editor.selection.setCursorLocation(cells[0].dom,0);return true;};var deleteCellContents=function deleteCellContents(editor,rng,cell){rng.deleteContents();var lastNode=freefallRtl(cell).getOr(cell);var lastBlock=SugarElement.fromDom(editor.dom.getParent(lastNode.dom,editor.dom.isBlock));if(isEmpty(lastBlock)){fillWithPaddingBr(lastBlock);editor.selection.setCursorLocation(lastBlock.dom,0);}if(!eq$2(cell,lastBlock)){var additionalCleanupNodes=parent(lastBlock).is(cell)?[]:siblings(lastBlock);each(additionalCleanupNodes.concat(children(cell)),function(node){if(!eq$2(node,lastBlock)&&!contains$2(node,lastBlock)){remove(node);}});}return true;};var deleteTableElement=function deleteTableElement(editor,table){deleteElement(editor,false,table);return true;};var deleteCellRange=function deleteCellRange(editor,rootElm,rng){return getActionFromRange(rootElm,rng).map(function(action){return action.fold(curry(deleteTableElement,editor),curry(emptyCells,editor),curry(deleteCellContents,editor));});};var deleteCaptionRange=function deleteCaptionRange(editor,caption){return emptyElement(editor,caption);};var deleteTableRange=function deleteTableRange(editor,rootElm,rng,startElm){return getParentCaption(rootElm,startElm).fold(function(){return deleteCellRange(editor,rootElm,rng);},function(caption){return deleteCaptionRange(editor,caption);}).getOr(false);};var deleteRange=function deleteRange(editor,startElm){var rootNode=SugarElement.fromDom(editor.getBody());var rng=editor.selection.getRng();var selectedCells=getCellsFromEditor(editor);return selectedCells.length!==0?emptyCells(editor,selectedCells):deleteTableRange(editor,rootNode,rng,startElm);};var getParentCell=function getParentCell(rootElm,elm){return find(parentsAndSelf(elm,rootElm),isTableCell$1);};var getParentCaption=function getParentCaption(rootElm,elm){return find(parentsAndSelf(elm,rootElm),function(elm){return name(elm)==='caption';});};var deleteBetweenCells=function deleteBetweenCells(editor,rootElm,forward,fromCell,from){return navigate(forward,editor.getBody(),from).bind(function(to){return getParentCell(rootElm,SugarElement.fromDom(to.getNode())).map(function(toCell){return eq$2(toCell,fromCell)===false;});});};var emptyElement=function emptyElement(editor,elm){fillWithPaddingBr(elm);editor.selection.setCursorLocation(elm.dom,0);return Optional.some(true);};var isDeleteOfLastCharPos=function isDeleteOfLastCharPos(fromCaption,forward,from,to){return firstPositionIn(fromCaption.dom).bind(function(first){return lastPositionIn(fromCaption.dom).map(function(last){return forward?from.isEqual(first)&&to.isEqual(last):from.isEqual(last)&&to.isEqual(first);});}).getOr(true);};var emptyCaretCaption=function emptyCaretCaption(editor,elm){return emptyElement(editor,elm);};var validateCaretCaption=function validateCaretCaption(rootElm,fromCaption,to){return getParentCaption(rootElm,SugarElement.fromDom(to.getNode())).map(function(toCaption){return eq$2(toCaption,fromCaption)===false;});};var deleteCaretInsideCaption=function deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from){return navigate(forward,editor.getBody(),from).bind(function(to){return isDeleteOfLastCharPos(fromCaption,forward,from,to)?emptyCaretCaption(editor,fromCaption):validateCaretCaption(rootElm,fromCaption,to);}).or(Optional.some(true));};var deleteCaretCells=function deleteCaretCells(editor,forward,rootElm,startElm){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return getParentCell(rootElm,startElm).bind(function(fromCell){return isEmpty(fromCell)?emptyElement(editor,fromCell):deleteBetweenCells(editor,rootElm,forward,fromCell,from);}).getOr(false);};var deleteCaretCaption=function deleteCaretCaption(editor,forward,rootElm,fromCaption){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return isEmpty(fromCaption)?emptyElement(editor,fromCaption):deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from);};var isNearTable=function isNearTable(forward,pos){return forward?isBeforeTable(pos):isAfterTable(pos);};var isBeforeOrAfterTable=function isBeforeOrAfterTable(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return isNearTable(forward,fromPos)||fromPosition(forward,editor.getBody(),fromPos).exists(function(pos){return isNearTable(forward,pos);});};var deleteCaret=function deleteCaret(editor,forward,startElm){var rootElm=SugarElement.fromDom(editor.getBody());return getParentCaption(rootElm,startElm).fold(function(){return deleteCaretCells(editor,forward,rootElm,startElm)||isBeforeOrAfterTable(editor,forward);},function(fromCaption){return deleteCaretCaption(editor,forward,rootElm,fromCaption).getOr(false);});};var backspaceDelete=function backspaceDelete(editor,forward){var startElm=SugarElement.fromDom(editor.selection.getStart(true));var cells=getCellsFromEditor(editor);return editor.selection.isCollapsed()&&cells.length===0?deleteCaret(editor,forward,startElm):deleteRange(editor,startElm);};var createRange$1=function createRange$1(sc,so,ec,eo){var rng=document.createRange();rng.setStart(sc,so);rng.setEnd(ec,eo);return rng;};var normalizeBlockSelectionRange=function normalizeBlockSelectionRange(rng){var startPos=CaretPosition$1.fromRangeStart(rng);var endPos=CaretPosition$1.fromRangeEnd(rng);var rootNode=rng.commonAncestorContainer;return fromPosition(false,rootNode,endPos).map(function(newEndPos){if(!isInSameBlock(startPos,endPos,rootNode)&&isInSameBlock(startPos,newEndPos,rootNode)){return createRange$1(startPos.container(),startPos.offset(),newEndPos.container(),newEndPos.offset());}else{return rng;}}).getOr(rng);};var normalize$2=function normalize$2(rng){return rng.collapsed?rng:normalizeBlockSelectionRange(rng);};var hasOnlyOneChild=function hasOnlyOneChild(node){return node.firstChild&&node.firstChild===node.lastChild;};var isPaddingNode=function isPaddingNode(node){return node.name==='br'||node.value===nbsp;};var isPaddedEmptyBlock=function isPaddedEmptyBlock(schema,node){var blockElements=schema.getBlockElements();return blockElements[node.name]&&hasOnlyOneChild(node)&&isPaddingNode(node.firstChild);};var isEmptyFragmentElement=function isEmptyFragmentElement(schema,node){var nonEmptyElements=schema.getNonEmptyElements();return node&&(node.isEmpty(nonEmptyElements)||isPaddedEmptyBlock(schema,node));};var isListFragment=function isListFragment(schema,fragment){var firstChild=fragment.firstChild;var lastChild=fragment.lastChild;if(firstChild&&firstChild.name==='meta'){firstChild=firstChild.next;}if(lastChild&&lastChild.attr('id')==='mce_marker'){lastChild=lastChild.prev;}if(isEmptyFragmentElement(schema,lastChild)){lastChild=lastChild.prev;}if(!firstChild||firstChild!==lastChild){return false;}return firstChild.name==='ul'||firstChild.name==='ol';};var cleanupDomFragment=function cleanupDomFragment(domFragment){var firstChild=domFragment.firstChild;var lastChild=domFragment.lastChild;if(firstChild&&firstChild.nodeName==='META'){firstChild.parentNode.removeChild(firstChild);}if(lastChild&&lastChild.id==='mce_marker'){lastChild.parentNode.removeChild(lastChild);}return domFragment;};var toDomFragment=function toDomFragment(dom,serializer,fragment){var html=serializer.serialize(fragment);var domFragment=dom.createFragment(html);return cleanupDomFragment(domFragment);};var listItems$1=function listItems$1(elm){return Tools.grep(elm.childNodes,function(child){return child.nodeName==='LI';});};var isPadding=function isPadding(node){return node.data===nbsp||isBr(node);};var isListItemPadded=function isListItemPadded(node){return node&&node.firstChild&&node.firstChild===node.lastChild&&isPadding(node.firstChild);};var isEmptyOrPadded=function isEmptyOrPadded(elm){return!elm.firstChild||isListItemPadded(elm);};var trimListItems=function trimListItems(elms){return elms.length>0&&isEmptyOrPadded(elms[elms.length-1])?elms.slice(0,-1):elms;};var getParentLi=function getParentLi(dom,node){var parentBlock=dom.getParent(node,dom.isBlock);return parentBlock&&parentBlock.nodeName==='LI'?parentBlock:null;};var isParentBlockLi=function isParentBlockLi(dom,node){return!!getParentLi(dom,node);};var getSplit=function getSplit(parentNode,rng){var beforeRng=rng.cloneRange();var afterRng=rng.cloneRange();beforeRng.setStartBefore(parentNode);afterRng.setEndAfter(parentNode);return[beforeRng.cloneContents(),afterRng.cloneContents()];};var findFirstIn=function findFirstIn(node,rootNode){var caretPos=CaretPosition$1.before(node);var caretWalker=CaretWalker(rootNode);var newCaretPos=caretWalker.next(caretPos);return newCaretPos?newCaretPos.toRange():null;};var findLastOf=function findLastOf(node,rootNode){var caretPos=CaretPosition$1.after(node);var caretWalker=CaretWalker(rootNode);var newCaretPos=caretWalker.prev(caretPos);return newCaretPos?newCaretPos.toRange():null;};var insertMiddle=function insertMiddle(target,elms,rootNode,rng){var parts=getSplit(target,rng);var parentElm=target.parentNode;parentElm.insertBefore(parts[0],target);Tools.each(elms,function(li){parentElm.insertBefore(li,target);});parentElm.insertBefore(parts[1],target);parentElm.removeChild(target);return findLastOf(elms[elms.length-1],rootNode);};var insertBefore=function insertBefore(target,elms,rootNode){var parentElm=target.parentNode;Tools.each(elms,function(elm){parentElm.insertBefore(elm,target);});return findFirstIn(target,rootNode);};var insertAfter=function insertAfter(target,elms,rootNode,dom){dom.insertAfter(elms.reverse(),target);return findLastOf(elms[0],rootNode);};var insertAtCaret=function insertAtCaret(serializer,dom,rng,fragment){var domFragment=toDomFragment(dom,serializer,fragment);var liTarget=getParentLi(dom,rng.startContainer);var liElms=trimListItems(listItems$1(domFragment.firstChild));var BEGINNING=1,END=2;var rootNode=dom.getRoot();var isAt=function isAt(location){var caretPos=CaretPosition$1.fromRangeStart(rng);var caretWalker=CaretWalker(dom.getRoot());var newPos=location===BEGINNING?caretWalker.prev(caretPos):caretWalker.next(caretPos);return newPos?getParentLi(dom,newPos.getNode())!==liTarget:true;};if(isAt(BEGINNING)){return insertBefore(liTarget,liElms,rootNode);}else if(isAt(END)){return insertAfter(liTarget,liElms,rootNode,dom);}return insertMiddle(liTarget,liElms,rootNode,rng);};var trimOrPadLeftRight=function trimOrPadLeftRight(dom,rng,html){var root=SugarElement.fromDom(dom.getRoot());if(needsToBeNbspLeft(root,CaretPosition$1.fromRangeStart(rng))){html=html.replace(/^ /,'&nbsp;');}else{html=html.replace(/^&nbsp;/,' ');}if(needsToBeNbspRight(root,CaretPosition$1.fromRangeEnd(rng))){html=html.replace(/(&nbsp;| )(<br( \/)>)?$/,'&nbsp;');}else{html=html.replace(/&nbsp;(<br( \/)?>)?$/,' ');}return html;};var isTableCell$4=isTableCell;var isTableCellContentSelected=function isTableCellContentSelected(dom,rng,cell){if(cell!==null){var endCell=dom.getParent(rng.endContainer,isTableCell$4);return cell===endCell&&hasAllContentsSelected(SugarElement.fromDom(cell),rng);}else{return false;}};var validInsertion=function validInsertion(editor,value,parentNode){if(parentNode.getAttribute('data-mce-bogus')==='all'){parentNode.parentNode.insertBefore(editor.dom.createFragment(value),parentNode);}else{var node=parentNode.firstChild;var node2=parentNode.lastChild;if(!node||node===node2&&node.nodeName==='BR'){editor.dom.setHTML(parentNode,value);}else{editor.selection.setContent(value);}}};var trimBrsFromTableCell=function trimBrsFromTableCell(dom,elm){Optional.from(dom.getParent(elm,'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);};var reduceInlineTextElements=function reduceInlineTextElements(editor,merge){var textInlineElements=editor.schema.getTextInlineElements();var dom=editor.dom;if(merge){var root_1=editor.getBody(),elementUtils_1=new ElementUtils(dom);Tools.each(dom.select('*[data-mce-fragment]'),function(node){for(var testNode=node.parentNode;testNode&&testNode!==root_1;testNode=testNode.parentNode){if(textInlineElements[node.nodeName.toLowerCase()]&&elementUtils_1.compare(testNode,node)){dom.remove(node,true);}}});}};var markFragmentElements=function markFragmentElements(fragment){var node=fragment;while(node=node.walk()){if(node.type===1){node.attr('data-mce-fragment','1');}}};var unmarkFragmentElements=function unmarkFragmentElements(elm){Tools.each(elm.getElementsByTagName('*'),function(elm){elm.removeAttribute('data-mce-fragment');});};var isPartOfFragment=function isPartOfFragment(node){return!!node.getAttribute('data-mce-fragment');};var canHaveChildren=function canHaveChildren(editor,node){return node&&!editor.schema.getShortEndedElements()[node.nodeName];};var moveSelectionToMarker=function moveSelectionToMarker(editor,marker){var nextRng;var dom=editor.dom,selection=editor.selection;var node2;var getContentEditableFalseParent=function getContentEditableFalseParent(node){var root=editor.getBody();for(;node&&node!==root;node=node.parentNode){if(dom.getContentEditable(node)==='false'){return node;}}return null;};if(!marker){return;}selection.scrollIntoView(marker);var parentEditableFalseElm=getContentEditableFalseParent(marker);if(parentEditableFalseElm){dom.remove(marker);selection.select(parentEditableFalseElm);return;}var rng=dom.createRng();var node=marker.previousSibling;if(node&&node.nodeType===3){rng.setStart(node,node.nodeValue.length);if(!Env.ie){node2=marker.nextSibling;if(node2&&node2.nodeType===3){node.appendData(node2.data);node2.parentNode.removeChild(node2);}}}else{rng.setStartBefore(marker);rng.setEndBefore(marker);}var findNextCaretRng=function findNextCaretRng(rng){var caretPos=CaretPosition$1.fromRangeStart(rng);var caretWalker=CaretWalker(editor.getBody());caretPos=caretWalker.next(caretPos);if(caretPos){return caretPos.toRange();}};var parentBlock=dom.getParent(marker,dom.isBlock);dom.remove(marker);if(parentBlock&&dom.isEmpty(parentBlock)){editor.$(parentBlock).empty();rng.setStart(parentBlock,0);rng.setEnd(parentBlock,0);if(!isTableCell$4(parentBlock)&&!isPartOfFragment(parentBlock)&&(nextRng=findNextCaretRng(rng))){rng=nextRng;dom.remove(parentBlock);}else{dom.add(parentBlock,dom.create('br',{'data-mce-bogus':'1'}));}}selection.setRng(rng);};var deleteSelectedContent=function deleteSelectedContent(editor){var dom=editor.dom;var rng=normalize$2(editor.selection.getRng());editor.selection.setRng(rng);var startCell=dom.getParent(rng.startContainer,isTableCell$4);if(isTableCellContentSelected(dom,rng,startCell)){deleteCellContents(editor,rng,SugarElement.fromDom(startCell));}else{editor.getDoc().execCommand('Delete',false,null);}};var insertHtmlAtCaret=function insertHtmlAtCaret(editor,value,details){var parentNode,rootNode,args;var marker,rng,node;var selection=editor.selection,dom=editor.dom;if(/^ | $/.test(value)){value=trimOrPadLeftRight(dom,selection.getRng(),value);}var parser=editor.parser;var merge=details.merge;var serializer=HtmlSerializer({validate:shouldValidate(editor)},editor.schema);var bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';args={content:value,format:'html',selection:true,paste:details.paste};args=editor.fire('BeforeSetContent',args);if(args.isDefaultPrevented()){editor.fire('SetContent',{content:args.content,format:'html',selection:true,paste:details.paste});return;}value=args.content;if(value.indexOf('{$caret}')===-1){value+='{$caret}';}value=value.replace(/\{\$caret\}/,bookmarkHtml);rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null);var body=editor.getBody();if(caretElement===body&&selection.isCollapsed()){if(dom.isBlock(body.firstChild)&&canHaveChildren(editor,body.firstChild)&&dom.isEmpty(body.firstChild)){rng=dom.createRng();rng.setStart(body.firstChild,0);rng.setEnd(body.firstChild,0);selection.setRng(rng);}}if(!selection.isCollapsed()){deleteSelectedContent(editor);}parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase(),data:details.data,insert:true};var fragment=parser.parse(value,parserArgs);if(details.paste===true&&isListFragment(editor.schema,fragment)&&isParentBlockLi(dom,parentNode)){rng=insertAtCaret(serializer,dom,selection.getRng(),fragment);selection.setRng(rng);editor.fire('SetContent',args);return;}markFragmentElements(fragment);node=fragment.lastChild;if(node.attr('id')==='mce_marker'){marker=node;for(node=node.prev;node;node=node.walk(true)){if(node.type===3||!dom.isBlock(node.name)){if(editor.schema.isValidChild(node.parent.name,'span')){node.parent.insert(marker,node,node.name==='br');}break;}}}editor._selectionOverrides.showBlockCaretContainer(parentNode);if(!parserArgs.invalid){value=serializer.serialize(fragment);validInsertion(editor,value,parentNode);}else{editor.selection.setContent(bookmarkHtml);parentNode=selection.getNode();rootNode=editor.getBody();if(parentNode.nodeType===9){parentNode=node=rootNode;}else{node=parentNode;}while(node!==rootNode){parentNode=node;node=node.parentNode;}value=parentNode===rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode);value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment);})));if(parentNode===rootNode){dom.setHTML(rootNode,value);}else{dom.setOuterHTML(parentNode,value);}}reduceInlineTextElements(editor,merge);moveSelectionToMarker(editor,dom.get('mce_marker'));unmarkFragmentElements(editor.getBody());trimBrsFromTableCell(dom,selection.getStart());editor.fire('SetContent',args);editor.addVisual();};var traverse=function traverse(node,fn){fn(node);if(node.firstChild){traverse(node.firstChild,fn);}if(node.next){traverse(node.next,fn);}};var findMatchingNodes=function findMatchingNodes(nodeFilters,attributeFilters,node){var nodeMatches={};var attrMatches={};var matches=[];if(node.firstChild){traverse(node.firstChild,function(node){each(nodeFilters,function(filter){if(filter.name===node.name){if(nodeMatches[filter.name]){nodeMatches[filter.name].nodes.push(node);}else{nodeMatches[filter.name]={filter:filter,nodes:[node]};}}});each(attributeFilters,function(filter){if(typeof node.attr(filter.name)==='string'){if(attrMatches[filter.name]){attrMatches[filter.name].nodes.push(node);}else{attrMatches[filter.name]={filter:filter,nodes:[node]};}}});});}for(var name_1 in nodeMatches){if(nodeMatches.hasOwnProperty(name_1)){matches.push(nodeMatches[name_1]);}}for(var name_2 in attrMatches){if(attrMatches.hasOwnProperty(name_2)){matches.push(attrMatches[name_2]);}}return matches;};var filter$3=function filter$3(nodeFilters,attributeFilters,node){var matches=findMatchingNodes(nodeFilters,attributeFilters,node);each(matches,function(match){each(match.filter.callbacks,function(callback){callback(match.nodes,match.filter.name,{});});});};var defaultFormat='html';var isTreeNode=function isTreeNode(content){return content instanceof AstNode;};var moveSelection=function moveSelection(editor){if(hasFocus$1(editor)){firstPositionIn(editor.getBody()).each(function(pos){var node=pos.getNode();var caretPos=isTable(node)?firstPositionIn(node).getOr(pos):pos;editor.selection.setRng(caretPos.toRange());});}};var setEditorHtml=function setEditorHtml(editor,html){editor.dom.setHTML(editor.getBody(),html);moveSelection(editor);};var setContentString=function setContentString(editor,body,content,args){var forcedRootBlockName,padd;if(content.length===0||/^\s+$/.test(content)){padd='<br data-mce-bogus="1">';if(body.nodeName==='TABLE'){content='<tr><td>'+padd+'</td></tr>';}else if(/^(UL|OL)$/.test(body.nodeName)){content='<li>'+padd+'</li>';}forcedRootBlockName=getForcedRootBlock(editor);if(forcedRootBlockName&&editor.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())){content=padd;content=editor.dom.createHTML(forcedRootBlockName,getForcedRootBlockAttrs(editor),content);}else if(!content){content='<br data-mce-bogus="1">';}setEditorHtml(editor,content);editor.fire('SetContent',args);}else{if(args.format!=='raw'){content=HtmlSerializer({validate:editor.validate},editor.schema).serialize(editor.parser.parse(content,{isRootContent:true,insert:true}));}args.content=isWsPreserveElement(SugarElement.fromDom(body))?content:Tools.trim(content);setEditorHtml(editor,args.content);if(!args.no_events){editor.fire('SetContent',args);}}return args.content;};var setContentTree=function setContentTree(editor,body,content,args){filter$3(editor.parser.getNodeFilters(),editor.parser.getAttributeFilters(),content);var html=HtmlSerializer({validate:editor.validate},editor.schema).serialize(content);args.content=isWsPreserveElement(SugarElement.fromDom(body))?html:Tools.trim(html);setEditorHtml(editor,args.content);if(!args.no_events){editor.fire('SetContent',args);}return content;};var setContentInternal=function setContentInternal(editor,content,args){args.format=args.format?args.format:defaultFormat;args.set=true;args.content=isTreeNode(content)?'':content;if(!isTreeNode(content)&&!args.no_events){editor.fire('BeforeSetContent',args);content=args.content;}return Optional.from(editor.getBody()).fold(constant(content),function(body){return isTreeNode(content)?setContentTree(editor,body,content,args):setContentString(editor,body,content,args);});};var isEq$2=isEq;var matchesUnInheritedFormatSelector=function matchesUnInheritedFormatSelector(ed,node,name){var formatList=ed.formatter.get(name);if(formatList){for(var i=0;i<formatList.length;i++){if(formatList[i].inherit===false&&ed.dom.is(node,formatList[i].selector)){return true;}}}return false;};var matchParents=function matchParents(editor,node,name,vars){var root=editor.dom.getRoot();if(node===root){return false;}node=editor.dom.getParent(node,function(node){if(matchesUnInheritedFormatSelector(editor,node,name)){return true;}return node.parentNode===root||!!matchNode(editor,node,name,vars,true);});return matchNode(editor,node,name,vars);};var matchName=function matchName(dom,node,format){if(isEq$2(node,format.inline)){return true;}if(isEq$2(node,format.block)){return true;}if(format.selector){return node.nodeType===1&&dom.is(node,format.selector);}};var matchItems=function matchItems(dom,node,format,itemName,similar,vars){var key,value;var items=format[itemName];var i;if(format.onmatch){return format.onmatch(node,format,itemName);}if(items){if(typeof items.length==='undefined'){for(key in items){if(items.hasOwnProperty(key)){if(itemName==='attributes'){value=dom.getAttrib(node,key);}else{value=getStyle(dom,node,key);}if(similar&&!value&&!format.exact){return;}if((!similar||format.exact)&&!isEq$2(value,normalizeStyleValue(dom,replaceVars(items[key],vars),key))){return;}}}}else{for(i=0;i<items.length;i++){if(itemName==='attributes'?dom.getAttrib(node,items[i]):getStyle(dom,node,items[i])){return format;}}}}return format;};var matchNode=function matchNode(ed,node,name,vars,similar){var formatList=ed.formatter.get(name);var format,i,x,classes;var dom=ed.dom;if(formatList&&node){for(i=0;i<formatList.length;i++){format=formatList[i];if(matchName(ed.dom,node,format)&&matchItems(dom,node,format,'attributes',similar,vars)&&matchItems(dom,node,format,'styles',similar,vars)){if(classes=format.classes){for(x=0;x<classes.length;x++){if(!ed.dom.hasClass(node,classes[x])){return;}}}return format;}}}};var match=function match(editor,name,vars,node){if(node){return matchParents(editor,node,name,vars);}node=editor.selection.getNode();if(matchParents(editor,node,name,vars)){return true;}var startNode=editor.selection.getStart();if(startNode!==node){if(matchParents(editor,startNode,name,vars)){return true;}}return false;};var matchAll=function matchAll(editor,names,vars){var matchedFormatNames=[];var checkedMap={};var startElement=editor.selection.getStart();editor.dom.getParent(startElement,function(node){for(var i=0;i<names.length;i++){var name_1=names[i];if(!checkedMap[name_1]&&matchNode(editor,node,name_1,vars)){checkedMap[name_1]=true;matchedFormatNames.push(name_1);}}},editor.dom.getRoot());return matchedFormatNames;};var canApply=function canApply(editor,name){var formatList=editor.formatter.get(name);var startNode,parents,i,x,selector;var dom=editor.dom;if(formatList){startNode=editor.selection.getStart();parents=getParents$1(dom,startNode);for(x=formatList.length-1;x>=0;x--){selector=formatList[x].selector;if(!selector||formatList[x].defaultBlock){return true;}for(i=parents.length-1;i>=0;i--){if(dom.is(parents[i],selector)){return true;}}}}return false;};var matchAllOnNode=function matchAllOnNode(editor,node,formatNames){return foldl(formatNames,function(acc,name){var matchSimilar=isVariableFormatName(editor,name);if(editor.formatter.matchNode(node,name,{},matchSimilar)){return acc.concat([name]);}else{return acc;}},[]);};var ZWSP$1=ZWSP,CARET_ID$1='_mce_caret';var importNode=function importNode(ownerDocument,node){return ownerDocument.importNode(node,true);};var getEmptyCaretContainers=function getEmptyCaretContainers(node){var nodes=[];while(node){if(node.nodeType===3&&node.nodeValue!==ZWSP$1||node.childNodes.length>1){return[];}if(node.nodeType===1){nodes.push(node);}node=node.firstChild;}return nodes;};var isCaretContainerEmpty=function isCaretContainerEmpty(node){return getEmptyCaretContainers(node).length>0;};var findFirstTextNode=function findFirstTextNode(node){if(node){var walker=new DomTreeWalker(node,node);for(node=walker.current();node;node=walker.next()){if(isText$1(node)){return node;}}}return null;};var createCaretContainer=function createCaretContainer(fill){var caretContainer=SugarElement.fromTag('span');setAll(caretContainer,{'id':CARET_ID$1,'data-mce-bogus':'1','data-mce-type':'format-caret'});if(fill){append(caretContainer,SugarElement.fromText(ZWSP$1));}return caretContainer;};var trimZwspFromCaretContainer=function trimZwspFromCaretContainer(caretContainerNode){var textNode=findFirstTextNode(caretContainerNode);if(textNode&&textNode.nodeValue.charAt(0)===ZWSP$1){textNode.deleteData(0,1);}return textNode;};var removeCaretContainerNode=function removeCaretContainerNode(editor,node,moveCaret){if(moveCaret===void 0){moveCaret=true;}var dom=editor.dom,selection=editor.selection;if(isCaretContainerEmpty(node)){deleteElement(editor,false,SugarElement.fromDom(node),moveCaret);}else{var rng=selection.getRng();var block=dom.getParent(node,dom.isBlock);var startContainer=rng.startContainer;var startOffset=rng.startOffset;var endContainer=rng.endContainer;var endOffset=rng.endOffset;var textNode=trimZwspFromCaretContainer(node);dom.remove(node,true);if(startContainer===textNode&&startOffset>0){rng.setStart(textNode,startOffset-1);}if(endContainer===textNode&&endOffset>0){rng.setEnd(textNode,endOffset-1);}if(block&&dom.isEmpty(block)){fillWithPaddingBr(SugarElement.fromDom(block));}selection.setRng(rng);}};var removeCaretContainer=function removeCaretContainer(editor,node,moveCaret){if(moveCaret===void 0){moveCaret=true;}var dom=editor.dom,selection=editor.selection;if(!node){node=getParentCaretContainer(editor.getBody(),selection.getStart());if(!node){while(node=dom.get(CARET_ID$1)){removeCaretContainerNode(editor,node,false);}}}else{removeCaretContainerNode(editor,node,moveCaret);}};var insertCaretContainerNode=function insertCaretContainerNode(editor,caretContainer,formatNode){var dom=editor.dom,block=dom.getParent(formatNode,curry(isTextBlock$1,editor));if(block&&dom.isEmpty(block)){formatNode.parentNode.replaceChild(caretContainer,formatNode);}else{removeTrailingBr(SugarElement.fromDom(formatNode));if(dom.isEmpty(formatNode)){formatNode.parentNode.replaceChild(caretContainer,formatNode);}else{dom.insertAfter(caretContainer,formatNode);}}};var appendNode=function appendNode(parentNode,node){parentNode.appendChild(node);return node;};var insertFormatNodesIntoCaretContainer=function insertFormatNodesIntoCaretContainer(formatNodes,caretContainer){var innerMostFormatNode=foldr(formatNodes,function(parentNode,formatNode){return appendNode(parentNode,formatNode.cloneNode(false));},caretContainer);return appendNode(innerMostFormatNode,innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));};var cleanFormatNode=function cleanFormatNode(editor,caretContainer,formatNode,name,vars,similar){var formatter=editor.formatter;var dom=editor.dom;var validFormats=filter(keys(formatter.get()),function(formatName){return formatName!==name&&!contains$1(formatName,'removeformat');});var matchedFormats=matchAllOnNode(editor,formatNode,validFormats);var uniqueFormats=filter(matchedFormats,function(fmtName){return!areSimilarFormats(editor,fmtName,name);});if(uniqueFormats.length>0){var clonedFormatNode=formatNode.cloneNode(false);dom.add(caretContainer,clonedFormatNode);formatter.remove(name,vars,clonedFormatNode,similar);dom.remove(clonedFormatNode);return Optional.some(clonedFormatNode);}else{return Optional.none();}};var applyCaretFormat=function applyCaretFormat(editor,name,vars){var caretContainer,textNode;var selection=editor.selection;var selectionRng=selection.getRng();var offset=selectionRng.startOffset;var container=selectionRng.startContainer;var text=container.nodeValue;caretContainer=getParentCaretContainer(editor.getBody(),selection.getStart());if(caretContainer){textNode=findFirstTextNode(caretContainer);}var wordcharRegex=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(text&&offset>0&&offset<text.length&&wordcharRegex.test(text.charAt(offset))&&wordcharRegex.test(text.charAt(offset-1))){var bookmark=selection.getBookmark();selectionRng.collapse(true);var rng=expandRng(editor,selectionRng,editor.formatter.get(name));rng=split$1(rng);editor.formatter.apply(name,vars,rng);selection.moveToBookmark(bookmark);}else{if(!caretContainer||textNode.nodeValue!==ZWSP$1){caretContainer=importNode(editor.getDoc(),createCaretContainer(true).dom);textNode=caretContainer.firstChild;selectionRng.insertNode(caretContainer);offset=1;editor.formatter.apply(name,vars,caretContainer);}else{editor.formatter.apply(name,vars,caretContainer);}selection.setCursorLocation(textNode,offset);}};var removeCaretFormat=function removeCaretFormat(editor,name,vars,similar){var dom=editor.dom;var selection=editor.selection;var hasContentAfter,node,formatNode;var parents=[];var rng=selection.getRng();var container=rng.startContainer;var offset=rng.startOffset;node=container;if(container.nodeType===3){if(offset!==container.nodeValue.length){hasContentAfter=true;}node=node.parentNode;}while(node){if(matchNode(editor,node,name,vars,similar)){formatNode=node;break;}if(node.nextSibling){hasContentAfter=true;}parents.push(node);node=node.parentNode;}if(!formatNode){return;}if(hasContentAfter){var bookmark=selection.getBookmark();rng.collapse(true);var expandedRng=expandRng(editor,rng,editor.formatter.get(name),true);expandedRng=split$1(expandedRng);editor.formatter.remove(name,vars,expandedRng,similar);selection.moveToBookmark(bookmark);}else{var caretContainer=getParentCaretContainer(editor.getBody(),formatNode);var newCaretContainer=createCaretContainer(false).dom;insertCaretContainerNode(editor,newCaretContainer,caretContainer!==null?caretContainer:formatNode);var cleanedFormatNode=cleanFormatNode(editor,newCaretContainer,formatNode,name,vars,similar);var caretTextNode=insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()),newCaretContainer);removeCaretContainerNode(editor,caretContainer,false);selection.setCursorLocation(caretTextNode,1);if(dom.isEmpty(formatNode)){dom.remove(formatNode);}}};var disableCaretContainer=function disableCaretContainer(editor,keyCode){var selection=editor.selection,body=editor.getBody();removeCaretContainer(editor,null,false);if((keyCode===8||keyCode===46)&&selection.isCollapsed()&&selection.getStart().innerHTML===ZWSP$1){removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart()));}if(keyCode===37||keyCode===39){removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart()));}};var setup$3=function setup$3(editor){editor.on('mouseup keydown',function(e){disableCaretContainer(editor,e.keyCode);});};var replaceWithCaretFormat=function replaceWithCaretFormat(targetNode,formatNodes){var caretContainer=createCaretContainer(false);var innerMost=insertFormatNodesIntoCaretContainer(formatNodes,caretContainer.dom);before(SugarElement.fromDom(targetNode),caretContainer);remove(SugarElement.fromDom(targetNode));return CaretPosition$1(innerMost,0);};var isFormatElement=function isFormatElement(editor,element){var inlineElements=editor.schema.getTextInlineElements();return inlineElements.hasOwnProperty(name(element))&&!isCaretNode(element.dom)&&!isBogus(element.dom);};var isEmptyCaretFormatElement=function isEmptyCaretFormatElement(element){return isCaretNode(element.dom)&&isCaretContainerEmpty(element.dom);};var postProcessHooks={};var filter$4=filter$2;var each$8=each$2;var addPostProcessHook=function addPostProcessHook(name,hook){var hooks=postProcessHooks[name];if(!hooks){postProcessHooks[name]=[];}postProcessHooks[name].push(hook);};var postProcess=function postProcess(name,editor){each$8(postProcessHooks[name],function(hook){hook(editor);});};addPostProcessHook('pre',function(editor){var rng=editor.selection.getRng();var blocks;var hasPreSibling=function hasPreSibling(pre){return isPre(pre.previousSibling)&&indexOf$1(blocks,pre.previousSibling)!==-1;};var joinPre=function joinPre(pre1,pre2){DomQuery(pre2).remove();DomQuery(pre1).append('<br><br>').append(pre2.childNodes);};var isPre=matchNodeNames(['pre']);if(!rng.collapsed){blocks=editor.selection.getSelectedBlocks();each$8(filter$4(filter$4(blocks,isPre),hasPreSibling),function(pre){joinPre(pre.previousSibling,pre);});}});var each$9=Tools.each;var isElementNode=function isElementNode(node){return isElement$1(node)&&!isBookmarkNode$1(node)&&!isCaretNode(node)&&!isBogus(node);};var findElementSibling=function findElementSibling(node,siblingName){var sibling;for(sibling=node;sibling;sibling=sibling[siblingName]){if(isText$1(sibling)&&sibling.nodeValue.length!==0){return node;}if(isElement$1(sibling)&&!isBookmarkNode$1(sibling)){return sibling;}}return node;};var mergeSiblingsNodes=function mergeSiblingsNodes(dom,prev,next){var sibling,tmpSibling;var elementUtils=new ElementUtils(dom);if(prev&&next){prev=findElementSibling(prev,'previousSibling');next=findElementSibling(next,'nextSibling');if(elementUtils.compare(prev,next)){for(sibling=prev.nextSibling;sibling&&sibling!==next;){tmpSibling=sibling;sibling=sibling.nextSibling;prev.appendChild(tmpSibling);}dom.remove(next);Tools.each(Tools.grep(next.childNodes),function(node){prev.appendChild(node);});return prev;}}return next;};var mergeSiblings=function mergeSiblings(dom,format,vars,node){if(node&&format.merge_siblings!==false){var newNode=mergeSiblingsNodes(dom,getNonWhiteSpaceSibling(node),node);mergeSiblingsNodes(dom,newNode,getNonWhiteSpaceSibling(newNode,true));}};var clearChildStyles=function clearChildStyles(dom,format,node){if(format.clear_child_styles){var selector=format.links?'*:not(a)':'*';each$9(dom.select(selector,node),function(node){if(isElementNode(node)){each$9(format.styles,function(value,name){dom.setStyle(node,name,'');});}});}};var processChildElements=function processChildElements(node,filter,process){each$9(node.childNodes,function(node){if(isElementNode(node)){if(filter(node)){process(node);}if(node.hasChildNodes()){processChildElements(node,filter,process);}}});};var unwrapEmptySpan=function unwrapEmptySpan(dom,node){if(node.nodeName==='SPAN'&&dom.getAttribs(node).length===0){dom.remove(node,true);}};var hasStyle=function hasStyle(dom,name){return function(node){return!!(node&&getStyle(dom,node,name));};};var applyStyle=function applyStyle(dom,name,value){return function(node){dom.setStyle(node,name,value);if(node.getAttribute('style')===''){node.removeAttribute('style');}unwrapEmptySpan(dom,node);};};var removeResult=Adt.generate([{keep:[]},{rename:['name']},{removed:[]}]);var MCE_ATTR_RE=/^(src|href|style)$/;var each$a=Tools.each;var isEq$3=isEq;var isTableCellOrRow=function isTableCellOrRow(node){return /^(TR|TH|TD)$/.test(node.nodeName);};var isChildOfInlineParent=function isChildOfInlineParent(dom,node,parent){return dom.isChildOf(node,parent)&&node!==parent&&!dom.isBlock(parent);};var getContainer=function getContainer(ed,rng,start){var container,offset;container=rng[start?'startContainer':'endContainer'];offset=rng[start?'startOffset':'endOffset'];if(isElement$1(container)){var lastIdx=container.childNodes.length-1;if(!start&&offset){offset--;}container=container.childNodes[offset>lastIdx?lastIdx:offset];}if(isText$1(container)&&start&&offset>=container.nodeValue.length){container=new DomTreeWalker(container,ed.getBody()).next()||container;}if(isText$1(container)&&!start&&offset===0){container=new DomTreeWalker(container,ed.getBody()).prev()||container;}return container;};var normalizeTableSelection=function normalizeTableSelection(node,start){var prop=start?'firstChild':'lastChild';if(isTableCellOrRow(node)&&node[prop]){var childNode=node[prop];if(node.nodeName==='TR'){return childNode[prop]||childNode;}else{return childNode;}}return node;};var wrap$2=function wrap$2(dom,node,name,attrs){var wrapper=dom.create(name,attrs);node.parentNode.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper;};var wrapWithSiblings=function wrapWithSiblings(dom,node,next,name,attrs){var start=SugarElement.fromDom(node);var wrapper=SugarElement.fromDom(dom.create(name,attrs));var siblings=next?nextSiblings(start):prevSiblings(start);append$1(wrapper,siblings);if(next){before(start,wrapper);prepend(wrapper,start);}else{after(start,wrapper);append(wrapper,start);}return wrapper.dom;};var matchName$1=function matchName$1(dom,node,format){if(isEq$3(node,format.inline)){return true;}if(isEq$3(node,format.block)){return true;}if(format.selector){return isElement$1(node)&&dom.is(node,format.selector);}};var isColorFormatAndAnchor=function isColorFormatAndAnchor(node,format){return format.links&&node.nodeName==='A';};var find$3=function find$3(dom,node,next,inc){node=getNonWhiteSpaceSibling(node,next,inc);return!node||node.nodeName==='BR'||dom.isBlock(node);};var removeNode$1=function removeNode$1(ed,node,format){var parentNode=node.parentNode;var rootBlockElm;var dom=ed.dom,forcedRootBlock=getForcedRootBlock(ed);if(format.block){if(!forcedRootBlock){if(dom.isBlock(node)&&!dom.isBlock(parentNode)){if(!find$3(dom,node,false)&&!find$3(dom,node.firstChild,true,true)){node.insertBefore(dom.create('br'),node.firstChild);}if(!find$3(dom,node,true)&&!find$3(dom,node.lastChild,false,true)){node.appendChild(dom.create('br'));}}}else{if(parentNode===dom.getRoot()){if(!format.list_block||!isEq$3(node,format.list_block)){each(from$1(node.childNodes),function(node){if(isValid(ed,forcedRootBlock,node.nodeName.toLowerCase())){if(!rootBlockElm){rootBlockElm=wrap$2(dom,node,forcedRootBlock);dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs);}else{rootBlockElm.appendChild(node);}}else{rootBlockElm=0;}});}}}}if(format.selector&&format.inline&&!isEq$3(format.inline,node)){return;}dom.remove(node,true);};var removeFormatInternal=function removeFormatInternal(ed,format,vars,node,compareNode){var stylesModified;var dom=ed.dom;if(!matchName$1(dom,node,format)&&!isColorFormatAndAnchor(node,format)){return removeResult.keep();}var elm=node;if(format.inline&&format.remove==='all'&&isArray(format.preserve_attributes)){var attrsToPreserve=filter(dom.getAttribs(elm),function(attr){return contains(format.preserve_attributes,attr.name.toLowerCase());});dom.removeAllAttribs(elm);each(attrsToPreserve,function(attr){return dom.setAttrib(elm,attr.name,attr.value);});if(attrsToPreserve.length>0){return removeResult.rename('span');}}if(format.remove!=='all'){each$a(format.styles,function(value,name){value=normalizeStyleValue(dom,replaceVars(value,vars),name+'');if(isNumber(name)){name=value;compareNode=null;}if(format.remove_similar||!compareNode||isEq$3(getStyle(dom,compareNode,name),value)){dom.setStyle(elm,name,'');}stylesModified=true;});if(stylesModified&&dom.getAttrib(elm,'style')===''){elm.removeAttribute('style');elm.removeAttribute('data-mce-style');}each$a(format.attributes,function(value,name){var valueOut;value=replaceVars(value,vars);if(isNumber(name)){name=value;compareNode=null;}if(format.remove_similar||!compareNode||isEq$3(dom.getAttrib(compareNode,name),value)){if(name==='class'){value=dom.getAttrib(elm,name);if(value){valueOut='';each(value.split(/\s+/),function(cls){if(/mce\-\w+/.test(cls)){valueOut+=(valueOut?' ':'')+cls;}});if(valueOut){dom.setAttrib(elm,name,valueOut);return;}}}if(name==='class'){elm.removeAttribute('className');}if(MCE_ATTR_RE.test(name)){elm.removeAttribute('data-mce-'+name);}elm.removeAttribute(name);}});each$a(format.classes,function(value){value=replaceVars(value,vars);if(!compareNode||dom.hasClass(compareNode,value)){dom.removeClass(elm,value);}});var attrs=dom.getAttribs(elm);for(var i=0;i<attrs.length;i++){var attrName=attrs[i].nodeName;if(attrName.indexOf('_')!==0&&attrName.indexOf('data-')!==0){return removeResult.keep();}}}if(format.remove!=='none'){removeNode$1(ed,elm,format);return removeResult.removed();}return removeResult.keep();};var removeFormat=function removeFormat(ed,format,vars,node,compareNode){return removeFormatInternal(ed,format,vars,node,compareNode).fold(never,function(newName){ed.dom.rename(node,newName);return true;},always);};var findFormatRoot=function findFormatRoot(editor,container,name,vars,similar){var formatRoot;each(getParents$1(editor.dom,container.parentNode).reverse(),function(parent){if(!formatRoot&&parent.id!=='_start'&&parent.id!=='_end'){var format=matchNode(editor,parent,name,vars,similar);if(format&&format.split!==false){formatRoot=parent;}}});return formatRoot;};var removeFormatFromClone=function removeFormatFromClone(editor,format,vars,clone){return removeFormatInternal(editor,format,vars,clone,clone).fold(constant(clone),function(newName){var fragment=editor.dom.createFragment();fragment.appendChild(clone);return editor.dom.rename(clone,newName);},constant(null));};var wrapAndSplit=function wrapAndSplit(editor,formatList,formatRoot,container,target,split,format,vars){var clone,lastClone,firstClone;var dom=editor.dom;if(formatRoot){var formatRootParent=formatRoot.parentNode;for(var parent_1=container.parentNode;parent_1&&parent_1!==formatRootParent;parent_1=parent_1.parentNode){clone=dom.clone(parent_1,false);for(var i=0;i<formatList.length;i++){clone=removeFormatFromClone(editor,formatList[i],vars,clone);if(clone===null){break;}}if(clone){if(lastClone){clone.appendChild(lastClone);}if(!firstClone){firstClone=clone;}lastClone=clone;}}if(split&&(!format.mixed||!dom.isBlock(formatRoot))){container=dom.split(formatRoot,container);}if(lastClone){target.parentNode.insertBefore(lastClone,target);firstClone.appendChild(target);if(format.inline){mergeSiblings(dom,format,vars,lastClone);}}}return container;};var remove$6=function remove$6(ed,name,vars,node,similar){var formatList=ed.formatter.get(name);var format=formatList[0];var contentEditable=true;var dom=ed.dom;var selection=ed.selection;var splitToFormatRoot=function splitToFormatRoot(container){var formatRoot=findFormatRoot(ed,container,name,vars,similar);return wrapAndSplit(ed,formatList,formatRoot,container,container,true,format,vars);};var isRemoveBookmarkNode=function isRemoveBookmarkNode(node){return isBookmarkNode$1(node)&&isElement$1(node)&&(node.id==='_start'||node.id==='_end');};var process=function process(node){var lastContentEditable,hasContentEditableState;if(isElement$1(node)&&dom.getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=dom.getContentEditable(node)==='true';hasContentEditableState=true;}var children=from$1(node.childNodes);if(contentEditable&&!hasContentEditableState){for(var i=0;i<formatList.length;i++){if(removeFormat(ed,formatList[i],vars,node,node)){break;}}}if(format.deep){if(children.length){for(var i=0;i<children.length;i++){process(children[i]);}if(hasContentEditableState){contentEditable=lastContentEditable;}}}};var unwrap=function unwrap(start){var node=dom.get(start?'_start':'_end');var out=node[start?'firstChild':'lastChild'];if(isRemoveBookmarkNode(out)){out=out[start?'firstChild':'lastChild'];}if(isText$1(out)&&out.data.length===0){out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling;}dom.remove(node,true);return out;};var removeRngStyle=function removeRngStyle(rng){var startContainer,endContainer;var expandedRng=expandRng(ed,rng,formatList,true);if(format.split){expandedRng=split$1(expandedRng);startContainer=getContainer(ed,expandedRng,true);endContainer=getContainer(ed,expandedRng);if(startContainer!==endContainer){startContainer=normalizeTableSelection(startContainer,true);endContainer=normalizeTableSelection(endContainer,false);if(isChildOfInlineParent(dom,startContainer,endContainer)){var marker=Optional.from(startContainer.firstChild).getOr(startContainer);splitToFormatRoot(wrapWithSiblings(dom,marker,true,'span',{'id':'_start','data-mce-type':'bookmark'}));unwrap(true);return;}if(isChildOfInlineParent(dom,endContainer,startContainer)){var marker=Optional.from(endContainer.lastChild).getOr(endContainer);splitToFormatRoot(wrapWithSiblings(dom,marker,false,'span',{'id':'_end','data-mce-type':'bookmark'}));unwrap(false);return;}startContainer=wrap$2(dom,startContainer,'span',{'id':'_start','data-mce-type':'bookmark'});endContainer=wrap$2(dom,endContainer,'span',{'id':'_end','data-mce-type':'bookmark'});var newRng=dom.createRng();newRng.setStartAfter(startContainer);newRng.setEndBefore(endContainer);walk$1(dom,newRng,function(nodes){each(nodes,function(n){if(!isBookmarkNode$1(n)&&!isBookmarkNode$1(n.parentNode)){splitToFormatRoot(n);}});});splitToFormatRoot(startContainer);splitToFormatRoot(endContainer);startContainer=unwrap(true);endContainer=unwrap();}else{startContainer=endContainer=splitToFormatRoot(startContainer);}expandedRng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer;expandedRng.startOffset=dom.nodeIndex(startContainer);expandedRng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer;expandedRng.endOffset=dom.nodeIndex(endContainer)+1;}walk$1(dom,expandedRng,function(nodes){each(nodes,function(node){process(node);var textDecorations=['underline','line-through','overline'];each(textDecorations,function(decoration){if(isElement$1(node)&&ed.dom.getStyle(node,'text-decoration')===decoration&&node.parentNode&&getTextDecoration(dom,node.parentNode)===decoration){removeFormat(ed,{deep:false,exact:true,inline:'span',styles:{textDecoration:decoration}},null,node);}});});});};if(node){if(isNode(node)){var rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);removeRngStyle(rng);}else{removeRngStyle(node);}return;}if(dom.getContentEditable(selection.getNode())==='false'){node=selection.getNode();for(var i=0;i<formatList.length;i++){if(formatList[i].ceFalseOverride){if(removeFormat(ed,formatList[i],vars,node,node)){break;}}}return;}if(!selection.isCollapsed()||!format.inline||getCellsFromEditor(ed).length){preserve(selection,true,function(){runOnRanges(ed,removeRngStyle);});if(format.inline&&match(ed,name,vars,selection.getStart())){moveStart(dom,selection,selection.getRng());}ed.nodeChanged();}else{removeCaretFormat(ed,name,vars,similar);}};var each$b=Tools.each;var mergeTextDecorationsAndColor=function mergeTextDecorationsAndColor(dom,format,vars,node){var processTextDecorationsAndColor=function processTextDecorationsAndColor(n){if(n.nodeType===1&&n.parentNode&&n.parentNode.nodeType===1){var textDecoration=getTextDecoration(dom,n.parentNode);if(dom.getStyle(n,'color')&&textDecoration){dom.setStyle(n,'text-decoration',textDecoration);}else if(dom.getStyle(n,'text-decoration')===textDecoration){dom.setStyle(n,'text-decoration',null);}}};if(format.styles&&(format.styles.color||format.styles.textDecoration)){Tools.walk(node,processTextDecorationsAndColor,'childNodes');processTextDecorationsAndColor(node);}};var mergeBackgroundColorAndFontSize=function mergeBackgroundColorAndFontSize(dom,format,vars,node){if(format.styles&&format.styles.backgroundColor){processChildElements(node,hasStyle(dom,'fontSize'),applyStyle(dom,'backgroundColor',replaceVars(format.styles.backgroundColor,vars)));}};var mergeSubSup=function mergeSubSup(dom,format,vars,node){if(format.inline==='sub'||format.inline==='sup'){processChildElements(node,hasStyle(dom,'fontSize'),applyStyle(dom,'fontSize',''));dom.remove(dom.select(format.inline==='sup'?'sub':'sup',node),true);}};var mergeWithChildren=function mergeWithChildren(editor,formatList,vars,node){each$b(formatList,function(format){each$b(editor.dom.select(format.inline,node),function(child){if(!isElementNode(child)){return;}removeFormat(editor,format,vars,child,format.exact?child:null);});clearChildStyles(editor.dom,format,node);});};var mergeWithParents=function mergeWithParents(editor,format,name,vars,node){if(matchNode(editor,node.parentNode,name,vars)){if(removeFormat(editor,format,vars,node)){return;}}if(format.merge_with_parents){editor.dom.getParent(node.parentNode,function(parent){if(matchNode(editor,parent,name,vars)){removeFormat(editor,format,vars,node);return true;}});}};var each$c=Tools.each;var isElementNode$1=function isElementNode$1(node){return node&&node.nodeType===1&&!isBookmarkNode$1(node)&&!isCaretNode(node)&&!isBogus(node);};var applyFormat=function applyFormat(ed,name,vars,node){var formatList=ed.formatter.get(name);var format=formatList[0];var rng;var isCollapsed=!node&&ed.selection.isCollapsed();var dom=ed.dom,selection=ed.selection;var setElementFormat=function setElementFormat(elm,fmt){fmt=fmt||format;if(elm){if(fmt.onformat){fmt.onformat(elm,fmt,vars,node);}each$c(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars));});if(fmt.styles){var styleVal=dom.getAttrib(elm,'style');if(styleVal){dom.setAttrib(elm,'data-mce-style',styleVal);}}each$c(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars));});each$c(fmt.classes,function(value){value=replaceVars(value,vars);if(!dom.hasClass(elm,value)){dom.addClass(elm,value);}});}};var applyNodeStyle=function applyNodeStyle(formatList,node){var found=false;if(!format.selector){return false;}each$c(formatList,function(format){if('collapsed'in format&&format.collapsed!==isCollapsed){return;}if(dom.is(node,format.selector)&&!isCaretNode(node)){setElementFormat(node,format);found=true;return false;}});return found;};var applyRngStyle=function applyRngStyle(dom,rng,bookmark,nodeSpecific){var newWrappers=[];var contentEditable=true;var wrapName=format.inline||format.block;var wrapElm=dom.create(wrapName);setElementFormat(wrapElm);walk$1(dom,rng,function(nodes){var currentWrapElm;var process=function process(node){var hasContentEditableState=false;var lastContentEditable=contentEditable;var nodeName=node.nodeName.toLowerCase();var parentName=node.parentNode.nodeName.toLowerCase();if(isElement$1(node)&&dom.getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=dom.getContentEditable(node)==='true';hasContentEditableState=true;}if(isEq(nodeName,'br')){currentWrapElm=0;if(format.block){dom.remove(node);}return;}if(format.wrapper&&matchNode(ed,node,name,vars)){currentWrapElm=0;return;}if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock$1(ed,nodeName)&&isValid(ed,parentName,wrapName)){var elm=dom.rename(node,wrapName);setElementFormat(elm);newWrappers.push(elm);currentWrapElm=0;return;}if(format.selector){var found=applyNodeStyle(formatList,node);if(!format.inline||found){currentWrapElm=0;return;}}if(contentEditable&&!hasContentEditableState&&isValid(ed,wrapName,nodeName)&&isValid(ed,parentName,wrapName)&&!(!nodeSpecific&&node.nodeType===3&&node.nodeValue.length===1&&node.nodeValue.charCodeAt(0)===65279)&&!isCaretNode(node)&&(!format.inline||!dom.isBlock(node))){if(!currentWrapElm){currentWrapElm=dom.clone(wrapElm,false);node.parentNode.insertBefore(currentWrapElm,node);newWrappers.push(currentWrapElm);}currentWrapElm.appendChild(node);}else{currentWrapElm=0;each$c(Tools.grep(node.childNodes),process);if(hasContentEditableState){contentEditable=lastContentEditable;}currentWrapElm=0;}};each$c(nodes,process);});if(format.links===true){each$c(newWrappers,function(node){var process=function process(node){if(node.nodeName==='A'){setElementFormat(node,format);}each$c(Tools.grep(node.childNodes),process);};process(node);});}each$c(newWrappers,function(node){var getChildCount=function getChildCount(node){var count=0;each$c(node.childNodes,function(node){if(!isEmptyTextNode(node)&&!isBookmarkNode$1(node)){count++;}});return count;};var getChildElementNode=function getChildElementNode(root){var child=false;each$c(root.childNodes,function(node){if(isElementNode$1(node)){child=node;return false;}});return child;};var mergeStyles=function mergeStyles(node){var clone;var child=getChildElementNode(node);if(child&&!isBookmarkNode$1(child)&&matchName(dom,child,format)){clone=dom.clone(child,false);setElementFormat(clone);dom.replace(clone,node,true);dom.remove(child,true);}return clone||node;};var childCount=getChildCount(node);if((newWrappers.length>1||!dom.isBlock(node))&&childCount===0){dom.remove(node,true);return;}if(format.inline||format.wrapper){if(!format.exact&&childCount===1){node=mergeStyles(node);}mergeWithChildren(ed,formatList,vars,node);mergeWithParents(ed,format,name,vars,node);mergeBackgroundColorAndFontSize(dom,format,vars,node);mergeTextDecorationsAndColor(dom,format,vars,node);mergeSubSup(dom,format,vars,node);mergeSiblings(dom,format,vars,node);}});};if(dom.getContentEditable(selection.getNode())==='false'){node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++){if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector)){setElementFormat(node,formatList[i]);return;}}return;}if(format){if(node){if(isNode(node)){if(!applyNodeStyle(formatList,node)){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);applyRngStyle(dom,expandRng(ed,rng,formatList),null,true);}}else{applyRngStyle(dom,node,null,true);}}else{if(!isCollapsed||!format.inline||getCellsFromEditor(ed).length){var curSelNode=selection.getNode();if(!ed.settings.forced_root_block&&formatList[0].defaultBlock&&!dom.getParent(curSelNode,dom.isBlock)){applyFormat(ed,formatList[0].defaultBlock);}selection.setRng(normalize$2(selection.getRng()));preserve(selection,true,function(bookmark){runOnRanges(ed,function(selectionRng,fake){var expandedRng=fake?selectionRng:expandRng(ed,selectionRng,formatList);applyRngStyle(dom,expandedRng);});});moveStart(dom,selection,selection.getRng());ed.nodeChanged();}else{applyCaretFormat(ed,name,vars);}}postProcess(name,ed);}};var _toggle=function toggle(editor,name,vars,node){var fmt=editor.formatter.get(name);if(match(editor,name,vars,node)&&(!('toggle'in fmt[0])||fmt[0].toggle)){remove$6(editor,name,vars,node);}else{applyFormat(editor,name,vars,node);}};var fromElements=function fromElements(elements,scope){var doc=scope||document;var fragment=doc.createDocumentFragment();each(elements,function(element){fragment.appendChild(element.dom);});return SugarElement.fromDom(fragment);};var tableModel=function tableModel(element,width,rows){return{element:element,width:width,rows:rows};};var tableRow=function tableRow(element,cells){return{element:element,cells:cells};};var cellPosition=function cellPosition(x,y){return{x:x,y:y};};var getSpan=function getSpan(td,key){var value=parseInt(get$3(td,key),10);return isNaN(value)?1:value;};var fillout=function fillout(table,x,y,tr,td){var rowspan=getSpan(td,'rowspan');var colspan=getSpan(td,'colspan');var rows=table.rows;for(var y2=y;y2<y+rowspan;y2++){if(!rows[y2]){rows[y2]=tableRow(deep(tr),[]);}for(var x2=x;x2<x+colspan;x2++){var cells=rows[y2].cells;cells[x2]=y2===y&&x2===x?td:shallow(td);}}};var cellExists=function cellExists(table,x,y){var rows=table.rows;var cells=rows[y]?rows[y].cells:[];return!!cells[x];};var skipCellsX=function skipCellsX(table,x,y){while(cellExists(table,x,y)){x++;}return x;};var getWidth=function getWidth(rows){return foldl(rows,function(acc,row){return row.cells.length>acc?row.cells.length:acc;},0);};var findElementPos=function findElementPos(table,element){var rows=table.rows;for(var y=0;y<rows.length;y++){var cells=rows[y].cells;for(var x=0;x<cells.length;x++){if(eq$2(cells[x],element)){return Optional.some(cellPosition(x,y));}}}return Optional.none();};var extractRows=function extractRows(table,sx,sy,ex,ey){var newRows=[];var rows=table.rows;for(var y=sy;y<=ey;y++){var cells=rows[y].cells;var slice=sx<ex?cells.slice(sx,ex+1):cells.slice(ex,sx+1);newRows.push(tableRow(rows[y].element,slice));}return newRows;};var subTable=function subTable(table,startPos,endPos){var sx=startPos.x,sy=startPos.y;var ex=endPos.x,ey=endPos.y;var newRows=sy<ey?extractRows(table,sx,sy,ex,ey):extractRows(table,sx,ey,ex,sy);return tableModel(table.element,getWidth(newRows),newRows);};var createDomTable=function createDomTable(table,rows){var tableElement=shallow(table.element);var tableBody=SugarElement.fromTag('tbody');append$1(tableBody,rows);append(tableElement,tableBody);return tableElement;};var modelRowsToDomRows=function modelRowsToDomRows(table){return map(table.rows,function(row){var cells=map(row.cells,function(cell){var td=deep(cell);remove$1(td,'colspan');remove$1(td,'rowspan');return td;});var tr=shallow(row.element);append$1(tr,cells);return tr;});};var fromDom$1=function fromDom$1(tableElm){var table=tableModel(shallow(tableElm),0,[]);each(descendants$1(tableElm,'tr'),function(tr,y){each(descendants$1(tr,'td,th'),function(td,x){fillout(table,skipCellsX(table,x,y),y,tr,td);});});return tableModel(table.element,getWidth(table.rows),table.rows);};var toDom=function toDom(table){return createDomTable(table,modelRowsToDomRows(table));};var subsection=function subsection(table,startElement,endElement){return findElementPos(table,startElement).bind(function(startPos){return findElementPos(table,endElement).map(function(endPos){return subTable(table,startPos,endPos);});});};var findParentListContainer=function findParentListContainer(parents){return find(parents,function(elm){return name(elm)==='ul'||name(elm)==='ol';});};var getFullySelectedListWrappers=function getFullySelectedListWrappers(parents,rng){return find(parents,function(elm){return name(elm)==='li'&&hasAllContentsSelected(elm,rng);}).fold(constant([]),function(_li){return findParentListContainer(parents).map(function(listCont){var listElm=SugarElement.fromTag(name(listCont));var listStyles=filter$1(getAllRaw(listCont),function(_style,name){return startsWith(name,'list-style');});setAll$1(listElm,listStyles);return[SugarElement.fromTag('li'),listElm];}).getOr([]);});};var wrap$3=function wrap$3(innerElm,elms){var wrapped=foldl(elms,function(acc,elm){append(elm,acc);return elm;},innerElm);return elms.length>0?fromElements([wrapped]):wrapped;};var directListWrappers=function directListWrappers(commonAnchorContainer){if(isListItem(commonAnchorContainer)){return parent(commonAnchorContainer).filter(isList).fold(constant([]),function(listElm){return[commonAnchorContainer,listElm];});}else{return isList(commonAnchorContainer)?[commonAnchorContainer]:[];}};var getWrapElements=function getWrapElements(rootNode,rng){var commonAnchorContainer=SugarElement.fromDom(rng.commonAncestorContainer);var parents=parentsAndSelf(commonAnchorContainer,rootNode);var wrapElements=filter(parents,function(elm){return isInline(elm)||isHeading(elm);});var listWrappers=getFullySelectedListWrappers(parents,rng);var allWrappers=wrapElements.concat(listWrappers.length?listWrappers:directListWrappers(commonAnchorContainer));return map(allWrappers,shallow);};var emptyFragment=function emptyFragment(){return fromElements([]);};var getFragmentFromRange=function getFragmentFromRange(rootNode,rng){return wrap$3(SugarElement.fromDom(rng.cloneContents()),getWrapElements(rootNode,rng));};var getParentTable=function getParentTable(rootElm,cell){return ancestor$1(cell,'table',curry(eq$2,rootElm));};var getTableFragment=function getTableFragment(rootNode,selectedTableCells){return getParentTable(rootNode,selectedTableCells[0]).bind(function(tableElm){var firstCell=selectedTableCells[0];var lastCell=selectedTableCells[selectedTableCells.length-1];var fullTableModel=fromDom$1(tableElm);return subsection(fullTableModel,firstCell,lastCell).map(function(sectionedTableModel){return fromElements([toDom(sectionedTableModel)]);});}).getOrThunk(emptyFragment);};var getSelectionFragment=function getSelectionFragment(rootNode,ranges){return ranges.length>0&&ranges[0].collapsed?emptyFragment():getFragmentFromRange(rootNode,ranges[0]);};var read$1=function read$1(rootNode,ranges){var selectedCells=getCellsFromElementOrRanges(ranges,rootNode);return selectedCells.length>0?getTableFragment(rootNode,selectedCells):getSelectionFragment(rootNode,ranges);};var trimLeadingCollapsibleText=function trimLeadingCollapsibleText(text){return text.replace(/^[ \f\n\r\t\v]+/,'');};var isCollapsibleWhitespace=function isCollapsibleWhitespace(text,index){return index>=0&&index<text.length&&isWhiteSpace$1(text.charAt(index));};var getInnerText=function getInnerText(bin){var text=trim$2(bin.innerText);return Env.browser.isIE()?trimLeadingCollapsibleText(text):text;};var getTextContent=function getTextContent(editor){return Optional.from(editor.selection.getRng()).map(function(rng){var bin=editor.dom.add(editor.getBody(),'div',{'data-mce-bogus':'all','style':'overflow: hidden; opacity: 0;'},rng.cloneContents());var text=getInnerText(bin);var nonRenderedText=trim$2(bin.textContent);editor.dom.remove(bin);if(isCollapsibleWhitespace(nonRenderedText,0)||isCollapsibleWhitespace(nonRenderedText,nonRenderedText.length-1)){var parentBlock=editor.dom.getParent(rng.commonAncestorContainer,editor.dom.isBlock);var parentBlockText=getInnerText(parentBlock);var textIndex=parentBlockText.indexOf(text);if(textIndex!==-1){var hasProceedingSpace=isCollapsibleWhitespace(parentBlockText,textIndex-1);var hasTrailingSpace=isCollapsibleWhitespace(parentBlockText,textIndex+text.length);return(hasProceedingSpace?' ':'')+text+(hasTrailingSpace?' ':'');}else{return text;}}else{return text;}}).getOr('');};var getSerializedContent=function getSerializedContent(editor,args){var rng=editor.selection.getRng(),tmpElm=editor.dom.create('body');var sel=editor.selection.getSel();var ranges=processRanges(editor,getRanges(sel));var fragment=args.contextual?read$1(SugarElement.fromDom(editor.getBody()),ranges).dom:rng.cloneContents();if(fragment){tmpElm.appendChild(fragment);}return editor.selection.serializer.serialize(tmpElm,args);};var getSelectedContentInternal=function getSelectedContentInternal(editor,format,args){if(args===void 0){args={};}args.get=true;args.format=format;args.selection=true;args=editor.fire('BeforeGetContent',args);if(args.isDefaultPrevented()){editor.fire('GetContent',args);return args.content;}if(args.format==='text'){return getTextContent(editor);}else{args.getInner=true;var content=getSerializedContent(editor,args);if(args.format==='tree'){return content;}else{args.content=editor.selection.isCollapsed()?'':content;editor.fire('GetContent',args);return args.content;}}};var KEEP=0,INSERT=1,DELETE=2;var diff=function diff(left,right){var size=left.length+right.length+2;var vDown=new Array(size);var vUp=new Array(size);var snake=function snake(start,end,diag){return{start:start,end:end,diag:diag};};var buildScript=function buildScript(start1,end1,start2,end2,script){var middle=getMiddleSnake(start1,end1,start2,end2);if(middle===null||middle.start===end1&&middle.diag===end1-end2||middle.end===start1&&middle.diag===start1-start2){var i=start1;var j=start2;while(i<end1||j<end2){if(i<end1&&j<end2&&left[i]===right[j]){script.push([KEEP,left[i]]);++i;++j;}else{if(end1-start1>end2-start2){script.push([DELETE,left[i]]);++i;}else{script.push([INSERT,right[j]]);++j;}}}}else{buildScript(start1,middle.start,start2,middle.start-middle.diag,script);for(var i2=middle.start;i2<middle.end;++i2){script.push([KEEP,left[i2]]);}buildScript(middle.end,end1,middle.end-middle.diag,end2,script);}};var buildSnake=function buildSnake(start,diag,end1,end2){var end=start;while(end-diag<end2&&end<end1&&left[end]===right[end-diag]){++end;}return snake(start,end,diag);};var getMiddleSnake=function getMiddleSnake(start1,end1,start2,end2){var m=end1-start1;var n=end2-start2;if(m===0||n===0){return null;}var delta=m-n;var sum=n+m;var offset=(sum%2===0?sum:sum+1)/2;vDown[1+offset]=start1;vUp[1+offset]=end1+1;var d,k,i,x,y;for(d=0;d<=offset;++d){for(k=-d;k<=d;k+=2){i=k+offset;if(k===-d||k!==d&&vDown[i-1]<vDown[i+1]){vDown[i]=vDown[i+1];}else{vDown[i]=vDown[i-1]+1;}x=vDown[i];y=x-start1+start2-k;while(x<end1&&y<end2&&left[x]===right[y]){vDown[i]=++x;++y;}if(delta%2!==0&&delta-d<=k&&k<=delta+d){if(vUp[i-delta]<=vDown[i]){return buildSnake(vUp[i-delta],k+start1-start2,end1,end2);}}}for(k=delta-d;k<=delta+d;k+=2){i=k+offset-delta;if(k===delta-d||k!==delta+d&&vUp[i+1]<=vUp[i-1]){vUp[i]=vUp[i+1]-1;}else{vUp[i]=vUp[i-1];}x=vUp[i]-1;y=x-start1+start2-k;while(x>=start1&&y>=start2&&left[x]===right[y]){vUp[i]=x--;y--;}if(delta%2===0&&-d<=k&&k<=d){if(vUp[i]<=vDown[i+delta]){return buildSnake(vUp[i],k+start1-start2,end1,end2);}}}}};var script=[];buildScript(0,left.length,0,right.length,script);return script;};var getOuterHtml=function getOuterHtml(elm){if(isElement$1(elm)){return elm.outerHTML;}else if(isText$1(elm)){return Entities.encodeRaw(elm.data,false);}else if(isComment$1(elm)){return'<!--'+elm.data+'-->';}return'';};var createFragment$1=function createFragment$1(html){var node;var container=document.createElement('div');var frag=document.createDocumentFragment();if(html){container.innerHTML=html;}while(node=container.firstChild){frag.appendChild(node);}return frag;};var insertAt=function insertAt(elm,html,index){var fragment=createFragment$1(html);if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.insertBefore(fragment,target);}else{elm.appendChild(fragment);}};var removeAt=function removeAt(elm,index){if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.removeChild(target);}};var applyDiff=function applyDiff(diff,elm){var index=0;each(diff,function(action){if(action[0]===KEEP){index++;}else if(action[0]===INSERT){insertAt(elm,action[1],index);index++;}else if(action[0]===DELETE){removeAt(elm,index);}});};var read$2=function read$2(elm){return filter(map(from$1(elm.childNodes),getOuterHtml),function(item){return item.length>0;});};var write=function write(fragments,elm){var currentFragments=map(from$1(elm.childNodes),getOuterHtml);applyDiff(diff(currentFragments,fragments),elm);return elm;};var undoLevelDocument=Cell(Optional.none());var lazyTempDocument=function lazyTempDocument(){return undoLevelDocument.get().getOrThunk(function(){var doc=document.implementation.createHTMLDocument('undo');undoLevelDocument.set(Optional.some(doc));return doc;});};var hasIframes=function hasIframes(html){return html.indexOf('</iframe>')!==-1;};var createFragmentedLevel=function createFragmentedLevel(fragments){return{type:'fragmented',fragments:fragments,content:'',bookmark:null,beforeBookmark:null};};var createCompleteLevel=function createCompleteLevel(content){return{type:'complete',fragments:null,content:content,bookmark:null,beforeBookmark:null};};var createFromEditor=function createFromEditor(editor){var fragments=read$2(editor.getBody());var trimmedFragments=bind(fragments,function(html){var trimmed=trimInternal(editor.serializer,html);return trimmed.length>0?[trimmed]:[];});var content=trimmedFragments.join('');return hasIframes(content)?createFragmentedLevel(trimmedFragments):createCompleteLevel(content);};var applyToEditor=function applyToEditor(editor,level,before){if(level.type==='fragmented'){write(level.fragments,editor.getBody());}else{editor.setContent(level.content,{format:'raw'});}editor.selection.moveToBookmark(before?level.beforeBookmark:level.bookmark);};var getLevelContent=function getLevelContent(level){return level.type==='fragmented'?level.fragments.join(''):level.content;};var getCleanLevelContent=function getCleanLevelContent(level){var elm=SugarElement.fromTag('body',lazyTempDocument());set$1(elm,getLevelContent(level));each(descendants$1(elm,'*[data-mce-bogus]'),unwrap);return get$6(elm);};var hasEqualContent=function hasEqualContent(level1,level2){return getLevelContent(level1)===getLevelContent(level2);};var hasEqualCleanedContent=function hasEqualCleanedContent(level1,level2){return getCleanLevelContent(level1)===getCleanLevelContent(level2);};var isEq$4=function isEq$4(level1,level2){if(!level1||!level2){return false;}else if(hasEqualContent(level1,level2)){return true;}else{return hasEqualCleanedContent(level1,level2);}};var isUnlocked=function isUnlocked(locks){return locks.get()===0;};var setTyping=function setTyping(undoManager,typing,locks){if(isUnlocked(locks)){undoManager.typing=typing;}};var endTyping=function endTyping(undoManager,locks){if(undoManager.typing){setTyping(undoManager,false,locks);undoManager.add();}};var endTypingLevelIgnoreLocks=function endTypingLevelIgnoreLocks(undoManager){if(undoManager.typing){undoManager.typing=false;undoManager.add();}};var _beforeChange=function beforeChange(editor,locks,beforeBookmark){if(isUnlocked(locks)){beforeBookmark.set(Optional.some(getUndoBookmark(editor.selection)));}};var _addUndoLevel=function addUndoLevel(editor,undoManager,index,locks,beforeBookmark,level,event){var currentLevel=createFromEditor(editor);level=level||{};level=Tools.extend(level,currentLevel);if(isUnlocked(locks)===false||editor.removed){return null;}var lastLevel=undoManager.data[index.get()];if(editor.fire('BeforeAddUndo',{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented()){return null;}if(lastLevel&&isEq$4(lastLevel,level)){return null;}if(undoManager.data[index.get()]){beforeBookmark.get().each(function(bm){undoManager.data[index.get()].beforeBookmark=bm;});}var customUndoRedoLevels=getCustomUndoRedoLevels(editor);if(customUndoRedoLevels){if(undoManager.data.length>customUndoRedoLevels){for(var i=0;i<undoManager.data.length-1;i++){undoManager.data[i]=undoManager.data[i+1];}undoManager.data.length--;index.set(undoManager.data.length);}}level.bookmark=getUndoBookmark(editor.selection);if(index.get()<undoManager.data.length-1){undoManager.data.length=index.get()+1;}undoManager.data.push(level);index.set(undoManager.data.length-1);var args={level:level,lastLevel:lastLevel,originalEvent:event};if(index.get()>0){editor.setDirty(true);editor.fire('AddUndo',args);editor.fire('change',args);}else{editor.fire('AddUndo',args);}return level;};var _clear=function clear(editor,undoManager,index){undoManager.data=[];index.set(0);undoManager.typing=false;editor.fire('ClearUndos');};var _extra=function extra(editor,undoManager,index,callback1,callback2){if(undoManager.transact(callback1)){var bookmark=undoManager.data[index.get()].bookmark;var lastLevel=undoManager.data[index.get()-1];applyToEditor(editor,lastLevel,true);if(undoManager.transact(callback2)){undoManager.data[index.get()-1].beforeBookmark=bookmark;}}};var _redo=function redo(editor,index,data){var level;if(index.get()<data.length-1){index.set(index.get()+1);level=data[index.get()];applyToEditor(editor,level,false);editor.setDirty(true);editor.fire('Redo',{level:level});}return level;};var _undo=function undo(editor,undoManager,locks,index){var level;if(undoManager.typing){undoManager.add();undoManager.typing=false;setTyping(undoManager,false,locks);}if(index.get()>0){index.set(index.get()-1);level=undoManager.data[index.get()];applyToEditor(editor,level,true);editor.setDirty(true);editor.fire('Undo',{level:level});}return level;};var _reset=function reset(undoManager){undoManager.clear();undoManager.add();};var _hasUndo=function hasUndo(editor,undoManager,index){return index.get()>0||undoManager.typing&&undoManager.data[0]&&!isEq$4(createFromEditor(editor),undoManager.data[0]);};var _hasRedo=function hasRedo(undoManager,index){return index.get()<undoManager.data.length-1&&!undoManager.typing;};var _transact=function transact(undoManager,locks,callback){endTyping(undoManager,locks);undoManager.beforeChange();undoManager.ignore(callback);return undoManager.add();};var _ignore=function ignore(locks,callback){try{locks.set(locks.get()+1);callback();}finally{locks.set(locks.get()-1);}};var isTreeNode$1=function isTreeNode$1(content){return content instanceof AstNode;};var runSerializerFiltersOnFragment=function runSerializerFiltersOnFragment(editor,fragment){filter$3(editor.serializer.getNodeFilters(),editor.serializer.getAttributeFilters(),fragment);};var getInsertContext=function getInsertContext(editor){return Optional.from(editor.selection.getStart(true)).map(function(elm){return elm.nodeName.toLowerCase();});};var createDummyUndoLevel=function createDummyUndoLevel(){return{type:'complete',fragments:[],content:'',bookmark:null,beforeBookmark:null};};var makePlainAdaptor=function makePlainAdaptor(editor){return{undoManager:{beforeChange:function beforeChange(locks,beforeBookmark){return _beforeChange(editor,locks,beforeBookmark);},addUndoLevel:function addUndoLevel(undoManager,index,locks,beforeBookmark,level,event){return _addUndoLevel(editor,undoManager,index,locks,beforeBookmark,level,event);},undo:function undo(undoManager,locks,index){return _undo(editor,undoManager,locks,index);},redo:function redo(index,data){return _redo(editor,index,data);},clear:function clear(undoManager,index){return _clear(editor,undoManager,index);},reset:function reset(undoManager){return _reset(undoManager);},hasUndo:function hasUndo(undoManager,index){return _hasUndo(editor,undoManager,index);},hasRedo:function hasRedo(undoManager,index){return _hasRedo(undoManager,index);},transact:function transact(undoManager,locks,callback){return _transact(undoManager,locks,callback);},ignore:function ignore(locks,callback){return _ignore(locks,callback);},extra:function extra(undoManager,index,callback1,callback2){return _extra(editor,undoManager,index,callback1,callback2);}},formatter:{apply:function apply(name,vars,node){return applyFormat(editor,name,vars,node);},remove:function remove(name,vars,node,similar){return remove$6(editor,name,vars,node,similar);},toggle:function toggle(name,vars,node){return _toggle(editor,name,vars,node);}},editor:{getContent:function getContent(args,format){return getContentInternal(editor,args,format);},setContent:function setContent(content,args){return setContentInternal(editor,content,args);},insertContent:function insertContent(value,details){return insertHtmlAtCaret(editor,value,details);}},selection:{getContent:function getContent(format,args){return getSelectedContentInternal(editor,format,args);}},raw:{getModel:function getModel(){return Optional.none();}}};};var makeRtcAdaptor=function makeRtcAdaptor(tinymceEditor,rtcEditor){var defaultVars=function defaultVars(vars){return isObject(vars)?vars:{};};var unsupported=die('Unimplemented feature for rtc');var ignore=noop;return{undoManager:{beforeChange:ignore,addUndoLevel:unsupported,undo:function undo(){rtcEditor.undo();return createDummyUndoLevel();},redo:function redo(){rtcEditor.redo();return createDummyUndoLevel();},clear:unsupported,reset:unsupported,hasUndo:function hasUndo(){return rtcEditor.hasUndo();},hasRedo:function hasRedo(){return rtcEditor.hasRedo();},transact:function transact(_undoManager,_locks,fn){rtcEditor.transact(fn);return createDummyUndoLevel();},ignore:unsupported,extra:unsupported},formatter:{apply:function apply(name,vars,_node){return rtcEditor.applyFormat(name,defaultVars(vars));},remove:function remove(name,vars,_node,_similar){return rtcEditor.removeFormat(name,defaultVars(vars));},toggle:function toggle(name,vars,_node){return rtcEditor.toggleFormat(name,defaultVars(vars));}},editor:{getContent:function getContent(args,format){if(format==='html'||format==='tree'){var fragment=rtcEditor.getContent();var serializer=HtmlSerializer({inner:true});runSerializerFiltersOnFragment(tinymceEditor,fragment);return format==='tree'?fragment:serializer.serialize(fragment);}else{return makePlainAdaptor(tinymceEditor).editor.getContent(args,format);}},setContent:function setContent(content,_args){var fragment=isTreeNode$1(content)?content:tinymceEditor.parser.parse(content,{isRootContent:true,insert:true});rtcEditor.setContent(fragment);return content;},insertContent:function insertContent(value,_details){var contextArgs=getInsertContext(tinymceEditor).fold(function(){return{};},function(context){return{context:context};});var fragment=isTreeNode$1(value)?value:tinymceEditor.parser.parse(value,_assign(_assign({},contextArgs),{insert:true}));rtcEditor.insertContent(fragment);}},selection:{getContent:function getContent(format,args){if(format==='html'||format==='tree'){var fragment=rtcEditor.getSelectedContent();var serializer=HtmlSerializer({});runSerializerFiltersOnFragment(tinymceEditor,fragment);return format==='tree'?fragment:serializer.serialize(fragment);}else{return makePlainAdaptor(tinymceEditor).selection.getContent(format,args);}}},raw:{getModel:function getModel(){return Optional.some(rtcEditor.getRawModel());}}};};var isRtc=function isRtc(editor){return has(editor.plugins,'rtc');};var setup$4=function setup$4(editor){var editorCast=editor;return get(editor.plugins,'rtc').fold(function(){editorCast.rtcInstance=makePlainAdaptor(editor);return Optional.none();},function(rtc){return Optional.some(rtc.setup().then(function(rtcEditor){editorCast.rtcInstance=makeRtcAdaptor(editor,rtcEditor);return rtcEditor.isRemote;}));});};var getRtcInstanceWithFallback=function getRtcInstanceWithFallback(editor){return editor.rtcInstance?editor.rtcInstance:makePlainAdaptor(editor);};var getRtcInstanceWithError=function getRtcInstanceWithError(editor){var rtcInstance=editor.rtcInstance;if(!rtcInstance){throw new Error('Failed to get RTC instance not yet initialized.');}else{return rtcInstance;}};var beforeChange$1=function beforeChange$1(editor,locks,beforeBookmark){getRtcInstanceWithError(editor).undoManager.beforeChange(locks,beforeBookmark);};var addUndoLevel$1=function addUndoLevel$1(editor,undoManager,index,locks,beforeBookmark,level,event){return getRtcInstanceWithError(editor).undoManager.addUndoLevel(undoManager,index,locks,beforeBookmark,level,event);};var undo$1=function undo$1(editor,undoManager,locks,index){return getRtcInstanceWithError(editor).undoManager.undo(undoManager,locks,index);};var redo$1=function redo$1(editor,index,data){return getRtcInstanceWithError(editor).undoManager.redo(index,data);};var clear$1=function clear$1(editor,undoManager,index){getRtcInstanceWithError(editor).undoManager.clear(undoManager,index);};var reset$1=function reset$1(editor,undoManager){getRtcInstanceWithError(editor).undoManager.reset(undoManager);};var hasUndo$1=function hasUndo$1(editor,undoManager,index){return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager,index);};var hasRedo$1=function hasRedo$1(editor,undoManager,index){return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager,index);};var transact$1=function transact$1(editor,undoManager,locks,callback){return getRtcInstanceWithError(editor).undoManager.transact(undoManager,locks,callback);};var ignore$1=function ignore$1(editor,locks,callback){getRtcInstanceWithError(editor).undoManager.ignore(locks,callback);};var extra$1=function extra$1(editor,undoManager,index,callback1,callback2){getRtcInstanceWithError(editor).undoManager.extra(undoManager,index,callback1,callback2);};var applyFormat$1=function applyFormat$1(editor,name,vars,node){getRtcInstanceWithError(editor).formatter.apply(name,vars,node);};var removeFormat$1=function removeFormat$1(editor,name,vars,node,similar){getRtcInstanceWithError(editor).formatter.remove(name,vars,node,similar);};var toggleFormat=function toggleFormat(editor,name,vars,node){getRtcInstanceWithError(editor).formatter.toggle(name,vars,node);};var getContent=function getContent(editor,args,format){return getRtcInstanceWithFallback(editor).editor.getContent(args,format);};var setContent=function setContent(editor,content,args){return getRtcInstanceWithFallback(editor).editor.setContent(content,args);};var insertContent=function insertContent(editor,value,details){return getRtcInstanceWithFallback(editor).editor.insertContent(value,details);};var getSelectedContent=function getSelectedContent(editor,format,args){return getRtcInstanceWithError(editor).selection.getContent(format,args);};var getContent$1=function getContent$1(editor,args){if(args===void 0){args={};}var format=args.format?args.format:'html';return getSelectedContent(editor,format,args);};var removeEmpty=function removeEmpty(text){if(text.dom.length===0){remove(text);return Optional.none();}else{return Optional.some(text);}};var walkPastBookmark=function walkPastBookmark(node,start){return node.filter(function(elm){return BookmarkManager$1.isBookmarkNode(elm.dom);}).bind(start?nextSibling:prevSibling);};var merge=function merge(outer,inner,rng,start){var outerElm=outer.dom;var innerElm=inner.dom;var oldLength=start?outerElm.length:innerElm.length;if(start){mergeTextNodes(outerElm,innerElm,false,!start);rng.setStart(innerElm,oldLength);}else{mergeTextNodes(innerElm,outerElm,false,!start);rng.setEnd(innerElm,oldLength);}};var normalizeTextIfRequired=function normalizeTextIfRequired(inner,start){parent(inner).each(function(root){var text=inner.dom;if(start&&needsToBeNbspLeft(root,CaretPosition$1(text,0))){normalizeWhitespaceAfter(text,0);}else if(!start&&needsToBeNbspRight(root,CaretPosition$1(text,text.length))){normalizeWhitespaceBefore(text,text.length);}});};var mergeAndNormalizeText=function mergeAndNormalizeText(outerNode,innerNode,rng,start){outerNode.bind(function(outer){var normalizer=start?normalizeWhitespaceBefore:normalizeWhitespaceAfter;normalizer(outer.dom,start?outer.dom.length:0);return innerNode.filter(isText).map(function(inner){return merge(outer,inner,rng,start);});}).orThunk(function(){var innerTextNode=walkPastBookmark(innerNode,start).or(innerNode).filter(isText);return innerTextNode.map(function(inner){return normalizeTextIfRequired(inner,start);});});};var rngSetContent=function rngSetContent(rng,fragment){var firstChild=Optional.from(fragment.firstChild).map(SugarElement.fromDom);var lastChild=Optional.from(fragment.lastChild).map(SugarElement.fromDom);rng.deleteContents();rng.insertNode(fragment);var prevText=firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);var nextText=lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);mergeAndNormalizeText(prevText,firstChild,rng,true);mergeAndNormalizeText(nextText,lastChild,rng,false);rng.collapse(false);};var setupArgs=function setupArgs(args,content){return _assign(_assign({format:'html'},args),{set:true,selection:true,content:content});};var cleanContent=function cleanContent(editor,args){if(args.format!=='raw'){var rng=editor.selection.getRng();var contextBlock=editor.dom.getParent(rng.commonAncestorContainer,editor.dom.isBlock);var contextArgs=contextBlock?{context:contextBlock.nodeName.toLowerCase()}:{};var node=editor.parser.parse(args.content,_assign(_assign({isRootContent:true,forced_root_block:false},contextArgs),args));return HtmlSerializer({validate:editor.validate},editor.schema).serialize(node);}else{return args.content;}};var setContent$1=function setContent$1(editor,content,args){if(args===void 0){args={};}var contentArgs=setupArgs(args,content);if(!contentArgs.no_events){contentArgs=editor.fire('BeforeSetContent',contentArgs);if(contentArgs.isDefaultPrevented()){editor.fire('SetContent',contentArgs);return;}}args.content=cleanContent(editor,contentArgs);var rng=editor.selection.getRng();rngSetContent(rng,rng.createContextualFragment(args.content));editor.selection.setRng(rng);scrollRangeIntoView(editor,rng);if(!contentArgs.no_events){editor.fire('SetContent',contentArgs);}};var deleteFromCallbackMap=function deleteFromCallbackMap(callbackMap,selector,callback){if(callbackMap&&callbackMap.hasOwnProperty(selector)){var newCallbacks=filter(callbackMap[selector],function(cb){return cb!==callback;});if(newCallbacks.length===0){delete callbackMap[selector];}else{callbackMap[selector]=newCallbacks;}}};function SelectorChanged(dom,editor){var selectorChangedData;var currentSelectors;return{selectorChangedWithUnbind:function selectorChangedWithUnbind(selector,callback){if(!selectorChangedData){selectorChangedData={};currentSelectors={};editor.on('NodeChange',function(e){var node=e.element,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};Tools.each(selectorChangedData,function(callbacks,selector){Tools.each(parents,function(node){if(dom.is(node,selector)){if(!currentSelectors[selector]){Tools.each(callbacks,function(callback){callback(true,{node:node,selector:selector,parents:parents});});currentSelectors[selector]=callbacks;}matchedSelectors[selector]=callbacks;return false;}});});Tools.each(currentSelectors,function(callbacks,selector){if(!matchedSelectors[selector]){delete currentSelectors[selector];Tools.each(callbacks,function(callback){callback(false,{node:node,selector:selector,parents:parents});});}});});}if(!selectorChangedData[selector]){selectorChangedData[selector]=[];}selectorChangedData[selector].push(callback);return{unbind:function unbind(){deleteFromCallbackMap(selectorChangedData,selector,callback);deleteFromCallbackMap(currentSelectors,selector,callback);}};}};}var isNativeIeSelection=function isNativeIeSelection(rng){return!!rng.select;};var isAttachedToDom=function isAttachedToDom(node){return!!(node&&node.ownerDocument)&&contains$2(SugarElement.fromDom(node.ownerDocument),SugarElement.fromDom(node));};var isValidRange=function isValidRange(rng){if(!rng){return false;}else if(isNativeIeSelection(rng)){return true;}else{return isAttachedToDom(rng.startContainer)&&isAttachedToDom(rng.endContainer);}};var EditorSelection=function EditorSelection(dom,win,serializer,editor){var selectedRange;var explicitRange;var selectorChangedWithUnbind=SelectorChanged(dom,editor).selectorChangedWithUnbind;var setCursorLocation=function setCursorLocation(node,offset){var rng=dom.createRng();if(!node){moveEndPoint$1(dom,rng,editor.getBody(),true);setRng(rng);}else{rng.setStart(node,offset);rng.setEnd(node,offset);setRng(rng);collapse(false);}};var getContent=function getContent(args){return getContent$1(editor,args);};var setContent=function setContent(content,args){return setContent$1(editor,content,args);};var getStart=function getStart(real){return getStart$2(editor.getBody(),getRng$1(),real);};var getEnd$1=function getEnd$1(real){return getEnd(editor.getBody(),getRng$1(),real);};var getBookmark=function getBookmark(type,normalized){return bookmarkManager.getBookmark(type,normalized);};var moveToBookmark=function moveToBookmark(bookmark){return bookmarkManager.moveToBookmark(bookmark);};var select=function select(node,content){select$1(dom,node,content).each(setRng);return node;};var isCollapsed=function isCollapsed(){var rng=getRng$1(),sel=getSel();if(!rng||rng.item){return false;}if(rng.compareEndPoints){return rng.compareEndPoints('StartToEnd',rng)===0;}return!sel||rng.collapsed;};var collapse=function collapse(toStart){var rng=getRng$1();rng.collapse(!!toStart);setRng(rng);};var getSel=function getSel(){return win.getSelection?win.getSelection():win.document.selection;};var getRng$1=function getRng$1(){var selection,rng,elm;var tryCompareBoundaryPoints=function tryCompareBoundaryPoints(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange);}catch(ex){return-1;}};if(!win){return null;}var doc=win.document;if(typeof doc==='undefined'||doc===null){return null;}if(editor.bookmark!==undefined&&hasFocus$1(editor)===false){var bookmark=getRng(editor);if(bookmark.isSome()){return bookmark.map(function(r){return processRanges(editor,[r])[0];}).getOr(doc.createRange());}}try{if((selection=getSel())&&!isRestrictedNode(selection.anchorNode)){if(selection.rangeCount>0){rng=selection.getRangeAt(0);}else{rng=selection.createRange?selection.createRange():doc.createRange();}rng=processRanges(editor,[rng])[0];}}catch(ex){}if(!rng){rng=doc.createRange?doc.createRange():doc.body.createTextRange();}if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=dom.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0);}if(selectedRange&&explicitRange){if(tryCompareBoundaryPoints(rng.START_TO_START,rng,selectedRange)===0&&tryCompareBoundaryPoints(rng.END_TO_END,rng,selectedRange)===0){rng=explicitRange;}else{selectedRange=null;explicitRange=null;}}return rng;};var setRng=function setRng(rng,forward){var node;if(!isValidRange(rng)){return;}var ieRange=isNativeIeSelection(rng)?rng:null;if(ieRange){explicitRange=null;try{ieRange.select();}catch(ex){}return;}var sel=getSel();var evt=editor.fire('SetSelectionRange',{range:rng,forward:forward});rng=evt.range;if(sel){explicitRange=rng;try{sel.removeAllRanges();sel.addRange(rng);}catch(ex){}if(forward===false&&sel.extend){sel.collapse(rng.endContainer,rng.endOffset);sel.extend(rng.startContainer,rng.startOffset);}selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null;}if(!rng.collapsed&&rng.startContainer===rng.endContainer&&sel.setBaseAndExtent&&!Env.ie){if(rng.endOffset-rng.startOffset<2){if(rng.startContainer.hasChildNodes()){node=rng.startContainer.childNodes[rng.startOffset];if(node&&node.tagName==='IMG'){sel.setBaseAndExtent(rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset);if(sel.anchorNode!==rng.startContainer||sel.focusNode!==rng.endContainer){sel.setBaseAndExtent(node,0,node,1);}}}}}editor.fire('AfterSetSelectionRange',{range:rng,forward:forward});};var setNode=function setNode(elm){setContent(dom.getOuterHTML(elm));return elm;};var getNode=function getNode(){return getNode$1(editor.getBody(),getRng$1());};var getSelectedBlocks$1=function getSelectedBlocks$1(startElm,endElm){return getSelectedBlocks(dom,getRng$1(),startElm,endElm);};var isForward=function isForward(){var sel=getSel();var anchorNode=sel===null||sel===void 0?void 0:sel.anchorNode;var focusNode=sel===null||sel===void 0?void 0:sel.focusNode;if(!sel||!anchorNode||!focusNode||isRestrictedNode(anchorNode)||isRestrictedNode(focusNode)){return true;}var anchorRange=dom.createRng();anchorRange.setStart(anchorNode,sel.anchorOffset);anchorRange.collapse(true);var focusRange=dom.createRng();focusRange.setStart(focusNode,sel.focusOffset);focusRange.collapse(true);return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0;};var normalize$1=function normalize$1(){var rng=getRng$1();var sel=getSel();if(!hasMultipleRanges(sel)&&hasAnyRanges(editor)){var normRng=normalize(dom,rng);normRng.each(function(normRng){setRng(normRng,isForward());});return normRng.getOr(rng);}return rng;};var selectorChanged=function selectorChanged(selector,callback){selectorChangedWithUnbind(selector,callback);return exports;};var getScrollContainer=function getScrollContainer(){var scrollContainer;var node=dom.getRoot();while(node&&node.nodeName!=='BODY'){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break;}node=node.parentNode;}return scrollContainer;};var scrollIntoView=function scrollIntoView(elm,alignToTop){return scrollElementIntoView(editor,elm,alignToTop);};var placeCaretAt=function placeCaretAt(clientX,clientY){return setRng(fromPoint$1(clientX,clientY,editor.getDoc()));};var getBoundingClientRect=function getBoundingClientRect(){var rng=getRng$1();return rng.collapsed?CaretPosition$1.fromRangeStart(rng).getClientRects()[0]:rng.getBoundingClientRect();};var destroy=function destroy(){win=selectedRange=explicitRange=null;controlSelection.destroy();};var exports={bookmarkManager:null,controlSelection:null,dom:dom,win:win,serializer:serializer,editor:editor,collapse:collapse,setCursorLocation:setCursorLocation,getContent:getContent,setContent:setContent,getBookmark:getBookmark,moveToBookmark:moveToBookmark,select:select,isCollapsed:isCollapsed,isForward:isForward,setNode:setNode,getNode:getNode,getSel:getSel,setRng:setRng,getRng:getRng$1,getStart:getStart,getEnd:getEnd$1,getSelectedBlocks:getSelectedBlocks$1,normalize:normalize$1,selectorChanged:selectorChanged,selectorChangedWithUnbind:selectorChangedWithUnbind,getScrollContainer:getScrollContainer,scrollIntoView:scrollIntoView,placeCaretAt:placeCaretAt,getBoundingClientRect:getBoundingClientRect,destroy:destroy};var bookmarkManager=BookmarkManager$1(exports);var controlSelection=ControlSelection(exports,editor);exports.bookmarkManager=bookmarkManager;exports.controlSelection=controlSelection;return exports;};var removeAttrs=function removeAttrs(node,names){each(names,function(name){node.attr(name,null);});};var addFontToSpansFilter=function addFontToSpansFilter(domParser,styles,fontSizes){domParser.addNodeFilter('font',function(nodes){each(nodes,function(node){var props=styles.parse(node.attr('style'));var color=node.attr('color');var face=node.attr('face');var size=node.attr('size');if(color){props.color=color;}if(face){props['font-family']=face;}if(size){props['font-size']=fontSizes[parseInt(node.attr('size'),10)-1];}node.name='span';node.attr('style',styles.serialize(props));removeAttrs(node,['color','face','size']);});});};var addStrikeToSpanFilter=function addStrikeToSpanFilter(domParser,styles){domParser.addNodeFilter('strike',function(nodes){each(nodes,function(node){var props=styles.parse(node.attr('style'));props['text-decoration']='line-through';node.name='span';node.attr('style',styles.serialize(props));});});};var addFilters=function addFilters(domParser,settings){var styles=Styles();if(settings.convert_fonts_to_spans){addFontToSpansFilter(domParser,styles,Tools.explode(settings.font_size_legacy_values));}addStrikeToSpanFilter(domParser,styles);};var register$1=function register$1(domParser,settings){if(settings.inline_styles){addFilters(domParser,settings);}};var blobUriToBlob=function blobUriToBlob(url){return new promiseObj(function(resolve,reject){var rejectWithError=function rejectWithError(){reject('Cannot convert '+url+' to Blob. Resource might not exist or is inaccessible.');};try{var xhr=new XMLHttpRequest();xhr.open('GET',url,true);xhr.responseType='blob';xhr.onload=function(){if(this.status===200){resolve(this.response);}else{rejectWithError();}};xhr.onerror=rejectWithError;xhr.send();}catch(ex){rejectWithError();}});};var parseDataUri$1=function parseDataUri$1(uri){var type;var uriParts=decodeURIComponent(uri).split(',');var matches=/data:([^;]+)/.exec(uriParts[0]);if(matches){type=matches[1];}return{type:type,data:uriParts[1]};};var buildBlob=function buildBlob(type,data){var str;try{str=atob(data);}catch(e){return Optional.none();}var arr=new Uint8Array(str.length);for(var i=0;i<arr.length;i++){arr[i]=str.charCodeAt(i);}return Optional.some(new Blob([arr],{type:type}));};var dataUriToBlob=function dataUriToBlob(uri){return new promiseObj(function(resolve){var _a=parseDataUri$1(uri),type=_a.type,data=_a.data;buildBlob(type,data).fold(function(){return resolve(new Blob([]));},resolve);});};var uriToBlob=function uriToBlob(url){if(url.indexOf('blob:')===0){return blobUriToBlob(url);}if(url.indexOf('data:')===0){return dataUriToBlob(url);}return null;};var blobToDataUri=function blobToDataUri(blob){return new promiseObj(function(resolve){var reader=new FileReader();reader.onloadend=function(){resolve(reader.result);};reader.readAsDataURL(blob);});};var count=0;var uniqueId=function uniqueId(prefix){return(prefix||'blobid')+count++;};var imageToBlobInfo=function imageToBlobInfo(blobCache,img,resolve,reject){var base64,blobInfo;if(img.src.indexOf('blob:')===0){blobInfo=blobCache.getByUri(img.src);if(blobInfo){resolve({image:img,blobInfo:blobInfo});}else{uriToBlob(img.src).then(function(blob){blobToDataUri(blob).then(function(dataUri){base64=parseDataUri$1(dataUri).data;blobInfo=blobCache.create(uniqueId(),blob,base64);blobCache.add(blobInfo);resolve({image:img,blobInfo:blobInfo});});},function(err){reject(err);});}return;}var _a=parseDataUri$1(img.src),data=_a.data,type=_a.type;base64=data;blobInfo=blobCache.getByData(base64,type);if(blobInfo){resolve({image:img,blobInfo:blobInfo});}else{uriToBlob(img.src).then(function(blob){blobInfo=blobCache.create(uniqueId(),blob,base64);blobCache.add(blobInfo);resolve({image:img,blobInfo:blobInfo});},function(err){reject(err);});}};var getAllImages=function getAllImages(elm){return elm?from$1(elm.getElementsByTagName('img')):[];};function ImageScanner(uploadStatus,blobCache){var cachedPromises={};var findAll=function findAll(elm,predicate){if(!predicate){predicate=always;}var images=filter(getAllImages(elm),function(img){var src=img.src;if(!Env.fileApi){return false;}if(img.hasAttribute('data-mce-bogus')){return false;}if(img.hasAttribute('data-mce-placeholder')){return false;}if(!src||src===Env.transparentSrc){return false;}if(src.indexOf('blob:')===0){return!uploadStatus.isUploaded(src)&&predicate(img);}if(src.indexOf('data:')===0){return predicate(img);}return false;});var promises=map(images,function(img){if(cachedPromises[img.src]!==undefined){return new promiseObj(function(resolve){cachedPromises[img.src].then(function(imageInfo){if(typeof imageInfo==='string'){return imageInfo;}resolve({image:img,blobInfo:imageInfo.blobInfo});});});}var newPromise=new promiseObj(function(resolve,reject){imageToBlobInfo(blobCache,img,resolve,reject);}).then(function(result){delete cachedPromises[result.image.src];return result;})["catch"](function(error){delete cachedPromises[img.src];return error;});cachedPromises[img.src]=newPromise;return newPromise;});return promiseObj.all(promises);};return{findAll:findAll};}var paddEmptyNode=function paddEmptyNode(settings,args,blockElements,node){var brPreferred=settings.padd_empty_with_br||args.insert;if(brPreferred&&blockElements[node.name]){node.empty().append(new AstNode('br',1)).shortEnded=true;}else{node.empty().append(new AstNode('#text',3)).value=nbsp;}};var isPaddedWithNbsp=function isPaddedWithNbsp(node){return hasOnlyChild(node,'#text')&&node.firstChild.value===nbsp;};var hasOnlyChild=function hasOnlyChild(node,name){return node&&node.firstChild&&node.firstChild===node.lastChild&&node.firstChild.name===name;};var isPadded=function isPadded(schema,node){var rule=schema.getElementRule(node.name);return rule&&rule.paddEmpty;};var isEmpty$2=function isEmpty$2(schema,nonEmptyElements,whitespaceElements,node){return node.isEmpty(nonEmptyElements,whitespaceElements,function(node){return isPadded(schema,node);});};var isLineBreakNode=function isLineBreakNode(node,blockElements){return node&&(blockElements[node.name]||node.name==='br');};var isBogusImage=function isBogusImage(img){return img.attr('data-mce-bogus');};var isInternalImageSource=function isInternalImageSource(img){return img.attr('src')===Env.transparentSrc||img.attr('data-mce-placeholder');};var isValidDataImg=function isValidDataImg(img,settings){if(settings.images_dataimg_filter){var imgElem_1=new Image();imgElem_1.src=img.attr('src');each$1(img.attributes.map,function(value,key){imgElem_1.setAttribute(key,value);});return settings.images_dataimg_filter(imgElem_1);}else{return true;}};var registerBase64ImageFilter=function registerBase64ImageFilter(parser,settings){var blobCache=settings.blob_cache;var processImage=function processImage(img){var inputSrc=img.attr('src');if(isInternalImageSource(img)||isBogusImage(img)){return;}parseDataUri(inputSrc).filter(function(){return isValidDataImg(img,settings);}).bind(function(_a){var type=_a.type,data=_a.data;return Optional.from(blobCache.getByData(data,type)).orThunk(function(){return buildBlob(type,data).map(function(blob){var blobInfo=blobCache.create(uniqueId(),blob,data);blobCache.add(blobInfo);return blobInfo;});});}).each(function(blobInfo){img.attr('src',blobInfo.blobUri());});};if(blobCache){parser.addAttributeFilter('src',function(nodes){return each(nodes,processImage);});}};var register$2=function register$2(parser,settings){var schema=parser.schema;if(settings.remove_trailing_brs){parser.addNodeFilter('br',function(nodes,_,args){var i;var l=nodes.length;var node;var blockElements=Tools.extend({},schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements();var parent,lastParent,prev,prevName;var whiteSpaceElements=schema.getWhiteSpaceElements();var elementRule,textNode;blockElements.body=1;for(i=0;i<l;i++){node=nodes[i];parent=node.parent;if(blockElements[node.parent.name]&&node===parent.lastChild){prev=node.prev;while(prev){prevName=prev.name;if(prevName!=='span'||prev.attr('data-mce-type')!=='bookmark'){if(prevName==='br'){node=null;}break;}prev=prev.prev;}if(node){node.remove();if(isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,parent)){elementRule=schema.getElementRule(parent.name);if(elementRule){if(elementRule.removeEmpty){parent.remove();}else if(elementRule.paddEmpty){paddEmptyNode(settings,args,blockElements,parent);}}}}}else{lastParent=node;while(parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent){lastParent=parent;if(blockElements[parent.name]){break;}parent=parent.parent;}if(lastParent===parent&&settings.padd_empty_with_br!==true){textNode=new AstNode('#text',3);textNode.value=nbsp;node.replace(textNode);}}}});}parser.addAttributeFilter('href',function(nodes){var i=nodes.length;var appendRel=function appendRel(rel){var parts=rel.split(' ').filter(function(p){return p.length>0;});return parts.concat(['noopener']).sort().join(' ');};var addNoOpener=function addNoOpener(rel){var newRel=rel?Tools.trim(rel):'';if(!/\b(noopener)\b/g.test(newRel)){return appendRel(newRel);}else{return newRel;}};if(!settings.allow_unsafe_link_target){while(i--){var node=nodes[i];if(node.name==='a'&&node.attr('target')==='_blank'){node.attr('rel',addNoOpener(node.attr('rel')));}}}});if(!settings.allow_html_in_named_anchor){parser.addAttributeFilter('id,name',function(nodes){var i=nodes.length,sibling,prevSibling,parent,node;while(i--){node=nodes[i];if(node.name==='a'&&node.firstChild&&!node.attr('href')){parent=node.parent;sibling=node.lastChild;do{prevSibling=sibling.prev;parent.insert(sibling,node);sibling=prevSibling;}while(sibling);}}});}if(settings.fix_list_elements){parser.addNodeFilter('ul,ol',function(nodes){var i=nodes.length,node,parentNode;while(i--){node=nodes[i];parentNode=node.parent;if(parentNode.name==='ul'||parentNode.name==='ol'){if(node.prev&&node.prev.name==='li'){node.prev.append(node);}else{var li=new AstNode('li',1);li.attr('style','list-style-type: none');node.wrap(li);}}}});}if(settings.validate&&schema.getValidClasses()){parser.addAttributeFilter('class',function(nodes){var i=nodes.length,node,classList,ci,className,classValue;var validClasses=schema.getValidClasses();var validClassesMap,valid;while(i--){node=nodes[i];classList=node.attr('class').split(' ');classValue='';for(ci=0;ci<classList.length;ci++){className=classList[ci];valid=false;validClassesMap=validClasses['*'];if(validClassesMap&&validClassesMap[className]){valid=true;}validClassesMap=validClasses[node.name];if(!valid&&validClassesMap&&validClassesMap[className]){valid=true;}if(valid){if(classValue){classValue+=' ';}classValue+=className;}}if(!classValue.length){classValue=null;}node.attr('class',classValue);}});}registerBase64ImageFilter(parser,settings);};var makeMap$4=Tools.makeMap,each$d=Tools.each,explode$2=Tools.explode,extend$2=Tools.extend;var DomParser=function DomParser(settings,schema){if(schema===void 0){schema=Schema();}var nodeFilters={};var attributeFilters=[];var matchedNodes={};var matchedAttributes={};settings=settings||{};settings.validate='validate'in settings?settings.validate:true;settings.root_name=settings.root_name||'body';var fixInvalidChildren=function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i;var sibling,nextNode;var nonSplitableElements=makeMap$4('tr,td,th,tbody,thead,tfoot,table');var nonEmptyElements=schema.getNonEmptyElements();var whitespaceElements=schema.getWhiteSpaceElements();var textBlockElements=schema.getTextBlockElements();var specialElements=schema.getSpecialElements();for(ni=0;ni<nodes.length;ni++){node=nodes[ni];if(!node.parent||node.fixed){continue;}if(textBlockElements[node.name]&&node.parent.name==='li'){sibling=node.next;while(sibling){if(textBlockElements[sibling.name]){sibling.name='li';sibling.fixed=true;node.parent.insert(sibling,node.parent);}else{break;}sibling=sibling.next;}node.unwrap(node);continue;}parents=[node];for(parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent){parents.push(parent);}if(parent&&parents.length>1){parents.reverse();newParent=currentNode=filterNode(parents[0].clone());for(i=0;i<parents.length-1;i++){if(schema.isValidChild(currentNode.name,parents[i].name)){tempNode=filterNode(parents[i].clone());currentNode.append(tempNode);}else{tempNode=currentNode;}for(childNode=parents[i].firstChild;childNode&&childNode!==parents[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode;}currentNode=tempNode;}if(!isEmpty$2(schema,nonEmptyElements,whitespaceElements,newParent)){parent.insert(newParent,parents[0],true);parent.insert(node,newParent);}else{parent.insert(node,parents[0],true);}parent=parents[0];if(isEmpty$2(schema,nonEmptyElements,whitespaceElements,parent)||hasOnlyChild(parent,'br')){parent.empty().remove();}}else if(node.parent){if(node.name==='li'){sibling=node.prev;if(sibling&&(sibling.name==='ul'||sibling.name==='ol')){sibling.append(node);continue;}sibling=node.next;if(sibling&&(sibling.name==='ul'||sibling.name==='ol')){sibling.insert(node,sibling.firstChild,true);continue;}node.wrap(filterNode(new AstNode('ul',1)));continue;}if(schema.isValidChild(node.parent.name,'div')&&schema.isValidChild('div',node.name)){node.wrap(filterNode(new AstNode('div',1)));}else{if(specialElements[node.name]){node.empty().remove();}else{node.unwrap();}}}}};var filterNode=function filterNode(node){var i,name,list;name=node.name;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node);}else{matchedNodes[name]=[node];}}i=attributeFilters.length;while(i--){name=attributeFilters[i].name;if(name in node.attributes.map){list=matchedAttributes[name];if(list){list.push(node);}else{matchedAttributes[name]=[node];}}}return node;};var addNodeFilter=function addNodeFilter(name,callback){each$d(explode$2(name),function(name){var list=nodeFilters[name];if(!list){nodeFilters[name]=list=[];}list.push(callback);});};var getNodeFilters=function getNodeFilters(){var out=[];for(var name_1 in nodeFilters){if(nodeFilters.hasOwnProperty(name_1)){out.push({name:name_1,callbacks:nodeFilters[name_1]});}}return out;};var addAttributeFilter=function addAttributeFilter(name,callback){each$d(explode$2(name),function(name){var i;for(i=0;i<attributeFilters.length;i++){if(attributeFilters[i].name===name){attributeFilters[i].callbacks.push(callback);return;}}attributeFilters.push({name:name,callbacks:[callback]});});};var getAttributeFilters=function getAttributeFilters(){return[].concat(attributeFilters);};var parse=function parse(html,args){var nodes,i,l,fi,fl,list,name;var invalidChildren=[];var isInWhiteSpacePreservedElement;var node;var getRootBlockName=function getRootBlockName(name){if(name===false){return'';}else if(name===true){return'p';}else{return name;}};args=args||{};matchedNodes={};matchedAttributes={};var blockElements=extend$2(makeMap$4('script,style,head,html,body,title,meta,param'),schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements();var children=schema.children;var validate=settings.validate;var forcedRootBlockName='forced_root_block'in args?args.forced_root_block:settings.forced_root_block;var rootBlockName=getRootBlockName(forcedRootBlockName);var whiteSpaceElements=schema.getWhiteSpaceElements();var startWhiteSpaceRegExp=/^[ \t\r\n]+/;var endWhiteSpaceRegExp=/[ \t\r\n]+$/;var allWhiteSpaceRegExp=/[ \t\r\n]+/g;var isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;isInWhiteSpacePreservedElement=whiteSpaceElements.hasOwnProperty(args.context)||whiteSpaceElements.hasOwnProperty(settings.root_name);var addRootBlocks=function addRootBlocks(){var node=rootNode.firstChild,next,rootBlockNode;var trim=function trim(rootBlockNode){if(rootBlockNode){node=rootBlockNode.firstChild;if(node&&node.type===3){node.value=node.value.replace(startWhiteSpaceRegExp,'');}node=rootBlockNode.lastChild;if(node&&node.type===3){node.value=node.value.replace(endWhiteSpaceRegExp,'');}}};if(!schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){return;}while(node){next=node.next;if(node.type===3||node.type===1&&node.name!=='p'&&!blockElements[node.name]&&!node.attr('data-mce-type')){if(!rootBlockNode){rootBlockNode=createNode(rootBlockName,1);rootBlockNode.attr(settings.forced_root_block_attrs);rootNode.insert(rootBlockNode,node);rootBlockNode.append(node);}else{rootBlockNode.append(node);}}else{trim(rootBlockNode);rootBlockNode=null;}node=next;}trim(rootBlockNode);};var createNode=function createNode(name,type){var node=new AstNode(name,type);var list;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node);}else{matchedNodes[name]=[node];}}return node;};var removeWhitespaceBefore=function removeWhitespaceBefore(node){var textNode,textNodeNext,textVal,sibling;var blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&textNode.type===3;){textVal=textNode.value.replace(endWhiteSpaceRegExp,'');if(textVal.length>0){textNode.value=textVal;return;}textNodeNext=textNode.next;if(textNodeNext){if(textNodeNext.type===3&&textNodeNext.value.length){textNode=textNode.prev;continue;}if(!blockElements[textNodeNext.name]&&textNodeNext.name!=='script'&&textNodeNext.name!=='style'){textNode=textNode.prev;continue;}}sibling=textNode.prev;textNode.remove();textNode=sibling;}};var cloneAndExcludeBlocks=function cloneAndExcludeBlocks(input){var name;var output={};for(name in input){if(name!=='li'&&name!=='p'){output[name]=input[name];}}return output;};var parser=SaxParser$1({validate:validate,allow_html_data_urls:settings.allow_html_data_urls,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,preserve_cdata:settings.preserve_cdata,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function cdata(text){node.append(createNode('#cdata',4)).value=text;},text:function text(_text2,raw){var textNode;if(!isInWhiteSpacePreservedElement){_text2=_text2.replace(allWhiteSpaceRegExp,' ');if(isLineBreakNode(node.lastChild,blockElements)){_text2=_text2.replace(startWhiteSpaceRegExp,'');}}if(_text2.length!==0){textNode=createNode('#text',3);textNode.raw=!!raw;node.append(textNode).value=_text2;}},comment:function comment(text){node.append(createNode('#comment',8)).value=text;},pi:function pi(name,text){node.append(createNode(name,7)).value=text;removeWhitespaceBefore(node);},doctype:function doctype(text){var newNode=node.append(createNode('#doctype',10));newNode.value=text;removeWhitespaceBefore(node);},start:function start(name,attrs,empty){var newNode,attrFiltersLen,attrName,parent;var elementRule=validate?schema.getElementRule(name):{};if(elementRule){newNode=createNode(elementRule.outputName||name,1);newNode.attributes=attrs;newNode.shortEnded=empty;node.append(newNode);parent=children[node.name];if(parent&&children[newNode.name]&&!parent[newNode.name]){invalidChildren.push(newNode);}attrFiltersLen=attributeFilters.length;while(attrFiltersLen--){attrName=attributeFilters[attrFiltersLen].name;if(attrName in attrs.map){list=matchedAttributes[attrName];if(list){list.push(newNode);}else{matchedAttributes[attrName]=[newNode];}}}if(blockElements[name]){removeWhitespaceBefore(newNode);}if(!empty){node=newNode;}if(!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=true;}}},end:function end(name){var textNode,text,sibling,tempNode;var elementRule=validate?schema.getElementRule(name):{};if(elementRule){if(blockElements[name]){if(!isInWhiteSpacePreservedElement){textNode=node.firstChild;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,'');if(text.length>0){textNode.value=text;textNode=textNode.next;}else{sibling=textNode.next;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.next;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling;}textNode=sibling;}}}textNode=node.lastChild;if(textNode&&textNode.type===3){text=textNode.value.replace(endWhiteSpaceRegExp,'');if(text.length>0){textNode.value=text;textNode=textNode.prev;}else{sibling=textNode.prev;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.prev;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling;}textNode=sibling;}}}}}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=false;}if(elementRule.removeEmpty&&isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,node)){tempNode=node.parent;if(blockElements[node.name]){node.empty().remove();}else{node.unwrap();}node=tempNode;return;}if(elementRule.paddEmpty&&(isPaddedWithNbsp(node)||isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,node))){paddEmptyNode(settings,args,blockElements,node);}node=node.parent;}}},schema);var rootNode=node=new AstNode(args.context||settings.root_name,11);parser.parse(html,args.format);if(validate&&invalidChildren.length){if(!args.context){fixInvalidChildren(invalidChildren);}else{args.invalid=true;}}if(rootBlockName&&(rootNode.name==='body'||args.isRootContent)){addRootBlocks();}if(!args.invalid){for(name in matchedNodes){if(!matchedNodes.hasOwnProperty(name)){continue;}list=nodeFilters[name];nodes=matchedNodes[name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1);}}for(i=0,l=list.length;i<l;i++){list[i](nodes,name,args);}}for(i=0,l=attributeFilters.length;i<l;i++){list=attributeFilters[i];if(list.name in matchedAttributes){nodes=matchedAttributes[list.name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1);}}for(fi=0,fl=list.callbacks.length;fi<fl;fi++){list.callbacks[fi](nodes,list.name,args);}}}}return rootNode;};var exports={schema:schema,addAttributeFilter:addAttributeFilter,getAttributeFilters:getAttributeFilters,addNodeFilter:addNodeFilter,getNodeFilters:getNodeFilters,filterNode:filterNode,parse:parse};register$2(exports,settings);register$1(exports,settings);return exports;};var register$3=function register$3(htmlParser,settings,dom){htmlParser.addAttributeFilter('data-mce-tabindex',function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.attr('tabindex',node.attr('data-mce-tabindex'));node.attr(name,null);}});htmlParser.addAttributeFilter('src,href,style',function(nodes,name){var i=nodes.length,node,value;var internalName='data-mce-'+name;var urlConverter=settings.url_converter;var urlConverterScope=settings.url_converter_scope;while(i--){node=nodes[i];value=node.attr(internalName);if(value!==undefined){node.attr(name,value.length>0?value:null);node.attr(internalName,null);}else{value=node.attr(name);if(name==='style'){value=dom.serializeStyle(dom.parseStyle(value),node.name);}else if(urlConverter){value=urlConverter.call(urlConverterScope,value,name,node.name);}node.attr(name,value.length>0?value:null);}}});htmlParser.addAttributeFilter('class',function(nodes){var i=nodes.length,node,value;while(i--){node=nodes[i];value=node.attr('class');if(value){value=node.attr('class').replace(/(?:^|\s)mce-item-\w+(?!\S)/g,'');node.attr('class',value.length>0?value:null);}}});htmlParser.addAttributeFilter('data-mce-type',function(nodes,name,args){var i=nodes.length,node;while(i--){node=nodes[i];if(node.attr('data-mce-type')==='bookmark'&&!args.cleanup){var hasChildren=Optional.from(node.firstChild).exists(function(firstChild){return!isZwsp$1(firstChild.value);});if(hasChildren){node.unwrap();}else{node.remove();}}}});htmlParser.addNodeFilter('noscript',function(nodes){var i=nodes.length,node;while(i--){node=nodes[i].firstChild;if(node){node.value=Entities.decode(node.value);}}});htmlParser.addNodeFilter('script,style',function(nodes,name){var i=nodes.length,node,value,type;var trim=function trim(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,'\n').replace(/^[\r\n]*|[\r\n]*$/g,'').replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,'').replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,'');};while(i--){node=nodes[i];value=node.firstChild?node.firstChild.value:'';if(name==='script'){type=node.attr('type');if(type){node.attr('type',type==='mce-no/type'?null:type.replace(/^mce\-/,''));}if(settings.element_format==='xhtml'&&value.length>0){node.firstChild.value='// <![CDATA[\n'+trim(value)+'\n// ]]>';}}else{if(settings.element_format==='xhtml'&&value.length>0){node.firstChild.value='<!--\n'+trim(value)+'\n-->';}}}});htmlParser.addNodeFilter('#comment',function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];if(settings.preserve_cdata&&node.value.indexOf('[CDATA[')===0){node.name='#cdata';node.type=4;node.value=dom.decode(node.value.replace(/^\[CDATA\[|\]\]$/g,''));}else if(node.value.indexOf('mce:protected ')===0){node.name='#text';node.type=3;node.raw=true;node.value=unescape(node.value).substr(14);}}});htmlParser.addNodeFilter('xml:namespace,input',function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.type===7){node.remove();}else if(node.type===1){if(name==='input'&&!node.attr('type')){node.attr('type','text');}}}});htmlParser.addAttributeFilter('data-mce-type',function(nodes){each(nodes,function(node){if(node.attr('data-mce-type')==='format-caret'){if(node.isEmpty(htmlParser.schema.getNonEmptyElements())){node.remove();}else{node.unwrap();}}});});htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,'+'data-mce-selected,data-mce-expando,'+'data-mce-type,data-mce-resize,data-mce-placeholder',function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null);}});};var trimTrailingBr=function trimTrailingBr(rootNode){var isBr=function isBr(node){return node&&node.name==='br';};var brNode1=rootNode.lastChild;if(isBr(brNode1)){var brNode2=brNode1.prev;if(isBr(brNode2)){brNode1.remove();brNode2.remove();}}};var preProcess=function preProcess(editor,node,args){var doc,oldDoc;var dom=editor.dom;node=node.cloneNode(true);var impl=document.implementation;if(impl.createHTMLDocument){doc=impl.createHTMLDocument('');Tools.each(node.nodeName==='BODY'?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,true));});if(node.nodeName!=='BODY'){node=doc.body.firstChild;}else{node=doc.body;}oldDoc=dom.doc;dom.doc=doc;}firePreProcess(editor,_assign(_assign({},args),{node:node}));if(oldDoc){dom.doc=oldDoc;}return node;};var shouldFireEvent=function shouldFireEvent(editor,args){return editor&&editor.hasEventListeners('PreProcess')&&!args.no_events;};var process=function process(editor,node,args){return shouldFireEvent(editor,args)?preProcess(editor,node,args):node;};var addTempAttr=function addTempAttr(htmlParser,tempAttrs,name){if(Tools.inArray(tempAttrs,name)===-1){htmlParser.addAttributeFilter(name,function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null);}});tempAttrs.push(name);}};var postProcess$1=function postProcess$1(editor,args,content){if(!args.no_events&&editor){var outArgs=firePostProcess(editor,_assign(_assign({},args),{content:content}));return outArgs.content;}else{return content;}};var getHtmlFromNode=function getHtmlFromNode(dom,node,args){var html=trim$2(args.getInner?node.innerHTML:dom.getOuterHTML(node));return args.selection||isWsPreserveElement(SugarElement.fromDom(node))?html:Tools.trim(html);};var parseHtml=function parseHtml(htmlParser,html,args){var parserArgs=args.selection?_assign({forced_root_block:false},args):args;var rootNode=htmlParser.parse(html,parserArgs);trimTrailingBr(rootNode);return rootNode;};var serializeNode=function serializeNode(settings,schema,node){var htmlSerializer=HtmlSerializer(settings,schema);return htmlSerializer.serialize(node);};var toHtml=function toHtml(editor,settings,schema,rootNode,args){var content=serializeNode(settings,schema,rootNode);return postProcess$1(editor,args,content);};var DomSerializerImpl=function DomSerializerImpl(settings,editor){var tempAttrs=['data-mce-selected'];var dom=editor&&editor.dom?editor.dom:DOMUtils$1.DOM;var schema=editor&&editor.schema?editor.schema:Schema(settings);settings.entity_encoding=settings.entity_encoding||'named';settings.remove_trailing_brs='remove_trailing_brs'in settings?settings.remove_trailing_brs:true;var htmlParser=DomParser(settings,schema);register$3(htmlParser,settings,dom);var serialize=function serialize(node,parserArgs){if(parserArgs===void 0){parserArgs={};}var args=_assign({format:'html'},parserArgs);var targetNode=process(editor,node,args);var html=getHtmlFromNode(dom,targetNode,args);var rootNode=parseHtml(htmlParser,html,args);return args.format==='tree'?rootNode:toHtml(editor,settings,schema,rootNode,args);};return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:serialize,addRules:function addRules(rules){schema.addValidElements(rules);},setRules:function setRules(rules){schema.setValidElements(rules);},addTempAttr:curry(addTempAttr,htmlParser,tempAttrs),getTempAttrs:function getTempAttrs(){return tempAttrs;},getNodeFilters:htmlParser.getNodeFilters,getAttributeFilters:htmlParser.getAttributeFilters};};var DomSerializer=function DomSerializer(settings,editor){var domSerializer=DomSerializerImpl(settings,editor);return{schema:domSerializer.schema,addNodeFilter:domSerializer.addNodeFilter,addAttributeFilter:domSerializer.addAttributeFilter,serialize:domSerializer.serialize,addRules:domSerializer.addRules,setRules:domSerializer.setRules,addTempAttr:domSerializer.addTempAttr,getTempAttrs:domSerializer.getTempAttrs,getNodeFilters:domSerializer.getNodeFilters,getAttributeFilters:domSerializer.getAttributeFilters};};var defaultFormat$1='html';var getContent$2=function getContent$2(editor,args){if(args===void 0){args={};}var format=args.format?args.format:defaultFormat$1;return getContent(editor,args,format);};var setContent$2=function setContent$2(editor,content,args){if(args===void 0){args={};}return setContent(editor,content,args);};var DOM$3=DOMUtils$1.DOM;var restoreOriginalStyles=function restoreOriginalStyles(editor){DOM$3.setStyle(editor.id,'display',editor.orgDisplay);};var safeDestroy=function safeDestroy(x){return Optional.from(x).each(function(x){return x.destroy();});};var clearDomReferences=function clearDomReferences(editor){editor.contentAreaContainer=editor.formElement=editor.container=editor.editorContainer=null;editor.bodyElement=editor.contentDocument=editor.contentWindow=null;editor.iframeElement=editor.targetElm=null;if(editor.selection){editor.selection=editor.selection.win=editor.selection.dom=editor.selection.dom.doc=null;}};var restoreForm=function restoreForm(editor){var form=editor.formElement;if(form){if(form._mceOldSubmit){form.submit=form._mceOldSubmit;form._mceOldSubmit=null;}DOM$3.unbind(form,'submit reset',editor.formEventDelegate);}};var remove$7=function remove$7(editor){if(!editor.removed){var _selectionOverrides=editor._selectionOverrides,editorUpload=editor.editorUpload;var body=editor.getBody();var element=editor.getElement();if(body){editor.save({is_removing:true});}editor.removed=true;editor.unbindAllNativeEvents();if(editor.hasHiddenInput&&element){DOM$3.remove(element.nextSibling);}fireRemove(editor);editor.editorManager.remove(editor);if(!editor.inline&&body){restoreOriginalStyles(editor);}fireDetach(editor);DOM$3.remove(editor.getContainer());safeDestroy(_selectionOverrides);safeDestroy(editorUpload);editor.destroy();}};var destroy=function destroy(editor,automatic){var selection=editor.selection,dom=editor.dom;if(editor.destroyed){return;}if(!automatic&&!editor.removed){editor.remove();return;}if(!automatic){editor.editorManager.off('beforeunload',editor._beforeUnload);if(editor.theme&&editor.theme.destroy){editor.theme.destroy();}safeDestroy(selection);safeDestroy(dom);}restoreForm(editor);clearDomReferences(editor);editor.destroyed=true;};var hasOwnProperty$2=Object.prototype.hasOwnProperty;var deep$1=function deep$1(old,nu){var bothObjects=isObject(old)&&isObject(nu);return bothObjects?deepMerge(old,nu):nu;};var baseMerge=function baseMerge(merger){return function(){var objects=new Array(arguments.length);for(var i=0;i<objects.length;i++){objects[i]=arguments[i];}if(objects.length===0){throw new Error('Can\'t merge zero objects');}var ret={};for(var j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject){if(hasOwnProperty$2.call(curObject,key)){ret[key]=merger(ret[key],curObject[key]);}}}return ret;};};var deepMerge=baseMerge(deep$1);var sectionResult=function sectionResult(sections,settings){return{sections:constant(sections),settings:constant(settings)};};var deviceDetection=detect$3().deviceType;var isTouch=deviceDetection.isTouch();var isPhone=deviceDetection.isPhone();var isTablet=deviceDetection.isTablet();var legacyMobilePlugins=['lists','autolink','autosave'];var defaultTouchSettings={table_grid:false,object_resizing:false,resize:false};var normalizePlugins=function normalizePlugins(plugins){var pluginNames=isArray(plugins)?plugins.join(' '):plugins;var trimmedPlugins=map(isString(pluginNames)?pluginNames.split(' '):[],trim);return filter(trimmedPlugins,function(item){return item.length>0;});};var filterLegacyMobilePlugins=function filterLegacyMobilePlugins(plugins){return filter(plugins,curry(contains,legacyMobilePlugins));};var extractSections=function extractSections(keys,settings){var result=bifilter(settings,function(value,key){return contains(keys,key);});return sectionResult(result.t,result.f);};var getSection=function getSection(sectionResult,name,defaults){if(defaults===void 0){defaults={};}var sections=sectionResult.sections();var sectionSettings=sections.hasOwnProperty(name)?sections[name]:{};return Tools.extend({},defaults,sectionSettings);};var hasSection=function hasSection(sectionResult,name){return sectionResult.sections().hasOwnProperty(name);};var isSectionTheme=function isSectionTheme(sectionResult,name,theme){var section=sectionResult.sections();return hasSection(sectionResult,name)&&section[name].theme===theme;};var getSectionConfig=function getSectionConfig(sectionResult,name){return hasSection(sectionResult,name)?sectionResult.sections()[name]:{};};var getToolbarMode=function getToolbarMode(settings,defaultVal){return get(settings,'toolbar_mode').orThunk(function(){return get(settings,'toolbar_drawer').map(function(val){return val===false?'wrap':val;});}).getOr(defaultVal);};var getDefaultSettings=function getDefaultSettings(settings,id,documentBaseUrl,isTouch,editor){var baseDefaults={id:id,theme:'silver',toolbar_mode:getToolbarMode(settings,'floating'),plugins:'',document_base_url:documentBaseUrl,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:'<!DOCTYPE html>',visual:true,font_size_legacy_values:'xx-small,small,medium,large,x-large,xx-large,300%',forced_root_block:'p',hidden_input:true,inline_styles:true,convert_fonts_to_spans:true,indent:true,indent_before:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',indent_after:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',entity_encoding:'named',url_converter:editor.convertURL,url_converter_scope:editor};return _assign(_assign({},baseDefaults),isTouch?defaultTouchSettings:{});};var getDefaultMobileSettings=function getDefaultMobileSettings(mobileSettings,isPhone){var defaultMobileSettings={resize:false,toolbar_mode:getToolbarMode(mobileSettings,'scrolling'),toolbar_sticky:false};var defaultPhoneSettings={menubar:false};return _assign(_assign(_assign({},defaultTouchSettings),defaultMobileSettings),isPhone?defaultPhoneSettings:{});};var getExternalPlugins$1=function getExternalPlugins$1(overrideSettings,settings){var userDefinedExternalPlugins=settings.external_plugins?settings.external_plugins:{};if(overrideSettings&&overrideSettings.external_plugins){return Tools.extend({},overrideSettings.external_plugins,userDefinedExternalPlugins);}else{return userDefinedExternalPlugins;}};var combinePlugins=function combinePlugins(forcedPlugins,plugins){return[].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));};var processPlugins=function processPlugins(isMobileDevice,sectionResult,defaultOverrideSettings,settings){var forcedPlugins=normalizePlugins(defaultOverrideSettings.forced_plugins);var desktopPlugins=normalizePlugins(settings.plugins);var mobileConfig=getSectionConfig(sectionResult,'mobile');var mobilePlugins=mobileConfig.plugins?normalizePlugins(mobileConfig.plugins):desktopPlugins;var platformPlugins=isMobileDevice&&isSectionTheme(sectionResult,'mobile','mobile')?filterLegacyMobilePlugins(mobilePlugins):isMobileDevice&&hasSection(sectionResult,'mobile')?mobilePlugins:desktopPlugins;var combinedPlugins=combinePlugins(forcedPlugins,platformPlugins);return Tools.extend(settings,{plugins:combinedPlugins.join(' ')});};var isOnMobile=function isOnMobile(isMobileDevice,sectionResult){return isMobileDevice&&hasSection(sectionResult,'mobile');};var combineSettings=function combineSettings(isMobileDevice,isPhone,defaultSettings,defaultOverrideSettings,settings){var defaultDeviceSettings=isMobileDevice?{mobile:getDefaultMobileSettings(settings.mobile||{},isPhone)}:{};var sectionResult=extractSections(['mobile'],deepMerge(defaultDeviceSettings,settings));var extendedSettings=Tools.extend(defaultSettings,defaultOverrideSettings,sectionResult.settings(),isOnMobile(isMobileDevice,sectionResult)?getSection(sectionResult,'mobile'):{},{validate:true,external_plugins:getExternalPlugins$1(defaultOverrideSettings,sectionResult.settings())});return processPlugins(isMobileDevice,sectionResult,defaultOverrideSettings,extendedSettings);};var getEditorSettings=function getEditorSettings(editor,id,documentBaseUrl,defaultOverrideSettings,settings){var defaultSettings=getDefaultSettings(settings,id,documentBaseUrl,isTouch,editor);return combineSettings(isPhone||isTablet,isPhone,defaultSettings,defaultOverrideSettings,settings);};var getFiltered=function getFiltered(predicate,editor,name){return Optional.from(editor.settings[name]).filter(predicate);};var getParamObject=function getParamObject(value){var output={};if(typeof value==='string'){each(value.indexOf('=')>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(','),function(val){var arr=val.split('=');if(arr.length>1){output[Tools.trim(arr[0])]=Tools.trim(arr[1]);}else{output[Tools.trim(arr[0])]=Tools.trim(arr[0]);}});}else{output=value;}return output;};var isArrayOf=function isArrayOf(p){return function(a){return isArray(a)&&forall(a,p);};};var getParam=function getParam(editor,name,defaultVal,type){var value=name in editor.settings?editor.settings[name]:defaultVal;if(type==='hash'){return getParamObject(value);}else if(type==='string'){return getFiltered(isString,editor,name).getOr(defaultVal);}else if(type==='number'){return getFiltered(isNumber,editor,name).getOr(defaultVal);}else if(type==='boolean'){return getFiltered(isBoolean,editor,name).getOr(defaultVal);}else if(type==='object'){return getFiltered(isObject,editor,name).getOr(defaultVal);}else if(type==='array'){return getFiltered(isArray,editor,name).getOr(defaultVal);}else if(type==='string[]'){return getFiltered(isArrayOf(isString),editor,name).getOr(defaultVal);}else if(type==='function'){return getFiltered(isFunction,editor,name).getOr(defaultVal);}else{return value;}};var CreateIconManager=function CreateIconManager(){var lookup={};var add=function add(id,iconPack){lookup[id]=iconPack;};var get=function get(id){if(lookup[id]){return lookup[id];}return{icons:{}};};var has$1=function has$1(id){return has(lookup,id);};return{add:add,get:get,has:has$1};};var IconManager=CreateIconManager();var getProp=function getProp(propName,elm){var rawElm=elm.dom;return rawElm[propName];};var getComputedSizeProp=function getComputedSizeProp(propName,elm){return parseInt(get$4(elm,propName),10);};var getClientWidth=curry(getProp,'clientWidth');var getClientHeight=curry(getProp,'clientHeight');var getMarginTop=curry(getComputedSizeProp,'margin-top');var getMarginLeft=curry(getComputedSizeProp,'margin-left');var getBoundingClientRect$1=function getBoundingClientRect$1(elm){return elm.dom.getBoundingClientRect();};var isInsideElementContentArea=function isInsideElementContentArea(bodyElm,clientX,clientY){var clientWidth=getClientWidth(bodyElm);var clientHeight=getClientHeight(bodyElm);return clientX>=0&&clientY>=0&&clientX<=clientWidth&&clientY<=clientHeight;};var transpose=function transpose(inline,elm,clientX,clientY){var clientRect=getBoundingClientRect$1(elm);var deltaX=inline?clientRect.left+elm.dom.clientLeft+getMarginLeft(elm):0;var deltaY=inline?clientRect.top+elm.dom.clientTop+getMarginTop(elm):0;var x=clientX-deltaX;var y=clientY-deltaY;return{x:x,y:y};};var isXYInContentArea=function isXYInContentArea(editor,clientX,clientY){var bodyElm=SugarElement.fromDom(editor.getBody());var targetElm=editor.inline?bodyElm:documentElement(bodyElm);var transposedPoint=transpose(editor.inline,targetElm,clientX,clientY);return isInsideElementContentArea(targetElm,transposedPoint.x,transposedPoint.y);};var fromDomSafe=function fromDomSafe(node){return Optional.from(node).map(SugarElement.fromDom);};var isEditorAttachedToDom=function isEditorAttachedToDom(editor){var rawContainer=editor.inline?editor.getBody():editor.getContentAreaContainer();return fromDomSafe(rawContainer).map(inBody).getOr(false);};function NotificationManagerImpl(){var unimplemented=function unimplemented(){throw new Error('Theme did not provide a NotificationManager implementation.');};return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented};}function NotificationManager(editor){var notifications=[];var getImplementation=function getImplementation(){var theme=editor.theme;return theme&&theme.getNotificationManagerImpl?theme.getNotificationManagerImpl():NotificationManagerImpl();};var getTopNotification=function getTopNotification(){return Optional.from(notifications[0]);};var isEqual=function isEqual(a,b){return a.type===b.type&&a.text===b.text&&!a.progressBar&&!a.timeout&&!b.progressBar&&!b.timeout;};var reposition=function reposition(){if(notifications.length>0){getImplementation().reposition(notifications);}};var addNotification=function addNotification(notification){notifications.push(notification);};var closeNotification=function closeNotification(notification){findIndex(notifications,function(otherNotification){return otherNotification===notification;}).each(function(index){notifications.splice(index,1);});};var open=function open(spec){if(editor.removed||!isEditorAttachedToDom(editor)){return;}return find(notifications,function(notification){return isEqual(getImplementation().getArgs(notification),spec);}).getOrThunk(function(){editor.editorManager.setActive(editor);var notification=getImplementation().open(spec,function(){closeNotification(notification);reposition();getTopNotification().fold(function(){return editor.focus();},function(top){return focus(SugarElement.fromDom(top.getEl()));});});addNotification(notification);reposition();return notification;});};var close=function close(){getTopNotification().each(function(notification){getImplementation().close(notification);closeNotification(notification);reposition();});};var getNotifications=function getNotifications(){return notifications;};var registerEvents=function registerEvents(editor){editor.on('SkinLoaded',function(){var serviceMessage=getServiceMessage(editor);if(serviceMessage){open({text:serviceMessage,type:'warning',timeout:0});}});editor.on('ResizeEditor ResizeWindow NodeChange',function(){Delay.requestAnimationFrame(reposition);});editor.on('remove',function(){each(notifications.slice(),function(notification){getImplementation().close(notification);});});};registerEvents(editor);return{open:open,close:close,getNotifications:getNotifications};}var PluginManager=AddOnManager$1.PluginManager;var ThemeManager=AddOnManager$1.ThemeManager;function WindowManagerImpl(){var unimplemented=function unimplemented(){throw new Error('Theme did not provide a WindowManager implementation.');};return{open:unimplemented,openUrl:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented};}var WindowManager=function WindowManager(editor){var dialogs=[];var getImplementation=function getImplementation(){var theme=editor.theme;return theme&&theme.getWindowManagerImpl?theme.getWindowManagerImpl():WindowManagerImpl();};var funcBind=function funcBind(scope,f){return function(){return f?f.apply(scope,arguments):undefined;};};var fireOpenEvent=function fireOpenEvent(dialog){editor.fire('OpenWindow',{dialog:dialog});};var fireCloseEvent=function fireCloseEvent(dialog){editor.fire('CloseWindow',{dialog:dialog});};var addDialog=function addDialog(dialog){dialogs.push(dialog);fireOpenEvent(dialog);};var closeDialog=function closeDialog(dialog){fireCloseEvent(dialog);dialogs=filter(dialogs,function(otherDialog){return otherDialog!==dialog;});if(dialogs.length===0){editor.focus();}};var getTopDialog=function getTopDialog(){return Optional.from(dialogs[dialogs.length-1]);};var storeSelectionAndOpenDialog=function storeSelectionAndOpenDialog(openDialog){editor.editorManager.setActive(editor);store(editor);var dialog=openDialog();addDialog(dialog);return dialog;};var open=function open(args,params){return storeSelectionAndOpenDialog(function(){return getImplementation().open(args,params,closeDialog);});};var openUrl=function openUrl(args){return storeSelectionAndOpenDialog(function(){return getImplementation().openUrl(args,closeDialog);});};var alert=function alert(message,callback,scope){getImplementation().alert(message,funcBind(scope?scope:this,callback));};var confirm=function confirm(message,callback,scope){getImplementation().confirm(message,funcBind(scope?scope:this,callback));};var close=function close(){getTopDialog().each(function(dialog){getImplementation().close(dialog);closeDialog(dialog);});};editor.on('remove',function(){each(dialogs,function(dialog){getImplementation().close(dialog);});});return{open:open,openUrl:openUrl,alert:alert,confirm:confirm,close:close};};var displayNotification=function displayNotification(editor,message){editor.notificationManager.open({type:'error',text:message});};var displayError=function displayError(editor,message){if(editor._skinLoaded){displayNotification(editor,message);}else{editor.on('SkinLoaded',function(){displayNotification(editor,message);});}};var uploadError=function uploadError(editor,message){displayError(editor,I18n.translate(['Failed to upload image: {0}',message]));};var logError=function logError(editor,errorType,msg){fireError(editor,errorType,{message:msg});console.error(msg);};var createLoadError=function createLoadError(type,url,name){return name?'Failed to load '+type+': '+name+' from url '+url:'Failed to load '+type+' url: '+url;};var pluginLoadError=function pluginLoadError(editor,url,name){logError(editor,'PluginLoadError',createLoadError('plugin',url,name));};var iconsLoadError=function iconsLoadError(editor,url,name){logError(editor,'IconsLoadError',createLoadError('icons',url,name));};var languageLoadError=function languageLoadError(editor,url,name){logError(editor,'LanguageLoadError',createLoadError('language',url,name));};var pluginInitError=function pluginInitError(editor,name,err){var message=I18n.translate(['Failed to initialize plugin: {0}',name]);initError(message,err);displayError(editor,message);};var initError=function initError(message){var x=[];for(var _i=1;_i<arguments.length;_i++){x[_i-1]=arguments[_i];}var console=window.console;if(console){if(console.error){console.error.apply(console,__spreadArrays([message],x));}else{console.log.apply(console,__spreadArrays([message],x));}}};var isContentCssSkinName=function isContentCssSkinName(url){return /^[a-z0-9\-]+$/i.test(url);};var getContentCssUrls=function getContentCssUrls(editor){var contentCss=getContentCss(editor);var skinUrl=editor.editorManager.baseURL+'/skins/content';var suffix=editor.editorManager.suffix;var contentCssFile='content'+suffix+'.css';var inline=editor.inline===true;return map(contentCss,function(url){if(isContentCssSkinName(url)&&!inline){return skinUrl+'/'+url+'/'+contentCssFile;}else{return editor.documentBaseURI.toAbsolute(url);}});};var appendContentCssFromSettings=function appendContentCssFromSettings(editor){editor.contentCSS=editor.contentCSS.concat(getContentCssUrls(editor));};function Uploader(uploadStatus,settings){var pendingPromises={};var pathJoin=function pathJoin(path1,path2){if(path1){return path1.replace(/\/$/,'')+'/'+path2.replace(/^\//,'');}return path2;};var defaultHandler=function defaultHandler(blobInfo,success,failure,progress){var xhr=new XMLHttpRequest();xhr.open('POST',settings.url);xhr.withCredentials=settings.credentials;xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100);};xhr.onerror=function(){failure('Image upload failed due to a XHR Transport error. Code: '+xhr.status);};xhr.onload=function(){if(xhr.status<200||xhr.status>=300){failure('HTTP Error: '+xhr.status);return;}var json=JSON.parse(xhr.responseText);if(!json||typeof json.location!=='string'){failure('Invalid JSON: '+xhr.responseText);return;}success(pathJoin(settings.basePath,json.location));};var formData=new FormData();formData.append('file',blobInfo.blob(),blobInfo.filename());xhr.send(formData);};var noUpload=function noUpload(){return new promiseObj(function(resolve){resolve([]);});};var handlerSuccess=function handlerSuccess(blobInfo,url){return{url:url,blobInfo:blobInfo,status:true};};var handlerFailure=function handlerFailure(blobInfo,message,options){return{url:'',blobInfo:blobInfo,status:false,error:{message:message,options:options}};};var resolvePending=function resolvePending(blobUri,result){Tools.each(pendingPromises[blobUri],function(resolve){resolve(result);});delete pendingPromises[blobUri];};var uploadBlobInfo=function uploadBlobInfo(blobInfo,handler,openNotification){uploadStatus.markPending(blobInfo.blobUri());return new promiseObj(function(resolve){var notification,progress;var noop=function noop(){};try{var closeNotification_1=function closeNotification_1(){if(notification){notification.close();progress=noop;}};var success=function success(url){closeNotification_1();uploadStatus.markUploaded(blobInfo.blobUri(),url);resolvePending(blobInfo.blobUri(),handlerSuccess(blobInfo,url));resolve(handlerSuccess(blobInfo,url));};var failure=function failure(error,options){var failureOptions=options?options:{};closeNotification_1();uploadStatus.removeFailed(blobInfo.blobUri());resolvePending(blobInfo.blobUri(),handlerFailure(blobInfo,error,failureOptions));resolve(handlerFailure(blobInfo,error,failureOptions));};progress=function progress(percent){if(percent<0||percent>100){return;}if(!notification){notification=openNotification();}notification.progressBar.value(percent);};handler(blobInfo,success,failure,progress);}catch(ex){resolve(handlerFailure(blobInfo,ex.message,{}));}});};var isDefaultHandler=function isDefaultHandler(handler){return handler===defaultHandler;};var pendingUploadBlobInfo=function pendingUploadBlobInfo(blobInfo){var blobUri=blobInfo.blobUri();return new promiseObj(function(resolve){pendingPromises[blobUri]=pendingPromises[blobUri]||[];pendingPromises[blobUri].push(resolve);});};var uploadBlobs=function uploadBlobs(blobInfos,openNotification){blobInfos=Tools.grep(blobInfos,function(blobInfo){return!uploadStatus.isUploaded(blobInfo.blobUri());});return promiseObj.all(Tools.map(blobInfos,function(blobInfo){return uploadStatus.isPending(blobInfo.blobUri())?pendingUploadBlobInfo(blobInfo):uploadBlobInfo(blobInfo,settings.handler,openNotification);}));};var upload=function upload(blobInfos,openNotification){return!settings.url&&isDefaultHandler(settings.handler)?noUpload():uploadBlobs(blobInfos,openNotification);};if(isFunction(settings.handler)===false){settings.handler=defaultHandler;}return{upload:upload};}function UploadStatus(){var PENDING=1,UPLOADED=2;var blobUriStatuses={};var createStatus=function createStatus(status,resultUri){return{status:status,resultUri:resultUri};};var hasBlobUri=function hasBlobUri(blobUri){return blobUri in blobUriStatuses;};var getResultUri=function getResultUri(blobUri){var result=blobUriStatuses[blobUri];return result?result.resultUri:null;};var isPending=function isPending(blobUri){return hasBlobUri(blobUri)?blobUriStatuses[blobUri].status===PENDING:false;};var isUploaded=function isUploaded(blobUri){return hasBlobUri(blobUri)?blobUriStatuses[blobUri].status===UPLOADED:false;};var markPending=function markPending(blobUri){blobUriStatuses[blobUri]=createStatus(PENDING,null);};var markUploaded=function markUploaded(blobUri,resultUri){blobUriStatuses[blobUri]=createStatus(UPLOADED,resultUri);};var removeFailed=function removeFailed(blobUri){delete blobUriStatuses[blobUri];};var destroy=function destroy(){blobUriStatuses={};};return{hasBlobUri:hasBlobUri,getResultUri:getResultUri,isPending:isPending,isUploaded:isUploaded,markPending:markPending,markUploaded:markUploaded,removeFailed:removeFailed,destroy:destroy};}var count$1=0;var seed=function seed(){var rnd=function rnd(){return Math.round(Math.random()*4294967295).toString(36);};var now=new Date().getTime();return's'+now.toString(36)+rnd()+rnd()+rnd();};var uuid=function uuid(prefix){return prefix+count$1++ +seed();};var BlobCache=function BlobCache(){var cache=[];var mimeToExt=function mimeToExt(mime){var mimes={'image/jpeg':'jpg','image/jpg':'jpg','image/gif':'gif','image/png':'png'};return mimes[mime.toLowerCase()]||'dat';};var create=function create(o,blob,base64,filename){if(isString(o)){var id=o;return toBlobInfo({id:id,name:filename,blob:blob,base64:base64});}else if(isObject(o)){return toBlobInfo(o);}else{throw new Error('Unknown input type');}};var toBlobInfo=function toBlobInfo(o){if(!o.blob||!o.base64){throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');}var id=o.id||uuid('blobid');var name=o.name||id;return{id:constant(id),name:constant(name),filename:constant(name+'.'+mimeToExt(o.blob.type)),blob:constant(o.blob),base64:constant(o.base64),blobUri:constant(o.blobUri||URL.createObjectURL(o.blob)),uri:constant(o.uri)};};var add=function add(blobInfo){if(!get(blobInfo.id())){cache.push(blobInfo);}};var findFirst=function findFirst(predicate){return find(cache,predicate).getOrUndefined();};var get=function get(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id;});};var getByUri=function getByUri(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()===blobUri;});};var getByData=function getByData(base64,type){return findFirst(function(blobInfo){return blobInfo.base64()===base64&&blobInfo.blob().type===type;});};var removeByUri=function removeByUri(blobUri){cache=filter(cache,function(blobInfo){if(blobInfo.blobUri()===blobUri){URL.revokeObjectURL(blobInfo.blobUri());return false;}return true;});};var destroy=function destroy(){each(cache,function(cachedBlobInfo){URL.revokeObjectURL(cachedBlobInfo.blobUri());});cache=[];};return{create:create,add:add,get:get,getByUri:getByUri,getByData:getByData,findFirst:findFirst,removeByUri:removeByUri,destroy:destroy};};var EditorUpload=function EditorUpload(editor){var blobCache=BlobCache();var uploader,imageScanner;var uploadStatus=UploadStatus();var urlFilters=[];var aliveGuard=function aliveGuard(callback){return function(result){if(editor.selection){return callback(result);}return[];};};var cacheInvalidator=function cacheInvalidator(url){return url+(url.indexOf('?')===-1?'?':'&')+new Date().getTime();};var replaceString=function replaceString(content,search,replace){var index=0;do{index=content.indexOf(search,index);if(index!==-1){content=content.substring(0,index)+replace+content.substr(index+search.length);index+=replace.length-search.length+1;}}while(index!==-1);return content;};var replaceImageUrl=function replaceImageUrl(content,targetUrl,replacementUrl){var replacementString='src="'+replacementUrl+'"'+(replacementUrl===Env.transparentSrc?' data-mce-placeholder="1"':'');content=replaceString(content,'src="'+targetUrl+'"',replacementString);content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"');return content;};var replaceUrlInUndoStack=function replaceUrlInUndoStack(targetUrl,replacementUrl){each(editor.undoManager.data,function(level){if(level.type==='fragmented'){level.fragments=map(level.fragments,function(fragment){return replaceImageUrl(fragment,targetUrl,replacementUrl);});}else{level.content=replaceImageUrl(level.content,targetUrl,replacementUrl);}});};var openNotification=function openNotification(){return editor.notificationManager.open({text:editor.translate('Image uploading...'),type:'info',timeout:-1,progressBar:true});};var replaceImageUriInView=function replaceImageUriInView(image,resultUri){var src=editor.convertURL(resultUri,'src');replaceUrlInUndoStack(image.src,resultUri);editor.$(image).attr({'src':shouldReuseFileName(editor)?cacheInvalidator(resultUri):resultUri,'data-mce-src':src});};var uploadImages=function uploadImages(callback){if(!uploader){uploader=Uploader(uploadStatus,{url:getImageUploadUrl(editor),basePath:getImageUploadBasePath(editor),credentials:getImagesUploadCredentials(editor),handler:getImagesUploadHandler(editor)});}return scanForImages().then(aliveGuard(function(imageInfos){var blobInfos=map(imageInfos,function(imageInfo){return imageInfo.blobInfo;});return uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){var imagesToRemove=[];var filteredResult=map(result,function(uploadInfo,index){var blobInfo=imageInfos[index].blobInfo;var image=imageInfos[index].image;if(uploadInfo.status&&shouldReplaceBlobUris(editor)){blobCache.removeByUri(image.src);replaceImageUriInView(image,uploadInfo.url);}else if(uploadInfo.error){if(uploadInfo.error.options.remove){replaceUrlInUndoStack(image.getAttribute('src'),Env.transparentSrc);imagesToRemove.push(image);}uploadError(editor,uploadInfo.error.message);}return{element:image,status:uploadInfo.status,uploadUri:uploadInfo.url,blobInfo:blobInfo};});if(imagesToRemove.length>0){if(isRtc(editor)){console.error('Removing images on failed uploads is currently unsupported for RTC');}else{editor.undoManager.transact(function(){each(imagesToRemove,function(element){editor.dom.remove(element);blobCache.removeByUri(element.src);});});}}if(callback){callback(filteredResult);}return filteredResult;}));}));};var uploadImagesAuto=function uploadImagesAuto(callback){if(isAutomaticUploadsEnabled(editor)){return uploadImages(callback);}};var isValidDataUriImage=function isValidDataUriImage(imgElm){if(forall(urlFilters,function(filter){return filter(imgElm);})===false){return false;}if(imgElm.getAttribute('src').indexOf('data:')===0){var dataImgFilter=getImagesDataImgFilter(editor);return dataImgFilter(imgElm);}return true;};var addFilter=function addFilter(filter){urlFilters.push(filter);};var scanForImages=function scanForImages(){if(!imageScanner){imageScanner=ImageScanner(uploadStatus,blobCache);}return imageScanner.findAll(editor.getBody(),isValidDataUriImage).then(aliveGuard(function(result){result=filter(result,function(resultItem){if(typeof resultItem==='string'){displayError(editor,resultItem);return false;}return true;});each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri());resultItem.image.src=resultItem.blobInfo.blobUri();resultItem.image.removeAttribute('data-mce-src');});return result;}));};var destroy=function destroy(){blobCache.destroy();uploadStatus.destroy();imageScanner=uploader=null;};var replaceBlobUris=function replaceBlobUris(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var resultUri=uploadStatus.getResultUri(blobUri);if(resultUri){return'src="'+resultUri+'"';}var blobInfo=blobCache.getByUri(blobUri);if(!blobInfo){blobInfo=foldl(editor.editorManager.get(),function(result,editor){return result||editor.editorUpload&&editor.editorUpload.blobCache.getByUri(blobUri);},null);}if(blobInfo){var blob=blobInfo.blob();return'src="data:'+blob.type+';base64,'+blobInfo.base64()+'"';}return match;});};editor.on('SetContent',function(){if(isAutomaticUploadsEnabled(editor)){uploadImagesAuto();}else{scanForImages();}});editor.on('RawSaveContent',function(e){e.content=replaceBlobUris(e.content);});editor.on('GetContent',function(e){if(e.source_view||e.format==='raw'){return;}e.content=replaceBlobUris(e.content);});editor.on('PostRender',function(){editor.parser.addNodeFilter('img',function(images){each(images,function(img){var src=img.attr('src');if(blobCache.getByUri(src)){return;}var resultUri=uploadStatus.getResultUri(src);if(resultUri){img.attr('src',resultUri);}});});});return{blobCache:blobCache,addFilter:addFilter,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy};};var setup$5=function setup$5(registeredFormatListeners,editor){var currentFormats=Cell({});registeredFormatListeners.set({});editor.on('NodeChange',function(e){updateAndFireChangeCallbacks(editor,e.element,currentFormats,registeredFormatListeners.get());});};var updateAndFireChangeCallbacks=function updateAndFireChangeCallbacks(editor,elm,currentFormats,formatChangeData){var formatsList=keys(currentFormats.get());var newFormats={};var matchedFormats={};var parents=filter(getParents$1(editor.dom,elm),function(node){return node.nodeType===1&&!node.getAttribute('data-mce-bogus');});each$1(formatChangeData,function(data,format){Tools.each(parents,function(node){if(editor.formatter.matchNode(node,format,{},data.similar)){if(formatsList.indexOf(format)===-1){each(data.callbacks,function(callback){callback(true,{node:node,format:format,parents:parents});});newFormats[format]=data.callbacks;}matchedFormats[format]=data.callbacks;return false;}if(matchesUnInheritedFormatSelector(editor,node,format)){return false;}});});var remainingFormats=filterRemainingFormats(currentFormats.get(),matchedFormats,elm,parents);currentFormats.set(_assign(_assign({},newFormats),remainingFormats));};var filterRemainingFormats=function filterRemainingFormats(currentFormats,matchedFormats,elm,parents){return bifilter(currentFormats,function(callbacks,format){if(!has(matchedFormats,format)){each(callbacks,function(callback){callback(false,{node:elm,format:format,parents:parents});});return false;}else{return true;}}).t;};var addListeners=function addListeners(registeredFormatListeners,formats,callback,similar){var formatChangeItems=registeredFormatListeners.get();each(formats.split(','),function(format){if(!formatChangeItems[format]){formatChangeItems[format]={similar:similar,callbacks:[]};}formatChangeItems[format].callbacks.push(callback);});registeredFormatListeners.set(formatChangeItems);};var removeListeners=function removeListeners(registeredFormatListeners,formats,callback){var formatChangeItems=registeredFormatListeners.get();each(formats.split(','),function(format){formatChangeItems[format].callbacks=filter(formatChangeItems[format].callbacks,function(c){return c!==callback;});if(formatChangeItems[format].callbacks.length===0){delete formatChangeItems[format];}});registeredFormatListeners.set(formatChangeItems);};var formatChanged=function formatChanged(editor,registeredFormatListeners,formats,callback,similar){if(registeredFormatListeners.get()===null){setup$5(registeredFormatListeners,editor);}addListeners(registeredFormatListeners,formats,callback,similar);return{unbind:function unbind(){return removeListeners(registeredFormatListeners,formats,callback);}};};var get$9=function get$9(dom){var formats={valigntop:[{selector:'td,th',styles:{verticalAlign:'top'}}],valignmiddle:[{selector:'td,th',styles:{verticalAlign:'middle'}}],valignbottom:[{selector:'td,th',styles:{verticalAlign:'bottom'}}],alignleft:[{selector:'figure.image',collapsed:false,classes:'align-left',ceFalseOverride:true,preview:'font-family font-size'},{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'left'},inherit:false,preview:false,defaultBlock:'div'},{selector:'img,table',collapsed:false,styles:{"float":'left'},preview:'font-family font-size'}],aligncenter:[{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'center'},inherit:false,preview:'font-family font-size',defaultBlock:'div'},{selector:'figure.image',collapsed:false,classes:'align-center',ceFalseOverride:true,preview:'font-family font-size'},{selector:'img',collapsed:false,styles:{display:'block',marginLeft:'auto',marginRight:'auto'},preview:false},{selector:'table',collapsed:false,styles:{marginLeft:'auto',marginRight:'auto'},preview:'font-family font-size'}],alignright:[{selector:'figure.image',collapsed:false,classes:'align-right',ceFalseOverride:true,preview:'font-family font-size'},{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'right'},inherit:false,preview:'font-family font-size',defaultBlock:'div'},{selector:'img,table',collapsed:false,styles:{"float":'right'},preview:'font-family font-size'}],alignjustify:[{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'justify'},inherit:false,defaultBlock:'div',preview:'font-family font-size'}],bold:[{inline:'strong',remove:'all',preserve_attributes:['class','style']},{inline:'span',styles:{fontWeight:'bold'}},{inline:'b',remove:'all',preserve_attributes:['class','style']}],italic:[{inline:'em',remove:'all',preserve_attributes:['class','style']},{inline:'span',styles:{fontStyle:'italic'}},{inline:'i',remove:'all',preserve_attributes:['class','style']}],underline:[{inline:'span',styles:{textDecoration:'underline'},exact:true},{inline:'u',remove:'all',preserve_attributes:['class','style']}],strikethrough:[{inline:'span',styles:{textDecoration:'line-through'},exact:true},{inline:'strike',remove:'all',preserve_attributes:['class','style']}],forecolor:{inline:'span',styles:{color:'%value'},links:true,remove_similar:true,clear_child_styles:true},hilitecolor:{inline:'span',styles:{backgroundColor:'%value'},links:true,remove_similar:true,clear_child_styles:true},fontname:{inline:'span',toggle:false,styles:{fontFamily:'%value'},clear_child_styles:true},fontsize:{inline:'span',toggle:false,styles:{fontSize:'%value'},clear_child_styles:true},lineheight:{selector:'h1,h2,h3,h4,h5,h6,p,li,td,th,div',defaultBlock:'p',styles:{lineHeight:'%value'}},fontsize_class:{inline:'span',attributes:{"class":'%value'}},blockquote:{block:'blockquote',wrapper:true,remove:'all'},subscript:{inline:'sub'},superscript:{inline:'sup'},code:{inline:'code'},link:{inline:'a',selector:'a',remove:'all',split:true,deep:true,onmatch:function onmatch(node,_fmt,_itemName){return isElement$1(node)&&node.hasAttribute('href');},onformat:function onformat(elm,_fmt,vars){Tools.each(vars,function(value,key){dom.setAttrib(elm,key,value);});}},removeformat:[{selector:'b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',remove:'all',split:true,expand:false,block_expand:true,deep:true},{selector:'span',attributes:['style','class'],remove:'empty',split:true,expand:false,deep:true},{selector:'*',attributes:['style','class'],split:false,expand:false,deep:true}]};Tools.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\s/),function(name){formats[name]={block:name,remove:'all'};});return formats;};function FormatRegistry(editor){var formats={};var get=function get(name){return name?formats[name]:formats;};var has$1=function has$1(name){return has(formats,name);};var register=function register(name,format){if(name){if(typeof name!=='string'){Tools.each(name,function(format,name){register(name,format);});}else{if(!isArray(format)){format=[format];}Tools.each(format,function(format){if(typeof format.deep==='undefined'){format.deep=!format.selector;}if(typeof format.split==='undefined'){format.split=!format.selector||format.inline;}if(typeof format.remove==='undefined'&&format.selector&&!format.inline){format.remove='none';}if(format.selector&&format.inline){format.mixed=true;format.block_expand=true;}if(typeof format.classes==='string'){format.classes=format.classes.split(/\s+/);}});formats[name]=format;}}};var unregister=function unregister(name){if(name&&formats[name]){delete formats[name];}return formats;};register(get$9(editor.dom));register(getFormats(editor));return{get:get,has:has$1,register:register,unregister:unregister};}var each$e=Tools.each;var dom=DOMUtils$1.DOM;var parsedSelectorToHtml=function parsedSelectorToHtml(ancestry,editor){var elm,item,fragment;var schema=editor&&editor.schema||Schema({});var decorate=function decorate(elm,item){if(item.classes.length){dom.addClass(elm,item.classes.join(' '));}dom.setAttribs(elm,item.attrs);};var createElement=function createElement(sItem){item=typeof sItem==='string'?{name:sItem,classes:[],attrs:{}}:sItem;var elm=dom.create(item.name);decorate(elm,item);return elm;};var getRequiredParent=function getRequiredParent(elm,candidate){var name=typeof elm!=='string'?elm.nodeName.toLowerCase():elm;var elmRule=schema.getElementRule(name);var parentsRequired=elmRule&&elmRule.parentsRequired;if(parentsRequired&&parentsRequired.length){return candidate&&Tools.inArray(parentsRequired,candidate)!==-1?candidate:parentsRequired[0];}else{return false;}};var wrapInHtml=function wrapInHtml(elm,ancestry,siblings){var parent,parentCandidate;var ancestor=ancestry.length>0&&ancestry[0];var ancestorName=ancestor&&ancestor.name;var parentRequired=getRequiredParent(elm,ancestorName);if(parentRequired){if(ancestorName===parentRequired){parentCandidate=ancestry[0];ancestry=ancestry.slice(1);}else{parentCandidate=parentRequired;}}else if(ancestor){parentCandidate=ancestry[0];ancestry=ancestry.slice(1);}else if(!siblings){return elm;}if(parentCandidate){parent=createElement(parentCandidate);parent.appendChild(elm);}if(siblings){if(!parent){parent=dom.create('div');parent.appendChild(elm);}Tools.each(siblings,function(sibling){var siblingElm=createElement(sibling);parent.insertBefore(siblingElm,elm);});}return wrapInHtml(parent,ancestry,parentCandidate&&parentCandidate.siblings);};if(ancestry&&ancestry.length){item=ancestry[0];elm=createElement(item);fragment=dom.create('div');fragment.appendChild(wrapInHtml(elm,ancestry.slice(1),item.siblings));return fragment;}else{return'';}};var parseSelectorItem=function parseSelectorItem(item){var tagName;var obj={classes:[],attrs:{}};item=obj.selector=Tools.trim(item);if(item!=='*'){tagName=item.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function($0,$1,$2,$3,$4){switch($1){case'#':obj.attrs.id=$2;break;case'.':obj.classes.push($2);break;case':':if(Tools.inArray('checked disabled enabled read-only required'.split(' '),$2)!==-1){obj.attrs[$2]=$2;}break;}if($3==='['){var m=$4.match(/([\w\-]+)(?:\=\"([^\"]+))?/);if(m){obj.attrs[m[1]]=m[2];}}return'';});}obj.name=tagName||'div';return obj;};var parseSelector=function parseSelector(selector){if(!selector||typeof selector!=='string'){return[];}selector=selector.split(/\s*,\s*/)[0];selector=selector.replace(/\s*(~\+|~|\+|>)\s*/g,'$1');return Tools.map(selector.split(/(?:>|\s+(?![^\[\]]+\]))/),function(item){var siblings=Tools.map(item.split(/(?:~\+|~|\+)/),parseSelectorItem);var obj=siblings.pop();if(siblings.length){obj.siblings=siblings;}return obj;}).reverse();};var getCssText=function getCssText(editor,format){var name,previewFrag;var previewCss='',parentFontSize;var previewStyles=getPreviewStyles(editor);if(previewStyles===''){return'';}var removeVars=function removeVars(val){return val.replace(/%(\w+)/g,'');};if(typeof format==='string'){format=editor.formatter.get(format);if(!format){return;}format=format[0];}if('preview'in format){var previewOpt=get(format,'preview');if(previewOpt.is(false)){return'';}else{previewStyles=previewOpt.getOr(previewStyles);}}name=format.block||format.inline||'span';var items=parseSelector(format.selector);if(items.length){if(!items[0].name){items[0].name=name;}name=format.selector;previewFrag=parsedSelectorToHtml(items,editor);}else{previewFrag=parsedSelectorToHtml([name],editor);}var previewElm=dom.select(name,previewFrag)[0]||previewFrag.firstChild;each$e(format.styles,function(value,name){var newValue=removeVars(value);if(newValue){dom.setStyle(previewElm,name,newValue);}});each$e(format.attributes,function(value,name){var newValue=removeVars(value);if(newValue){dom.setAttrib(previewElm,name,newValue);}});each$e(format.classes,function(value){var newValue=removeVars(value);if(!dom.hasClass(previewElm,newValue)){dom.addClass(previewElm,newValue);}});editor.fire('PreviewFormats');dom.setStyles(previewFrag,{position:'absolute',left:-65535});editor.getBody().appendChild(previewFrag);parentFontSize=dom.getStyle(editor.getBody(),'fontSize',true);parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0;each$e(previewStyles.split(' '),function(name){var value=dom.getStyle(previewElm,name,true);if(name==='background-color'&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)){value=dom.getStyle(editor.getBody(),name,true);if(dom.toHex(value).toLowerCase()==='#ffffff'){return;}}if(name==='color'){if(dom.toHex(value).toLowerCase()==='#000000'){return;}}if(name==='font-size'){if(/em|%$/.test(value)){if(parentFontSize===0){return;}var numValue=parseFloat(value)/(/%$/.test(value)?100:1);value=numValue*parentFontSize+'px';}}if(name==='border'&&value){previewCss+='padding:0 2px;';}previewCss+=name+':'+value+';';});editor.fire('AfterPreviewFormats');dom.remove(previewFrag);return previewCss;};var setup$6=function setup$6(editor){editor.addShortcut('meta+b','','Bold');editor.addShortcut('meta+i','','Italic');editor.addShortcut('meta+u','','Underline');for(var i=1;i<=6;i++){editor.addShortcut('access+'+i,'',['FormatBlock',false,'h'+i]);}editor.addShortcut('access+7','',['FormatBlock',false,'p']);editor.addShortcut('access+8','',['FormatBlock',false,'div']);editor.addShortcut('access+9','',['FormatBlock',false,'address']);};var Formatter=function Formatter(editor){var formats=FormatRegistry(editor);var formatChangeState=Cell(null);setup$6(editor);setup$3(editor);return{get:formats.get,has:formats.has,register:formats.register,unregister:formats.unregister,apply:function apply(name,vars,node){applyFormat$1(editor,name,vars,node);},remove:function remove(name,vars,node,similar){removeFormat$1(editor,name,vars,node,similar);},toggle:function toggle(name,vars,node){toggleFormat(editor,name,vars,node);},match:curry(match,editor),matchAll:curry(matchAll,editor),matchNode:curry(matchNode,editor),canApply:curry(canApply,editor),formatChanged:curry(formatChanged,editor,formatChangeState),getCssText:curry(getCssText,editor)};};var registerEvents$1=function registerEvents$1(editor,undoManager,locks){var isFirstTypedCharacter=Cell(false);var addNonTypingUndoLevel=function addNonTypingUndoLevel(e){setTyping(undoManager,false,locks);undoManager.add({},e);};editor.on('init',function(){undoManager.add();});editor.on('BeforeExecCommand',function(e){var cmd=e.command.toLowerCase();if(cmd!=='undo'&&cmd!=='redo'&&cmd!=='mcerepaint'){endTyping(undoManager,locks);undoManager.beforeChange();}});editor.on('ExecCommand',function(e){var cmd=e.command.toLowerCase();if(cmd!=='undo'&&cmd!=='redo'&&cmd!=='mcerepaint'){addNonTypingUndoLevel(e);}});editor.on('ObjectResizeStart cut',function(){undoManager.beforeChange();});editor.on('SaveContent ObjectResized blur',addNonTypingUndoLevel);editor.on('dragend',addNonTypingUndoLevel);editor.on('keyup',function(e){var keyCode=e.keyCode;if(e.isDefaultPrevented()){return;}if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode===45||e.ctrlKey){addNonTypingUndoLevel();editor.nodeChanged();}if(keyCode===46||keyCode===8){editor.nodeChanged();}if(isFirstTypedCharacter.get()&&undoManager.typing&&isEq$4(createFromEditor(editor),undoManager.data[0])===false){if(editor.isDirty()===false){editor.setDirty(true);editor.fire('change',{level:undoManager.data[0],lastLevel:null});}editor.fire('TypingUndo');isFirstTypedCharacter.set(false);editor.nodeChanged();}});editor.on('keydown',function(e){var keyCode=e.keyCode;if(e.isDefaultPrevented()){return;}if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode===45){if(undoManager.typing){addNonTypingUndoLevel(e);}return;}var modKey=e.ctrlKey&&!e.altKey||e.metaKey;if((keyCode<16||keyCode>20)&&keyCode!==224&&keyCode!==91&&!undoManager.typing&&!modKey){undoManager.beforeChange();setTyping(undoManager,true,locks);undoManager.add({},e);isFirstTypedCharacter.set(true);}});editor.on('mousedown',function(e){if(undoManager.typing){addNonTypingUndoLevel(e);}});var isInsertReplacementText=function isInsertReplacementText(event){return event.inputType==='insertReplacementText';};var isInsertTextDataNull=function isInsertTextDataNull(event){return event.inputType==='insertText'&&event.data===null;};var isInsertFromPasteOrDrop=function isInsertFromPasteOrDrop(event){return event.inputType==='insertFromPaste'||event.inputType==='insertFromDrop';};editor.on('input',function(e){if(e.inputType&&(isInsertReplacementText(e)||isInsertTextDataNull(e)||isInsertFromPasteOrDrop(e))){addNonTypingUndoLevel(e);}});editor.on('AddUndo Undo Redo ClearUndos',function(e){if(!e.isDefaultPrevented()){editor.nodeChanged();}});};var addKeyboardShortcuts=function addKeyboardShortcuts(editor){editor.addShortcut('meta+z','','Undo');editor.addShortcut('meta+y,meta+shift+z','','Redo');};var UndoManager=function UndoManager(editor){var beforeBookmark=Cell(Optional.none());var locks=Cell(0);var index=Cell(0);var undoManager={data:[],typing:false,beforeChange:function beforeChange(){beforeChange$1(editor,locks,beforeBookmark);},add:function add(level,event){return addUndoLevel$1(editor,undoManager,index,locks,beforeBookmark,level,event);},undo:function undo(){return undo$1(editor,undoManager,locks,index);},redo:function redo(){return redo$1(editor,index,undoManager.data);},clear:function clear(){clear$1(editor,undoManager,index);},reset:function reset(){reset$1(editor,undoManager);},hasUndo:function hasUndo(){return hasUndo$1(editor,undoManager,index);},hasRedo:function hasRedo(){return hasRedo$1(editor,undoManager,index);},transact:function transact(callback){return transact$1(editor,undoManager,locks,callback);},ignore:function ignore(callback){ignore$1(editor,locks,callback);},extra:function extra(callback1,callback2){extra$1(editor,undoManager,index,callback1,callback2);}};if(!isRtc(editor)){registerEvents$1(editor,undoManager,locks);}addKeyboardShortcuts(editor);return undoManager;};var nonTypingKeycodes=[9,27,VK.HOME,VK.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,VK.DOWN,VK.UP,VK.LEFT,VK.RIGHT].concat(Env.browser.isFirefox()?[224]:[]);var placeholderAttr='data-mce-placeholder';var isKeyboardEvent=function isKeyboardEvent(e){return e.type==='keydown'||e.type==='keyup';};var isDeleteEvent=function isDeleteEvent(e){var keyCode=e.keyCode;return keyCode===VK.BACKSPACE||keyCode===VK.DELETE;};var isNonTypingKeyboardEvent=function isNonTypingKeyboardEvent(e){if(isKeyboardEvent(e)){var keyCode=e.keyCode;return!isDeleteEvent(e)&&(VK.metaKeyPressed(e)||e.altKey||keyCode>=112&&keyCode<=123||contains(nonTypingKeycodes,keyCode));}else{return false;}};var isTypingKeyboardEvent=function isTypingKeyboardEvent(e){return isKeyboardEvent(e)&&!(isDeleteEvent(e)||e.type==='keyup'&&e.keyCode===229);};var isVisuallyEmpty=function isVisuallyEmpty(dom,rootElm,forcedRootBlock){if(isEmpty(SugarElement.fromDom(rootElm),false)){var isForcedRootBlockFalse=forcedRootBlock==='';var firstElement=rootElm.firstElementChild;if(!firstElement){return true;}else if(dom.getStyle(rootElm.firstElementChild,'padding-left')||dom.getStyle(rootElm.firstElementChild,'padding-right')){return false;}else{return isForcedRootBlockFalse?!dom.isBlock(firstElement):forcedRootBlock===firstElement.nodeName.toLowerCase();}}else{return false;}};var setup$7=function setup$7(editor){var dom=editor.dom;var rootBlock=getForcedRootBlock(editor);var placeholder=getPlaceholder(editor);var updatePlaceholder=function updatePlaceholder(e,initial){if(isNonTypingKeyboardEvent(e)){return;}var body=editor.getBody();var showPlaceholder=isTypingKeyboardEvent(e)?false:isVisuallyEmpty(dom,body,rootBlock);var isPlaceholderShown=dom.getAttrib(body,placeholderAttr)!=='';if(isPlaceholderShown!==showPlaceholder||initial){dom.setAttrib(body,placeholderAttr,showPlaceholder?placeholder:null);dom.setAttrib(body,'aria-placeholder',showPlaceholder?placeholder:null);firePlaceholderToggle(editor,showPlaceholder);editor.on(showPlaceholder?'keydown':'keyup',updatePlaceholder);editor.off(showPlaceholder?'keyup':'keydown',updatePlaceholder);}};if(placeholder){editor.on('init',function(e){updatePlaceholder(e,true);editor.on('change SetContent ExecCommand',updatePlaceholder);editor.on('paste',function(e){return Delay.setEditorTimeout(editor,function(){return updatePlaceholder(e);});});});}};var strongRtl=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/;var hasStrongRtl=function hasStrongRtl(text){return strongRtl.test(text);};var isInlineTarget=function isInlineTarget(editor,elm){return is$1(SugarElement.fromDom(elm),getInlineBoundarySelector(editor));};var isRtl$1=function isRtl$1(element){return DOMUtils$1.DOM.getStyle(element,'direction',true)==='rtl'||hasStrongRtl(element.textContent);};var findInlineParents=function findInlineParents(isInlineTarget,rootNode,pos){return filter(DOMUtils$1.DOM.getParents(pos.container(),'*',rootNode),isInlineTarget);};var findRootInline=function findRootInline(isInlineTarget,rootNode,pos){var parents=findInlineParents(isInlineTarget,rootNode,pos);return Optional.from(parents[parents.length-1]);};var hasSameParentBlock=function hasSameParentBlock(rootNode,node1,node2){var block1=getParentBlock(node1,rootNode);var block2=getParentBlock(node2,rootNode);return block1&&block1===block2;};var isAtZwsp=function isAtZwsp(pos){return isBeforeInline(pos)||isAfterInline(pos);};var normalizePosition=function normalizePosition(forward,pos){if(!pos){return pos;}var container=pos.container(),offset=pos.offset();if(forward){if(isCaretContainerInline(container)){if(isText$1(container.nextSibling)){return CaretPosition$1(container.nextSibling,0);}else{return CaretPosition$1.after(container);}}else{return isBeforeInline(pos)?CaretPosition$1(container,offset+1):pos;}}else{if(isCaretContainerInline(container)){if(isText$1(container.previousSibling)){return CaretPosition$1(container.previousSibling,container.previousSibling.data.length);}else{return CaretPosition$1.before(container);}}else{return isAfterInline(pos)?CaretPosition$1(container,offset-1):pos;}}};var normalizeForwards=curry(normalizePosition,true);var normalizeBackwards=curry(normalizePosition,false);var isBeforeRoot=function isBeforeRoot(rootNode){return function(elm){return eq$2(rootNode,SugarElement.fromDom(elm.dom.parentNode));};};var getParentBlock$1=function getParentBlock$1(rootNode,elm){return contains$2(rootNode,elm)?closest(elm,function(element){return isTextBlock(element)||isListItem(element);},isBeforeRoot(rootNode)):Optional.none();};var placeCaretInEmptyBody=function placeCaretInEmptyBody(editor){var body=editor.getBody();var node=body.firstChild&&editor.dom.isBlock(body.firstChild)?body.firstChild:body;editor.selection.setCursorLocation(node,0);};var paddEmptyBody=function paddEmptyBody(editor){if(editor.dom.isEmpty(editor.getBody())){editor.setContent('');placeCaretInEmptyBody(editor);}};var willDeleteLastPositionInElement=function willDeleteLastPositionInElement(forward,fromPos,elm){return lift2(firstPositionIn(elm),lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=normalizePosition(true,firstPos);var normalizedLastPos=normalizePosition(false,lastPos);var normalizedFromPos=normalizePosition(false,fromPos);if(forward){return nextPosition(elm,normalizedFromPos).exists(function(nextPos){return nextPos.isEqual(normalizedLastPos)&&fromPos.isEqual(normalizedFirstPos);});}else{return prevPosition(elm,normalizedFromPos).exists(function(prevPos){return prevPos.isEqual(normalizedFirstPos)&&fromPos.isEqual(normalizedLastPos);});}}).getOr(true);};var blockPosition=function blockPosition(block,position){return{block:block,position:position};};var blockBoundary=function blockBoundary(from,to){return{from:from,to:to};};var getBlockPosition=function getBlockPosition(rootNode,pos){var rootElm=SugarElement.fromDom(rootNode);var containerElm=SugarElement.fromDom(pos.container());return getParentBlock$1(rootElm,containerElm).map(function(block){return blockPosition(block,pos);});};var isDifferentBlocks=function isDifferentBlocks(blockBoundary){return eq$2(blockBoundary.from.block,blockBoundary.to.block)===false;};var hasSameParent=function hasSameParent(blockBoundary){return parent(blockBoundary.from.block).bind(function(parent1){return parent(blockBoundary.to.block).filter(function(parent2){return eq$2(parent1,parent2);});}).isSome();};var isEditable=function isEditable(blockBoundary){return isContentEditableFalse(blockBoundary.from.block.dom)===false&&isContentEditableFalse(blockBoundary.to.block.dom)===false;};var skipLastBr=function skipLastBr(rootNode,forward,blockPosition){if(isBr(blockPosition.position.getNode())&&isEmpty(blockPosition.block)===false){return positionIn(false,blockPosition.block.dom).bind(function(lastPositionInBlock){if(lastPositionInBlock.isEqual(blockPosition.position)){return fromPosition(forward,rootNode,lastPositionInBlock).bind(function(to){return getBlockPosition(rootNode,to);});}else{return Optional.some(blockPosition);}}).getOr(blockPosition);}else{return blockPosition;}};var readFromRange=function readFromRange(rootNode,forward,rng){var fromBlockPos=getBlockPosition(rootNode,CaretPosition$1.fromRangeStart(rng));var toBlockPos=fromBlockPos.bind(function(blockPos){return fromPosition(forward,rootNode,blockPos.position).bind(function(to){return getBlockPosition(rootNode,to).map(function(blockPos){return skipLastBr(rootNode,forward,blockPos);});});});return lift2(fromBlockPos,toBlockPos,blockBoundary).filter(function(blockBoundary){return isDifferentBlocks(blockBoundary)&&hasSameParent(blockBoundary)&&isEditable(blockBoundary);});};var read$3=function read$3(rootNode,forward,rng){return rng.collapsed?readFromRange(rootNode,forward,rng):Optional.none();};var getChildrenUntilBlockBoundary=function getChildrenUntilBlockBoundary(block){var children$1=children(block);return findIndex(children$1,isBlock).fold(function(){return children$1;},function(index){return children$1.slice(0,index);});};var extractChildren=function extractChildren(block){var children=getChildrenUntilBlockBoundary(block);each(children,remove);return children;};var removeEmptyRoot=function removeEmptyRoot(rootNode,block){var parents=parentsAndSelf(block,rootNode);return find(parents.reverse(),function(element){return isEmpty(element);}).each(remove);};var isEmptyBefore=function isEmptyBefore(el){return filter(prevSiblings(el),function(el){return!isEmpty(el);}).length===0;};var nestedBlockMerge=function nestedBlockMerge(rootNode,fromBlock,toBlock,insertionPoint){if(isEmpty(toBlock)){fillWithPaddingBr(toBlock);return firstPositionIn(toBlock.dom);}if(isEmptyBefore(insertionPoint)&&isEmpty(fromBlock)){before(insertionPoint,SugarElement.fromTag('br'));}var position=prevPosition(toBlock.dom,CaretPosition$1.before(insertionPoint.dom));each(extractChildren(fromBlock),function(child){before(insertionPoint,child);});removeEmptyRoot(rootNode,fromBlock);return position;};var sidelongBlockMerge=function sidelongBlockMerge(rootNode,fromBlock,toBlock){if(isEmpty(toBlock)){remove(toBlock);if(isEmpty(fromBlock)){fillWithPaddingBr(fromBlock);}return firstPositionIn(fromBlock.dom);}var position=lastPositionIn(toBlock.dom);each(extractChildren(fromBlock),function(child){append(toBlock,child);});removeEmptyRoot(rootNode,fromBlock);return position;};var findInsertionPoint=function findInsertionPoint(toBlock,block){var parentsAndSelf$1=parentsAndSelf(block,toBlock);return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length-1]);};var getInsertionPoint=function getInsertionPoint(fromBlock,toBlock){return contains$2(toBlock,fromBlock)?findInsertionPoint(toBlock,fromBlock):Optional.none();};var trimBr=function trimBr(first,block){positionIn(first,block.dom).map(function(position){return position.getNode();}).map(SugarElement.fromDom).filter(isBr$1).each(remove);};var mergeBlockInto=function mergeBlockInto(rootNode,fromBlock,toBlock){trimBr(true,fromBlock);trimBr(false,toBlock);return getInsertionPoint(fromBlock,toBlock).fold(curry(sidelongBlockMerge,rootNode,fromBlock,toBlock),curry(nestedBlockMerge,rootNode,fromBlock,toBlock));};var mergeBlocks=function mergeBlocks(rootNode,forward,block1,block2){return forward?mergeBlockInto(rootNode,block2,block1):mergeBlockInto(rootNode,block1,block2);};var backspaceDelete$1=function backspaceDelete$1(editor,forward){var rootNode=SugarElement.fromDom(editor.getBody());var position=read$3(rootNode.dom,forward,editor.selection.getRng()).bind(function(blockBoundary){return mergeBlocks(rootNode,forward,blockBoundary.from.block,blockBoundary.to.block);});position.each(function(pos){editor.selection.setRng(pos.toRange());});return position.isSome();};var deleteRangeMergeBlocks=function deleteRangeMergeBlocks(rootNode,selection){var rng=selection.getRng();return lift2(getParentBlock$1(rootNode,SugarElement.fromDom(rng.startContainer)),getParentBlock$1(rootNode,SugarElement.fromDom(rng.endContainer)),function(block1,block2){if(eq$2(block1,block2)===false){rng.deleteContents();mergeBlocks(rootNode,true,block1,block2).each(function(pos){selection.setRng(pos.toRange());});return true;}else{return false;}}).getOr(false);};var isRawNodeInTable=function isRawNodeInTable(root,rawNode){var node=SugarElement.fromDom(rawNode);var isRoot=curry(eq$2,root);return ancestor(node,isTableCell$1,isRoot).isSome();};var isSelectionInTable=function isSelectionInTable(root,rng){return isRawNodeInTable(root,rng.startContainer)||isRawNodeInTable(root,rng.endContainer);};var isEverythingSelected=function isEverythingSelected(root,rng){var noPrevious=prevPosition(root.dom,CaretPosition$1.fromRangeStart(rng)).isNone();var noNext=nextPosition(root.dom,CaretPosition$1.fromRangeEnd(rng)).isNone();return!isSelectionInTable(root,rng)&&noPrevious&&noNext;};var emptyEditor=function emptyEditor(editor){editor.setContent('');editor.selection.setCursorLocation();return true;};var deleteRange$1=function deleteRange$1(editor){var rootNode=SugarElement.fromDom(editor.getBody());var rng=editor.selection.getRng();return isEverythingSelected(rootNode,rng)?emptyEditor(editor):deleteRangeMergeBlocks(rootNode,editor.selection);};var backspaceDelete$2=function backspaceDelete$2(editor,_forward){return editor.selection.isCollapsed()?false:deleteRange$1(editor);};var isContentEditableTrue$2=isContentEditableTrue;var isContentEditableFalse$7=isContentEditableFalse;var showCaret=function showCaret(direction,editor,node,before,scrollIntoView){return Optional.from(editor._selectionOverrides.showCaret(direction,node,before,scrollIntoView));};var getNodeRange=function getNodeRange(node){var rng=node.ownerDocument.createRange();rng.selectNode(node);return rng;};var selectNode=function selectNode(editor,node){var e=editor.fire('BeforeObjectSelected',{target:node});if(e.isDefaultPrevented()){return Optional.none();}return Optional.some(getNodeRange(node));};var renderCaretAtRange=function renderCaretAtRange(editor,range,scrollIntoView){var normalizedRange=normalizeRange(1,editor.getBody(),range);var caretPosition=CaretPosition$1.fromRangeStart(normalizedRange);var caretPositionNode=caretPosition.getNode();if(isInlineFakeCaretTarget(caretPositionNode)){return showCaret(1,editor,caretPositionNode,!caretPosition.isAtEnd(),false);}var caretPositionBeforeNode=caretPosition.getNode(true);if(isInlineFakeCaretTarget(caretPositionBeforeNode)){return showCaret(1,editor,caretPositionBeforeNode,false,false);}var ceRoot=editor.dom.getParent(caretPosition.getNode(),function(node){return isContentEditableFalse$7(node)||isContentEditableTrue$2(node);});if(isInlineFakeCaretTarget(ceRoot)){return showCaret(1,editor,ceRoot,false,scrollIntoView);}return Optional.none();};var renderRangeCaret=function renderRangeCaret(editor,range,scrollIntoView){return range.collapsed?renderCaretAtRange(editor,range,scrollIntoView).getOr(range):range;};var isBeforeBoundary=function isBeforeBoundary(pos){return isBeforeContentEditableFalse(pos)||isBeforeMedia(pos);};var isAfterBoundary=function isAfterBoundary(pos){return isAfterContentEditableFalse(pos)||isAfterMedia(pos);};var trimEmptyTextNode$1=function trimEmptyTextNode$1(dom,node){if(isText$1(node)&&node.data.length===0){dom.remove(node);}};var deleteContentAndShowCaret=function deleteContentAndShowCaret(editor,range,node,direction,forward,peekCaretPosition){showCaret(direction,editor,peekCaretPosition.getNode(!forward),forward,true).each(function(caretRange){if(range.collapsed){var deleteRange=range.cloneRange();if(forward){deleteRange.setEnd(caretRange.startContainer,caretRange.startOffset);}else{deleteRange.setStart(caretRange.endContainer,caretRange.endOffset);}deleteRange.deleteContents();}else{range.deleteContents();}editor.selection.setRng(caretRange);});trimEmptyTextNode$1(editor.dom,node);return true;};var deleteBoundaryText=function deleteBoundaryText(editor,forward){var range=editor.selection.getRng();if(!isText$1(range.commonAncestorContainer)){return false;}var direction=forward?HDirection.Forwards:HDirection.Backwards;var caretWalker=CaretWalker(editor.getBody());var getNextPosFn=curry(getVisualCaretPosition,forward?caretWalker.next:caretWalker.prev);var isBeforeFn=forward?isBeforeBoundary:isAfterBoundary;var caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);var nextCaretPosition=normalizePosition(forward,getNextPosFn(caretPosition));if(!nextCaretPosition||!isMoveInsideSameBlock(caretPosition,nextCaretPosition)){return false;}else if(isBeforeFn(nextCaretPosition)){return deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,nextCaretPosition);}var peekCaretPosition=getNextPosFn(nextCaretPosition);if(peekCaretPosition&&isBeforeFn(peekCaretPosition)){if(isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition)){return deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,peekCaretPosition);}}return false;};var backspaceDelete$3=function backspaceDelete$3(editor,forward){return deleteBoundaryText(editor,forward);};var isCompoundElement=function isCompoundElement(node){return isTableCell$1(SugarElement.fromDom(node))||isListItem(SugarElement.fromDom(node));};var DeleteAction=Adt.generate([{remove:['element']},{moveToElement:['element']},{moveToPosition:['position']}]);var isAtContentEditableBlockCaret=function isAtContentEditableBlockCaret(forward,from){var elm=from.getNode(forward===false);var caretLocation=forward?'after':'before';return isElement$1(elm)&&elm.getAttribute('data-mce-caret')===caretLocation;};var isDeleteFromCefDifferentBlocks=function isDeleteFromCefDifferentBlocks(root,forward,from,to){var inSameBlock=function inSameBlock(elm){return isInline(SugarElement.fromDom(elm))&&!isInSameBlock(from,to,root);};return getRelativeCefElm(!forward,from).fold(function(){return getRelativeCefElm(forward,to).fold(never,inSameBlock);},inSameBlock);};var deleteEmptyBlockOrMoveToCef=function deleteEmptyBlockOrMoveToCef(root,forward,from,to){var toCefElm=to.getNode(forward===false);return getParentBlock$1(SugarElement.fromDom(root),SugarElement.fromDom(from.getNode())).map(function(blockElm){return isEmpty(blockElm)?DeleteAction.remove(blockElm.dom):DeleteAction.moveToElement(toCefElm);}).orThunk(function(){return Optional.some(DeleteAction.moveToElement(toCefElm));});};var findCefPosition=function findCefPosition(root,forward,from){return fromPosition(forward,root,from).bind(function(to){if(isCompoundElement(to.getNode())){return Optional.none();}else if(isDeleteFromCefDifferentBlocks(root,forward,from,to)){return Optional.none();}else if(forward&&isContentEditableFalse(to.getNode())){return deleteEmptyBlockOrMoveToCef(root,forward,from,to);}else if(forward===false&&isContentEditableFalse(to.getNode(true))){return deleteEmptyBlockOrMoveToCef(root,forward,from,to);}else if(forward&&isAfterContentEditableFalse(from)){return Optional.some(DeleteAction.moveToPosition(to));}else if(forward===false&&isBeforeContentEditableFalse(from)){return Optional.some(DeleteAction.moveToPosition(to));}else{return Optional.none();}});};var getContentEditableBlockAction=function getContentEditableBlockAction(forward,elm){if(forward&&isContentEditableFalse(elm.nextSibling)){return Optional.some(DeleteAction.moveToElement(elm.nextSibling));}else if(forward===false&&isContentEditableFalse(elm.previousSibling)){return Optional.some(DeleteAction.moveToElement(elm.previousSibling));}else{return Optional.none();}};var skipMoveToActionFromInlineCefToContent=function skipMoveToActionFromInlineCefToContent(root,from,deleteAction){return deleteAction.fold(function(elm){return Optional.some(DeleteAction.remove(elm));},function(elm){return Optional.some(DeleteAction.moveToElement(elm));},function(to){if(isInSameBlock(from,to,root)){return Optional.none();}else{return Optional.some(DeleteAction.moveToPosition(to));}});};var getContentEditableAction=function getContentEditableAction(root,forward,from){if(isAtContentEditableBlockCaret(forward,from)){return getContentEditableBlockAction(forward,from.getNode(forward===false)).fold(function(){return findCefPosition(root,forward,from);},Optional.some);}else{return findCefPosition(root,forward,from).bind(function(deleteAction){return skipMoveToActionFromInlineCefToContent(root,from,deleteAction);});}};var read$4=function read$4(root,forward,rng){var normalizedRange=normalizeRange(forward?1:-1,root,rng);var from=CaretPosition$1.fromRangeStart(normalizedRange);var rootElement=SugarElement.fromDom(root);if(forward===false&&isAfterContentEditableFalse(from)){return Optional.some(DeleteAction.remove(from.getNode(true)));}else if(forward&&isBeforeContentEditableFalse(from)){return Optional.some(DeleteAction.remove(from.getNode()));}else if(forward===false&&isBeforeContentEditableFalse(from)&&isAfterBr(rootElement,from)){return findPreviousBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode());});}else if(forward&&isAfterContentEditableFalse(from)&&isBeforeBr(rootElement,from)){return findNextBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode());});}else{return getContentEditableAction(root,forward,from);}};var deleteElement$1=function deleteElement$1(editor,forward){return function(element){editor._selectionOverrides.hideFakeCaret();deleteElement(editor,forward,SugarElement.fromDom(element));return true;};};var moveToElement=function moveToElement(editor,forward){return function(element){var pos=forward?CaretPosition$1.before(element):CaretPosition$1.after(element);editor.selection.setRng(pos.toRange());return true;};};var moveToPosition=function moveToPosition(editor){return function(pos){editor.selection.setRng(pos.toRange());return true;};};var getAncestorCe=function getAncestorCe(editor,node){return Optional.from(getContentEditableRoot(editor.getBody(),node));};var backspaceDeleteCaret=function backspaceDeleteCaret(editor,forward){var selectedNode=editor.selection.getNode();return getAncestorCe(editor,selectedNode).filter(isContentEditableFalse).fold(function(){return read$4(editor.getBody(),forward,editor.selection.getRng()).exists(function(deleteAction){return deleteAction.fold(deleteElement$1(editor,forward),moveToElement(editor,forward),moveToPosition(editor));});},always);};var deleteOffscreenSelection=function deleteOffscreenSelection(rootElement){each(descendants$1(rootElement,'.mce-offscreen-selection'),remove);};var backspaceDeleteRange=function backspaceDeleteRange(editor,forward){var selectedNode=editor.selection.getNode();if(isContentEditableFalse(selectedNode)){var hasCefAncestor=getAncestorCe(editor,selectedNode.parentNode).filter(isContentEditableFalse);return hasCefAncestor.fold(function(){deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));deleteElement(editor,forward,SugarElement.fromDom(editor.selection.getNode()));paddEmptyBody(editor);return true;},function(){return true;});}return false;};var paddEmptyElement=function paddEmptyElement(editor){var dom=editor.dom,selection=editor.selection;var ceRoot=getContentEditableRoot(editor.getBody(),selection.getNode());if(isContentEditableTrue(ceRoot)&&dom.isBlock(ceRoot)&&dom.isEmpty(ceRoot)){var br=dom.create('br',{'data-mce-bogus':'1'});dom.setHTML(ceRoot,'');ceRoot.appendChild(br);selection.setRng(CaretPosition$1.before(br).toRange());}return true;};var backspaceDelete$4=function backspaceDelete$4(editor,forward){if(editor.selection.isCollapsed()){return backspaceDeleteCaret(editor,forward);}else{return backspaceDeleteRange(editor,forward);}};var deleteCaret$1=function deleteCaret$1(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return fromPosition(forward,editor.getBody(),fromPos).filter(function(pos){return forward?isBeforeImageBlock(pos):isAfterImageBlock(pos);}).bind(function(pos){return Optional.from(getChildNodeAtRelativeOffset(forward?0:-1,pos));}).exists(function(elm){editor.selection.select(elm);return true;});};var backspaceDelete$5=function backspaceDelete$5(editor,forward){return editor.selection.isCollapsed()?deleteCaret$1(editor,forward):false;};var isText$8=isText$1;var startsWithCaretContainer$1=function startsWithCaretContainer$1(node){return isText$8(node)&&node.data[0]===ZWSP;};var endsWithCaretContainer$1=function endsWithCaretContainer$1(node){return isText$8(node)&&node.data[node.data.length-1]===ZWSP;};var createZwsp=function createZwsp(node){return node.ownerDocument.createTextNode(ZWSP);};var insertBefore$1=function insertBefore$1(node){if(isText$8(node.previousSibling)){if(endsWithCaretContainer$1(node.previousSibling)){return node.previousSibling;}else{node.previousSibling.appendData(ZWSP);return node.previousSibling;}}else if(isText$8(node)){if(startsWithCaretContainer$1(node)){return node;}else{node.insertData(0,ZWSP);return node;}}else{var newNode=createZwsp(node);node.parentNode.insertBefore(newNode,node);return newNode;}};var insertAfter$1=function insertAfter$1(node){if(isText$8(node.nextSibling)){if(startsWithCaretContainer$1(node.nextSibling)){return node.nextSibling;}else{node.nextSibling.insertData(0,ZWSP);return node.nextSibling;}}else if(isText$8(node)){if(endsWithCaretContainer$1(node)){return node;}else{node.appendData(ZWSP);return node;}}else{var newNode=createZwsp(node);if(node.nextSibling){node.parentNode.insertBefore(newNode,node.nextSibling);}else{node.parentNode.appendChild(newNode);}return newNode;}};var insertInline$1=function insertInline$1(before,node){return before?insertBefore$1(node):insertAfter$1(node);};var insertInlineBefore=curry(insertInline$1,true);var insertInlineAfter=curry(insertInline$1,false);var insertInlinePos=function insertInlinePos(pos,before){if(isText$1(pos.container())){return insertInline$1(before,pos.container());}else{return insertInline$1(before,pos.getNode());}};var isPosCaretContainer=function isPosCaretContainer(pos,caret){var caretNode=caret.get();return caretNode&&pos.container()===caretNode&&isCaretContainerInline(caretNode);};var renderCaret=function renderCaret(caret,location){return location.fold(function(element){remove$5(caret.get());var text=insertInlineBefore(element);caret.set(text);return Optional.some(CaretPosition$1(text,text.length-1));},function(element){return firstPositionIn(element).map(function(pos){if(!isPosCaretContainer(pos,caret)){remove$5(caret.get());var text=insertInlinePos(pos,true);caret.set(text);return CaretPosition$1(text,1);}else{return CaretPosition$1(caret.get(),1);}});},function(element){return lastPositionIn(element).map(function(pos){if(!isPosCaretContainer(pos,caret)){remove$5(caret.get());var text=insertInlinePos(pos,false);caret.set(text);return CaretPosition$1(text,text.length-1);}else{return CaretPosition$1(caret.get(),caret.get().length-1);}});},function(element){remove$5(caret.get());var text=insertInlineAfter(element);caret.set(text);return Optional.some(CaretPosition$1(text,1));});};var evaluateUntil=function evaluateUntil(fns,args){for(var i=0;i<fns.length;i++){var result=fns[i].apply(null,args);if(result.isSome()){return result;}}return Optional.none();};var Location=Adt.generate([{before:['element']},{start:['element']},{end:['element']},{after:['element']}]);var rescope=function rescope(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode;};var before$4=function before$4(isInlineTarget,rootNode,pos){var nPos=normalizeForwards(pos);var scope=rescope(rootNode,nPos.container());return findRootInline(isInlineTarget,scope,nPos).fold(function(){return nextPosition(scope,nPos).bind(curry(findRootInline,isInlineTarget,scope)).map(function(inline){return Location.before(inline);});},Optional.none);};var isNotInsideFormatCaretContainer=function isNotInsideFormatCaretContainer(rootNode,elm){return getParentCaretContainer(rootNode,elm)===null;};var findInsideRootInline=function findInsideRootInline(isInlineTarget,rootNode,pos){return findRootInline(isInlineTarget,rootNode,pos).filter(curry(isNotInsideFormatCaretContainer,rootNode));};var start=function start(isInlineTarget,rootNode,pos){var nPos=normalizeBackwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var prevPos=prevPosition(inline,nPos);return prevPos.isNone()?Optional.some(Location.start(inline)):Optional.none();});};var end=function end(isInlineTarget,rootNode,pos){var nPos=normalizeForwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var nextPos=nextPosition(inline,nPos);return nextPos.isNone()?Optional.some(Location.end(inline)):Optional.none();});};var after$3=function after$3(isInlineTarget,rootNode,pos){var nPos=normalizeBackwards(pos);var scope=rescope(rootNode,nPos.container());return findRootInline(isInlineTarget,scope,nPos).fold(function(){return prevPosition(scope,nPos).bind(curry(findRootInline,isInlineTarget,scope)).map(function(inline){return Location.after(inline);});},Optional.none);};var isValidLocation=function isValidLocation(location){return isRtl$1(getElement(location))===false;};var readLocation=function readLocation(isInlineTarget,rootNode,pos){var location=evaluateUntil([before$4,start,end,after$3],[isInlineTarget,rootNode,pos]);return location.filter(isValidLocation);};var getElement=function getElement(location){return location.fold(identity,identity,identity,identity);};var getName=function getName(location){return location.fold(constant('before'),constant('start'),constant('end'),constant('after'));};var outside=function outside(location){return location.fold(Location.before,Location.before,Location.after,Location.after);};var inside=function inside(location){return location.fold(Location.start,Location.start,Location.end,Location.end);};var isEq$5=function isEq$5(location1,location2){return getName(location1)===getName(location2)&&getElement(location1)===getElement(location2);};var betweenInlines=function betweenInlines(forward,isInlineTarget,rootNode,from,to,location){return lift2(findRootInline(isInlineTarget,rootNode,from),findRootInline(isInlineTarget,rootNode,to),function(fromInline,toInline){if(fromInline!==toInline&&hasSameParentBlock(rootNode,fromInline,toInline)){return Location.after(forward?fromInline:toInline);}else{return location;}}).getOr(location);};var skipNoMovement=function skipNoMovement(fromLocation,toLocation){return fromLocation.fold(always,function(fromLocation){return!isEq$5(fromLocation,toLocation);});};var findLocationTraverse=function findLocationTraverse(forward,isInlineTarget,rootNode,fromLocation,pos){var from=normalizePosition(forward,pos);var to=fromPosition(forward,rootNode,from).map(curry(normalizePosition,forward));var location=to.fold(function(){return fromLocation.map(outside);},function(to){return readLocation(isInlineTarget,rootNode,to).map(curry(betweenInlines,forward,isInlineTarget,rootNode,from,to)).filter(curry(skipNoMovement,fromLocation));});return location.filter(isValidLocation);};var findLocationSimple=function findLocationSimple(forward,location){if(forward){return location.fold(compose(Optional.some,Location.start),Optional.none,compose(Optional.some,Location.after),Optional.none);}else{return location.fold(Optional.none,compose(Optional.some,Location.before),Optional.none,compose(Optional.some,Location.end));}};var findLocation=function findLocation(forward,isInlineTarget,rootNode,pos){var from=normalizePosition(forward,pos);var fromLocation=readLocation(isInlineTarget,rootNode,from);return readLocation(isInlineTarget,rootNode,from).bind(curry(findLocationSimple,forward)).orThunk(function(){return findLocationTraverse(forward,isInlineTarget,rootNode,fromLocation,pos);});};var prevLocation=curry(findLocation,false);var nextLocation=curry(findLocation,true);var hasSelectionModifyApi=function hasSelectionModifyApi(editor){return isFunction(editor.selection.getSel().modify);};var moveRel=function moveRel(forward,selection,pos){var delta=forward?1:-1;selection.setRng(CaretPosition$1(pos.container(),pos.offset()+delta).toRange());selection.getSel().modify('move',forward?'forward':'backward','word');return true;};var moveByWord=function moveByWord(forward,editor){var rng=editor.selection.getRng();var pos=forward?CaretPosition$1.fromRangeEnd(rng):CaretPosition$1.fromRangeStart(rng);if(!hasSelectionModifyApi(editor)){return false;}else if(forward&&isBeforeInline(pos)){return moveRel(true,editor.selection,pos);}else if(!forward&&isAfterInline(pos)){return moveRel(false,editor.selection,pos);}else{return false;}};var setCaretPosition=function setCaretPosition(editor,pos){var rng=editor.dom.createRng();rng.setStart(pos.container(),pos.offset());rng.setEnd(pos.container(),pos.offset());editor.selection.setRng(rng);};var setSelected=function setSelected(state,elm){if(state){elm.setAttribute('data-mce-selected','inline-boundary');}else{elm.removeAttribute('data-mce-selected');}};var renderCaretLocation=function renderCaretLocation(editor,caret,location){return renderCaret(caret,location).map(function(pos){setCaretPosition(editor,pos);return location;});};var findLocation$1=function findLocation$1(editor,caret,forward){var rootNode=editor.getBody();var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());var isInlineTarget$1=curry(isInlineTarget,editor);var location=findLocation(forward,isInlineTarget$1,rootNode,from);return location.bind(function(location){return renderCaretLocation(editor,caret,location);});};var toggleInlines=function toggleInlines(isInlineTarget,dom,elms){var inlineBoundaries=map(descendants$1(SugarElement.fromDom(dom.getRoot()),'*[data-mce-selected="inline-boundary"]'),function(e){return e.dom;});var selectedInlines=filter(inlineBoundaries,isInlineTarget);var targetInlines=filter(elms,isInlineTarget);each(difference(selectedInlines,targetInlines),curry(setSelected,false));each(difference(targetInlines,selectedInlines),curry(setSelected,true));};var safeRemoveCaretContainer=function safeRemoveCaretContainer(editor,caret){if(editor.selection.isCollapsed()&&editor.composing!==true&&caret.get()){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());if(CaretPosition$1.isTextPosition(pos)&&isAtZwsp(pos)===false){setCaretPosition(editor,removeAndReposition(caret.get(),pos));caret.set(null);}}};var renderInsideInlineCaret=function renderInsideInlineCaret(isInlineTarget,editor,caret,elms){if(editor.selection.isCollapsed()){var inlines=filter(elms,isInlineTarget);each(inlines,function(_inline){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());readLocation(isInlineTarget,editor.getBody(),pos).bind(function(location){return renderCaretLocation(editor,caret,location);});});}};var move=function move(editor,caret,forward){return isInlineBoundariesEnabled(editor)?findLocation$1(editor,caret,forward).isSome():false;};var moveWord=function moveWord(forward,editor,_caret){return isInlineBoundariesEnabled(editor)?moveByWord(forward,editor):false;};var setupSelectedState=function setupSelectedState(editor){var caret=Cell(null);var isInlineTarget$1=curry(isInlineTarget,editor);editor.on('NodeChange',function(e){if(isInlineBoundariesEnabled(editor)&&!(Env.browser.isIE()&&e.initial)){toggleInlines(isInlineTarget$1,editor.dom,e.parents);safeRemoveCaretContainer(editor,caret);renderInsideInlineCaret(isInlineTarget$1,editor,caret,e.parents);}});return caret;};var moveNextWord=curry(moveWord,true);var movePrevWord=curry(moveWord,false);var rangeFromPositions=function rangeFromPositions(from,to){var range=document.createRange();range.setStart(from.container(),from.offset());range.setEnd(to.container(),to.offset());return range;};var hasOnlyTwoOrLessPositionsLeft=function hasOnlyTwoOrLessPositionsLeft(elm){return lift2(firstPositionIn(elm),lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=normalizePosition(true,firstPos);var normalizedLastPos=normalizePosition(false,lastPos);return nextPosition(elm,normalizedFirstPos).forall(function(pos){return pos.isEqual(normalizedLastPos);});}).getOr(true);};var setCaretLocation=function setCaretLocation(editor,caret){return function(location){return renderCaret(caret,location).exists(function(pos){setCaretPosition(editor,pos);return true;});};};var deleteFromTo=function deleteFromTo(editor,caret,from,to){var rootNode=editor.getBody();var isInlineTarget$1=curry(isInlineTarget,editor);editor.undoManager.ignore(function(){editor.selection.setRng(rangeFromPositions(from,to));editor.execCommand('Delete');readLocation(isInlineTarget$1,rootNode,CaretPosition$1.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor,caret));});editor.nodeChanged();};var rescope$1=function rescope$1(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode;};var backspaceDeleteCollapsed=function backspaceDeleteCollapsed(editor,caret,forward,from){var rootNode=rescope$1(editor.getBody(),from.container());var isInlineTarget$1=curry(isInlineTarget,editor);var fromLocation=readLocation(isInlineTarget$1,rootNode,from);return fromLocation.bind(function(location){if(forward){return location.fold(constant(Optional.some(inside(location))),Optional.none,constant(Optional.some(outside(location))),Optional.none);}else{return location.fold(Optional.none,constant(Optional.some(outside(location))),Optional.none,constant(Optional.some(inside(location))));}}).map(setCaretLocation(editor,caret)).getOrThunk(function(){var toPosition=navigate(forward,rootNode,from);var toLocation=toPosition.bind(function(pos){return readLocation(isInlineTarget$1,rootNode,pos);});return lift2(fromLocation,toLocation,function(){return findRootInline(isInlineTarget$1,rootNode,from).exists(function(elm){if(hasOnlyTwoOrLessPositionsLeft(elm)){deleteElement(editor,forward,SugarElement.fromDom(elm));return true;}else{return false;}});}).orThunk(function(){return toLocation.bind(function(_){return toPosition.map(function(to){if(forward){deleteFromTo(editor,caret,from,to);}else{deleteFromTo(editor,caret,to,from);}return true;});});}).getOr(false);});};var backspaceDelete$6=function backspaceDelete$6(editor,caret,forward){if(editor.selection.isCollapsed()&&isInlineBoundariesEnabled(editor)){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return backspaceDeleteCollapsed(editor,caret,forward,from);}return false;};var getParentInlines=function getParentInlines(rootElm,startElm){var parents=parentsAndSelf(startElm,rootElm);return findIndex(parents,isBlock).fold(constant(parents),function(index){return parents.slice(0,index);});};var hasOnlyOneChild$1=function hasOnlyOneChild$1(elm){return children(elm).length===1;};var deleteLastPosition=function deleteLastPosition(forward,editor,target,parentInlines){var isFormatElement$1=curry(isFormatElement,editor);var formatNodes=map(filter(parentInlines,isFormatElement$1),function(elm){return elm.dom;});if(formatNodes.length===0){deleteElement(editor,forward,target);}else{var pos=replaceWithCaretFormat(target.dom,formatNodes);editor.selection.setRng(pos.toRange());}};var deleteCaret$2=function deleteCaret$2(editor,forward){var rootElm=SugarElement.fromDom(editor.getBody());var startElm=SugarElement.fromDom(editor.selection.getStart());var parentInlines=filter(getParentInlines(rootElm,startElm),hasOnlyOneChild$1);return last(parentInlines).exists(function(target){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());if(willDeleteLastPositionInElement(forward,fromPos,target.dom)&&!isEmptyCaretFormatElement(target)){deleteLastPosition(forward,editor,target,parentInlines);return true;}else{return false;}});};var backspaceDelete$7=function backspaceDelete$7(editor,forward){return editor.selection.isCollapsed()?deleteCaret$2(editor,forward):false;};var deleteElement$2=function deleteElement$2(editor,forward,element){editor._selectionOverrides.hideFakeCaret();deleteElement(editor,forward,SugarElement.fromDom(element));return true;};var deleteCaret$3=function deleteCaret$3(editor,forward){var isNearMedia=forward?isBeforeMedia:isAfterMedia;var direction=forward?HDirection.Forwards:HDirection.Backwards;var fromPos=getNormalizedRangeEndPoint(direction,editor.getBody(),editor.selection.getRng());if(isNearMedia(fromPos)){return deleteElement$2(editor,forward,fromPos.getNode(!forward));}else{return Optional.from(normalizePosition(forward,fromPos)).filter(function(pos){return isNearMedia(pos)&&isMoveInsideSameBlock(fromPos,pos);}).exists(function(pos){return deleteElement$2(editor,forward,pos.getNode(!forward));});}};var deleteRange$2=function deleteRange$2(editor,forward){var selectedNode=editor.selection.getNode();return isMedia(selectedNode)?deleteElement$2(editor,forward,selectedNode):false;};var backspaceDelete$8=function backspaceDelete$8(editor,forward){return editor.selection.isCollapsed()?deleteCaret$3(editor,forward):deleteRange$2(editor,forward);};var isEditable$1=function isEditable$1(target){return closest(target,function(elm){return isContentEditableTrue(elm.dom)||isContentEditableFalse(elm.dom);}).exists(function(elm){return isContentEditableTrue(elm.dom);});};var parseIndentValue=function parseIndentValue(value){var number=parseInt(value,10);return isNaN(number)?0:number;};var getIndentStyleName=function getIndentStyleName(useMargin,element){var indentStyleName=useMargin||isTable$1(element)?'margin':'padding';var suffix=get$4(element,'direction')==='rtl'?'-right':'-left';return indentStyleName+suffix;};var indentElement=function indentElement(dom,command,useMargin,value,unit,element){var indentStyleName=getIndentStyleName(useMargin,SugarElement.fromDom(element));if(command==='outdent'){var styleValue=Math.max(0,parseIndentValue(element.style[indentStyleName])-value);dom.setStyle(element,indentStyleName,styleValue?styleValue+unit:'');}else{var styleValue=parseIndentValue(element.style[indentStyleName])+value+unit;dom.setStyle(element,indentStyleName,styleValue);}};var validateBlocks=function validateBlocks(editor,blocks){return forall(blocks,function(block){var indentStyleName=getIndentStyleName(shouldIndentUseMargin(editor),block);var intentValue=getRaw(block,indentStyleName).map(parseIndentValue).getOr(0);var contentEditable=editor.dom.getContentEditable(block.dom);return contentEditable!=='false'&&intentValue>0;});};var canOutdent=function canOutdent(editor){var blocks=getBlocksToIndent(editor);return!editor.mode.isReadOnly()&&(blocks.length>1||validateBlocks(editor,blocks));};var isListComponent=function isListComponent(el){return isList(el)||isListItem(el);};var parentIsListComponent=function parentIsListComponent(el){return parent(el).map(isListComponent).getOr(false);};var getBlocksToIndent=function getBlocksToIndent(editor){return filter(map(editor.selection.getSelectedBlocks(),SugarElement.fromDom),function(el){return!isListComponent(el)&&!parentIsListComponent(el)&&isEditable$1(el);});};var handle=function handle(editor,command){var dom=editor.dom,selection=editor.selection,formatter=editor.formatter;var indentation=getIndentation(editor);var indentUnit=/[a-z%]+$/i.exec(indentation)[0];var indentValue=parseInt(indentation,10);var useMargin=shouldIndentUseMargin(editor);var forcedRootBlock=getForcedRootBlock(editor);if(!editor.queryCommandState('InsertUnorderedList')&&!editor.queryCommandState('InsertOrderedList')){if(forcedRootBlock===''&&!dom.getParent(selection.getNode(),dom.isBlock)){formatter.apply('div');}}each(getBlocksToIndent(editor),function(block){indentElement(dom,command,useMargin,indentValue,indentUnit,block.dom);});};var backspaceDelete$9=function backspaceDelete$9(editor,_forward){if(editor.selection.isCollapsed()&&canOutdent(editor)){var dom=editor.dom;var rng=editor.selection.getRng();var pos=CaretPosition$1.fromRangeStart(rng);var block=dom.getParent(rng.startContainer,dom.isBlock);if(block!==null&&isAtStartOfBlock(SugarElement.fromDom(block),pos)){handle(editor,'outdent');return true;}}return false;};var nativeCommand=function nativeCommand(editor,command){editor.getDoc().execCommand(command,false,null);};var deleteCommand=function deleteCommand(editor,caret){if(backspaceDelete$9(editor)){return;}else if(backspaceDelete$4(editor,false)){return;}else if(backspaceDelete$3(editor,false)){return;}else if(backspaceDelete$6(editor,caret,false)){return;}else if(backspaceDelete$1(editor,false)){return;}else if(backspaceDelete(editor)){return;}else if(backspaceDelete$5(editor,false)){return;}else if(backspaceDelete$8(editor,false)){return;}else if(backspaceDelete$2(editor)){return;}else if(backspaceDelete$7(editor,false)){return;}else{nativeCommand(editor,'Delete');paddEmptyBody(editor);}};var forwardDeleteCommand=function forwardDeleteCommand(editor,caret){if(backspaceDelete$4(editor,true)){return;}else if(backspaceDelete$3(editor,true)){return;}else if(backspaceDelete$6(editor,caret,true)){return;}else if(backspaceDelete$1(editor,true)){return;}else if(backspaceDelete(editor)){return;}else if(backspaceDelete$5(editor,true)){return;}else if(backspaceDelete$8(editor,true)){return;}else if(backspaceDelete$2(editor)){return;}else if(backspaceDelete$7(editor,true)){return;}else{nativeCommand(editor,'ForwardDelete');}};var setup$8=function setup$8(editor,caret){editor.addCommand('delete',function(){deleteCommand(editor,caret);});editor.addCommand('forwardDelete',function(){forwardDeleteCommand(editor,caret);});};var SIGNIFICANT_MOVE=5;var LONGPRESS_DELAY=400;var getTouch=function getTouch(event){if(event.touches===undefined||event.touches.length!==1){return Optional.none();}return Optional.some(event.touches[0]);};var isFarEnough=function isFarEnough(touch,data){var distX=Math.abs(touch.clientX-data.x);var distY=Math.abs(touch.clientY-data.y);return distX>SIGNIFICANT_MOVE||distY>SIGNIFICANT_MOVE;};var setup$9=function setup$9(editor){var startData=Cell(Optional.none());var longpressFired=Cell(false);var debounceLongpress=last$2(function(e){editor.fire('longpress',_assign(_assign({},e),{type:'longpress'}));longpressFired.set(true);},LONGPRESS_DELAY);editor.on('touchstart',function(e){getTouch(e).each(function(touch){debounceLongpress.cancel();var data={x:touch.clientX,y:touch.clientY,target:e.target};debounceLongpress.throttle(e);longpressFired.set(false);startData.set(Optional.some(data));});},true);editor.on('touchmove',function(e){debounceLongpress.cancel();getTouch(e).each(function(touch){startData.get().each(function(data){if(isFarEnough(touch,data)){startData.set(Optional.none());longpressFired.set(false);editor.fire('longpresscancel');}});});},true);editor.on('touchend touchcancel',function(e){debounceLongpress.cancel();if(e.type==='touchcancel'){return;}startData.get().filter(function(data){return data.target.isEqualNode(e.target);}).each(function(){if(longpressFired.get()){e.preventDefault();}else{editor.fire('tap',_assign(_assign({},e),{type:'tap'}));}});},true);};var isBlockElement=function isBlockElement(blockElements,node){return blockElements.hasOwnProperty(node.nodeName);};var isValidTarget=function isValidTarget(blockElements,node){if(isText$1(node)){return true;}else if(isElement$1(node)){return!isBlockElement(blockElements,node)&&!isBookmarkNode$1(node);}else{return false;}};var hasBlockParent=function hasBlockParent(blockElements,root,node){return exists(parents$1(SugarElement.fromDom(node),SugarElement.fromDom(root)),function(elm){return isBlockElement(blockElements,elm.dom);});};var shouldRemoveTextNode=function shouldRemoveTextNode(blockElements,node){if(isText$1(node)){if(node.nodeValue.length===0){return true;}else if(/^\s+$/.test(node.nodeValue)&&(!node.nextSibling||isBlockElement(blockElements,node.nextSibling))){return true;}}return false;};var addRootBlocks=function addRootBlocks(editor){var dom=editor.dom,selection=editor.selection;var schema=editor.schema,blockElements=schema.getBlockElements();var node=selection.getStart();var rootNode=editor.getBody();var rootBlockNode,tempNode,wrapped;var forcedRootBlock=getForcedRootBlock(editor);if(!node||!isElement$1(node)||!forcedRootBlock){return;}var rootNodeName=rootNode.nodeName.toLowerCase();if(!schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())||hasBlockParent(blockElements,rootNode,node)){return;}var rng=selection.getRng();var startContainer=rng.startContainer;var startOffset=rng.startOffset;var endContainer=rng.endContainer;var endOffset=rng.endOffset;var restoreSelection=hasFocus$1(editor);node=rootNode.firstChild;while(node){if(isValidTarget(blockElements,node)){if(shouldRemoveTextNode(blockElements,node)){tempNode=node;node=node.nextSibling;dom.remove(tempNode);continue;}if(!rootBlockNode){rootBlockNode=dom.create(forcedRootBlock,getForcedRootBlockAttrs(editor));node.parentNode.insertBefore(rootBlockNode,node);wrapped=true;}tempNode=node;node=node.nextSibling;rootBlockNode.appendChild(tempNode);}else{rootBlockNode=null;node=node.nextSibling;}}if(wrapped&&restoreSelection){rng.setStart(startContainer,startOffset);rng.setEnd(endContainer,endOffset);selection.setRng(rng);editor.nodeChanged();}};var setup$a=function setup$a(editor){if(getForcedRootBlock(editor)){editor.on('NodeChange',curry(addRootBlocks,editor));}};var findBlockCaretContainer=function findBlockCaretContainer(editor){return descendant(SugarElement.fromDom(editor.getBody()),'*[data-mce-caret]').fold(constant(null),function(elm){return elm.dom;});};var removeIeControlRect=function removeIeControlRect(editor){editor.selection.setRng(editor.selection.getRng());};var showBlockCaretContainer=function showBlockCaretContainer(editor,blockCaretContainer){if(blockCaretContainer.hasAttribute('data-mce-caret')){showCaretContainerBlock(blockCaretContainer);removeIeControlRect(editor);editor.selection.scrollIntoView(blockCaretContainer);}};var handleBlockContainer=function handleBlockContainer(editor,e){var blockCaretContainer=findBlockCaretContainer(editor);if(!blockCaretContainer){return;}if(e.type==='compositionstart'){e.preventDefault();e.stopPropagation();showBlockCaretContainer(editor,blockCaretContainer);return;}if(hasContent(blockCaretContainer)){showBlockCaretContainer(editor,blockCaretContainer);editor.undoManager.add();}};var setup$b=function setup$b(editor){editor.on('keyup compositionstart',curry(handleBlockContainer,editor));};var BreakType;(function(BreakType){BreakType[BreakType['Br']=0]='Br';BreakType[BreakType['Block']=1]='Block';BreakType[BreakType['Wrap']=2]='Wrap';BreakType[BreakType['Eol']=3]='Eol';})(BreakType||(BreakType={}));var flip=function flip(direction,positions){return direction===HDirection.Backwards?reverse(positions):positions;};var walk$3=function walk$3(direction,caretWalker,pos){return direction===HDirection.Forwards?caretWalker.next(pos):caretWalker.prev(pos);};var getBreakType=function getBreakType(scope,direction,currentPos,nextPos){if(isBr(nextPos.getNode(direction===HDirection.Forwards))){return BreakType.Br;}else if(isInSameBlock(currentPos,nextPos)===false){return BreakType.Block;}else{return BreakType.Wrap;}};var getPositionsUntil=function getPositionsUntil(predicate,direction,scope,start){var caretWalker=CaretWalker(scope);var currentPos=start,nextPos;var positions=[];while(currentPos){nextPos=walk$3(direction,caretWalker,currentPos);if(!nextPos){break;}if(isBr(nextPos.getNode(false))){if(direction===HDirection.Forwards){return{positions:flip(direction,positions).concat([nextPos]),breakType:BreakType.Br,breakAt:Optional.some(nextPos)};}else{return{positions:flip(direction,positions),breakType:BreakType.Br,breakAt:Optional.some(nextPos)};}}if(!nextPos.isVisible()){currentPos=nextPos;continue;}if(predicate(currentPos,nextPos)){var breakType=getBreakType(scope,direction,currentPos,nextPos);return{positions:flip(direction,positions),breakType:breakType,breakAt:Optional.some(nextPos)};}positions.push(nextPos);currentPos=nextPos;}return{positions:flip(direction,positions),breakType:BreakType.Eol,breakAt:Optional.none()};};var getAdjacentLinePositions=function getAdjacentLinePositions(direction,getPositionsUntilBreak,scope,start){return getPositionsUntilBreak(scope,start).breakAt.map(function(pos){var positions=getPositionsUntilBreak(scope,pos).positions;return direction===HDirection.Backwards?positions.concat(pos):[pos].concat(positions);}).getOr([]);};var findClosestHorizontalPositionFromPoint=function findClosestHorizontalPositionFromPoint(positions,x){return foldl(positions,function(acc,newPos){return acc.fold(function(){return Optional.some(newPos);},function(lastPos){return lift2(head(lastPos.getClientRects()),head(newPos.getClientRects()),function(lastRect,newRect){var lastDist=Math.abs(x-lastRect.left);var newDist=Math.abs(x-newRect.left);return newDist<=lastDist?newPos:lastPos;}).or(acc);});},Optional.none());};var findClosestHorizontalPosition=function findClosestHorizontalPosition(positions,pos){return head(pos.getClientRects()).bind(function(targetRect){return findClosestHorizontalPositionFromPoint(positions,targetRect.left);});};var getPositionsUntilPreviousLine=curry(getPositionsUntil,CaretPosition.isAbove,-1);var getPositionsUntilNextLine=curry(getPositionsUntil,CaretPosition.isBelow,1);var isAtFirstLine=function isAtFirstLine(scope,pos){return getPositionsUntilPreviousLine(scope,pos).breakAt.isNone();};var isAtLastLine=function isAtLastLine(scope,pos){return getPositionsUntilNextLine(scope,pos).breakAt.isNone();};var getPositionsAbove=curry(getAdjacentLinePositions,-1,getPositionsUntilPreviousLine);var getPositionsBelow=curry(getAdjacentLinePositions,1,getPositionsUntilNextLine);var getFirstLinePositions=function getFirstLinePositions(scope){return firstPositionIn(scope).map(function(pos){return[pos].concat(getPositionsUntilNextLine(scope,pos).positions);}).getOr([]);};var getLastLinePositions=function getLastLinePositions(scope){return lastPositionIn(scope).map(function(pos){return getPositionsUntilPreviousLine(scope,pos).positions.concat(pos);}).getOr([]);};var getNodeClientRects=function getNodeClientRects(node){var toArrayWithNode=function toArrayWithNode(clientRects){return map(clientRects,function(clientRect){clientRect=clone$2(clientRect);clientRect.node=node;return clientRect;});};if(isElement$1(node)){return toArrayWithNode(node.getClientRects());}if(isText$1(node)){var rng=node.ownerDocument.createRange();rng.setStart(node,0);rng.setEnd(node,node.data.length);return toArrayWithNode(rng.getClientRects());}};var getClientRects=function getClientRects(nodes){return bind(nodes,getNodeClientRects);};var VDirection;(function(VDirection){VDirection[VDirection['Up']=-1]='Up';VDirection[VDirection['Down']=1]='Down';})(VDirection||(VDirection={}));var findUntil$1=function findUntil$1(direction,root,predicateFn,node){while(node=findNode(node,direction,isEditableCaretCandidate,root)){if(predicateFn(node)){return;}}};var walkUntil=function walkUntil(direction,isAboveFn,isBeflowFn,root,predicateFn,caretPosition){var line=0;var result=[];var add=function add(node){var i,clientRect,clientRects;clientRects=getClientRects([node]);if(direction===-1){clientRects=clientRects.reverse();}for(i=0;i<clientRects.length;i++){clientRect=clientRects[i];if(isBeflowFn(clientRect,targetClientRect)){continue;}if(result.length>0&&isAboveFn(clientRect,last$1(result))){line++;}clientRect.line=line;if(predicateFn(clientRect)){return true;}result.push(clientRect);}};var targetClientRect=last$1(caretPosition.getClientRects());if(!targetClientRect){return result;}var node=caretPosition.getNode();add(node);findUntil$1(direction,root,add,node);return result;};var aboveLineNumber=function aboveLineNumber(lineNumber,clientRect){return clientRect.line>lineNumber;};var isLineNumber=function isLineNumber(lineNumber,clientRect){return clientRect.line===lineNumber;};var upUntil=curry(walkUntil,VDirection.Up,isAbove,isBelow);var downUntil=curry(walkUntil,VDirection.Down,isBelow,isAbove);var positionsUntil=function positionsUntil(direction,root,predicateFn,node){var caretWalker=CaretWalker(root);var walkFn,isBelowFn,isAboveFn,caretPosition;var result=[];var line=0,clientRect;var getClientRect=function getClientRect(caretPosition){if(direction===1){return last$1(caretPosition.getClientRects());}return last$1(caretPosition.getClientRects());};if(direction===1){walkFn=caretWalker.next;isBelowFn=isBelow;isAboveFn=isAbove;caretPosition=CaretPosition$1.after(node);}else{walkFn=caretWalker.prev;isBelowFn=isAbove;isAboveFn=isBelow;caretPosition=CaretPosition$1.before(node);}var targetClientRect=getClientRect(caretPosition);do{if(!caretPosition.isVisible()){continue;}clientRect=getClientRect(caretPosition);if(isAboveFn(clientRect,targetClientRect)){continue;}if(result.length>0&&isBelowFn(clientRect,last$1(result))){line++;}clientRect=clone$2(clientRect);clientRect.position=caretPosition;clientRect.line=line;if(predicateFn(clientRect)){return result;}result.push(clientRect);}while(caretPosition=walkFn(caretPosition));return result;};var isAboveLine=function isAboveLine(lineNumber){return function(clientRect){return aboveLineNumber(lineNumber,clientRect);};};var isLine=function isLine(lineNumber){return function(clientRect){return isLineNumber(lineNumber,clientRect);};};var isContentEditableFalse$8=isContentEditableFalse;var findNode$1=findNode;var distanceToRectLeft=function distanceToRectLeft(clientRect,clientX){return Math.abs(clientRect.left-clientX);};var distanceToRectRight=function distanceToRectRight(clientRect,clientX){return Math.abs(clientRect.right-clientX);};var isInsideX=function isInsideX(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right;};var isInsideY=function isInsideY(clientY,clientRect){return clientY>=clientRect.top&&clientY<=clientRect.bottom;};var findClosestClientRect=function findClosestClientRect(clientRects,clientX){return reduce(clientRects,function(oldClientRect,clientRect){var oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX));var newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX));if(isInsideX(clientX,clientRect)){return clientRect;}if(isInsideX(clientX,oldClientRect)){return oldClientRect;}if(newDistance===oldDistance&&isContentEditableFalse$8(clientRect.node)){return clientRect;}if(newDistance<oldDistance){return clientRect;}return oldClientRect;});};var walkUntil$1=function walkUntil$1(direction,root,predicateFn,startNode,includeChildren){var node=findNode$1(startNode,direction,isEditableCaretCandidate,root,!includeChildren);do{if(!node||predicateFn(node)){return;}}while(node=findNode$1(node,direction,isEditableCaretCandidate,root));};var findLineNodeRects=function findLineNodeRects(root,targetNodeRect,includeChildren){if(includeChildren===void 0){includeChildren=true;}var clientRects=[];var collect=function collect(checkPosFn,node){var lineRects=filter(getClientRects([node]),function(clientRect){return!checkPosFn(clientRect,targetNodeRect);});clientRects=clientRects.concat(lineRects);return lineRects.length===0;};clientRects.push(targetNodeRect);walkUntil$1(VDirection.Up,root,curry(collect,isAbove),targetNodeRect.node,includeChildren);walkUntil$1(VDirection.Down,root,curry(collect,isBelow),targetNodeRect.node,includeChildren);return clientRects;};var getFakeCaretTargets=function getFakeCaretTargets(root){return filter(from$1(root.getElementsByTagName('*')),isFakeCaretTarget);};var caretInfo=function caretInfo(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)};};var closestFakeCaret=function closestFakeCaret(root,clientX,clientY){var fakeTargetNodeRects=getClientRects(getFakeCaretTargets(root));var targetNodeRects=filter(fakeTargetNodeRects,curry(isInsideY,clientY));var closestNodeRect=findClosestClientRect(targetNodeRects,clientX);if(closestNodeRect){var includeChildren=!isTable(closestNodeRect.node)&&!isMedia(closestNodeRect.node);closestNodeRect=findClosestClientRect(findLineNodeRects(root,closestNodeRect,includeChildren),clientX);if(closestNodeRect&&isFakeCaretTarget(closestNodeRect.node)){return caretInfo(closestNodeRect,clientX);}}return null;};var moveToRange=function moveToRange(editor,rng){editor.selection.setRng(rng);scrollRangeIntoView(editor,editor.selection.getRng());};var renderRangeCaretOpt=function renderRangeCaretOpt(editor,range,scrollIntoView){return Optional.some(renderRangeCaret(editor,range,scrollIntoView));};var moveHorizontally=function moveHorizontally(editor,direction,range,isBefore,isAfter,isElement){var forwards=direction===HDirection.Forwards;var caretWalker=CaretWalker(editor.getBody());var getNextPosFn=curry(getVisualCaretPosition,forwards?caretWalker.next:caretWalker.prev);var isBeforeFn=forwards?isBefore:isAfter;if(!range.collapsed){var node=getSelectedNode(range);if(isElement(node)){return showCaret(direction,editor,node,direction===HDirection.Backwards,false);}}var caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);if(isBeforeFn(caretPosition)){return selectNode(editor,caretPosition.getNode(!forwards));}var nextCaretPosition=normalizePosition(forwards,getNextPosFn(caretPosition));var rangeIsInContainerBlock=isRangeInCaretContainerBlock(range);if(!nextCaretPosition){return rangeIsInContainerBlock?Optional.some(range):Optional.none();}if(isBeforeFn(nextCaretPosition)){return showCaret(direction,editor,nextCaretPosition.getNode(!forwards),forwards,false);}var peekCaretPosition=getNextPosFn(nextCaretPosition);if(peekCaretPosition&&isBeforeFn(peekCaretPosition)){if(isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition)){return showCaret(direction,editor,peekCaretPosition.getNode(!forwards),forwards,false);}}if(rangeIsInContainerBlock){return renderRangeCaretOpt(editor,nextCaretPosition.toRange(),false);}return Optional.none();};var moveVertically=function moveVertically(editor,direction,range,isBefore,isAfter,isElement){var caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);var caretClientRect=last$1(caretPosition.getClientRects());var forwards=direction===VDirection.Down;if(!caretClientRect){return Optional.none();}var walkerFn=forwards?downUntil:upUntil;var linePositions=walkerFn(editor.getBody(),isAboveLine(1),caretPosition);var nextLinePositions=filter(linePositions,isLine(1));var clientX=caretClientRect.left;var nextLineRect=findClosestClientRect(nextLinePositions,clientX);if(nextLineRect&&isElement(nextLineRect.node)){var dist1=Math.abs(clientX-nextLineRect.left);var dist2=Math.abs(clientX-nextLineRect.right);return showCaret(direction,editor,nextLineRect.node,dist1<dist2,false);}var currentNode;if(isBefore(caretPosition)){currentNode=caretPosition.getNode();}else if(isAfter(caretPosition)){currentNode=caretPosition.getNode(true);}else{currentNode=getSelectedNode(range);}if(currentNode){var caretPositions=positionsUntil(direction,editor.getBody(),isAboveLine(1),currentNode);var closestNextLineRect=findClosestClientRect(filter(caretPositions,isLine(1)),clientX);if(closestNextLineRect){return renderRangeCaretOpt(editor,closestNextLineRect.position.toRange(),false);}closestNextLineRect=last$1(filter(caretPositions,isLine(0)));if(closestNextLineRect){return renderRangeCaretOpt(editor,closestNextLineRect.position.toRange(),false);}}if(nextLinePositions.length===0){return getLineEndPoint(editor,forwards).filter(forwards?isAfter:isBefore).map(function(pos){return renderRangeCaret(editor,pos.toRange(),false);});}return Optional.none();};var getLineEndPoint=function getLineEndPoint(editor,forward){var rng=editor.selection.getRng();var body=editor.getBody();if(forward){var from=CaretPosition$1.fromRangeEnd(rng);var result=getPositionsUntilNextLine(body,from);return last(result.positions);}else{var from=CaretPosition$1.fromRangeStart(rng);var result=getPositionsUntilPreviousLine(body,from);return head(result.positions);}};var moveToLineEndPoint=function moveToLineEndPoint(editor,forward,isElementPosition){return getLineEndPoint(editor,forward).filter(isElementPosition).exists(function(pos){editor.selection.setRng(pos.toRange());return true;});};var isContentEditableFalse$9=isContentEditableFalse;var moveToCeFalseHorizontally=function moveToCeFalseHorizontally(direction,editor,range){return moveHorizontally(editor,direction,range,isBeforeContentEditableFalse,isAfterContentEditableFalse,isContentEditableFalse$9);};var moveToCeFalseVertically=function moveToCeFalseVertically(direction,editor,range){var isBefore=function isBefore(caretPosition){return isBeforeContentEditableFalse(caretPosition)||isBeforeTable(caretPosition);};var isAfter=function isAfter(caretPosition){return isAfterContentEditableFalse(caretPosition)||isAfterTable(caretPosition);};return moveVertically(editor,direction,range,isBefore,isAfter,isContentEditableFalse$9);};var createTextBlock=function createTextBlock(editor){var textBlock=editor.dom.create(getForcedRootBlock(editor));if(!Env.ie||Env.ie>=11){textBlock.innerHTML='<br data-mce-bogus="1">';}return textBlock;};var exitPreBlock=function exitPreBlock(editor,direction,range){var caretWalker=CaretWalker(editor.getBody());var getVisualCaretPosition$1=curry(getVisualCaretPosition,direction===1?caretWalker.next:caretWalker.prev);if(range.collapsed&&hasForcedRootBlock(editor)){var pre=editor.dom.getParent(range.startContainer,'PRE');if(!pre){return;}var caretPos=getVisualCaretPosition$1(CaretPosition$1.fromRangeStart(range));if(!caretPos){var newBlock=createTextBlock(editor);if(direction===1){editor.$(pre).after(newBlock);}else{editor.$(pre).before(newBlock);}editor.selection.select(newBlock,true);editor.selection.collapse();}}};var getHorizontalRange=function getHorizontalRange(editor,forward){var direction=forward?HDirection.Forwards:HDirection.Backwards;var range=editor.selection.getRng();return moveToCeFalseHorizontally(direction,editor,range).orThunk(function(){exitPreBlock(editor,direction,range);return Optional.none();});};var getVerticalRange=function getVerticalRange(editor,down){var direction=down?1:-1;var range=editor.selection.getRng();return moveToCeFalseVertically(direction,editor,range).orThunk(function(){exitPreBlock(editor,direction,range);return Optional.none();});};var moveH=function moveH(editor,forward){return getHorizontalRange(editor,forward).exists(function(newRange){moveToRange(editor,newRange);return true;});};var moveV=function moveV(editor,down){return getVerticalRange(editor,down).exists(function(newRange){moveToRange(editor,newRange);return true;});};var moveToLineEndPoint$1=function moveToLineEndPoint$1(editor,forward){var isCefPosition=forward?isAfterContentEditableFalse:isBeforeContentEditableFalse;return moveToLineEndPoint(editor,forward,isCefPosition);};var isTarget=function isTarget(node){return contains(['figcaption'],name(node));};var rangeBefore=function rangeBefore(target){var rng=document.createRange();rng.setStartBefore(target.dom);rng.setEndBefore(target.dom);return rng;};var insertElement=function insertElement(root,elm,forward){if(forward){append(root,elm);}else{prepend(root,elm);}};var insertBr=function insertBr(root,forward){var br=SugarElement.fromTag('br');insertElement(root,br,forward);return rangeBefore(br);};var insertBlock$1=function insertBlock$1(root,forward,blockName,attrs){var block=SugarElement.fromTag(blockName);var br=SugarElement.fromTag('br');setAll(block,attrs);append(block,br);insertElement(root,block,forward);return rangeBefore(br);};var insertEmptyLine=function insertEmptyLine(root,rootBlockName,attrs,forward){if(rootBlockName===''){return insertBr(root,forward);}else{return insertBlock$1(root,forward,rootBlockName,attrs);}};var getClosestTargetBlock=function getClosestTargetBlock(pos,root){var isRoot=curry(eq$2,root);return closest(SugarElement.fromDom(pos.container()),isBlock,isRoot).filter(isTarget);};var isAtFirstOrLastLine=function isAtFirstOrLastLine(root,forward,pos){return forward?isAtLastLine(root.dom,pos):isAtFirstLine(root.dom,pos);};var moveCaretToNewEmptyLine=function moveCaretToNewEmptyLine(editor,forward){var root=SugarElement.fromDom(editor.getBody());var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());var rootBlock=getForcedRootBlock(editor);var rootBlockAttrs=getForcedRootBlockAttrs(editor);return getClosestTargetBlock(pos,root).exists(function(){if(isAtFirstOrLastLine(root,forward,pos)){var rng=insertEmptyLine(root,rootBlock,rootBlockAttrs,forward);editor.selection.setRng(rng);return true;}else{return false;}});};var moveV$1=function moveV$1(editor,forward){if(editor.selection.isCollapsed()){return moveCaretToNewEmptyLine(editor,forward);}else{return false;}};var defaultPatterns=function defaultPatterns(patterns){return map(patterns,function(pattern){return _assign({shiftKey:false,altKey:false,ctrlKey:false,metaKey:false,keyCode:0,action:noop},pattern);});};var matchesEvent=function matchesEvent(pattern,evt){return evt.keyCode===pattern.keyCode&&evt.shiftKey===pattern.shiftKey&&evt.altKey===pattern.altKey&&evt.ctrlKey===pattern.ctrlKey&&evt.metaKey===pattern.metaKey;};var match$1=function match$1(patterns,evt){return bind(defaultPatterns(patterns),function(pattern){return matchesEvent(pattern,evt)?[pattern]:[];});};var action=function action(f){var x=[];for(var _i=1;_i<arguments.length;_i++){x[_i-1]=arguments[_i];}return function(){return f.apply(null,x);};};var execute=function execute(patterns,evt){return find(match$1(patterns,evt),function(pattern){return pattern.action();});};var moveH$1=function moveH$1(editor,forward){var direction=forward?HDirection.Forwards:HDirection.Backwards;var range=editor.selection.getRng();return moveHorizontally(editor,direction,range,isBeforeMedia,isAfterMedia,isMedia).exists(function(newRange){moveToRange(editor,newRange);return true;});};var moveV$2=function moveV$2(editor,down){var direction=down?1:-1;var range=editor.selection.getRng();return moveVertically(editor,direction,range,isBeforeMedia,isAfterMedia,isMedia).exists(function(newRange){moveToRange(editor,newRange);return true;});};var moveToLineEndPoint$2=function moveToLineEndPoint$2(editor,forward){var isNearMedia=forward?isAfterMedia:isBeforeMedia;return moveToLineEndPoint(editor,forward,isNearMedia);};var deflate=function deflate(rect,delta){return{left:rect.left-delta,top:rect.top-delta,right:rect.right+delta*2,bottom:rect.bottom+delta*2,width:rect.width+delta,height:rect.height+delta};};var getCorners=function getCorners(getYAxisValue,tds){return bind(tds,function(td){var rect=deflate(clone$2(td.getBoundingClientRect()),-1);return[{x:rect.left,y:getYAxisValue(rect),cell:td},{x:rect.right,y:getYAxisValue(rect),cell:td}];});};var findClosestCorner=function findClosestCorner(corners,x,y){return foldl(corners,function(acc,newCorner){return acc.fold(function(){return Optional.some(newCorner);},function(oldCorner){var oldDist=Math.sqrt(Math.abs(oldCorner.x-x)+Math.abs(oldCorner.y-y));var newDist=Math.sqrt(Math.abs(newCorner.x-x)+Math.abs(newCorner.y-y));return Optional.some(newDist<oldDist?newCorner:oldCorner);});},Optional.none());};var getClosestCell$1=function getClosestCell$1(getYAxisValue,isTargetCorner,table,x,y){var cells=descendants$1(SugarElement.fromDom(table),'td,th,caption').map(function(e){return e.dom;});var corners=filter(getCorners(getYAxisValue,cells),function(corner){return isTargetCorner(corner,y);});return findClosestCorner(corners,x,y).map(function(corner){return corner.cell;});};var getBottomValue=function getBottomValue(rect){return rect.bottom;};var getTopValue=function getTopValue(rect){return rect.top;};var isAbove$1=function isAbove$1(corner,y){return corner.y<y;};var isBelow$1=function isBelow$1(corner,y){return corner.y>y;};var getClosestCellAbove=curry(getClosestCell$1,getBottomValue,isAbove$1);var getClosestCellBelow=curry(getClosestCell$1,getTopValue,isBelow$1);var findClosestPositionInAboveCell=function findClosestPositionInAboveCell(table,pos){return head(pos.getClientRects()).bind(function(rect){return getClosestCellAbove(table,rect.left,rect.top);}).bind(function(cell){return findClosestHorizontalPosition(getLastLinePositions(cell),pos);});};var findClosestPositionInBelowCell=function findClosestPositionInBelowCell(table,pos){return last(pos.getClientRects()).bind(function(rect){return getClosestCellBelow(table,rect.left,rect.top);}).bind(function(cell){return findClosestHorizontalPosition(getFirstLinePositions(cell),pos);});};var hasNextBreak=function hasNextBreak(getPositionsUntil,scope,lineInfo){return lineInfo.breakAt.exists(function(breakPos){return getPositionsUntil(scope,breakPos).breakAt.isSome();});};var startsWithWrapBreak=function startsWithWrapBreak(lineInfo){return lineInfo.breakType===BreakType.Wrap&&lineInfo.positions.length===0;};var startsWithBrBreak=function startsWithBrBreak(lineInfo){return lineInfo.breakType===BreakType.Br&&lineInfo.positions.length===1;};var isAtTableCellLine=function isAtTableCellLine(getPositionsUntil,scope,pos){var lineInfo=getPositionsUntil(scope,pos);if(startsWithWrapBreak(lineInfo)||!isBr(pos.getNode())&&startsWithBrBreak(lineInfo)){return!hasNextBreak(getPositionsUntil,scope,lineInfo);}else{return lineInfo.breakAt.isNone();}};var isAtFirstTableCellLine=curry(isAtTableCellLine,getPositionsUntilPreviousLine);var isAtLastTableCellLine=curry(isAtTableCellLine,getPositionsUntilNextLine);var isCaretAtStartOrEndOfTable=function isCaretAtStartOrEndOfTable(forward,rng,table){var caretPos=CaretPosition$1.fromRangeStart(rng);return positionIn(!forward,table).exists(function(pos){return pos.isEqual(caretPos);});};var navigateHorizontally=function navigateHorizontally(editor,forward,table,_td){var rng=editor.selection.getRng();var direction=forward?1:-1;if(isFakeCaretTableBrowser()&&isCaretAtStartOrEndOfTable(forward,rng,table)){showCaret(direction,editor,table,!forward,false).each(function(newRng){moveToRange(editor,newRng);});return true;}return false;};var getClosestAbovePosition=function getClosestAbovePosition(root,table,start){return findClosestPositionInAboveCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsAbove(root,CaretPosition$1.before(table)),rect.left);});}).getOr(CaretPosition$1.before(table));};var getClosestBelowPosition=function getClosestBelowPosition(root,table,start){return findClosestPositionInBelowCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsBelow(root,CaretPosition$1.after(table)),rect.left);});}).getOr(CaretPosition$1.after(table));};var getTable=function getTable(previous,pos){var node=pos.getNode(previous);return isElement$1(node)&&node.nodeName==='TABLE'?Optional.some(node):Optional.none();};var renderBlock=function renderBlock(down,editor,table,pos){var forcedRootBlock=getForcedRootBlock(editor);if(forcedRootBlock){editor.undoManager.transact(function(){var element=SugarElement.fromTag(forcedRootBlock);setAll(element,getForcedRootBlockAttrs(editor));append(element,SugarElement.fromTag('br'));if(down){after(SugarElement.fromDom(table),element);}else{before(SugarElement.fromDom(table),element);}var rng=editor.dom.createRng();rng.setStart(element.dom,0);rng.setEnd(element.dom,0);moveToRange(editor,rng);});}else{moveToRange(editor,pos.toRange());}};var moveCaret=function moveCaret(editor,down,pos){var table=down?getTable(true,pos):getTable(false,pos);var last=down===false;table.fold(function(){return moveToRange(editor,pos.toRange());},function(table){return positionIn(last,editor.getBody()).filter(function(lastPos){return lastPos.isEqual(pos);}).fold(function(){return moveToRange(editor,pos.toRange());},function(_){return renderBlock(down,editor,table,pos);});});};var navigateVertically=function navigateVertically(editor,down,table,td){var rng=editor.selection.getRng();var pos=CaretPosition$1.fromRangeStart(rng);var root=editor.getBody();if(!down&&isAtFirstTableCellLine(td,pos)){var newPos=getClosestAbovePosition(root,table,pos);moveCaret(editor,down,newPos);return true;}else if(down&&isAtLastTableCellLine(td,pos)){var newPos=getClosestBelowPosition(root,table,pos);moveCaret(editor,down,newPos);return true;}else{return false;}};var move$1=function move$1(editor,forward,mover){return Optional.from(editor.dom.getParent(editor.selection.getNode(),'td,th')).bind(function(td){return Optional.from(editor.dom.getParent(td,'table')).map(function(table){return mover(editor,forward,table,td);});}).getOr(false);};var moveH$2=function moveH$2(editor,forward){return move$1(editor,forward,navigateHorizontally);};var moveV$3=function moveV$3(editor,forward){return move$1(editor,forward,navigateVertically);};var executeKeydownOverride=function executeKeydownOverride(editor,caret,evt){var os=detect$3().os;execute([{keyCode:VK.RIGHT,action:action(moveH,editor,true)},{keyCode:VK.LEFT,action:action(moveH,editor,false)},{keyCode:VK.UP,action:action(moveV,editor,false)},{keyCode:VK.DOWN,action:action(moveV,editor,true)},{keyCode:VK.RIGHT,action:action(moveH$2,editor,true)},{keyCode:VK.LEFT,action:action(moveH$2,editor,false)},{keyCode:VK.UP,action:action(moveV$3,editor,false)},{keyCode:VK.DOWN,action:action(moveV$3,editor,true)},{keyCode:VK.RIGHT,action:action(moveH$1,editor,true)},{keyCode:VK.LEFT,action:action(moveH$1,editor,false)},{keyCode:VK.UP,action:action(moveV$2,editor,false)},{keyCode:VK.DOWN,action:action(moveV$2,editor,true)},{keyCode:VK.RIGHT,action:action(move,editor,caret,true)},{keyCode:VK.LEFT,action:action(move,editor,caret,false)},{keyCode:VK.RIGHT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:action(moveNextWord,editor,caret)},{keyCode:VK.LEFT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:action(movePrevWord,editor,caret)},{keyCode:VK.UP,action:action(moveV$1,editor,false)},{keyCode:VK.DOWN,action:action(moveV$1,editor,true)}],evt).each(function(_){evt.preventDefault();});};var setup$c=function setup$c(editor,caret){editor.on('keydown',function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride(editor,caret,evt);}});};var executeKeydownOverride$1=function executeKeydownOverride$1(editor,caret,evt){execute([{keyCode:VK.BACKSPACE,action:action(backspaceDelete$9,editor,false)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$4,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$4,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$3,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$3,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$6,editor,caret,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$6,editor,caret,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$5,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$5,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$8,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$8,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$2,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$2,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$1,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$1,editor,true)},{keyCode:VK.BACKSPACE,action:action(backspaceDelete$7,editor,false)},{keyCode:VK.DELETE,action:action(backspaceDelete$7,editor,true)}],evt).each(function(_){evt.preventDefault();});};var executeKeyupOverride=function executeKeyupOverride(editor,evt){execute([{keyCode:VK.BACKSPACE,action:action(paddEmptyElement,editor)},{keyCode:VK.DELETE,action:action(paddEmptyElement,editor)}],evt);};var setup$d=function setup$d(editor,caret){editor.on('keydown',function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride$1(editor,caret,evt);}});editor.on('keyup',function(evt){if(evt.isDefaultPrevented()===false){executeKeyupOverride(editor,evt);}});};var firstNonWhiteSpaceNodeSibling=function firstNonWhiteSpaceNodeSibling(node){while(node){if(node.nodeType===1||node.nodeType===3&&node.data&&/[\r\n\s]/.test(node.data)){return node;}node=node.nextSibling;}};var moveToCaretPosition=function moveToCaretPosition(editor,root){var node,lastNode=root;var dom=editor.dom;var moveCaretBeforeOnEnterElementsMap=editor.schema.getMoveCaretBeforeOnEnterElements();if(!root){return;}if(/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);if(firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)){root.insertBefore(dom.doc.createTextNode(nbsp),root.firstChild);}}var rng=dom.createRng();root.normalize();if(root.hasChildNodes()){var walker=new DomTreeWalker(root,root);while(node=walker.current()){if(isText$1(node)){rng.setStart(node,0);rng.setEnd(node,0);break;}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node);rng.setEndBefore(node);break;}lastNode=node;node=walker.next();}if(!node){rng.setStart(lastNode,0);rng.setEnd(lastNode,0);}}else{if(isBr(root)){if(root.nextSibling&&dom.isBlock(root.nextSibling)){rng.setStartBefore(root);rng.setEndBefore(root);}else{rng.setStartAfter(root);rng.setEndAfter(root);}}else{rng.setStart(root,0);rng.setEnd(root,0);}}editor.selection.setRng(rng);scrollRangeIntoView(editor,rng);};var getEditableRoot=function getEditableRoot(dom,node){var root=dom.getRoot();var parent,editableRoot;parent=node;while(parent!==root&&dom.getContentEditable(parent)!=='false'){if(dom.getContentEditable(parent)==='true'){editableRoot=parent;}parent=parent.parentNode;}return parent!==root?editableRoot:root;};var getParentBlock$2=function getParentBlock$2(editor){return Optional.from(editor.dom.getParent(editor.selection.getStart(true),editor.dom.isBlock));};var getParentBlockName=function getParentBlockName(editor){return getParentBlock$2(editor).fold(constant(''),function(parentBlock){return parentBlock.nodeName.toUpperCase();});};var isListItemParentBlock=function isListItemParentBlock(editor){return getParentBlock$2(editor).filter(function(elm){return isListItem(SugarElement.fromDom(elm));}).isSome();};var hasFirstChild=function hasFirstChild(elm,name){return elm.firstChild&&elm.firstChild.nodeName===name;};var hasParent$1=function hasParent$1(elm,parentName){return elm&&elm.parentNode&&elm.parentNode.nodeName===parentName;};var isListBlock=function isListBlock(elm){return elm&&/^(OL|UL|LI)$/.test(elm.nodeName);};var isNestedList=function isNestedList(elm){return isListBlock(elm)&&isListBlock(elm.parentNode);};var getContainerBlock=function getContainerBlock(containerBlock){var containerBlockParent=containerBlock.parentNode;if(/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)){return containerBlockParent;}return containerBlock;};var isFirstOrLastLi=function isFirstOrLastLi(containerBlock,parentBlock,first){var node=containerBlock[first?'firstChild':'lastChild'];while(node){if(isElement$1(node)){break;}node=node[first?'nextSibling':'previousSibling'];}return node===parentBlock;};var insert=function insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName){var dom=editor.dom;var rng=editor.selection.getRng();if(containerBlock===editor.getBody()){return;}if(isNestedList(containerBlock)){newBlockName='LI';}var newBlock=newBlockName?createNewBlock(newBlockName):dom.create('BR');if(isFirstOrLastLi(containerBlock,parentBlock,true)&&isFirstOrLastLi(containerBlock,parentBlock,false)){if(hasParent$1(containerBlock,'LI')){dom.insertAfter(newBlock,getContainerBlock(containerBlock));}else{dom.replace(newBlock,containerBlock);}}else if(isFirstOrLastLi(containerBlock,parentBlock,true)){if(hasParent$1(containerBlock,'LI')){dom.insertAfter(newBlock,getContainerBlock(containerBlock));newBlock.appendChild(dom.doc.createTextNode(' '));newBlock.appendChild(containerBlock);}else{containerBlock.parentNode.insertBefore(newBlock,containerBlock);}}else if(isFirstOrLastLi(containerBlock,parentBlock,false)){dom.insertAfter(newBlock,getContainerBlock(containerBlock));}else{containerBlock=getContainerBlock(containerBlock);var tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock);tmpRng.setEndAfter(containerBlock);var fragment=tmpRng.extractContents();if(newBlockName==='LI'&&hasFirstChild(fragment,'LI')){newBlock=fragment.firstChild;dom.insertAfter(fragment,containerBlock);}else{dom.insertAfter(fragment,containerBlock);dom.insertAfter(newBlock,containerBlock);}}dom.remove(parentBlock);moveToCaretPosition(editor,newBlock);};var trimZwsp=function trimZwsp(fragment){each(descendants(SugarElement.fromDom(fragment),isText),function(text){var rawNode=text.dom;rawNode.nodeValue=trim$2(rawNode.nodeValue);});};var isEmptyAnchor=function isEmptyAnchor(dom,elm){return elm&&elm.nodeName==='A'&&dom.isEmpty(elm);};var isTableCell$5=function isTableCell$5(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName);};var emptyBlock=function emptyBlock(elm){elm.innerHTML='<br data-mce-bogus="1">';};var containerAndSiblingName=function containerAndSiblingName(container,nodeName){return container.nodeName===nodeName||container.previousSibling&&container.previousSibling.nodeName===nodeName;};var canSplitBlock=function canSplitBlock(dom,node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&dom.getContentEditable(node)!=='true';};var trimInlineElementsOnLeftSideOfBlock=function trimInlineElementsOnLeftSideOfBlock(dom,nonEmptyElementsMap,block){var node=block;var firstChilds=[];var i;if(!node){return;}while(node=node.firstChild){if(dom.isBlock(node)){return;}if(isElement$1(node)&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]){firstChilds.push(node);}}i=firstChilds.length;while(i--){node=firstChilds[i];if(!node.hasChildNodes()||node.firstChild===node.lastChild&&node.firstChild.nodeValue===''){dom.remove(node);}else{if(isEmptyAnchor(dom,node)){dom.remove(node);}}}};var normalizeZwspOffset=function normalizeZwspOffset(start,container,offset){if(isText$1(container)===false){return offset;}else if(start){return offset===1&&container.data.charAt(offset-1)===ZWSP?0:offset;}else{return offset===container.data.length-1&&container.data.charAt(offset)===ZWSP?container.data.length:offset;}};var includeZwspInRange=function includeZwspInRange(rng){var newRng=rng.cloneRange();newRng.setStart(rng.startContainer,normalizeZwspOffset(true,rng.startContainer,rng.startOffset));newRng.setEnd(rng.endContainer,normalizeZwspOffset(false,rng.endContainer,rng.endOffset));return newRng;};var trimLeadingLineBreaks=function trimLeadingLineBreaks(node){do{if(isText$1(node)){node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,'');}node=node.firstChild;}while(node);};var getEditableRoot$1=function getEditableRoot$1(dom,node){var root=dom.getRoot();var parent,editableRoot;parent=node;while(parent!==root&&dom.getContentEditable(parent)!=='false'){if(dom.getContentEditable(parent)==='true'){editableRoot=parent;}parent=parent.parentNode;}return parent!==root?editableRoot:root;};var applyAttributes=function applyAttributes(editor,node,forcedRootBlockAttrs){var dom=editor.dom;Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function(attrStyles){var currentStyles=getAllRaw(SugarElement.fromDom(node));var newStyles=_assign(_assign({},currentStyles),attrStyles);dom.setStyles(node,newStyles);});var attrClassesOpt=Optional.from(forcedRootBlockAttrs["class"]).map(function(attrClasses){return attrClasses.split(/\s+/);});var currentClassesOpt=Optional.from(node.className).map(function(currentClasses){return filter(currentClasses.split(/\s+/),function(clazz){return clazz!=='';});});lift2(attrClassesOpt,currentClassesOpt,function(attrClasses,currentClasses){var filteredClasses=filter(currentClasses,function(clazz){return!contains(attrClasses,clazz);});var newClasses=__spreadArrays(attrClasses,filteredClasses);dom.setAttrib(node,'class',newClasses.join(' '));});var appliedAttrs=['style','class'];var remainingAttrs=filter$1(forcedRootBlockAttrs,function(_,attrs){return!contains(appliedAttrs,attrs);});dom.setAttribs(node,remainingAttrs);};var setForcedBlockAttrs=function setForcedBlockAttrs(editor,node){var forcedRootBlockName=getForcedRootBlock(editor);if(forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()){var forcedRootBlockAttrs=getForcedRootBlockAttrs(editor);applyAttributes(editor,node,forcedRootBlockAttrs);}};var wrapSelfAndSiblingsInDefaultBlock=function wrapSelfAndSiblingsInDefaultBlock(editor,newBlockName,rng,container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName;var blockName=newBlockName||'P';var dom=editor.dom,editableRoot=getEditableRoot$1(dom,container);parentBlock=dom.getParent(container,dom.isBlock);if(!parentBlock||!canSplitBlock(dom,parentBlock)){parentBlock=parentBlock||editableRoot;if(parentBlock===editor.getBody()||isTableCell$5(parentBlock)){rootBlockName=parentBlock.nodeName.toLowerCase();}else{rootBlockName=parentBlock.parentNode.nodeName.toLowerCase();}if(!parentBlock.hasChildNodes()){newBlock=dom.create(blockName);setForcedBlockAttrs(editor,newBlock);parentBlock.appendChild(newBlock);rng.setStart(newBlock,0);rng.setEnd(newBlock,0);return newBlock;}node=container;while(node.parentNode!==parentBlock){node=node.parentNode;}while(node&&!dom.isBlock(node)){startNode=node;node=node.previousSibling;}if(startNode&&editor.schema.isValidChild(rootBlockName,blockName.toLowerCase())){newBlock=dom.create(blockName);setForcedBlockAttrs(editor,newBlock);startNode.parentNode.insertBefore(newBlock,startNode);node=startNode;while(node&&!dom.isBlock(node)){next=node.nextSibling;newBlock.appendChild(node);node=next;}rng.setStart(container,offset);rng.setEnd(container,offset);}}return container;};var addBrToBlockIfNeeded=function addBrToBlockIfNeeded(dom,block){block.normalize();var lastChild=block.lastChild;if(!lastChild||/^(left|right)$/gi.test(dom.getStyle(lastChild,'float',true))){dom.add(block,'br');}};var insert$1=function insert$1(editor,evt){var tmpRng,container,offset,parentBlock;var newBlock,fragment,containerBlock,parentBlockName,newBlockName,isAfterLastNodeInContainer;var dom=editor.dom;var schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements();var rng=editor.selection.getRng();var createNewBlock=function createNewBlock(name){var node=container,block,clonedNode,caretNode;var textInlineElements=schema.getTextInlineElements();if(name||parentBlockName==='TABLE'||parentBlockName==='HR'){block=dom.create(name||newBlockName);}else{block=parentBlock.cloneNode(false);}caretNode=block;if(shouldKeepStyles(editor)===false){dom.setAttrib(block,'style',null);dom.setAttrib(block,'class',null);}else{do{if(textInlineElements[node.nodeName]){if(isCaretNode(node)||isBookmarkNode$1(node)){continue;}clonedNode=node.cloneNode(false);dom.setAttrib(clonedNode,'id','');if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode);}else{caretNode=clonedNode;block.appendChild(clonedNode);}}}while((node=node.parentNode)&&node!==editableRoot);}setForcedBlockAttrs(editor,block);emptyBlock(caretNode);return block;};var isCaretAtStartOrEndOfBlock=function isCaretAtStartOrEndOfBlock(start){var node,name;var normalizedOffset=normalizeZwspOffset(start,container,offset);if(isText$1(container)&&(start?normalizedOffset>0:normalizedOffset<container.nodeValue.length)){return false;}if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!start){return true;}if(start&&isElement$1(container)&&container===parentBlock.firstChild){return true;}if(containerAndSiblingName(container,'TABLE')||containerAndSiblingName(container,'HR')){return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;}var walker=new DomTreeWalker(container,parentBlock);if(isText$1(container)){if(start&&normalizedOffset===0){walker.prev();}else if(!start&&normalizedOffset===container.nodeValue.length){walker.next();}}while(node=walker.current()){if(isElement$1(node)){if(!node.getAttribute('data-mce-bogus')){name=node.nodeName.toLowerCase();if(nonEmptyElementsMap[name]&&name!=='br'){return false;}}}else if(isText$1(node)&&!isWhitespaceText(node.nodeValue)){return false;}if(start){walker.prev();}else{walker.next();}}return true;};var insertNewBlockAfter=function insertNewBlockAfter(){if(/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&containerBlockName!=='HGROUP'){newBlock=createNewBlock(newBlockName);}else{newBlock=createNewBlock();}if(shouldEndContainerOnEmptyBlock(editor)&&canSplitBlock(dom,containerBlock)&&dom.isEmpty(parentBlock)){newBlock=dom.split(containerBlock,parentBlock);}else{dom.insertAfter(newBlock,parentBlock);}moveToCaretPosition(editor,newBlock);};normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset);rng.setEnd(normRng.endContainer,normRng.endOffset);});container=rng.startContainer;offset=rng.startOffset;newBlockName=getForcedRootBlock(editor);var shiftKey=!!(evt&&evt.shiftKey);var ctrlKey=!!(evt&&evt.ctrlKey);if(isElement$1(container)&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&isText$1(container)){offset=container.nodeValue.length;}else{offset=0;}}var editableRoot=getEditableRoot$1(dom,container);if(!editableRoot){return;}if(newBlockName&&!shiftKey||!newBlockName&&shiftKey){container=wrapSelfAndSiblingsInDefaultBlock(editor,newBlockName,rng,container,offset);}parentBlock=dom.getParent(container,dom.isBlock);containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():'';var containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():'';if(containerBlockName==='LI'&&!ctrlKey){parentBlock=containerBlock;containerBlock=containerBlock.parentNode;parentBlockName=containerBlockName;}if(/^(LI|DT|DD)$/.test(parentBlockName)){if(dom.isEmpty(parentBlock)){insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName);return;}}if(newBlockName&&parentBlock===editor.getBody()){return;}newBlockName=newBlockName||'P';if(isCaretContainerBlock(parentBlock)){newBlock=showCaretContainerBlock(parentBlock);if(dom.isEmpty(parentBlock)){emptyBlock(parentBlock);}setForcedBlockAttrs(editor,newBlock);moveToCaretPosition(editor,newBlock);}else if(isCaretAtStartOrEndOfBlock()){insertNewBlockAfter();}else if(isCaretAtStartOrEndOfBlock(true)){newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock);moveToCaretPosition(editor,containerAndSiblingName(parentBlock,'HR')?newBlock:parentBlock);}else{tmpRng=includeZwspInRange(rng).cloneRange();tmpRng.setEndAfter(parentBlock);fragment=tmpRng.extractContents();trimZwsp(fragment);trimLeadingLineBreaks(fragment);newBlock=fragment.firstChild;dom.insertAfter(fragment,parentBlock);trimInlineElementsOnLeftSideOfBlock(dom,nonEmptyElementsMap,newBlock);addBrToBlockIfNeeded(dom,parentBlock);if(dom.isEmpty(parentBlock)){emptyBlock(parentBlock);}newBlock.normalize();if(dom.isEmpty(newBlock)){dom.remove(newBlock);insertNewBlockAfter();}else{setForcedBlockAttrs(editor,newBlock);moveToCaretPosition(editor,newBlock);}}dom.setAttrib(newBlock,'id','');editor.fire('NewBlock',{newBlock:newBlock});};var hasRightSideContent=function hasRightSideContent(schema,container,parentBlock){var walker=new DomTreeWalker(container,parentBlock);var node;var nonEmptyElementsMap=schema.getNonEmptyElements();while(node=walker.next()){if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0){return true;}}};var scrollToBr=function scrollToBr(dom,selection,brElm){var marker=dom.create('span',{},'&nbsp;');brElm.parentNode.insertBefore(marker,brElm);selection.scrollIntoView(marker);dom.remove(marker);};var moveSelectionToBr=function moveSelectionToBr(dom,selection,brElm,extraBr){var rng=dom.createRng();if(!extraBr){rng.setStartAfter(brElm);rng.setEndAfter(brElm);}else{rng.setStartBefore(brElm);rng.setEndBefore(brElm);}selection.setRng(rng);};var insertBrAtCaret=function insertBrAtCaret(editor,evt){var selection=editor.selection;var dom=editor.dom;var rng=selection.getRng();var brElm;var extraBr;normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset);rng.setEnd(normRng.endContainer,normRng.endOffset);});var offset=rng.startOffset;var container=rng.startContainer;if(container.nodeType===1&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&container.nodeType===3){offset=container.nodeValue.length;}else{offset=0;}}var parentBlock=dom.getParent(container,dom.isBlock);var containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;var containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():'';var isControlKey=!!(evt&&evt.ctrlKey);if(containerBlockName==='LI'&&!isControlKey){parentBlock=containerBlock;}if(container&&container.nodeType===3&&offset>=container.nodeValue.length){if(!hasRightSideContent(editor.schema,container,parentBlock)){brElm=dom.create('br');rng.insertNode(brElm);rng.setStartAfter(brElm);rng.setEndAfter(brElm);extraBr=true;}}brElm=dom.create('br');rangeInsertNode(dom,rng,brElm);scrollToBr(dom,selection,brElm);moveSelectionToBr(dom,selection,brElm,extraBr);editor.undoManager.add();};var insertBrBefore=function insertBrBefore(editor,inline){var br=SugarElement.fromTag('br');before(SugarElement.fromDom(inline),br);editor.undoManager.add();};var insertBrAfter=function insertBrAfter(editor,inline){if(!hasBrAfter(editor.getBody(),inline)){after(SugarElement.fromDom(inline),SugarElement.fromTag('br'));}var br=SugarElement.fromTag('br');after(SugarElement.fromDom(inline),br);scrollToBr(editor.dom,editor.selection,br.dom);moveSelectionToBr(editor.dom,editor.selection,br.dom,false);editor.undoManager.add();};var isBeforeBr$1=function isBeforeBr$1(pos){return isBr(pos.getNode());};var hasBrAfter=function hasBrAfter(rootNode,startNode){if(isBeforeBr$1(CaretPosition$1.after(startNode))){return true;}else{return nextPosition(rootNode,CaretPosition$1.after(startNode)).map(function(pos){return isBr(pos.getNode());}).getOr(false);}};var isAnchorLink=function isAnchorLink(elm){return elm&&elm.nodeName==='A'&&'href'in elm;};var isInsideAnchor=function isInsideAnchor(location){return location.fold(never,isAnchorLink,isAnchorLink,never);};var readInlineAnchorLocation=function readInlineAnchorLocation(editor){var isInlineTarget$1=curry(isInlineTarget,editor);var position=CaretPosition$1.fromRangeStart(editor.selection.getRng());return readLocation(isInlineTarget$1,editor.getBody(),position).filter(isInsideAnchor);};var insertBrOutsideAnchor=function insertBrOutsideAnchor(editor,location){location.fold(noop,curry(insertBrBefore,editor),curry(insertBrAfter,editor),noop);};var insert$2=function insert$2(editor,evt){var anchorLocation=readInlineAnchorLocation(editor);if(anchorLocation.isSome()){anchorLocation.each(curry(insertBrOutsideAnchor,editor));}else{insertBrAtCaret(editor,evt);}};var matchesSelector=function matchesSelector(editor,selector){return getParentBlock$2(editor).filter(function(parentBlock){return selector.length>0&&is$1(SugarElement.fromDom(parentBlock),selector);}).isSome();};var shouldInsertBr=function shouldInsertBr(editor){return matchesSelector(editor,getBrNewLineSelector(editor));};var shouldBlockNewLine=function shouldBlockNewLine(editor){return matchesSelector(editor,getNoNewLineSelector(editor));};var newLineAction=Adt.generate([{br:[]},{block:[]},{none:[]}]);var shouldBlockNewLine$1=function shouldBlockNewLine$1(editor,_shiftKey){return shouldBlockNewLine(editor);};var isBrMode=function isBrMode(requiredState){return function(editor,_shiftKey){var brMode=getForcedRootBlock(editor)==='';return brMode===requiredState;};};var inListBlock=function inListBlock(requiredState){return function(editor,_shiftKey){return isListItemParentBlock(editor)===requiredState;};};var inBlock=function inBlock(blockName,requiredState){return function(editor,_shiftKey){var state=getParentBlockName(editor)===blockName.toUpperCase();return state===requiredState;};};var inPreBlock=function inPreBlock(requiredState){return inBlock('pre',requiredState);};var inSummaryBlock=function inSummaryBlock(){return inBlock('summary',true);};var shouldPutBrInPre$1=function shouldPutBrInPre$1(requiredState){return function(editor,_shiftKey){return shouldPutBrInPre(editor)===requiredState;};};var inBrContext=function inBrContext(editor,_shiftKey){return shouldInsertBr(editor);};var hasShiftKey=function hasShiftKey(_editor,shiftKey){return shiftKey;};var canInsertIntoEditableRoot=function canInsertIntoEditableRoot(editor){var forcedRootBlock=getForcedRootBlock(editor);var rootEditable=getEditableRoot(editor.dom,editor.selection.getStart());return rootEditable&&editor.schema.isValidChild(rootEditable.nodeName,forcedRootBlock?forcedRootBlock:'P');};var match$2=function match$2(predicates,action){return function(editor,shiftKey){var isMatch=foldl(predicates,function(res,p){return res&&p(editor,shiftKey);},true);return isMatch?Optional.some(action):Optional.none();};};var getAction$1=function getAction$1(editor,evt){return evaluateUntil([match$2([shouldBlockNewLine$1],newLineAction.none()),match$2([inSummaryBlock()],newLineAction.br()),match$2([inPreBlock(true),shouldPutBrInPre$1(false),hasShiftKey],newLineAction.br()),match$2([inPreBlock(true),shouldPutBrInPre$1(false)],newLineAction.block()),match$2([inPreBlock(true),shouldPutBrInPre$1(true),hasShiftKey],newLineAction.block()),match$2([inPreBlock(true),shouldPutBrInPre$1(true)],newLineAction.br()),match$2([inListBlock(true),hasShiftKey],newLineAction.br()),match$2([inListBlock(true)],newLineAction.block()),match$2([isBrMode(true),hasShiftKey,canInsertIntoEditableRoot],newLineAction.block()),match$2([isBrMode(true)],newLineAction.br()),match$2([inBrContext],newLineAction.br()),match$2([isBrMode(false),hasShiftKey],newLineAction.br()),match$2([canInsertIntoEditableRoot],newLineAction.block())],[editor,!!(evt&&evt.shiftKey)]).getOr(newLineAction.none());};var insert$3=function insert$3(editor,evt){getAction$1(editor,evt).fold(function(){insert$2(editor,evt);},function(){insert$1(editor,evt);},noop);};var handleEnterKeyEvent=function handleEnterKeyEvent(editor,event){if(event.isDefaultPrevented()){return;}event.preventDefault();endTypingLevelIgnoreLocks(editor.undoManager);editor.undoManager.transact(function(){if(editor.selection.isCollapsed()===false){editor.execCommand('Delete');}insert$3(editor,event);});};var setup$e=function setup$e(editor){editor.on('keydown',function(event){if(event.keyCode===VK.ENTER){handleEnterKeyEvent(editor,event);}});};var executeKeydownOverride$2=function executeKeydownOverride$2(editor,evt){execute([{keyCode:VK.END,action:action(moveToLineEndPoint$1,editor,true)},{keyCode:VK.HOME,action:action(moveToLineEndPoint$1,editor,false)},{keyCode:VK.END,action:action(moveToLineEndPoint$2,editor,true)},{keyCode:VK.HOME,action:action(moveToLineEndPoint$2,editor,false)}],evt).each(function(_){evt.preventDefault();});};var setup$f=function setup$f(editor){editor.on('keydown',function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride$2(editor,evt);}});};var browser$4=detect$3().browser;var setupIeInput=function setupIeInput(editor){var keypressThrotter=first(function(){if(!editor.composing){normalizeNbspsInEditor(editor);}},0);if(browser$4.isIE()){editor.on('keypress',function(_e){keypressThrotter.throttle();});editor.on('remove',function(_e){keypressThrotter.cancel();});}};var setup$g=function setup$g(editor){setupIeInput(editor);editor.on('input',function(e){if(e.isComposing===false){normalizeNbspsInEditor(editor);}});};var insertTextAtPosition=function insertTextAtPosition(text,pos){var container=pos.container();var offset=pos.offset();if(isText$1(container)){container.insertData(offset,text);return Optional.some(CaretPosition(container,offset+text.length));}else{return getElementFromPosition(pos).map(function(elm){var textNode=SugarElement.fromText(text);if(pos.isAtEnd()){after(elm,textNode);}else{before(elm,textNode);}return CaretPosition(textNode.dom,text.length);});}};var insertNbspAtPosition=curry(insertTextAtPosition,nbsp);var insertSpaceAtPosition=curry(insertTextAtPosition,' ');var locationToCaretPosition=function locationToCaretPosition(root){return function(location){return location.fold(function(element){return prevPosition(root.dom,CaretPosition$1.before(element));},function(element){return firstPositionIn(element);},function(element){return lastPositionIn(element);},function(element){return nextPosition(root.dom,CaretPosition$1.after(element));});};};var insertInlineBoundarySpaceOrNbsp=function insertInlineBoundarySpaceOrNbsp(root,pos){return function(checkPos){return needsToHaveNbsp(root,checkPos)?insertNbspAtPosition(pos):insertSpaceAtPosition(pos);};};var setSelection$1=function setSelection$1(editor){return function(pos){editor.selection.setRng(pos.toRange());editor.nodeChanged();return true;};};var insertSpaceOrNbspAtSelection=function insertSpaceOrNbspAtSelection(editor){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());var root=SugarElement.fromDom(editor.getBody());if(editor.selection.isCollapsed()){var isInlineTarget$1=curry(isInlineTarget,editor);var caretPosition=CaretPosition$1.fromRangeStart(editor.selection.getRng());return readLocation(isInlineTarget$1,editor.getBody(),caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root,pos)).exists(setSelection$1(editor));}else{return false;}};var executeKeydownOverride$3=function executeKeydownOverride$3(editor,evt){execute([{keyCode:VK.SPACEBAR,action:action(insertSpaceOrNbspAtSelection,editor)}],evt).each(function(_){evt.preventDefault();});};var setup$h=function setup$h(editor){editor.on('keydown',function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride$3(editor,evt);}});};var registerKeyboardOverrides=function registerKeyboardOverrides(editor){var caret=setupSelectedState(editor);setup$b(editor);setup$c(editor,caret);setup$d(editor,caret);setup$e(editor);setup$h(editor);setup$g(editor);setup$f(editor);return caret;};var setup$i=function setup$i(editor){if(!isRtc(editor)){return registerKeyboardOverrides(editor);}else{return Cell(null);}};var NodeChange=function(){function NodeChange(editor){this.lastPath=[];this.editor=editor;var lastRng;var self=this;if(!('onselectionchange'in editor.getDoc())){editor.on('NodeChange click mouseup keyup focus',function(e){var nativeRng=editor.selection.getRng();var fakeRng={startContainer:nativeRng.startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset};if(e.type==='nodechange'||!isEq$1(fakeRng,lastRng)){editor.fire('SelectionChange');}lastRng=fakeRng;});}editor.on('contextmenu',function(){editor.fire('SelectionChange');});editor.on('SelectionChange',function(){var startElm=editor.selection.getStart(true);if(!startElm||!Env.range&&editor.selection.isCollapsed()){return;}if(hasAnyRanges(editor)&&!self.isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())){editor.nodeChanged({selectionChange:true});}});editor.on('mouseup',function(e){if(!e.isDefaultPrevented()&&hasAnyRanges(editor)){if(editor.selection.getNode().nodeName==='IMG'){Delay.setEditorTimeout(editor,function(){editor.nodeChanged();});}else{editor.nodeChanged();}}});}NodeChange.prototype.nodeChanged=function(args){var selection=this.editor.selection;var node,parents,root;if(this.editor.initialized&&selection&&!shouldDisableNodeChange(this.editor)&&!this.editor.mode.isReadOnly()){root=this.editor.getBody();node=selection.getStart(true)||root;if(node.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(node,root)){node=root;}parents=[];this.editor.dom.getParent(node,function(node){if(node===root){return true;}parents.push(node);});args=args||{};args.element=node;args.parents=parents;this.editor.fire('NodeChange',args);}};NodeChange.prototype.isSameElementPath=function(startElm){var i;var currentPath=this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);if(currentPath.length===this.lastPath.length){for(i=currentPath.length;i>=0;i--){if(currentPath[i]!==this.lastPath[i]){break;}}if(i===-1){this.lastPath=currentPath;return true;}}this.lastPath=currentPath;return false;};return NodeChange;}();var preventSummaryToggle=function preventSummaryToggle(editor){editor.on('click',function(e){if(editor.dom.getParent(e.target,'details')){e.preventDefault();}});};var filterDetails=function filterDetails(editor){editor.parser.addNodeFilter('details',function(elms){each(elms,function(details){details.attr('data-mce-open',details.attr('open'));details.attr('open','open');});});editor.serializer.addNodeFilter('details',function(elms){each(elms,function(details){var open=details.attr('data-mce-open');details.attr('open',isString(open)?open:null);details.attr('data-mce-open',null);});});};var setup$j=function setup$j(editor){preventSummaryToggle(editor);filterDetails(editor);};var isTextBlockNode=function isTextBlockNode(node){return isElement$1(node)&&isTextBlock(SugarElement.fromDom(node));};var normalizeSelection$1=function normalizeSelection$1(editor){var rng=editor.selection.getRng();var startPos=CaretPosition.fromRangeStart(rng);var endPos=CaretPosition.fromRangeEnd(rng);if(CaretPosition.isElementPosition(startPos)){var container=startPos.container();if(isTextBlockNode(container)){firstPositionIn(container).each(function(pos){return rng.setStart(pos.container(),pos.offset());});}}if(CaretPosition.isElementPosition(endPos)){var container=startPos.container();if(isTextBlockNode(container)){lastPositionIn(container).each(function(pos){return rng.setEnd(pos.container(),pos.offset());});}}editor.selection.setRng(normalize$2(rng));};var setup$k=function setup$k(editor){editor.on('click',function(e){if(e.detail>=3){normalizeSelection$1(editor);}});};var value$1=function value$1(){var subject=Cell(Optional.none());var clear=function clear(){return subject.set(Optional.none());};var set=function set(s){return subject.set(Optional.some(s));};var isSet=function isSet(){return subject.get().isSome();};var on=function on(f){return subject.get().each(f);};return{clear:clear,set:set,isSet:isSet,on:on};};var getAbsolutePosition=function getAbsolutePosition(elm){var clientRect=elm.getBoundingClientRect();var doc=elm.ownerDocument;var docElem=doc.documentElement;var win=doc.defaultView;return{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft};};var getBodyPosition=function getBodyPosition(editor){return editor.inline?getAbsolutePosition(editor.getBody()):{left:0,top:0};};var getScrollPosition=function getScrollPosition(editor){var body=editor.getBody();return editor.inline?{left:body.scrollLeft,top:body.scrollTop}:{left:0,top:0};};var getBodyScroll=function getBodyScroll(editor){var body=editor.getBody(),docElm=editor.getDoc().documentElement;var inlineScroll={left:body.scrollLeft,top:body.scrollTop};var iframeScroll={left:body.scrollLeft||docElm.scrollLeft,top:body.scrollTop||docElm.scrollTop};return editor.inline?inlineScroll:iframeScroll;};var getMousePosition=function getMousePosition(editor,event){if(event.target.ownerDocument!==editor.getDoc()){var iframePosition=getAbsolutePosition(editor.getContentAreaContainer());var scrollPosition=getBodyScroll(editor);return{left:event.pageX-iframePosition.left+scrollPosition.left,top:event.pageY-iframePosition.top+scrollPosition.top};}return{left:event.pageX,top:event.pageY};};var calculatePosition=function calculatePosition(bodyPosition,scrollPosition,mousePosition){return{pageX:mousePosition.left-bodyPosition.left+scrollPosition.left,pageY:mousePosition.top-bodyPosition.top+scrollPosition.top};};var calc=function calc(editor,event){return calculatePosition(getBodyPosition(editor),getScrollPosition(editor),getMousePosition(editor,event));};var isContentEditableFalse$a=isContentEditableFalse,isContentEditableTrue$3=isContentEditableTrue;var isDraggable=function isDraggable(rootElm,elm){return isContentEditableFalse$a(elm)&&elm!==rootElm;};var isValidDropTarget=function isValidDropTarget(editor,targetElement,dragElement){if(targetElement===dragElement||editor.dom.isChildOf(targetElement,dragElement)){return false;}return!isContentEditableFalse$a(targetElement);};var cloneElement=function cloneElement(elm){var cloneElm=elm.cloneNode(true);cloneElm.removeAttribute('data-mce-selected');return cloneElm;};var createGhost=function createGhost(editor,elm,width,height){var dom=editor.dom;var clonedElm=elm.cloneNode(true);dom.setStyles(clonedElm,{width:width,height:height});dom.setAttrib(clonedElm,'data-mce-selected',null);var ghostElm=dom.create('div',{'class':'mce-drag-container','data-mce-bogus':'all','unselectable':'on','contenteditable':'false'});dom.setStyles(ghostElm,{position:'absolute',opacity:0.5,overflow:'hidden',border:0,padding:0,margin:0,width:width,height:height});dom.setStyles(clonedElm,{margin:0,boxSizing:'border-box'});ghostElm.appendChild(clonedElm);return ghostElm;};var appendGhostToBody=function appendGhostToBody(ghostElm,bodyElm){if(ghostElm.parentNode!==bodyElm){bodyElm.appendChild(ghostElm);}};var moveGhost=function moveGhost(ghostElm,position,width,height,maxX,maxY){var overflowX=0,overflowY=0;ghostElm.style.left=position.pageX+'px';ghostElm.style.top=position.pageY+'px';if(position.pageX+width>maxX){overflowX=position.pageX+width-maxX;}if(position.pageY+height>maxY){overflowY=position.pageY+height-maxY;}ghostElm.style.width=width-overflowX+'px';ghostElm.style.height=height-overflowY+'px';};var removeElement=function removeElement(elm){if(elm&&elm.parentNode){elm.parentNode.removeChild(elm);}};var isLeftMouseButtonPressed=function isLeftMouseButtonPressed(e){return e.button===0;};var applyRelPos=function applyRelPos(state,position){return{pageX:position.pageX-state.relX,pageY:position.pageY+5};};var start$1=function start$1(state,editor){return function(e){if(isLeftMouseButtonPressed(e)){var ceElm=find(editor.dom.getParents(e.target),or(isContentEditableFalse$a,isContentEditableTrue$3)).getOr(null);if(isDraggable(editor.getBody(),ceElm)){var elmPos=editor.dom.getPos(ceElm);var bodyElm=editor.getBody();var docElm=editor.getDoc().documentElement;state.set({element:ceElm,dragging:false,screenX:e.screenX,screenY:e.screenY,maxX:(editor.inline?bodyElm.scrollWidth:docElm.offsetWidth)-2,maxY:(editor.inline?bodyElm.scrollHeight:docElm.offsetHeight)-2,relX:e.pageX-elmPos.x,relY:e.pageY-elmPos.y,width:ceElm.offsetWidth,height:ceElm.offsetHeight,ghost:createGhost(editor,ceElm,ceElm.offsetWidth,ceElm.offsetHeight)});}}};};var move$2=function move$2(state,editor){var throttledPlaceCaretAt=Delay.throttle(function(clientX,clientY){editor._selectionOverrides.hideFakeCaret();editor.selection.placeCaretAt(clientX,clientY);},0);return function(e){return state.on(function(state){var movement=Math.max(Math.abs(e.screenX-state.screenX),Math.abs(e.screenY-state.screenY));if(!state.dragging&&movement>10){var args=editor.fire('dragstart',{target:state.element});if(args.isDefaultPrevented()){return;}state.dragging=true;editor.focus();}if(state.dragging){var targetPos=applyRelPos(state,calc(editor,e));appendGhostToBody(state.ghost,editor.getBody());moveGhost(state.ghost,targetPos,state.width,state.height,state.maxX,state.maxY);throttledPlaceCaretAt(e.clientX,e.clientY);}});};};var getRawTarget=function getRawTarget(selection){var rng=selection.getSel().getRangeAt(0);var startContainer=rng.startContainer;return startContainer.nodeType===3?startContainer.parentNode:startContainer;};var drop=function drop(state,editor){return function(e){state.on(function(state){if(state.dragging){if(isValidDropTarget(editor,getRawTarget(editor.selection),state.element)){var targetClone_1=cloneElement(state.element);var args=editor.fire('drop',{clientX:e.clientX,clientY:e.clientY});if(!args.isDefaultPrevented()){editor.undoManager.transact(function(){removeElement(state.element);editor.insertContent(editor.dom.getOuterHTML(targetClone_1));editor._selectionOverrides.hideFakeCaret();});}}}});removeDragState(state);};};var stop=function stop(state,editor){return function(){state.on(function(state){if(state.dragging){editor.fire('dragend');}});removeDragState(state);};};var removeDragState=function removeDragState(state){state.on(function(state){removeElement(state.ghost);});state.clear();};var bindFakeDragEvents=function bindFakeDragEvents(editor){var state=value$1();var pageDom=DOMUtils$1.DOM;var rootDocument=document;var dragStartHandler=start$1(state,editor);var dragHandler=move$2(state,editor);var dropHandler=drop(state,editor);var dragEndHandler=stop(state,editor);editor.on('mousedown',dragStartHandler);editor.on('mousemove',dragHandler);editor.on('mouseup',dropHandler);pageDom.bind(rootDocument,'mousemove',dragHandler);pageDom.bind(rootDocument,'mouseup',dragEndHandler);editor.on('remove',function(){pageDom.unbind(rootDocument,'mousemove',dragHandler);pageDom.unbind(rootDocument,'mouseup',dragEndHandler);});};var blockIeDrop=function blockIeDrop(editor){editor.on('drop',function(e){var realTarget=typeof e.clientX!=='undefined'?editor.getDoc().elementFromPoint(e.clientX,e.clientY):null;if(isContentEditableFalse$a(realTarget)||editor.dom.getContentEditableParent(realTarget)==='false'){e.preventDefault();}});};var blockUnsupportedFileDrop=function blockUnsupportedFileDrop(editor){var preventFileDrop=function preventFileDrop(e){if(!e.defaultPrevented){var dataTransfer=e.dataTransfer;if(dataTransfer&&(contains(dataTransfer.types,'Files')||dataTransfer.files.length>0)){e.preventDefault();if(e.type==='drop'){displayError(editor,'Dropped file type is not supported');}}}};var preventFileDropIfUIElement=function preventFileDropIfUIElement(e){if(isUIElement(editor,e.target)){preventFileDrop(e);}};var setup=function setup(){var pageDom=DOMUtils$1.DOM;var dom=editor.dom;var doc=document;var editorRoot=editor.inline?editor.getBody():editor.getDoc();var eventNames=['drop','dragover'];each(eventNames,function(name){pageDom.bind(doc,name,preventFileDropIfUIElement);dom.bind(editorRoot,name,preventFileDrop);});editor.on('remove',function(){each(eventNames,function(name){pageDom.unbind(doc,name,preventFileDropIfUIElement);dom.unbind(editorRoot,name,preventFileDrop);});});};editor.on('init',function(){Delay.setEditorTimeout(editor,setup,0);});};var init=function init(editor){bindFakeDragEvents(editor);blockIeDrop(editor);if(shouldBlockUnsupportedDrop(editor)){blockUnsupportedFileDrop(editor);}};var setup$l=function setup$l(editor){var renderFocusCaret=first(function(){if(!editor.removed&&editor.getBody().contains(document.activeElement)){var rng=editor.selection.getRng();if(rng.collapsed){var caretRange=renderRangeCaret(editor,rng,false);editor.selection.setRng(caretRange);}}},0);editor.on('focus',function(){renderFocusCaret.throttle();});editor.on('blur',function(){renderFocusCaret.cancel();});};var setup$m=function setup$m(editor){editor.on('init',function(){editor.on('focusin',function(e){var target=e.target;if(isMedia(target)){var ceRoot=getContentEditableRoot(editor.getBody(),target);var node=isContentEditableFalse(ceRoot)?ceRoot:target;if(editor.selection.getNode()!==node){selectNode(editor,node).each(function(rng){return editor.selection.setRng(rng);});}}});});};var isContentEditableTrue$4=isContentEditableTrue;var isContentEditableFalse$b=isContentEditableFalse;var getContentEditableRoot$1=function getContentEditableRoot$1(editor,node){return getContentEditableRoot(editor.getBody(),node);};var SelectionOverrides=function SelectionOverrides(editor){var selection=editor.selection,dom=editor.dom;var isBlock=dom.isBlock;var rootNode=editor.getBody();var fakeCaret=FakeCaret(editor,rootNode,isBlock,function(){return hasFocus$1(editor);});var realSelectionId='sel-'+dom.uniqueId();var elementSelectionAttr='data-mce-selected';var selectedElement;var isFakeSelectionElement=function isFakeSelectionElement(node){return dom.hasClass(node,'mce-offscreen-selection');};var isFakeSelectionTargetElement=function isFakeSelectionTargetElement(node){return isContentEditableFalse$b(node)||isMedia(node);};var isNearFakeSelectionElement=function isNearFakeSelectionElement(pos){return isBeforeContentEditableFalse(pos)||isAfterContentEditableFalse(pos)||isBeforeMedia(pos)||isAfterMedia(pos);};var getRealSelectionElement=function getRealSelectionElement(){var container=dom.get(realSelectionId);return container?container.getElementsByTagName('*')[0]:container;};var setRange=function setRange(range){if(range){selection.setRng(range);}};var getRange=selection.getRng;var showCaret=function showCaret(direction,node,before,scrollIntoView){if(scrollIntoView===void 0){scrollIntoView=true;}var e=editor.fire('ShowCaret',{target:node,direction:direction,before:before});if(e.isDefaultPrevented()){return null;}if(scrollIntoView){selection.scrollIntoView(node,direction===-1);}return fakeCaret.show(before,node);};var showBlockCaretContainer=function showBlockCaretContainer(blockCaretContainer){if(blockCaretContainer.hasAttribute('data-mce-caret')){showCaretContainerBlock(blockCaretContainer);setRange(getRange());selection.scrollIntoView(blockCaretContainer);}};var registerEvents=function registerEvents(){editor.on('mouseup',function(e){var range=getRange();if(range.collapsed&&isXYInContentArea(editor,e.clientX,e.clientY)){renderCaretAtRange(editor,range,false).each(setRange);}});editor.on('click',function(e){var contentEditableRoot=getContentEditableRoot$1(editor,e.target);if(contentEditableRoot){if(isContentEditableFalse$b(contentEditableRoot)){e.preventDefault();editor.focus();}if(isContentEditableTrue$4(contentEditableRoot)){if(dom.isChildOf(contentEditableRoot,selection.getNode())){removeElementSelection();}}}});editor.on('blur NewBlock',removeElementSelection);editor.on('ResizeWindow FullscreenStateChanged',fakeCaret.reposition);var hasNormalCaretPosition=function hasNormalCaretPosition(elm){var caretWalker=CaretWalker(elm);if(!elm.firstChild){return false;}var startPos=CaretPosition$1.before(elm.firstChild);var newPos=caretWalker.next(startPos);return newPos&&!isNearFakeSelectionElement(newPos);};var isInSameBlock=function isInSameBlock(node1,node2){var block1=dom.getParent(node1,isBlock);var block2=dom.getParent(node2,isBlock);return block1===block2;};var hasBetterMouseTarget=function hasBetterMouseTarget(targetNode,caretNode){var targetBlock=dom.getParent(targetNode,isBlock);var caretBlock=dom.getParent(caretNode,isBlock);if(targetBlock&&targetNode!==caretBlock&&dom.isChildOf(targetBlock,caretBlock)&&isContentEditableFalse$b(getContentEditableRoot$1(editor,targetBlock))===false){return true;}return targetBlock&&!isInSameBlock(targetBlock,caretBlock)&&hasNormalCaretPosition(targetBlock);};editor.on('tap',function(e){var targetElm=e.target;var contentEditableRoot=getContentEditableRoot$1(editor,targetElm);if(isContentEditableFalse$b(contentEditableRoot)){e.preventDefault();selectNode(editor,contentEditableRoot).each(setElementSelection);}else if(isFakeSelectionTargetElement(targetElm)){selectNode(editor,targetElm).each(setElementSelection);}},true);editor.on('mousedown',function(e){var targetElm=e.target;if(targetElm!==rootNode&&targetElm.nodeName!=='HTML'&&!dom.isChildOf(targetElm,rootNode)){return;}if(isXYInContentArea(editor,e.clientX,e.clientY)===false){return;}var contentEditableRoot=getContentEditableRoot$1(editor,targetElm);if(contentEditableRoot){if(isContentEditableFalse$b(contentEditableRoot)){e.preventDefault();selectNode(editor,contentEditableRoot).each(setElementSelection);}else{removeElementSelection();if(!(isContentEditableTrue$4(contentEditableRoot)&&e.shiftKey)&&!isXYWithinRange(e.clientX,e.clientY,selection.getRng())){hideFakeCaret();selection.placeCaretAt(e.clientX,e.clientY);}}}else if(isFakeSelectionTargetElement(targetElm)){selectNode(editor,targetElm).each(setElementSelection);}else if(isFakeCaretTarget(targetElm)===false){removeElementSelection();hideFakeCaret();var fakeCaretInfo=closestFakeCaret(rootNode,e.clientX,e.clientY);if(fakeCaretInfo){if(!hasBetterMouseTarget(targetElm,fakeCaretInfo.node)){e.preventDefault();var range=showCaret(1,fakeCaretInfo.node,fakeCaretInfo.before,false);editor.getBody().focus();setRange(range);}}}});editor.on('keypress',function(e){if(VK.modifierPressed(e)){return;}if(isContentEditableFalse$b(selection.getNode())){e.preventDefault();}});editor.on('GetSelectionRange',function(e){var rng=e.range;if(selectedElement){if(!selectedElement.parentNode){selectedElement=null;return;}rng=rng.cloneRange();rng.selectNode(selectedElement);e.range=rng;}});editor.on('SetSelectionRange',function(e){e.range=normalizeShortEndedElementSelection(e.range);var rng=setElementSelection(e.range,e.forward);if(rng){e.range=rng;}});var isPasteBin=function isPasteBin(node){return node.id==='mcepastebin';};editor.on('AfterSetSelectionRange',function(e){var rng=e.range;var parentNode=rng.startContainer.parentNode;if(!isRangeInCaretContainer(rng)&&!isPasteBin(parentNode)){hideFakeCaret();}if(!isFakeSelectionElement(parentNode)){removeElementSelection();}});editor.on('copy',function(e){var clipboardData=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!Env.ie){var realSelectionElement=getRealSelectionElement();if(realSelectionElement){e.preventDefault();clipboardData.clearData();clipboardData.setData('text/html',realSelectionElement.outerHTML);clipboardData.setData('text/plain',realSelectionElement.outerText||realSelectionElement.innerText);}}});init(editor);setup$l(editor);setup$m(editor);};var isWithinCaretContainer=function isWithinCaretContainer(node){return isCaretContainer(node)||startsWithCaretContainer(node)||endsWithCaretContainer(node);};var isRangeInCaretContainer=function isRangeInCaretContainer(rng){return isWithinCaretContainer(rng.startContainer)||isWithinCaretContainer(rng.endContainer);};var normalizeShortEndedElementSelection=function normalizeShortEndedElementSelection(rng){var shortEndedElements=editor.schema.getShortEndedElements();var newRng=dom.createRng();var startContainer=rng.startContainer;var startOffset=rng.startOffset;var endContainer=rng.endContainer;var endOffset=rng.endOffset;if(has(shortEndedElements,startContainer.nodeName.toLowerCase())){if(startOffset===0){newRng.setStartBefore(startContainer);}else{newRng.setStartAfter(startContainer);}}else{newRng.setStart(startContainer,startOffset);}if(has(shortEndedElements,endContainer.nodeName.toLowerCase())){if(endOffset===0){newRng.setEndBefore(endContainer);}else{newRng.setEndAfter(endContainer);}}else{newRng.setEnd(endContainer,endOffset);}return newRng;};var setupOffscreenSelection=function setupOffscreenSelection(node,targetClone,origTargetClone){var $=editor.$;var $realSelectionContainer=descendant(SugarElement.fromDom(editor.getBody()),'#'+realSelectionId).fold(function(){return $([]);},function(elm){return $([elm.dom]);});if($realSelectionContainer.length===0){$realSelectionContainer=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr('id',realSelectionId);$realSelectionContainer.appendTo(editor.getBody());}var newRange=dom.createRng();if(targetClone===origTargetClone&&Env.ie){$realSelectionContainer.empty().append('<p style="font-size: 0" data-mce-bogus="all">\xA0</p>').append(targetClone);newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);newRange.setEndAfter(targetClone);}else{$realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);newRange.setStart($realSelectionContainer[0].firstChild,1);newRange.setEnd($realSelectionContainer[0].lastChild,0);}$realSelectionContainer.css({top:dom.getPos(node,editor.getBody()).y});$realSelectionContainer[0].focus();var sel=selection.getSel();sel.removeAllRanges();sel.addRange(newRange);return newRange;};var selectElement=function selectElement(elm){var targetClone=elm.cloneNode(true);var e=editor.fire('ObjectSelected',{target:elm,targetClone:targetClone});if(e.isDefaultPrevented()){return null;}var range=setupOffscreenSelection(elm,e.targetClone,targetClone);var nodeElm=SugarElement.fromDom(elm);each(descendants$1(SugarElement.fromDom(editor.getBody()),'*[data-mce-selected]'),function(elm){if(!eq$2(nodeElm,elm)){remove$1(elm,elementSelectionAttr);}});if(!dom.getAttrib(elm,elementSelectionAttr)){elm.setAttribute(elementSelectionAttr,'1');}selectedElement=elm;hideFakeCaret();return range;};var setElementSelection=function setElementSelection(range,forward){if(!range){return null;}if(range.collapsed){if(!isRangeInCaretContainer(range)){var dir=forward?1:-1;var caretPosition=getNormalizedRangeEndPoint(dir,rootNode,range);var beforeNode=caretPosition.getNode(!forward);if(isFakeCaretTarget(beforeNode)){return showCaret(dir,beforeNode,forward?!caretPosition.isAtEnd():false,false);}var afterNode=caretPosition.getNode(forward);if(isFakeCaretTarget(afterNode)){return showCaret(dir,afterNode,forward?false:!caretPosition.isAtEnd(),false);}}return null;}var startContainer=range.startContainer;var startOffset=range.startOffset;var endOffset=range.endOffset;if(startContainer.nodeType===3&&startOffset===0&&isContentEditableFalse$b(startContainer.parentNode)){startContainer=startContainer.parentNode;startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode;}if(startContainer.nodeType!==1){return null;}if(endOffset===startOffset+1&&startContainer===range.endContainer){var node=startContainer.childNodes[startOffset];if(isFakeSelectionTargetElement(node)){return selectElement(node);}}return null;};var removeElementSelection=function removeElementSelection(){if(selectedElement){selectedElement.removeAttribute(elementSelectionAttr);}descendant(SugarElement.fromDom(editor.getBody()),'#'+realSelectionId).each(remove);selectedElement=null;};var destroy=function destroy(){fakeCaret.destroy();selectedElement=null;};var hideFakeCaret=function hideFakeCaret(){fakeCaret.hide();};if(Env.ceFalse){registerEvents();}return{showCaret:showCaret,showBlockCaretContainer:showBlockCaretContainer,hideFakeCaret:hideFakeCaret,destroy:destroy};};var Quirks=function Quirks(editor){var each=Tools.each;var BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,parser=editor.parser;var isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit;var mceInternalUrlPrefix='data:text/mce-internal,';var mceInternalDataType=isIE?'Text':'URL';var setEditorCommandState=function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,false,state);}catch(ex){}};var isDefaultPrevented=function isDefaultPrevented(e){return e.isDefaultPrevented();};var setMceInternalContent=function setMceInternalContent(e){var selectionHtml,internalContent;if(e.dataTransfer){if(editor.selection.isCollapsed()&&e.target.tagName==='IMG'){selection.select(e.target);}selectionHtml=editor.selection.getContent();if(selectionHtml.length>0){internalContent=mceInternalUrlPrefix+escape(editor.id)+','+escape(selectionHtml);e.dataTransfer.setData(mceInternalDataType,internalContent);}}};var getMceInternalContent=function getMceInternalContent(e){var internalContent;if(e.dataTransfer){internalContent=e.dataTransfer.getData(mceInternalDataType);if(internalContent&&internalContent.indexOf(mceInternalUrlPrefix)>=0){internalContent=internalContent.substr(mceInternalUrlPrefix.length).split(',');return{id:unescape(internalContent[0]),html:unescape(internalContent[1])};}}return null;};var insertClipboardContents=function insertClipboardContents(content,internal){if(editor.queryCommandSupported('mceInsertClipboardContent')){editor.execCommand('mceInsertClipboardContent',false,{content:content,internal:internal});}else{editor.execCommand('mceInsertContent',false,content);}};var emptyEditorWhenDeleting=function emptyEditorWhenDeleting(){var serializeRng=function serializeRng(rng){var body=dom.create('body');var contents=rng.cloneContents();body.appendChild(contents);return selection.serializer.serialize(body,{format:'html'});};var allContentsSelected=function allContentsSelected(rng){var selection=serializeRng(rng);var allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection;};editor.on('keydown',function(e){var keyCode=e.keyCode;var isCollapsed,body;if(!isDefaultPrevented(e)&&(keyCode===DELETE||keyCode===BACKSPACE)){isCollapsed=editor.selection.isCollapsed();body=editor.getBody();if(isCollapsed&&!dom.isEmpty(body)){return;}if(!isCollapsed&&!allContentsSelected(editor.selection.getRng())){return;}e.preventDefault();editor.setContent('');if(body.firstChild&&dom.isBlock(body.firstChild)){editor.selection.setCursorLocation(body.firstChild,0);}else{editor.selection.setCursorLocation(body,0);}editor.nodeChanged();}});};var selectAll=function selectAll(){editor.shortcuts.add('meta+a',null,'SelectAll');};var inputMethodFocus=function inputMethodFocus(){if(!editor.inline){dom.bind(editor.getDoc(),'mousedown mouseup',function(e){var rng;if(e.target===editor.getDoc().documentElement){rng=selection.getRng();editor.getBody().focus();if(e.type==='mousedown'){if(isCaretContainer(rng.startContainer)){return;}selection.placeCaretAt(e.clientX,e.clientY);}else{selection.setRng(rng);}}});}};var removeHrOnBackspace=function removeHrOnBackspace(){editor.on('keydown',function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName('hr').length){return;}if(selection.isCollapsed()&&selection.getRng().startOffset===0){var node=selection.getNode();var previousSibling=node.previousSibling;if(node.nodeName==='HR'){dom.remove(node);e.preventDefault();return;}if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==='hr'){dom.remove(previousSibling);e.preventDefault();}}}});};var focusBody=function focusBody(){if(!Range.prototype.getClientRects){editor.on('mousedown',function(e){if(!isDefaultPrevented(e)&&e.target.nodeName==='HTML'){var body_1=editor.getBody();body_1.blur();Delay.setEditorTimeout(editor,function(){body_1.focus();});}});}};var selectControlElements=function selectControlElements(){editor.on('click',function(e){var target=e.target;if(/^(IMG|HR)$/.test(target.nodeName)&&dom.getContentEditableParent(target)!=='false'){e.preventDefault();editor.selection.select(target);editor.nodeChanged();}if(target.nodeName==='A'&&dom.hasClass(target,'mce-item-anchor')){e.preventDefault();selection.select(target);}});};var removeStylesWhenDeletingAcrossBlockElements=function removeStylesWhenDeletingAcrossBlockElements(){var getAttributeApplyFunction=function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(false));return function(){var target=selection.getStart();if(target!==editor.getBody()){dom.setAttrib(target,'style',null);each(template,function(attr){target.setAttributeNode(attr.cloneNode(true));});}};};var isSelectionAcrossElements=function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!==dom.getParent(selection.getEnd(),dom.isBlock);};editor.on('keypress',function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(e.keyCode===8||e.keyCode===46)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();editor.getDoc().execCommand('delete',false,null);applyAttributes();e.preventDefault();return false;}});dom.bind(editor.getDoc(),'cut',function(e){var applyAttributes;if(!isDefaultPrevented(e)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();Delay.setEditorTimeout(editor,function(){applyAttributes();});}});};var disableBackspaceIntoATable=function disableBackspaceIntoATable(){editor.on('keydown',function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(selection.isCollapsed()&&selection.getRng().startOffset===0){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==='table'){e.preventDefault();return false;}}}});};var removeBlockQuoteOnBackSpace=function removeBlockQuoteOnBackSpace(){editor.on('keydown',function(e){var rng,parent;if(isDefaultPrevented(e)||e.keyCode!==VK.BACKSPACE){return;}rng=selection.getRng();var container=rng.startContainer;var offset=rng.startOffset;var root=dom.getRoot();parent=container;if(!rng.collapsed||offset!==0){return;}while(parent&&parent.parentNode&&parent.parentNode.firstChild===parent&&parent.parentNode!==root){parent=parent.parentNode;}if(parent.tagName==='BLOCKQUOTE'){editor.formatter.toggle('blockquote',null,parent);rng=dom.createRng();rng.setStart(container,0);rng.setEnd(container,0);selection.setRng(rng);}});};var setGeckoEditingOptions=function setGeckoEditingOptions(){var setOpts=function setOpts(){setEditorCommandState('StyleWithCSS',false);setEditorCommandState('enableInlineTableEditing',false);if(!getObjectResizing(editor)){setEditorCommandState('enableObjectResizing',false);}};if(!isReadOnly(editor)){editor.on('BeforeExecCommand mousedown',setOpts);}};var addBrAfterLastLinks=function addBrAfterLastLinks(){var fixLinks=function fixLinks(){each(dom.select('a'),function(node){var parentNode=node.parentNode;var root=dom.getRoot();if(parentNode.lastChild===node){while(parentNode&&!dom.isBlock(parentNode)){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root){return;}parentNode=parentNode.parentNode;}dom.add(parentNode,'br',{'data-mce-bogus':1});}});};editor.on('SetContent ExecCommand',function(e){if(e.type==='setcontent'||e.command==='mceInsertLink'){fixLinks();}});};var setDefaultBlockType=function setDefaultBlockType(){if(getForcedRootBlock(editor)){editor.on('init',function(){setEditorCommandState('DefaultParagraphSeparator',getForcedRootBlock(editor));});}};var normalizeSelection=function normalizeSelection(){editor.on('keyup focusin mouseup',function(e){if(!VK.modifierPressed(e)){selection.normalize();}},true);};var showBrokenImageIcon=function showBrokenImageIcon(){editor.contentStyles.push('img:-moz-broken {'+'-moz-force-broken-image-icon:1;'+'min-width:24px;'+'min-height:24px'+'}');};var restoreFocusOnKeyDown=function restoreFocusOnKeyDown(){if(!editor.inline){editor.on('keydown',function(){if(document.activeElement===document.body){editor.getWin().focus();}});}};var bodyHeight=function bodyHeight(){if(!editor.inline){editor.contentStyles.push('body {min-height: 150px}');editor.on('click',function(e){var rng;if(e.target.nodeName==='HTML'){if(Env.ie>11){editor.getBody().focus();return;}rng=editor.selection.getRng();editor.getBody().focus();editor.selection.setRng(rng);editor.selection.normalize();editor.nodeChanged();}});}};var blockCmdArrowNavigation=function blockCmdArrowNavigation(){if(Env.mac){editor.on('keydown',function(e){if(VK.metaKeyPressed(e)&&!e.shiftKey&&(e.keyCode===37||e.keyCode===39)){e.preventDefault();var selection_1=editor.selection.getSel();selection_1.modify('move',e.keyCode===37?'backward':'forward','lineboundary');}});}};var disableAutoUrlDetect=function disableAutoUrlDetect(){setEditorCommandState('AutoUrlDetect',false);};var tapLinksAndImages=function tapLinksAndImages(){editor.on('click',function(e){var elm=e.target;do{if(elm.tagName==='A'){e.preventDefault();return;}}while(elm=elm.parentNode);});editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');};var blockFormSubmitInsideEditor=function blockFormSubmitInsideEditor(){editor.on('init',function(){editor.dom.bind(editor.getBody(),'submit',function(e){e.preventDefault();});});};var removeAppleInterchangeBrs=function removeAppleInterchangeBrs(){parser.addNodeFilter('br',function(nodes){var i=nodes.length;while(i--){if(nodes[i].attr('class')==='Apple-interchange-newline'){nodes[i].remove();}}});};var ieInternalDragAndDrop=function ieInternalDragAndDrop(){editor.on('dragstart',function(e){setMceInternalContent(e);});editor.on('drop',function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);if(internalContent&&internalContent.id!==editor.id){e.preventDefault();var rng=fromPoint$1(e.x,e.y,editor.getDoc());selection.setRng(rng);insertClipboardContents(internalContent.html,true);}}});};var refreshContentEditable=function refreshContentEditable(){};var isHidden=function isHidden(){if(!isGecko||editor.removed){return false;}var sel=editor.selection.getSel();return!sel||!sel.rangeCount||sel.rangeCount===0;};removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();if(!Env.windowsPhone){normalizeSelection();}if(isWebKit){inputMethodFocus();selectControlElements();setDefaultBlockType();blockFormSubmitInsideEditor();disableBackspaceIntoATable();removeAppleInterchangeBrs();if(Env.iOS){restoreFocusOnKeyDown();bodyHeight();tapLinksAndImages();}else{selectAll();}}if(Env.ie>=11){bodyHeight();disableBackspaceIntoATable();}if(Env.ie){selectAll();disableAutoUrlDetect();ieInternalDragAndDrop();}if(isGecko){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAcrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();showBrokenImageIcon();blockCmdArrowNavigation();disableBackspaceIntoATable();}return{refreshContentEditable:refreshContentEditable,isHidden:isHidden};};var DOM$4=DOMUtils$1.DOM;var appendStyle=function appendStyle(editor,text){var body=SugarElement.fromDom(editor.getBody());var container=getStyleContainer(getRootNode(body));var style=SugarElement.fromTag('style');set(style,'type','text/css');append(style,SugarElement.fromText(text));append(container,style);editor.on('remove',function(){remove(style);});};var getRootName=function getRootName(editor){return editor.inline?editor.getElement().nodeName.toLowerCase():undefined;};var removeUndefined=function removeUndefined(obj){return filter$1(obj,function(v){return isUndefined(v)===false;});};var mkParserSettings=function mkParserSettings(editor){var settings=editor.settings;var blobCache=editor.editorUpload.blobCache;return removeUndefined({allow_conditional_comments:settings.allow_conditional_comments,allow_html_data_urls:settings.allow_html_data_urls,allow_html_in_named_anchor:settings.allow_html_in_named_anchor,allow_script_urls:settings.allow_script_urls,allow_unsafe_link_target:settings.allow_unsafe_link_target,convert_fonts_to_spans:settings.convert_fonts_to_spans,fix_list_elements:settings.fix_list_elements,font_size_legacy_values:settings.font_size_legacy_values,forced_root_block:settings.forced_root_block,forced_root_block_attrs:settings.forced_root_block_attrs,padd_empty_with_br:settings.padd_empty_with_br,preserve_cdata:settings.preserve_cdata,remove_trailing_brs:settings.remove_trailing_brs,inline_styles:settings.inline_styles,root_name:getRootName(editor),validate:true,blob_cache:blobCache,images_dataimg_filter:settings.images_dataimg_filter});};var mkSerializerSettings=function mkSerializerSettings(editor){var settings=editor.settings;return _assign(_assign({},mkParserSettings(editor)),removeUndefined({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope,element_format:settings.element_format,entities:settings.entities,entity_encoding:settings.entity_encoding,indent:settings.indent,indent_after:settings.indent_after,indent_before:settings.indent_before,block_elements:settings.block_elements,boolean_attributes:settings.boolean_attributes,custom_elements:settings.custom_elements,extended_valid_elements:settings.extended_valid_elements,invalid_elements:settings.invalid_elements,invalid_styles:settings.invalid_styles,move_caret_before_on_enter_elements:settings.move_caret_before_on_enter_elements,non_empty_elements:settings.non_empty_elements,schema:settings.schema,self_closing_elements:settings.self_closing_elements,short_ended_elements:settings.short_ended_elements,special:settings.special,text_block_elements:settings.text_block_elements,text_inline_elements:settings.text_inline_elements,valid_children:settings.valid_children,valid_classes:settings.valid_classes,valid_elements:settings.valid_elements,valid_styles:settings.valid_styles,verify_html:settings.verify_html,whitespace_elements:settings.whitespace_elements}));};var createParser=function createParser(editor){var parser=DomParser(mkParserSettings(editor),editor.schema);parser.addAttributeFilter('src,href,style,tabindex',function(nodes,name){var i=nodes.length,node,value;var dom=editor.dom;var internalName='data-mce-'+name;while(i--){node=nodes[i];value=node.attr(name);if(value&&!node.attr(internalName)){if(value.indexOf('data:')===0||value.indexOf('blob:')===0){continue;}if(name==='style'){value=dom.serializeStyle(dom.parseStyle(value),node.name);if(!value.length){value=null;}node.attr(internalName,value);node.attr(name,value);}else if(name==='tabindex'){node.attr(internalName,value);node.attr(name,null);}else{node.attr(internalName,editor.convertURL(value,name,node.name));}}}});parser.addNodeFilter('script',function(nodes){var i=nodes.length;while(i--){var node=nodes[i];var type=node.attr('type')||'no/type';if(type.indexOf('mce-')!==0){node.attr('type','mce-'+type);}}});if(editor.settings.preserve_cdata){parser.addNodeFilter('#cdata',function(nodes){var i=nodes.length;while(i--){var node=nodes[i];node.type=8;node.name='#comment';node.value='[CDATA['+editor.dom.encode(node.value)+']]';}});}parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div',function(nodes){var i=nodes.length;var nonEmptyElements=editor.schema.getNonEmptyElements();while(i--){var node=nodes[i];if(node.isEmpty(nonEmptyElements)&&node.getAll('br').length===0){node.append(new AstNode('br',1)).shortEnded=true;}}});return parser;};var autoFocus=function autoFocus(editor){if(editor.settings.auto_focus){Delay.setEditorTimeout(editor,function(){var focusEditor;if(editor.settings.auto_focus===true){focusEditor=editor;}else{focusEditor=editor.editorManager.get(editor.settings.auto_focus);}if(!focusEditor.destroyed){focusEditor.focus();}},100);}};var moveSelectionToFirstCaretPosition=function moveSelectionToFirstCaretPosition(editor){var root=editor.dom.getRoot();if(!editor.inline&&(!hasAnyRanges(editor)||editor.selection.getStart(true)===root)){firstPositionIn(root).each(function(pos){var node=pos.getNode();var caretPos=isTable(node)?firstPositionIn(node).getOr(pos):pos;if(Env.browser.isIE()){storeNative(editor,caretPos.toRange());}else{editor.selection.setRng(caretPos.toRange());}});}};var initEditor=function initEditor(editor){editor.bindPendingEventDelegates();editor.initialized=true;fireInit(editor);editor.focus(true);moveSelectionToFirstCaretPosition(editor);editor.nodeChanged({initial:true});editor.execCallback('init_instance_callback',editor);autoFocus(editor);};var getStyleSheetLoader=function getStyleSheetLoader(editor){return editor.inline?editor.ui.styleSheetLoader:editor.dom.styleSheetLoader;};var loadContentCss=function loadContentCss(editor,css){var styleSheetLoader=getStyleSheetLoader(editor);var loaded=function loaded(){editor.on('remove',function(){return styleSheetLoader.unloadAll(css);});initEditor(editor);};styleSheetLoader.loadAll(css,loaded,loaded);};var preInit=function preInit(editor,rtcMode){var settings=editor.settings,doc=editor.getDoc(),body=editor.getBody();if(!settings.browser_spellcheck&&!settings.gecko_spellcheck){doc.body.spellcheck=false;DOM$4.setAttrib(body,'spellcheck','false');}editor.quirks=Quirks(editor);firePostRender(editor);var directionality=getDirectionality(editor);if(directionality!==undefined){body.dir=directionality;}if(settings.protect){editor.on('BeforeSetContent',function(e){Tools.each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return'<!--mce:protected '+escape(str)+'-->';});});});}editor.on('SetContent',function(){editor.addVisual(editor.getBody());});if(rtcMode===false){editor.load({initial:true,format:'html'});}editor.startContent=editor.getContent({format:'raw'});editor.on('compositionstart compositionend',function(e){editor.composing=e.type==='compositionstart';});if(editor.contentStyles.length>0){var contentCssText_1='';Tools.each(editor.contentStyles,function(style){contentCssText_1+=style+'\r\n';});editor.dom.addStyle(contentCssText_1);}loadContentCss(editor,editor.contentCSS);if(settings.content_style){appendStyle(editor,settings.content_style);}};var initContentBody=function initContentBody(editor,skipWrite){var settings=editor.settings;var targetElm=editor.getElement();var doc=editor.getDoc();if(!settings.inline){editor.getElement().style.visibility=editor.orgVisibility;}if(!skipWrite&&!editor.inline){doc.open();doc.write(editor.iframeHTML);doc.close();}if(editor.inline){DOM$4.addClass(targetElm,'mce-content-body');editor.contentDocument=doc=document;editor.contentWindow=window;editor.bodyElement=targetElm;editor.contentAreaContainer=targetElm;}var body=editor.getBody();body.disabled=true;editor.readonly=!!settings.readonly;if(!editor.readonly){if(editor.inline&&DOM$4.getStyle(body,'position',true)==='static'){body.style.position='relative';}body.contentEditable=editor.getParam('content_editable_state',true);}body.disabled=false;editor.editorUpload=EditorUpload(editor);editor.schema=Schema(settings);editor.dom=DOMUtils$1(doc,{keep_values:true,url_converter:editor.convertURL,url_converter_scope:editor,hex_colors:settings.force_hex_style_colors,update_styles:true,root_element:editor.inline?editor.getBody():null,collect:function collect(){return editor.inline;},schema:editor.schema,contentCssCors:shouldUseContentCssCors(editor),referrerPolicy:getReferrerPolicy(editor),onSetAttrib:function onSetAttrib(e){editor.fire('SetAttrib',e);}});editor.parser=createParser(editor);editor.serializer=DomSerializer(mkSerializerSettings(editor),editor);editor.selection=EditorSelection(editor.dom,editor.getWin(),editor.serializer,editor);editor.annotator=Annotator(editor);editor.formatter=Formatter(editor);editor.undoManager=UndoManager(editor);editor._nodeChangeDispatcher=new NodeChange(editor);editor._selectionOverrides=SelectionOverrides(editor);setup$9(editor);setup$j(editor);if(!isRtc(editor)){setup$k(editor);}var caret=setup$i(editor);setup$8(editor,caret);setup$a(editor);setup$7(editor);firePreInit(editor);setup$4(editor).fold(function(){preInit(editor,false);},function(loadingRtc){editor.setProgressState(true);loadingRtc.then(function(rtcMode){editor.setProgressState(false);preInit(editor,rtcMode);});});};var DOM$5=DOMUtils$1.DOM;var relaxDomain=function relaxDomain(editor,ifr){if(document.domain!==window.location.hostname&&Env.browser.isIE()){var bodyUuid=uuid('mce');editor[bodyUuid]=function(){initContentBody(editor);};var domainRelaxUrl='javascript:(function(){'+'document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+editor.id+'");document.write(ed.iframeHTML);'+'document.close();ed.'+bodyUuid+'(true);})()';DOM$5.setAttrib(ifr,'src',domainRelaxUrl);return true;}return false;};var createIframeElement=function createIframeElement(id,title,height,customAttrs){var iframe=SugarElement.fromTag('iframe');setAll(iframe,customAttrs);setAll(iframe,{id:id+'_ifr',frameBorder:'0',allowTransparency:'true',title:title});add$3(iframe,'tox-edit-area__iframe');return iframe;};var getIframeHtml=function getIframeHtml(editor){var iframeHTML=getDocType(editor)+'<html><head>';if(getDocumentBaseUrl(editor)!==editor.documentBaseUrl){iframeHTML+='<base href="'+editor.documentBaseURI.getURI()+'" />';}iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var bodyId=getBodyId(editor);var bodyClass=getBodyClass(editor);if(getContentSecurityPolicy(editor)){iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+getContentSecurityPolicy(editor)+'" />';}iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+editor.id+'"><br></body></html>';return iframeHTML;};var createIframe=function createIframe(editor,o){var title=editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');var ifr=createIframeElement(editor.id,title,o.height,getIframeAttrs(editor)).dom;ifr.onload=function(){ifr.onload=null;editor.fire('load');};var isDomainRelaxed=relaxDomain(editor,ifr);editor.contentAreaContainer=o.iframeContainer;editor.iframeElement=ifr;editor.iframeHTML=getIframeHtml(editor);DOM$5.add(o.iframeContainer,ifr);return isDomainRelaxed;};var init$1=function init$1(editor,boxInfo){var isDomainRelaxed=createIframe(editor,boxInfo);if(boxInfo.editorContainer){DOM$5.get(boxInfo.editorContainer).style.display=editor.orgDisplay;editor.hidden=DOM$5.isHidden(boxInfo.editorContainer);}editor.getElement().style.display='none';DOM$5.setAttrib(editor.id,'aria-hidden','true');if(!isDomainRelaxed){initContentBody(editor);}};var DOM$6=DOMUtils$1.DOM;var initPlugin=function initPlugin(editor,initializedPlugins,plugin){var Plugin=PluginManager.get(plugin);var pluginUrl=PluginManager.urls[plugin]||editor.documentBaseUrl.replace(/\/$/,'');plugin=Tools.trim(plugin);if(Plugin&&Tools.inArray(initializedPlugins,plugin)===-1){Tools.each(PluginManager.dependencies(plugin),function(dep){initPlugin(editor,initializedPlugins,dep);});if(editor.plugins[plugin]){return;}try{var pluginInstance=new Plugin(editor,pluginUrl,editor.$);editor.plugins[plugin]=pluginInstance;if(pluginInstance.init){pluginInstance.init(editor,pluginUrl);initializedPlugins.push(plugin);}}catch(e){pluginInitError(editor,plugin,e);}}};var trimLegacyPrefix=function trimLegacyPrefix(name){return name.replace(/^\-/,'');};var initPlugins=function initPlugins(editor){var initializedPlugins=[];Tools.each(getPlugins(editor).split(/[ ,]/),function(name){initPlugin(editor,initializedPlugins,trimLegacyPrefix(name));});};var initIcons=function initIcons(editor){var iconPackName=Tools.trim(getIconPackName(editor));var currentIcons=editor.ui.registry.getAll().icons;var loadIcons=_assign(_assign({},IconManager.get('default').icons),IconManager.get(iconPackName).icons);each$1(loadIcons,function(svgData,icon){if(!has(currentIcons,icon)){editor.ui.registry.addIcon(icon,svgData);}});};var initTheme=function initTheme(editor){var theme=getTheme(editor);if(isString(theme)){editor.settings.theme=trimLegacyPrefix(theme);var Theme=ThemeManager.get(theme);editor.theme=new Theme(editor,ThemeManager.urls[theme]);if(editor.theme.init){editor.theme.init(editor,ThemeManager.urls[theme]||editor.documentBaseUrl.replace(/\/$/,''),editor.$);}}else{editor.theme={};}};var renderFromLoadedTheme=function renderFromLoadedTheme(editor){return editor.theme.renderUI();};var renderFromThemeFunc=function renderFromThemeFunc(editor){var elm=editor.getElement();var theme=getTheme(editor);var info=theme(editor,elm);if(info.editorContainer.nodeType){info.editorContainer.id=info.editorContainer.id||editor.id+'_parent';}if(info.iframeContainer&&info.iframeContainer.nodeType){info.iframeContainer.id=info.iframeContainer.id||editor.id+'_iframecontainer';}info.height=info.iframeHeight?info.iframeHeight:elm.offsetHeight;return info;};var createThemeFalseResult=function createThemeFalseResult(element){return{editorContainer:element,iframeContainer:element,api:{}};};var renderThemeFalseIframe=function renderThemeFalseIframe(targetElement){var iframeContainer=DOM$6.create('div');DOM$6.insertAfter(iframeContainer,targetElement);return createThemeFalseResult(iframeContainer);};var renderThemeFalse=function renderThemeFalse(editor){var targetElement=editor.getElement();return editor.inline?createThemeFalseResult(null):renderThemeFalseIframe(targetElement);};var renderThemeUi=function renderThemeUi(editor){var elm=editor.getElement();editor.orgDisplay=elm.style.display;if(isString(getTheme(editor))){return renderFromLoadedTheme(editor);}else if(isFunction(getTheme(editor))){return renderFromThemeFunc(editor);}else{return renderThemeFalse(editor);}};var init$2=function init$2(editor){editor.fire('ScriptsLoaded');initIcons(editor);initTheme(editor);initPlugins(editor);var renderInfo=renderThemeUi(editor);editor.ui=_assign(_assign({},editor.ui),renderInfo.api);var boxInfo={editorContainer:renderInfo.editorContainer,iframeContainer:renderInfo.iframeContainer};editor.editorContainer=boxInfo.editorContainer?boxInfo.editorContainer:null;appendContentCssFromSettings(editor);if(editor.inline){return initContentBody(editor);}else{return init$1(editor,boxInfo);}};var DOM$7=DOMUtils$1.DOM;var hasSkipLoadPrefix=function hasSkipLoadPrefix(name){return name.charAt(0)==='-';};var loadLanguage=function loadLanguage(scriptLoader,editor){var languageCode=getLanguageCode(editor);var languageUrl=getLanguageUrl(editor);if(I18n.hasCode(languageCode)===false&&languageCode!=='en'){var url_1=languageUrl!==''?languageUrl:editor.editorManager.baseURL+'/langs/'+languageCode+'.js';scriptLoader.add(url_1,noop,undefined,function(){languageLoadError(editor,url_1,languageCode);});}};var loadTheme=function loadTheme(scriptLoader,editor,suffix,callback){var theme=getTheme(editor);if(isString(theme)){if(!hasSkipLoadPrefix(theme)&&!ThemeManager.urls.hasOwnProperty(theme)){var themeUrl=getThemeUrl(editor);if(themeUrl){ThemeManager.load(theme,editor.documentBaseURI.toAbsolute(themeUrl));}else{ThemeManager.load(theme,'themes/'+theme+'/theme'+suffix+'.js');}}scriptLoader.loadQueue(function(){ThemeManager.waitFor(theme,callback);});}else{callback();}};var getIconsUrlMetaFromUrl=function getIconsUrlMetaFromUrl(editor){return Optional.from(getIconsUrl(editor)).filter(function(url){return url.length>0;}).map(function(url){return{url:url,name:Optional.none()};});};var getIconsUrlMetaFromName=function getIconsUrlMetaFromName(editor,name,suffix){return Optional.from(name).filter(function(name){return name.length>0&&!IconManager.has(name);}).map(function(name){return{url:editor.editorManager.baseURL+'/icons/'+name+'/icons'+suffix+'.js',name:Optional.some(name)};});};var loadIcons=function loadIcons(scriptLoader,editor,suffix){var defaultIconsUrl=getIconsUrlMetaFromName(editor,'default',suffix);var customIconsUrl=getIconsUrlMetaFromUrl(editor).orThunk(function(){return getIconsUrlMetaFromName(editor,getIconPackName(editor),'');});each(cat([defaultIconsUrl,customIconsUrl]),function(urlMeta){scriptLoader.add(urlMeta.url,noop,undefined,function(){iconsLoadError(editor,urlMeta.url,urlMeta.name.getOrUndefined());});});};var loadPlugins=function loadPlugins(editor,suffix){Tools.each(getExternalPlugins(editor),function(url,name){PluginManager.load(name,url,noop,undefined,function(){pluginLoadError(editor,url,name);});editor.settings.plugins+=' '+name;});Tools.each(getPlugins(editor).split(/[ ,]/),function(plugin){plugin=Tools.trim(plugin);if(plugin&&!PluginManager.urls[plugin]){if(hasSkipLoadPrefix(plugin)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);Tools.each(dependencies,function(depPlugin){var defaultSettings={prefix:'plugins/',resource:depPlugin,suffix:'/plugin'+suffix+'.js'};var dep=PluginManager.createUrl(defaultSettings,depPlugin);PluginManager.load(dep.resource,dep,noop,undefined,function(){pluginLoadError(editor,dep.prefix+dep.resource+dep.suffix,dep.resource);});});}else{var url_2={prefix:'plugins/',resource:plugin,suffix:'/plugin'+suffix+'.js'};PluginManager.load(plugin,url_2,noop,undefined,function(){pluginLoadError(editor,url_2.prefix+url_2.resource+url_2.suffix,plugin);});}}});};var loadScripts=function loadScripts(editor,suffix){var scriptLoader=ScriptLoader.ScriptLoader;loadTheme(scriptLoader,editor,suffix,function(){loadLanguage(scriptLoader,editor);loadIcons(scriptLoader,editor,suffix);loadPlugins(editor,suffix);scriptLoader.loadQueue(function(){if(!editor.removed){init$2(editor);}},editor,function(){if(!editor.removed){init$2(editor);}});});};var getStyleSheetLoader$1=function getStyleSheetLoader$1(element,editor){return instance.forElement(element,{contentCssCors:hasContentCssCors(editor),referrerPolicy:getReferrerPolicy(editor)});};var render=function render(editor){var id=editor.id;I18n.setCode(getLanguageCode(editor));var readyHandler=function readyHandler(){DOM$7.unbind(window,'ready',readyHandler);editor.render();};if(!EventUtils.Event.domLoaded){DOM$7.bind(window,'ready',readyHandler);return;}if(!editor.getElement()){return;}if(!Env.contentEditable){return;}var element=SugarElement.fromDom(editor.getElement());var snapshot=clone(element);editor.on('remove',function(){eachr(element.dom.attributes,function(attr){return remove$1(element,attr.name);});setAll(element,snapshot);});editor.ui.styleSheetLoader=getStyleSheetLoader$1(element,editor);if(!isInline$1(editor)){editor.orgVisibility=editor.getElement().style.visibility;editor.getElement().style.visibility='hidden';}else{editor.inline=true;}var form=editor.getElement().form||DOM$7.getParent(id,'form');if(form){editor.formElement=form;if(hasHiddenInput(editor)&&!isTextareaOrInput(editor.getElement())){DOM$7.insertAfter(DOM$7.create('input',{type:'hidden',name:id}),id);editor.hasHiddenInput=true;}editor.formEventDelegate=function(e){editor.fire(e.type,e);};DOM$7.bind(form,'submit reset',editor.formEventDelegate);editor.on('reset',function(){editor.resetContent();});if(shouldPatchSubmit(editor)&&!form.submit.nodeType&&!form.submit.length&&!form._mceOldSubmit){form._mceOldSubmit=form.submit;form.submit=function(){editor.editorManager.triggerSave();editor.setDirty(false);return form._mceOldSubmit(form);};}}editor.windowManager=WindowManager(editor);editor.notificationManager=NotificationManager(editor);if(isEncodingXml(editor)){editor.on('GetContent',function(e){if(e.save){e.content=DOM$7.encode(e.content);}});}if(shouldAddFormSubmitTrigger(editor)){editor.on('submit',function(){if(editor.initialized){editor.save();}});}if(shouldAddUnloadTrigger(editor)){editor._beforeUnload=function(){if(editor.initialized&&!editor.destroyed&&!editor.isHidden()){editor.save({format:'raw',no_events:true,set_dirty:false});}};editor.editorManager.on('BeforeUnload',editor._beforeUnload);}editor.editorManager.add(editor);loadScripts(editor,editor.suffix);};var ensureIsRoot=function ensureIsRoot(isRoot){return isFunction(isRoot)?isRoot:never;};var ancestor$3=function ancestor$3(scope,transform,isRoot){var element=scope.dom;var stop=ensureIsRoot(isRoot);while(element.parentNode){element=element.parentNode;var el=SugarElement.fromDom(element);var transformed=transform(el);if(transformed.isSome()){return transformed;}else if(stop(el)){break;}}return Optional.none();};var closest$2=function closest$2(scope,transform,isRoot){var current=transform(scope);var stop=ensureIsRoot(isRoot);return current.orThunk(function(){return stop(scope)?Optional.none():ancestor$3(scope,transform,stop);});};var legacyPropNames={'font-size':'size','font-family':'face'};var getSpecifiedFontProp=function getSpecifiedFontProp(propName,rootElm,elm){var getProperty=function getProperty(elm){return getRaw(elm,propName).orThunk(function(){if(name(elm)==='font'){return get(legacyPropNames,propName).bind(function(legacyPropName){return getOpt(elm,legacyPropName);});}else{return Optional.none();}});};var isRoot=function isRoot(elm){return eq$2(SugarElement.fromDom(rootElm),elm);};return closest$2(SugarElement.fromDom(elm),function(elm){return getProperty(elm);},isRoot);};var normalizeFontFamily=function normalizeFontFamily(fontFamily){return fontFamily.replace(/[\'\"\\]/g,'').replace(/,\s+/g,',');};var getComputedFontProp=function getComputedFontProp(propName,elm){return Optional.from(DOMUtils$1.DOM.getStyle(elm,propName,true));};var getFontProp=function getFontProp(propName){return function(rootElm,elm){return Optional.from(elm).map(SugarElement.fromDom).filter(isElement).bind(function(element){return getSpecifiedFontProp(propName,rootElm,element.dom).or(getComputedFontProp(propName,element.dom));}).getOr('');};};var getFontSize=getFontProp('font-size');var getFontFamily=compose(normalizeFontFamily,getFontProp('font-family'));var findFirstCaretElement=function findFirstCaretElement(editor){return firstPositionIn(editor.getBody()).map(function(caret){var container=caret.container();return isText$1(container)?container.parentNode:container;});};var getCaretElement=function getCaretElement(editor){return Optional.from(editor.selection.getRng()).bind(function(rng){var root=editor.getBody();var atStartOfNode=rng.startContainer===root&&rng.startOffset===0;return atStartOfNode?Optional.none():Optional.from(editor.selection.getStart(true));});};var mapRange=function mapRange(editor,mapper){return getCaretElement(editor).orThunk(curry(findFirstCaretElement,editor)).map(SugarElement.fromDom).filter(isElement).map(mapper);};var fromFontSizeNumber=function fromFontSizeNumber(editor,value){if(/^[0-9.]+$/.test(value)){var fontSizeNumber=parseInt(value,10);if(fontSizeNumber>=1&&fontSizeNumber<=7){var fontSizes=getFontStyleValues(editor);var fontClasses=getFontSizeClasses(editor);if(fontClasses){return fontClasses[fontSizeNumber-1]||value;}else{return fontSizes[fontSizeNumber-1]||value;}}else{return value;}}else{return value;}};var normalizeFontNames=function normalizeFontNames(font){var fonts=font.split(/\s*,\s*/);return map(fonts,function(font){if(font.indexOf(' ')!==-1&&!(startsWith(font,'"')||startsWith(font,'\''))){return'\''+font+'\'';}else{return font;}}).join(',');};var fontNameAction=function fontNameAction(editor,value){var font=fromFontSizeNumber(editor,value);editor.formatter.toggle('fontname',{value:normalizeFontNames(font)});editor.nodeChanged();};var fontNameQuery=function fontNameQuery(editor){return mapRange(editor,function(elm){return getFontFamily(editor.getBody(),elm.dom);}).getOr('');};var fontSizeAction=function fontSizeAction(editor,value){editor.formatter.toggle('fontsize',{value:fromFontSizeNumber(editor,value)});editor.nodeChanged();};var fontSizeQuery=function fontSizeQuery(editor){return mapRange(editor,function(elm){return getFontSize(editor.getBody(),elm.dom);}).getOr('');};var lineHeightQuery=function lineHeightQuery(editor){return mapRange(editor,function(elm){var root=SugarElement.fromDom(editor.getBody());var specifiedStyle=closest$2(elm,function(elm){return getRaw(elm,'line-height');},curry(eq$2,root));var computedStyle=function computedStyle(){var lineHeight=parseFloat(get$4(elm,'line-height'));var fontSize=parseFloat(get$4(elm,'font-size'));return String(lineHeight/fontSize);};return specifiedStyle.getOrThunk(computedStyle);}).getOr('');};var lineHeightAction=function lineHeightAction(editor,lineHeight){editor.undoManager.transact(function(){editor.formatter.toggle('lineheight',{value:String(lineHeight)});editor.nodeChanged();});};var processValue=function processValue(value){var details;if(typeof value!=='string'){details=Tools.extend({paste:value.paste,data:{paste:value.paste}},value);return{content:value.content,details:details};}return{content:value,details:{}};};var insertAtCaret$1=function insertAtCaret$1(editor,value){var result=processValue(value);insertContent(editor,result.content,result.details);};var each$f=Tools.each;var map$3=Tools.map,inArray$2=Tools.inArray;var EditorCommands=function(){function EditorCommands(editor){this.commands={state:{},exec:{},value:{}};this.editor=editor;this.setupCommands(editor);}EditorCommands.prototype.execCommand=function(command,ui,value,args){var func,state=false;var self=this;if(self.editor.removed){return;}if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)&&(!args||!args.skip_focus)){self.editor.focus();}else{restore(self.editor);}args=self.editor.fire('BeforeExecCommand',{command:command,ui:ui,value:value});if(args.isDefaultPrevented()){return false;}var customCommand=command.toLowerCase();if(func=self.commands.exec[customCommand]){func(customCommand,ui,value);self.editor.fire('ExecCommand',{command:command,ui:ui,value:value});return true;}each$f(this.editor.plugins,function(p){if(p.execCommand&&p.execCommand(command,ui,value)){self.editor.fire('ExecCommand',{command:command,ui:ui,value:value});state=true;return false;}});if(state){return state;}if(self.editor.theme&&self.editor.theme.execCommand&&self.editor.theme.execCommand(command,ui,value)){self.editor.fire('ExecCommand',{command:command,ui:ui,value:value});return true;}try{state=self.editor.getDoc().execCommand(command,ui,value);}catch(ex){}if(state){self.editor.fire('ExecCommand',{command:command,ui:ui,value:value});return true;}return false;};EditorCommands.prototype.queryCommandState=function(command){var func;if(this.editor.quirks.isHidden()||this.editor.removed){return;}command=command.toLowerCase();if(func=this.commands.state[command]){return func(command);}try{return this.editor.getDoc().queryCommandState(command);}catch(ex){}return false;};EditorCommands.prototype.queryCommandValue=function(command){var func;if(this.editor.quirks.isHidden()||this.editor.removed){return;}command=command.toLowerCase();if(func=this.commands.value[command]){return func(command);}try{return this.editor.getDoc().queryCommandValue(command);}catch(ex){}};EditorCommands.prototype.addCommands=function(commandList,type){if(type===void 0){type='exec';}var self=this;each$f(commandList,function(callback,command){each$f(command.toLowerCase().split(','),function(command){self.commands[type][command]=callback;});});};EditorCommands.prototype.addCommand=function(command,callback,scope){var _this=this;command=command.toLowerCase();this.commands.exec[command]=function(command,ui,value,args){return callback.call(scope||_this.editor,ui,value,args);};};EditorCommands.prototype.queryCommandSupported=function(command){command=command.toLowerCase();if(this.commands.exec[command]){return true;}try{return this.editor.getDoc().queryCommandSupported(command);}catch(ex){}return false;};EditorCommands.prototype.addQueryStateHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase();this.commands.state[command]=function(){return callback.call(scope||_this.editor);};};EditorCommands.prototype.addQueryValueHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase();this.commands.value[command]=function(){return callback.call(scope||_this.editor);};};EditorCommands.prototype.hasCustomCommand=function(command){command=command.toLowerCase();return!!this.commands.exec[command];};EditorCommands.prototype.execNativeCommand=function(command,ui,value){if(ui===undefined){ui=false;}if(value===undefined){value=null;}return this.editor.getDoc().execCommand(command,ui,value);};EditorCommands.prototype.isFormatMatch=function(name){return this.editor.formatter.match(name);};EditorCommands.prototype.toggleFormat=function(name,value){this.editor.formatter.toggle(name,value?{value:value}:undefined);this.editor.nodeChanged();};EditorCommands.prototype.storeSelection=function(type){this.selectionBookmark=this.editor.selection.getBookmark(type);};EditorCommands.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark);};EditorCommands.prototype.setupCommands=function(editor){var self=this;this.addCommands({'mceResetDesignMode,mceBeginUndoLevel':function mceResetDesignModeMceBeginUndoLevel(){},'mceEndUndoLevel,mceAddUndoLevel':function mceEndUndoLevelMceAddUndoLevel(){editor.undoManager.add();},'Cut,Copy,Paste':function CutCopyPaste(command){var doc=editor.getDoc();var failed;try{self.execNativeCommand(command);}catch(ex){failed=true;}if(command==='paste'&&!doc.queryCommandEnabled(command)){failed=true;}if(failed||!doc.queryCommandSupported(command)){var msg=editor.translate('Your browser doesn\'t support direct access to the clipboard. '+'Please use the Ctrl+X/C/V keyboard shortcuts instead.');if(Env.mac){msg=msg.replace(/Ctrl\+/g,"\u2318+");}editor.notificationManager.open({text:msg,type:'error'});}},'unlink':function unlink(){if(editor.selection.isCollapsed()){var elm=editor.dom.getParent(editor.selection.getStart(),'a');if(elm){editor.dom.remove(elm,true);}return;}editor.formatter.remove('link');},'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone':function JustifyLeftJustifyCenterJustifyRightJustifyFullJustifyNone(command){var align=command.substring(7);if(align==='full'){align='justify';}each$f('left,center,right,justify'.split(','),function(name){if(align!==name){editor.formatter.remove('align'+name);}});if(align!=='none'){self.toggleFormat('align'+align);}},'InsertUnorderedList,InsertOrderedList':function InsertUnorderedListInsertOrderedList(command){var listParent;self.execNativeCommand(command);var listElm=editor.dom.getParent(editor.selection.getNode(),'ol,ul');if(listElm){listParent=listElm.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){self.storeSelection();editor.dom.split(listParent,listElm);self.restoreSelection();}}},'Bold,Italic,Underline,Strikethrough,Superscript,Subscript':function BoldItalicUnderlineStrikethroughSuperscriptSubscript(command){self.toggleFormat(command);},'ForeColor,HiliteColor':function ForeColorHiliteColor(command,ui,value){self.toggleFormat(command,value);},'FontName':function FontName(command,ui,value){fontNameAction(editor,value);},'FontSize':function FontSize(command,ui,value){fontSizeAction(editor,value);},'LineHeight':function LineHeight(command,ui,value){lineHeightAction(editor,value);},'RemoveFormat':function RemoveFormat(command){editor.formatter.remove(command);},'mceBlockQuote':function mceBlockQuote(){self.toggleFormat('blockquote');},'FormatBlock':function FormatBlock(command,ui,value){return self.toggleFormat(value||'p');},'mceCleanup':function mceCleanup(){var bookmark=editor.selection.getBookmark();editor.setContent(editor.getContent());editor.selection.moveToBookmark(bookmark);},'mceRemoveNode':function mceRemoveNode(command,ui,value){var node=value||editor.selection.getNode();if(node!==editor.getBody()){self.storeSelection();editor.dom.remove(node,true);self.restoreSelection();}},'mceSelectNodeDepth':function mceSelectNodeDepth(command,ui,value){var counter=0;editor.dom.getParent(editor.selection.getNode(),function(node){if(node.nodeType===1&&counter++===value){editor.selection.select(node);return false;}},editor.getBody());},'mceSelectNode':function mceSelectNode(command,ui,value){editor.selection.select(value);},'mceInsertContent':function mceInsertContent(command,ui,value){insertAtCaret$1(editor,value);},'mceInsertRawHTML':function mceInsertRawHTML(command,ui,value){editor.selection.setContent('tiny_mce_marker');var content=editor.getContent();editor.setContent(content.replace(/tiny_mce_marker/g,function(){return value;}));},'mceInsertNewLine':function mceInsertNewLine(command,ui,value){insert$3(editor,value);},'mceToggleFormat':function mceToggleFormat(command,ui,value){self.toggleFormat(value);},'mceSetContent':function mceSetContent(command,ui,value){editor.setContent(value);},'Indent,Outdent':function IndentOutdent(command){handle(editor,command);},'mceRepaint':function mceRepaint(){},'InsertHorizontalRule':function InsertHorizontalRule(){editor.execCommand('mceInsertContent',false,'<hr />');},'mceToggleVisualAid':function mceToggleVisualAid(){editor.hasVisual=!editor.hasVisual;editor.addVisual();},'mceReplaceContent':function mceReplaceContent(command,ui,value){editor.execCommand('mceInsertContent',false,value.replace(/\{\$selection\}/g,editor.selection.getContent({format:'text'})));},'mceInsertLink':function mceInsertLink(command,ui,value){if(typeof value==='string'){value={href:value};}var anchor=editor.dom.getParent(editor.selection.getNode(),'a');value.href=value.href.replace(/ /g,'%20');if(!anchor||!value.href){editor.formatter.remove('link');}if(value.href){editor.formatter.apply('link',value,anchor);}},'selectAll':function selectAll(){var editingHost=editor.dom.getParent(editor.selection.getStart(),isContentEditableTrue);if(editingHost){var rng=editor.dom.createRng();rng.selectNodeContents(editingHost);editor.selection.setRng(rng);}},'mceNewDocument':function mceNewDocument(){editor.setContent('');},'InsertLineBreak':function InsertLineBreak(command,ui,value){insert$2(editor,value);return true;}});var alignStates=function alignStates(name){return function(){var selection=editor.selection;var nodes=selection.isCollapsed()?[editor.dom.getParent(selection.getNode(),editor.dom.isBlock)]:selection.getSelectedBlocks();var matches=map$3(nodes,function(node){return!!editor.formatter.matchNode(node,name);});return inArray$2(matches,true)!==-1;};};self.addCommands({'JustifyLeft':alignStates('alignleft'),'JustifyCenter':alignStates('aligncenter'),'JustifyRight':alignStates('alignright'),'JustifyFull':alignStates('alignjustify'),'Bold,Italic,Underline,Strikethrough,Superscript,Subscript':function BoldItalicUnderlineStrikethroughSuperscriptSubscript(command){return self.isFormatMatch(command);},'mceBlockQuote':function mceBlockQuote(){return self.isFormatMatch('blockquote');},'Outdent':function Outdent(){return canOutdent(editor);},'InsertUnorderedList,InsertOrderedList':function InsertUnorderedListInsertOrderedList(command){var list=editor.dom.getParent(editor.selection.getNode(),'ul,ol');return list&&(command==='insertunorderedlist'&&list.tagName==='UL'||command==='insertorderedlist'&&list.tagName==='OL');}},'state');self.addCommands({Undo:function Undo(){editor.undoManager.undo();},Redo:function Redo(){editor.undoManager.redo();}});self.addQueryValueHandler('FontName',function(){return fontNameQuery(editor);},this);self.addQueryValueHandler('FontSize',function(){return fontSizeQuery(editor);},this);self.addQueryValueHandler('LineHeight',function(){return lineHeightQuery(editor);},this);};return EditorCommands;}();var internalContentEditableAttr='data-mce-contenteditable';var toggleClass=function toggleClass(elm,cls,state){if(has$2(elm,cls)&&state===false){remove$4(elm,cls);}else if(state){add$3(elm,cls);}};var setEditorCommandState=function setEditorCommandState(editor,cmd,state){try{editor.getDoc().execCommand(cmd,false,String(state));}catch(ex){}};var setContentEditable=function setContentEditable(elm,state){elm.dom.contentEditable=state?'true':'false';};var switchOffContentEditableTrue=function switchOffContentEditableTrue(elm){each(descendants$1(elm,'*[contenteditable="true"]'),function(elm){set(elm,internalContentEditableAttr,'true');setContentEditable(elm,false);});};var switchOnContentEditableTrue=function switchOnContentEditableTrue(elm){each(descendants$1(elm,'*['+internalContentEditableAttr+'="true"]'),function(elm){remove$1(elm,internalContentEditableAttr);setContentEditable(elm,true);});};var removeFakeSelection=function removeFakeSelection(editor){Optional.from(editor.selection.getNode()).each(function(elm){elm.removeAttribute('data-mce-selected');});};var restoreFakeSelection=function restoreFakeSelection(editor){editor.selection.setRng(editor.selection.getRng());};var toggleReadOnly=function toggleReadOnly(editor,state){var body=SugarElement.fromDom(editor.getBody());toggleClass(body,'mce-content-readonly',state);if(state){editor.selection.controlSelection.hideResizeRect();editor._selectionOverrides.hideFakeCaret();removeFakeSelection(editor);editor.readonly=true;setContentEditable(body,false);switchOffContentEditableTrue(body);}else{editor.readonly=false;setContentEditable(body,true);switchOnContentEditableTrue(body);setEditorCommandState(editor,'StyleWithCSS',false);setEditorCommandState(editor,'enableInlineTableEditing',false);setEditorCommandState(editor,'enableObjectResizing',false);if(hasEditorOrUiFocus(editor)){editor.focus();}restoreFakeSelection(editor);editor.nodeChanged();}};var isReadOnly$1=function isReadOnly$1(editor){return editor.readonly;};var registerFilters=function registerFilters(editor){editor.parser.addAttributeFilter('contenteditable',function(nodes){if(isReadOnly$1(editor)){each(nodes,function(node){node.attr(internalContentEditableAttr,node.attr('contenteditable'));node.attr('contenteditable','false');});}});editor.serializer.addAttributeFilter(internalContentEditableAttr,function(nodes){if(isReadOnly$1(editor)){each(nodes,function(node){node.attr('contenteditable',node.attr(internalContentEditableAttr));});}});editor.serializer.addTempAttr(internalContentEditableAttr);};var registerReadOnlyContentFilters=function registerReadOnlyContentFilters(editor){if(editor.serializer){registerFilters(editor);}else{editor.on('PreInit',function(){registerFilters(editor);});}};var isClickEvent=function isClickEvent(e){return e.type==='click';};var isInAnchor=function isInAnchor(editor,target){return editor.dom.getParent(target,'a')!==null;};var preventReadOnlyEvents=function preventReadOnlyEvents(editor,e){var target=e.target;if(isClickEvent(e)&&!VK.metaKeyPressed(e)&&isInAnchor(editor,target)){e.preventDefault();}};var registerReadOnlySelectionBlockers=function registerReadOnlySelectionBlockers(editor){editor.on('ShowCaret',function(e){if(isReadOnly$1(editor)){e.preventDefault();}});editor.on('ObjectSelected',function(e){if(isReadOnly$1(editor)){e.preventDefault();}});};var nativeEvents=Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange '+'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover '+'draggesture dragdrop drop drag submit '+'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel',' ');var EventDispatcher=function(){function EventDispatcher(settings){this.bindings={};this.settings=settings||{};this.scope=this.settings.scope||this;this.toggleEvent=this.settings.toggleEvent||never;}EventDispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()];};EventDispatcher.prototype.fire=function(nameIn,argsIn){var name=nameIn.toLowerCase();var args=argsIn||{};args.type=name;if(!args.target){args.target=this.scope;}if(!args.preventDefault){args.preventDefault=function(){args.isDefaultPrevented=always;};args.stopPropagation=function(){args.isPropagationStopped=always;};args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=always;};args.isDefaultPrevented=never;args.isPropagationStopped=never;args.isImmediatePropagationStopped=never;}if(this.settings.beforeFire){this.settings.beforeFire(args);}var handlers=this.bindings[name];if(handlers){for(var i=0,l=handlers.length;i<l;i++){var callback=handlers[i];if(callback.once){this.off(name,callback.func);}if(args.isImmediatePropagationStopped()){args.stopPropagation();return args;}if(callback.func.call(this.scope,args)===false){args.preventDefault();return args;}}}return args;};EventDispatcher.prototype.on=function(name,callback,prepend,extra){if(callback===false){callback=never;}if(callback){var wrappedCallback={func:callback};if(extra){Tools.extend(wrappedCallback,extra);}var names=name.toLowerCase().split(' ');var i=names.length;while(i--){var currentName=names[i];var handlers=this.bindings[currentName];if(!handlers){handlers=this.bindings[currentName]=[];this.toggleEvent(currentName,true);}if(prepend){handlers.unshift(wrappedCallback);}else{handlers.push(wrappedCallback);}}}return this;};EventDispatcher.prototype.off=function(name,callback){var _this=this;if(name){var names=name.toLowerCase().split(' ');var i=names.length;while(i--){var currentName=names[i];var handlers=this.bindings[currentName];if(!currentName){each$1(this.bindings,function(_value,bindingName){_this.toggleEvent(bindingName,false);delete _this.bindings[bindingName];});return this;}if(handlers){if(!callback){handlers.length=0;}else{var hi=handlers.length;while(hi--){if(handlers[hi].func===callback){handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1));this.bindings[currentName]=handlers;}}}if(!handlers.length){this.toggleEvent(name,false);delete this.bindings[currentName];}}}}else{each$1(this.bindings,function(_value,name){_this.toggleEvent(name,false);});this.bindings={};}return this;};EventDispatcher.prototype.once=function(name,callback,prepend){return this.on(name,callback,prepend,{once:true});};EventDispatcher.prototype.has=function(name){name=name.toLowerCase();return!(!this.bindings[name]||this.bindings[name].length===0);};return EventDispatcher;}();var getEventDispatcher=function getEventDispatcher(obj){if(!obj._eventDispatcher){obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function toggleEvent(name,state){if(EventDispatcher.isNative(name)&&obj.toggleNativeEvent){obj.toggleNativeEvent(name,state);}}});}return obj._eventDispatcher;};var Observable={fire:function fire(name,args,bubble){var self=this;if(self.removed&&name!=='remove'&&name!=='detach'){return args;}var dispatcherArgs=getEventDispatcher(self).fire(name,args);if(bubble!==false&&self.parent){var parent_1=self.parent();while(parent_1&&!dispatcherArgs.isPropagationStopped()){parent_1.fire(name,dispatcherArgs,false);parent_1=parent_1.parent();}}return dispatcherArgs;},on:function on(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend);},off:function off(name,callback){return getEventDispatcher(this).off(name,callback);},once:function once(name,callback){return getEventDispatcher(this).once(name,callback);},hasEventListeners:function hasEventListeners(name){return getEventDispatcher(this).has(name);}};var DOM$8=DOMUtils$1.DOM;var customEventRootDelegates;var getEventTarget=function getEventTarget(editor,eventName){if(eventName==='selectionchange'){return editor.getDoc();}if(!editor.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)){return editor.getDoc().documentElement;}var eventRoot=getEventRoot(editor);if(eventRoot){if(!editor.eventRoot){editor.eventRoot=DOM$8.select(eventRoot)[0];}return editor.eventRoot;}return editor.getBody();};var isListening=function isListening(editor){return!editor.hidden&&!isReadOnly$1(editor);};var fireEvent=function fireEvent(editor,eventName,e){if(isListening(editor)){editor.fire(eventName,e);}else if(isReadOnly$1(editor)){preventReadOnlyEvents(editor,e);}};var bindEventDelegate=function bindEventDelegate(editor,eventName){var delegate;if(!editor.delegates){editor.delegates={};}if(editor.delegates[eventName]||editor.removed){return;}var eventRootElm=getEventTarget(editor,eventName);if(getEventRoot(editor)){if(!customEventRootDelegates){customEventRootDelegates={};editor.editorManager.on('removeEditor',function(){if(!editor.editorManager.activeEditor){if(customEventRootDelegates){each$1(customEventRootDelegates,function(_value,name){editor.dom.unbind(getEventTarget(editor,name));});customEventRootDelegates=null;}}});}if(customEventRootDelegates[eventName]){return;}delegate=function delegate(e){var target=e.target;var editors=editor.editorManager.get();var i=editors.length;while(i--){var body=editors[i].getBody();if(body===target||DOM$8.isChildOf(target,body)){fireEvent(editors[i],eventName,e);}}};customEventRootDelegates[eventName]=delegate;DOM$8.bind(eventRootElm,eventName,delegate);}else{delegate=function delegate(e){fireEvent(editor,eventName,e);};DOM$8.bind(eventRootElm,eventName,delegate);editor.delegates[eventName]=delegate;}};var EditorObservable=_assign(_assign({},Observable),{bindPendingEventDelegates:function bindPendingEventDelegates(){var self=this;Tools.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name);});},toggleNativeEvent:function toggleNativeEvent(name,state){var self=this;if(name==='focus'||name==='blur'){return;}if(state){if(self.initialized){bindEventDelegate(self,name);}else{if(!self._pendingNativeEvents){self._pendingNativeEvents=[name];}else{self._pendingNativeEvents.push(name);}}}else if(self.initialized){self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]);delete self.delegates[name];}},unbindAllNativeEvents:function unbindAllNativeEvents(){var self=this;var body=self.getBody();var dom=self.dom;if(self.delegates){each$1(self.delegates,function(value,name){self.dom.unbind(getEventTarget(self,name),name,value);});delete self.delegates;}if(!self.inline&&body&&dom){body.onload=null;dom.unbind(self.getWin());dom.unbind(self.getDoc());}if(dom){dom.unbind(body);dom.unbind(self.getContainer());}}});var defaultModes=['design','readonly'];var switchToMode=function switchToMode(editor,activeMode,availableModes,mode){var oldMode=availableModes[activeMode.get()];var newMode=availableModes[mode];try{newMode.activate();}catch(e){console.error('problem while activating editor mode '+mode+':',e);return;}oldMode.deactivate();if(oldMode.editorReadOnly!==newMode.editorReadOnly){toggleReadOnly(editor,newMode.editorReadOnly);}activeMode.set(mode);fireSwitchMode(editor,mode);};var setMode=function setMode(editor,availableModes,activeMode,mode){if(mode===activeMode.get()){return;}else if(!has(availableModes,mode)){throw new Error('Editor mode \''+mode+'\' is invalid');}if(editor.initialized){switchToMode(editor,activeMode,availableModes,mode);}else{editor.on('init',function(){return switchToMode(editor,activeMode,availableModes,mode);});}};var registerMode=function registerMode(availableModes,mode,api){var _a;if(contains(defaultModes,mode)){throw new Error('Cannot override default mode '+mode);}return _assign(_assign({},availableModes),(_a={},_a[mode]=_assign(_assign({},api),{deactivate:function deactivate(){try{api.deactivate();}catch(e){console.error('problem while deactivating editor mode '+mode+':',e);}}}),_a));};var create$5=function create$5(editor){var activeMode=Cell('design');var availableModes=Cell({design:{activate:noop,deactivate:noop,editorReadOnly:false},readonly:{activate:noop,deactivate:noop,editorReadOnly:true}});registerReadOnlyContentFilters(editor);registerReadOnlySelectionBlockers(editor);return{isReadOnly:function isReadOnly(){return isReadOnly$1(editor);},set:function set(mode){return setMode(editor,availableModes.get(),activeMode,mode);},get:function get(){return activeMode.get();},register:function register(mode,api){availableModes.set(registerMode(availableModes.get(),mode,api));}};};var each$g=Tools.each,explode$3=Tools.explode;var keyCodeLookup={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var modifierNames=Tools.makeMap('alt,ctrl,shift,meta,access');var Shortcuts=function(){function Shortcuts(editor){this.shortcuts={};this.pendingPatterns=[];this.editor=editor;var self=this;editor.on('keyup keypress keydown',function(e){if((self.hasModifier(e)||self.isFunctionKey(e))&&!e.isDefaultPrevented()){each$g(self.shortcuts,function(shortcut){if(self.matchShortcut(e,shortcut)){self.pendingPatterns=shortcut.subpatterns.slice(0);if(e.type==='keydown'){self.executeShortcutAction(shortcut);}return true;}});if(self.matchShortcut(e,self.pendingPatterns[0])){if(self.pendingPatterns.length===1){if(e.type==='keydown'){self.executeShortcutAction(self.pendingPatterns[0]);}}self.pendingPatterns.shift();}}});}Shortcuts.prototype.add=function(pattern,desc,cmdFunc,scope){var self=this;var func=self.normalizeCommandFunc(cmdFunc);each$g(explode$3(Tools.trim(pattern)),function(pattern){var shortcut=self.createShortcut(pattern,desc,func,scope);self.shortcuts[shortcut.id]=shortcut;});return true;};Shortcuts.prototype.remove=function(pattern){var shortcut=this.createShortcut(pattern);if(this.shortcuts[shortcut.id]){delete this.shortcuts[shortcut.id];return true;}return false;};Shortcuts.prototype.normalizeCommandFunc=function(cmdFunc){var self=this;var cmd=cmdFunc;if(typeof cmd==='string'){return function(){self.editor.execCommand(cmd,false,null);};}else if(Tools.isArray(cmd)){return function(){self.editor.execCommand(cmd[0],cmd[1],cmd[2]);};}else{return cmd;}};Shortcuts.prototype.parseShortcut=function(pattern){var key;var shortcut={};each$g(explode$3(pattern.toLowerCase(),'+'),function(value){if(value in modifierNames){shortcut[value]=true;}else{if(/^[0-9]{2,}$/.test(value)){shortcut.keyCode=parseInt(value,10);}else{shortcut.charCode=value.charCodeAt(0);shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0);}}});var id=[shortcut.keyCode];for(key in modifierNames){if(shortcut[key]){id.push(key);}else{shortcut[key]=false;}}shortcut.id=id.join(',');if(shortcut.access){shortcut.alt=true;if(Env.mac){shortcut.ctrl=true;}else{shortcut.shift=true;}}if(shortcut.meta){if(Env.mac){shortcut.meta=true;}else{shortcut.ctrl=true;shortcut.meta=false;}}return shortcut;};Shortcuts.prototype.createShortcut=function(pattern,desc,cmdFunc,scope){var shortcuts=Tools.map(explode$3(pattern,'>'),this.parseShortcut);shortcuts[shortcuts.length-1]=Tools.extend(shortcuts[shortcuts.length-1],{func:cmdFunc,scope:scope||this.editor});return Tools.extend(shortcuts[0],{desc:this.editor.translate(desc),subpatterns:shortcuts.slice(1)});};Shortcuts.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey;};Shortcuts.prototype.isFunctionKey=function(e){return e.type==='keydown'&&e.keyCode>=112&&e.keyCode<=123;};Shortcuts.prototype.matchShortcut=function(e,shortcut){if(!shortcut){return false;}if(shortcut.ctrl!==e.ctrlKey||shortcut.meta!==e.metaKey){return false;}if(shortcut.alt!==e.altKey||shortcut.shift!==e.shiftKey){return false;}if(e.keyCode===shortcut.keyCode||e.charCode&&e.charCode===shortcut.charCode){e.preventDefault();return true;}return false;};Shortcuts.prototype.executeShortcutAction=function(shortcut){return shortcut.func?shortcut.func.call(shortcut.scope):null;};return Shortcuts;}();var create$6=function create$6(){var buttons={};var menuItems={};var popups={};var icons={};var contextMenus={};var contextToolbars={};var sidebars={};var add=function add(collection,type){return function(name,spec){return collection[name.toLowerCase()]=_assign(_assign({},spec),{type:type});};};var addIcon=function addIcon(name,svgData){return icons[name.toLowerCase()]=svgData;};return{addButton:add(buttons,'button'),addGroupToolbarButton:add(buttons,'grouptoolbarbutton'),addToggleButton:add(buttons,'togglebutton'),addMenuButton:add(buttons,'menubutton'),addSplitButton:add(buttons,'splitbutton'),addMenuItem:add(menuItems,'menuitem'),addNestedMenuItem:add(menuItems,'nestedmenuitem'),addToggleMenuItem:add(menuItems,'togglemenuitem'),addAutocompleter:add(popups,'autocompleter'),addContextMenu:add(contextMenus,'contextmenu'),addContextToolbar:add(contextToolbars,'contexttoolbar'),addContextForm:add(contextToolbars,'contextform'),addSidebar:add(sidebars,'sidebar'),addIcon:addIcon,getAll:function getAll(){return{buttons:buttons,menuItems:menuItems,icons:icons,popups:popups,contextMenus:contextMenus,contextToolbars:contextToolbars,sidebars:sidebars};}};};var registry=function registry(){var bridge=create$6();return{addAutocompleter:bridge.addAutocompleter,addButton:bridge.addButton,addContextForm:bridge.addContextForm,addContextMenu:bridge.addContextMenu,addContextToolbar:bridge.addContextToolbar,addIcon:bridge.addIcon,addMenuButton:bridge.addMenuButton,addMenuItem:bridge.addMenuItem,addNestedMenuItem:bridge.addNestedMenuItem,addSidebar:bridge.addSidebar,addSplitButton:bridge.addSplitButton,addToggleButton:bridge.addToggleButton,addGroupToolbarButton:bridge.addGroupToolbarButton,addToggleMenuItem:bridge.addToggleMenuItem,getAll:bridge.getAll};};var each$h=Tools.each,trim$4=Tools.trim;var queryParts='source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');var DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25};var URI=function(){function URI(url,settings){url=trim$4(url);this.settings=settings||{};var baseUri=this.settings.base_uri;var self=this;if(/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url)){self.source=url;return;}var isProtocolRelative=url.indexOf('//')===0;if(url.indexOf('/')===0&&!isProtocolRelative){url=(baseUri?baseUri.protocol||'http':'http')+'://mce_host'+url;}if(!/^[\w\-]*:?\/\//.test(url)){var baseUrl=this.settings.base_uri?this.settings.base_uri.path:new URI(document.location.href).directory;if(this.settings.base_uri&&this.settings.base_uri.protocol==''){url='//mce_host'+self.toAbsPath(baseUrl,url);}else{var match=/([^#?]*)([#?]?.*)/.exec(url);url=(baseUri&&baseUri.protocol||'http')+'://mce_host'+self.toAbsPath(baseUrl,match[1])+match[2];}}url=url.replace(/@@/g,'(mce_at)');var urlMatch=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url);each$h(queryParts,function(v,i){var part=urlMatch[i];if(part){part=part.replace(/\(mce_at\)/g,'@@');}self[v]=part;});if(baseUri){if(!self.protocol){self.protocol=baseUri.protocol;}if(!self.userInfo){self.userInfo=baseUri.userInfo;}if(!self.port&&self.host==='mce_host'){self.port=baseUri.port;}if(!self.host||self.host==='mce_host'){self.host=baseUri.host;}self.source='';}if(isProtocolRelative){self.protocol='';}}URI.parseDataUri=function(uri){var type;var uriComponents=decodeURIComponent(uri).split(',');var matches=/data:([^;]+)/.exec(uriComponents[0]);if(matches){type=matches[1];}return{type:type,data:uriComponents[1]};};URI.getDocumentBaseUrl=function(loc){var baseUrl;if(loc.protocol.indexOf('http')!==0&&loc.protocol!=='file:'){baseUrl=loc.href;}else{baseUrl=loc.protocol+'//'+loc.host+loc.pathname;}if(/^[^:]+:\/\/\/?[^\/]+\//.test(baseUrl)){baseUrl=baseUrl.replace(/[\?#].*$/,'').replace(/[\/\\][^\/]+$/,'');if(!/[\/\\]$/.test(baseUrl)){baseUrl+='/';}}return baseUrl;};URI.prototype.setPath=function(path){var pathMatch=/^(.*?)\/?(\w+)?$/.exec(path);this.path=pathMatch[0];this.directory=pathMatch[1];this.file=pathMatch[2];this.source='';this.getURI();};URI.prototype.toRelative=function(uri){var output;if(uri==='./'){return uri;}var relativeUri=new URI(uri,{base_uri:this});if(relativeUri.host!=='mce_host'&&this.host!==relativeUri.host&&relativeUri.host||this.port!==relativeUri.port||this.protocol!==relativeUri.protocol&&relativeUri.protocol!==''){return relativeUri.getURI();}var tu=this.getURI(),uu=relativeUri.getURI();if(tu===uu||tu.charAt(tu.length-1)==='/'&&tu.substr(0,tu.length-1)===uu){return tu;}output=this.toRelPath(this.path,relativeUri.path);if(relativeUri.query){output+='?'+relativeUri.query;}if(relativeUri.anchor){output+='#'+relativeUri.anchor;}return output;};URI.prototype.toAbsolute=function(uri,noHost){var absoluteUri=new URI(uri,{base_uri:this});return absoluteUri.getURI(noHost&&this.isSameOrigin(absoluteUri));};URI.prototype.isSameOrigin=function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port){return true;}var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort)){return true;}}return false;};URI.prototype.toRelPath=function(base,path){var breakPoint=0,out='',i,l;var normalizedBase=base.substring(0,base.lastIndexOf('/')).split('/');var items=path.split('/');if(normalizedBase.length>=items.length){for(i=0,l=normalizedBase.length;i<l;i++){if(i>=items.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break;}}}if(normalizedBase.length<items.length){for(i=0,l=items.length;i<l;i++){if(i>=normalizedBase.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break;}}}if(breakPoint===1){return path;}for(i=0,l=normalizedBase.length-(breakPoint-1);i<l;i++){out+='../';}for(i=breakPoint-1,l=items.length;i<l;i++){if(i!==breakPoint-1){out+='/'+items[i];}else{out+=items[i];}}return out;};URI.prototype.toAbsPath=function(base,path){var i,nb=0,o=[],outPath;var tr=/\/$/.test(path)?'/':'';var normalizedBase=base.split('/');var normalizedPath=path.split('/');each$h(normalizedBase,function(k){if(k){o.push(k);}});normalizedBase=o;for(i=normalizedPath.length-1,o=[];i>=0;i--){if(normalizedPath[i].length===0||normalizedPath[i]==='.'){continue;}if(normalizedPath[i]==='..'){nb++;continue;}if(nb>0){nb--;continue;}o.push(normalizedPath[i]);}i=normalizedBase.length-nb;if(i<=0){outPath=reverse(o).join('/');}else{outPath=normalizedBase.slice(0,i).join('/')+'/'+reverse(o).join('/');}if(outPath.indexOf('/')!==0){outPath='/'+outPath;}if(tr&&outPath.lastIndexOf('/')!==outPath.length-1){outPath+=tr;}return outPath;};URI.prototype.getURI=function(noProtoHost){if(noProtoHost===void 0){noProtoHost=false;}var s;if(!this.source||noProtoHost){s='';if(!noProtoHost){if(this.protocol){s+=this.protocol+'://';}else{s+='//';}if(this.userInfo){s+=this.userInfo+'@';}if(this.host){s+=this.host;}if(this.port){s+=':'+this.port;}}if(this.path){s+=this.path;}if(this.query){s+='?'+this.query;}if(this.anchor){s+='#'+this.anchor;}this.source=s;}return this.source;};return URI;}();var DOM$9=DOMUtils$1.DOM;var extend$3=Tools.extend,each$i=Tools.each;var resolve$3=Tools.resolve;var ie$1=Env.ie;var Editor=function(){function Editor(id,settings,editorManager){var _this=this;this.plugins={};this.contentCSS=[];this.contentStyles=[];this.loadedCSS={};this.isNotDirty=false;this.editorManager=editorManager;this.documentBaseUrl=editorManager.documentBaseURL;extend$3(this,EditorObservable);this.settings=getEditorSettings(this,id,this.documentBaseUrl,editorManager.defaultSettings,settings);if(this.settings.suffix){editorManager.suffix=this.settings.suffix;}this.suffix=editorManager.suffix;if(this.settings.base_url){editorManager._setBaseUrl(this.settings.base_url);}this.baseUri=editorManager.baseURI;if(this.settings.referrer_policy){ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);DOMUtils$1.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);}AddOnManager$1.languageLoad=this.settings.language_load;AddOnManager$1.baseURL=editorManager.baseURL;this.id=id;this.setDirty(false);this.documentBaseURI=new URI(this.settings.document_base_url,{base_uri:this.baseUri});this.baseURI=this.baseUri;this.inline=!!this.settings.inline;this.shortcuts=new Shortcuts(this);this.editorCommands=new EditorCommands(this);if(this.settings.cache_suffix){Env.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,'');}this.ui={registry:registry(),styleSheetLoader:undefined,show:noop,hide:noop};var self=this;var modeInstance=create$5(self);this.mode=modeInstance;this.setMode=modeInstance.set;editorManager.fire('SetupEditor',{editor:this});this.execCallback('setup',this);this.$=DomQuery.overrideDefaults(function(){return{context:_this.inline?_this.getBody():_this.getDoc(),element:_this.getBody()};});}Editor.prototype.render=function(){render(this);};Editor.prototype.focus=function(skipFocus){focus$1(this,skipFocus);};Editor.prototype.hasFocus=function(){return hasFocus$1(this);};Editor.prototype.execCallback=function(name){var x=[];for(var _i=1;_i<arguments.length;_i++){x[_i-1]=arguments[_i];}var self=this;var callback=self.settings[name],scope;if(!callback){return;}if(self.callbackLookup&&(scope=self.callbackLookup[name])){callback=scope.func;scope=scope.scope;}if(typeof callback==='string'){scope=callback.replace(/\.\w+$/,'');scope=scope?resolve$3(scope):0;callback=resolve$3(callback);self.callbackLookup=self.callbackLookup||{};self.callbackLookup[name]={func:callback,scope:scope};}return callback.apply(scope||self,x);};Editor.prototype.translate=function(text){return I18n.translate(text);};Editor.prototype.getParam=function(name,defaultVal,type){return getParam(this,name,defaultVal,type);};Editor.prototype.hasPlugin=function(name,loaded){var hasPlugin=contains(getPlugins(this).split(/[ ,]/),name);if(hasPlugin){return loaded?PluginManager.get(name)!==undefined:true;}else{return false;}};Editor.prototype.nodeChanged=function(args){this._nodeChangeDispatcher.nodeChanged(args);};Editor.prototype.addCommand=function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope);};Editor.prototype.addQueryStateHandler=function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope);};Editor.prototype.addQueryValueHandler=function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope);};Editor.prototype.addShortcut=function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope);};Editor.prototype.execCommand=function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args);};Editor.prototype.queryCommandState=function(cmd){return this.editorCommands.queryCommandState(cmd);};Editor.prototype.queryCommandValue=function(cmd){return this.editorCommands.queryCommandValue(cmd);};Editor.prototype.queryCommandSupported=function(cmd){return this.editorCommands.queryCommandSupported(cmd);};Editor.prototype.show=function(){var self=this;if(self.hidden){self.hidden=false;if(self.inline){self.getBody().contentEditable='true';}else{DOM$9.show(self.getContainer());DOM$9.hide(self.id);}self.load();self.fire('show');}};Editor.prototype.hide=function(){var self=this,doc=self.getDoc();if(!self.hidden){if(ie$1&&doc&&!self.inline){doc.execCommand('SelectAll');}self.save();if(self.inline){self.getBody().contentEditable='false';if(self===self.editorManager.focusedEditor){self.editorManager.focusedEditor=null;}}else{DOM$9.hide(self.getContainer());DOM$9.setStyle(self.id,'display',self.orgDisplay);}self.hidden=true;self.fire('hide');}};Editor.prototype.isHidden=function(){return!!this.hidden;};Editor.prototype.setProgressState=function(state,time){this.fire('ProgressState',{state:state,time:time});};Editor.prototype.load=function(args){var self=this;var elm=self.getElement(),html;if(self.removed){return'';}if(elm){args=args||{};args.load=true;var value=isTextareaOrInput(elm)?elm.value:elm.innerHTML;html=self.setContent(value,args);args.element=elm;if(!args.no_events){self.fire('LoadContent',args);}args.element=elm=null;return html;}};Editor.prototype.save=function(args){var self=this;var elm=self.getElement(),html,form;if(!elm||!self.initialized||self.removed){return;}args=args||{};args.save=true;args.element=elm;html=args.content=self.getContent(args);if(!args.no_events){self.fire('SaveContent',args);}if(args.format==='raw'){self.fire('RawSaveContent',args);}html=args.content;if(!isTextareaOrInput(elm)){if(args.is_removing||!self.inline){elm.innerHTML=html;}if(form=DOM$9.getParent(self.id,'form')){each$i(form.elements,function(elm){if(elm.name===self.id){elm.value=html;return false;}});}}else{elm.value=html;}args.element=elm=null;if(args.set_dirty!==false){self.setDirty(false);}return html;};Editor.prototype.setContent=function(content,args){return setContent$2(this,content,args);};Editor.prototype.getContent=function(args){return getContent$2(this,args);};Editor.prototype.insertContent=function(content,args){if(args){content=extend$3({content:content},args);}this.execCommand('mceInsertContent',false,content);};Editor.prototype.resetContent=function(initialContent){if(initialContent===undefined){setContent$2(this,this.startContent,{format:'raw'});}else{setContent$2(this,initialContent);}this.undoManager.reset();this.setDirty(false);this.nodeChanged();};Editor.prototype.isDirty=function(){return!this.isNotDirty;};Editor.prototype.setDirty=function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state;if(state&&state!==oldState){this.fire('dirty');}};Editor.prototype.getContainer=function(){var self=this;if(!self.container){self.container=DOM$9.get(self.editorContainer||self.id+'_parent');}return self.container;};Editor.prototype.getContentAreaContainer=function(){return this.contentAreaContainer;};Editor.prototype.getElement=function(){if(!this.targetElm){this.targetElm=DOM$9.get(this.id);}return this.targetElm;};Editor.prototype.getWin=function(){var self=this;var elm;if(!self.contentWindow){elm=self.iframeElement;if(elm){self.contentWindow=elm.contentWindow;}}return self.contentWindow;};Editor.prototype.getDoc=function(){var self=this;var win;if(!self.contentDocument){win=self.getWin();if(win){self.contentDocument=win.document;}}return self.contentDocument;};Editor.prototype.getBody=function(){var doc=this.getDoc();return this.bodyElement||(doc?doc.body:null);};Editor.prototype.convertURL=function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback){return self.execCallback('urlconverter_callback',url,elm,true,name);}if(!settings.convert_urls||elm&&elm.nodeName==='LINK'||url.indexOf('file:')===0||url.length===0){return url;}if(settings.relative_urls){return self.documentBaseURI.toRelative(url);}url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url;};Editor.prototype.addVisual=function(elm){var self=this;var settings=self.settings;var dom=self.dom;var cls;elm=elm||self.getBody();if(self.hasVisual===undefined){self.hasVisual=settings.visual;}each$i(dom.select('table,a',elm),function(elm){var value;switch(elm.nodeName){case'TABLE':cls=settings.visual_table_class||'mce-item-table';value=dom.getAttrib(elm,'border');if((!value||value==='0')&&self.hasVisual){dom.addClass(elm,cls);}else{dom.removeClass(elm,cls);}return;case'A':if(!dom.getAttrib(elm,'href')){value=dom.getAttrib(elm,'name')||elm.id;cls=settings.visual_anchor_class||'mce-item-anchor';if(value&&self.hasVisual){dom.addClass(elm,cls);}else{dom.removeClass(elm,cls);}}return;}});self.fire('VisualAid',{element:elm,hasVisual:self.hasVisual});};Editor.prototype.remove=function(){remove$7(this);};Editor.prototype.destroy=function(automatic){destroy(this,automatic);};Editor.prototype.uploadImages=function(callback){return this.editorUpload.uploadImages(callback);};Editor.prototype._scanForImages=function(){return this.editorUpload.scanForImages();};Editor.prototype.addButton=function(){throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');};Editor.prototype.addSidebar=function(){throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');};Editor.prototype.addMenuItem=function(){throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');};Editor.prototype.addContextToolbar=function(){throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');};return Editor;}();var DOM$a=DOMUtils$1.DOM;var explode$4=Tools.explode,each$j=Tools.each,extend$4=Tools.extend;var instanceCounter=0,boundGlobalEvents=false;var beforeUnloadDelegate;var legacyEditors=[];var editors=[];var isValidLegacyKey=function isValidLegacyKey(id){return id!=='length';};var globalEventDelegate=function globalEventDelegate(e){var type=e.type;each$j(EditorManager.get(),function(editor){switch(type){case'scroll':editor.fire('ScrollWindow',e);break;case'resize':editor.fire('ResizeWindow',e);break;}});};var toggleGlobalEvents=function toggleGlobalEvents(state){if(state!==boundGlobalEvents){if(state){DomQuery(window).on('resize scroll',globalEventDelegate);}else{DomQuery(window).off('resize scroll',globalEventDelegate);}boundGlobalEvents=state;}};var removeEditorFromList=function removeEditorFromList(targetEditor){var oldEditors=editors;delete legacyEditors[targetEditor.id];for(var i=0;i<legacyEditors.length;i++){if(legacyEditors[i]===targetEditor){legacyEditors.splice(i,1);break;}}editors=filter(editors,function(editor){return targetEditor!==editor;});if(EditorManager.activeEditor===targetEditor){EditorManager.activeEditor=editors.length>0?editors[0]:null;}if(EditorManager.focusedEditor===targetEditor){EditorManager.focusedEditor=null;}return oldEditors.length!==editors.length;};var purgeDestroyedEditor=function purgeDestroyedEditor(editor){if(editor&&editor.initialized&&!(editor.getContainer()||editor.getBody()).parentNode){removeEditorFromList(editor);editor.unbindAllNativeEvents();editor.destroy(true);editor.removed=true;editor=null;}return editor;};var isQuirksMode=document.compatMode!=='CSS1Compat';var EditorManager=_assign(_assign({},Observable),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:DomQuery,majorVersion:'5',minorVersion:'5.1',releaseDate:'2020-10-01',editors:legacyEditors,i18n:I18n,activeEditor:null,focusedEditor:null,settings:{},setup:function setup(){var self=this;var baseURL,documentBaseURL,suffix='';documentBaseURL=URI.getDocumentBaseUrl(document.location);if(/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)){documentBaseURL=documentBaseURL.replace(/[\?#].*$/,'').replace(/[\/\\][^\/]+$/,'');if(!/[\/\\]$/.test(documentBaseURL)){documentBaseURL+='/';}}var preInit=window.tinymce||window.tinyMCEPreInit;if(preInit){baseURL=preInit.base||preInit.baseURL;suffix=preInit.suffix;}else{var scripts=document.getElementsByTagName('script');for(var i=0;i<scripts.length;i++){var src=scripts[i].src||'';if(src===''){continue;}var srcScript=src.substring(src.lastIndexOf('/'));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){if(srcScript.indexOf('.min')!==-1){suffix='.min';}baseURL=src.substring(0,src.lastIndexOf('/'));break;}}if(!baseURL&&document.currentScript){var src=document.currentScript.src;if(src.indexOf('.min')!==-1){suffix='.min';}baseURL=src.substring(0,src.lastIndexOf('/'));}}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL);self.documentBaseURL=documentBaseURL;self.baseURI=new URI(self.baseURL);self.suffix=suffix;setup$2(self);},overrideDefaults:function overrideDefaults(defaultSettings){var baseUrl=defaultSettings.base_url;if(baseUrl){this._setBaseUrl(baseUrl);}var suffix=defaultSettings.suffix;if(defaultSettings.suffix){this.suffix=suffix;}this.defaultSettings=defaultSettings;var pluginBaseUrls=defaultSettings.plugin_base_urls;if(pluginBaseUrls!==undefined){each$1(pluginBaseUrls,function(pluginBaseUrl,pluginName){AddOnManager$1.PluginManager.urls[pluginName]=pluginBaseUrl;});}},init:function init(settings){var self=this;var result;var invalidInlineTargets=Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track '+'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu',' ');var isInvalidInlineTarget=function isInvalidInlineTarget(settings,elm){return settings.inline&&elm.tagName.toLowerCase()in invalidInlineTargets;};var createId=function createId(elm){var id=elm.id;if(!id){id=get(elm,'name').filter(function(name){return!DOM$a.get(name);}).getOrThunk(DOM$a.uniqueId);elm.setAttribute('id',id);}return id;};var execCallback=function execCallback(name){var callback=settings[name];if(!callback){return;}return callback.apply(self,Array.prototype.slice.call(arguments,2));};var hasClass=function hasClass(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM$a.hasClass(elm,className);};var findTargets=function findTargets(settings){var targets=[];if(Env.browser.isIE()&&Env.browser.version.major<11){initError('TinyMCE does not support the browser you are using. For a list of supported'+' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');return[];}else if(isQuirksMode){initError('Failed to initialize the editor as the document is not in standards mode. '+'TinyMCE requires standards mode.');return[];}if(settings.types){each$j(settings.types,function(type){targets=targets.concat(DOM$a.select(type.selector));});return targets;}else if(settings.selector){return DOM$a.select(settings.selector);}else if(settings.target){return[settings.target];}switch(settings.mode){case'exact':var l=settings.elements||'';if(l.length>0){each$j(explode$4(l),function(id){var elm=DOM$a.get(id);if(elm){targets.push(elm);}else{each$j(document.forms,function(f){each$j(f.elements,function(e){if(e.name===id){id='mce_editor_'+instanceCounter++;DOM$a.setAttrib(e,'id',id);targets.push(e);}});});}});}break;case'textareas':case'specific_textareas':each$j(DOM$a.select('textarea'),function(elm){if(settings.editor_deselector&&hasClass(elm,settings.editor_deselector)){return;}if(!settings.editor_selector||hasClass(elm,settings.editor_selector)){targets.push(elm);}});break;}return targets;};var provideResults=function provideResults(editors){result=editors;};var initEditors=function initEditors(){var initCount=0;var editors=[];var targets;var createEditor=function createEditor(id,settings,targetElm){var editor=new Editor(id,settings,self);editors.push(editor);editor.on('init',function(){if(++initCount===targets.length){provideResults(editors);}});editor.targetElm=editor.targetElm||targetElm;editor.render();};DOM$a.unbind(window,'ready',initEditors);execCallback('onpageload');targets=DomQuery.unique(findTargets(settings));if(settings.types){each$j(settings.types,function(type){Tools.each(targets,function(elm){if(DOM$a.is(elm,type.selector)){createEditor(createId(elm),extend$4({},settings,type),elm);return false;}return true;});});return;}Tools.each(targets,function(elm){purgeDestroyedEditor(self.get(elm.id));});targets=Tools.grep(targets,function(elm){return!self.get(elm.id);});if(targets.length===0){provideResults([]);}else{each$j(targets,function(elm){if(isInvalidInlineTarget(settings,elm)){initError('Could not initialize inline editor on invalid inline target element',elm);}else{createEditor(createId(elm),settings,elm);}});}};self.settings=settings;DOM$a.bind(window,'ready',initEditors);return new promiseObj(function(resolve){if(result){resolve(result);}else{provideResults=function provideResults(editors){resolve(editors);};}});},get:function get(id){if(arguments.length===0){return editors.slice(0);}else if(isString(id)){return find(editors,function(editor){return editor.id===id;}).getOr(null);}else if(isNumber(id)){return editors[id]?editors[id]:null;}else{return null;}},add:function add(editor){var self=this;var existingEditor=legacyEditors[editor.id];if(existingEditor===editor){return editor;}if(self.get(editor.id)===null){if(isValidLegacyKey(editor.id)){legacyEditors[editor.id]=editor;}legacyEditors.push(editor);editors.push(editor);}toggleGlobalEvents(true);self.activeEditor=editor;self.fire('AddEditor',{editor:editor});if(!beforeUnloadDelegate){beforeUnloadDelegate=function beforeUnloadDelegate(e){var event=self.fire('BeforeUnload');if(event.returnValue){e.preventDefault();e.returnValue=event.returnValue;return event.returnValue;}};window.addEventListener('beforeunload',beforeUnloadDelegate);}return editor;},createEditor:function createEditor(id,settings){return this.add(new Editor(id,settings,this));},remove:function remove(selector){var self=this;var i,editor;if(!selector){for(i=editors.length-1;i>=0;i--){self.remove(editors[i]);}return;}if(isString(selector)){each$j(DOM$a.select(selector),function(elm){editor=self.get(elm.id);if(editor){self.remove(editor);}});return;}editor=selector;if(isNull(self.get(editor.id))){return null;}if(removeEditorFromList(editor)){self.fire('RemoveEditor',{editor:editor});}if(editors.length===0){window.removeEventListener('beforeunload',beforeUnloadDelegate);}editor.remove();toggleGlobalEvents(editors.length>0);return editor;},execCommand:function execCommand(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case'mceAddEditor':if(!self.get(value)){new Editor(value,self.settings,self).render();}return true;case'mceRemoveEditor':if(editor){editor.remove();}return true;case'mceToggleEditor':if(!editor){self.execCommand('mceAddEditor',0,value);return true;}if(editor.isHidden()){editor.show();}else{editor.hide();}return true;}if(self.activeEditor){return self.activeEditor.execCommand(cmd,ui,value);}return false;},triggerSave:function triggerSave(){each$j(editors,function(editor){editor.save();});},addI18n:function addI18n(code,items){I18n.add(code,items);},translate:function translate(text){return I18n.translate(text);},setActive:function setActive(editor){var activeEditor=this.activeEditor;if(this.activeEditor!==editor){if(activeEditor){activeEditor.fire('deactivate',{relatedTarget:editor});}editor.fire('activate',{relatedTarget:activeEditor});}this.activeEditor=editor;},_setBaseUrl:function _setBaseUrl(baseUrl){this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,''));this.baseURI=new URI(this.baseURL);}});EditorManager.setup();var min=Math.min,max=Math.max,round$1=Math.round;var relativePosition=function relativePosition(rect,targetRect,rel){var x=targetRect.x;var y=targetRect.y;var w=rect.w;var h=rect.h;var targetW=targetRect.w;var targetH=targetRect.h;var relChars=(rel||'').split('');if(relChars[0]==='b'){y+=targetH;}if(relChars[1]==='r'){x+=targetW;}if(relChars[0]==='c'){y+=round$1(targetH/2);}if(relChars[1]==='c'){x+=round$1(targetW/2);}if(relChars[3]==='b'){y-=h;}if(relChars[4]==='r'){x-=w;}if(relChars[3]==='c'){y-=round$1(h/2);}if(relChars[4]==='c'){x-=round$1(w/2);}return create$7(x,y,w,h);};var findBestRelativePosition=function findBestRelativePosition(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++){pos=relativePosition(rect,targetRect,rels[i]);if(pos.x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y){return rels[i];}}return null;};var inflate=function inflate(rect,w,h){return create$7(rect.x-w,rect.y-h,rect.w+w*2,rect.h+h*2);};var intersect=function intersect(rect,cropRect){var x1=max(rect.x,cropRect.x);var y1=max(rect.y,cropRect.y);var x2=min(rect.x+rect.w,cropRect.x+cropRect.w);var y2=min(rect.y+rect.h,cropRect.y+cropRect.h);if(x2-x1<0||y2-y1<0){return null;}return create$7(x1,y1,x2-x1,y2-y1);};var clamp$1=function clamp$1(rect,clampRect,fixedSize){var x1=rect.x;var y1=rect.y;var x2=rect.x+rect.w;var y2=rect.y+rect.h;var cx2=clampRect.x+clampRect.w;var cy2=clampRect.y+clampRect.h;var underflowX1=max(0,clampRect.x-x1);var underflowY1=max(0,clampRect.y-y1);var overflowX2=max(0,x2-cx2);var overflowY2=max(0,y2-cy2);x1+=underflowX1;y1+=underflowY1;if(fixedSize){x2+=underflowX1;y2+=underflowY1;x1-=overflowX2;y1-=overflowY2;}x2-=overflowX2;y2-=overflowY2;return create$7(x1,y1,x2-x1,y2-y1);};var create$7=function create$7(x,y,w,h){return{x:x,y:y,w:w,h:h};};var fromClientRect=function fromClientRect(clientRect){return create$7(clientRect.left,clientRect.top,clientRect.width,clientRect.height);};var Rect={inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp$1,create:create$7,fromClientRect:fromClientRect};var awaiter=function awaiter(resolveCb,rejectCb,timeout){if(timeout===void 0){timeout=1000;}var done=false;var timer=null;var complete=function complete(completer){return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!done){done=true;if(timer!==null){clearTimeout(timer);timer=null;}completer.apply(null,args);}};};var resolve=complete(resolveCb);var reject=complete(rejectCb);var start=function start(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!done&&timer===null){timer=setTimeout(function(){return reject.apply(null,args);},timeout);}};return{start:start,resolve:resolve,reject:reject};};var create$8=function create$8(){var tasks={};var resultFns={};var load=function load(id,url){var loadErrMsg='Script at URL "'+url+'" failed to load';var runErrMsg='Script at URL "'+url+'" did not call `tinymce.Resource.add(\''+id+'\', data)` within 1 second';if(tasks[id]!==undefined){return tasks[id];}else{var task=new promiseObj(function(resolve,reject){var waiter=awaiter(resolve,reject);resultFns[id]=waiter.resolve;ScriptLoader.ScriptLoader.loadScript(url,function(){return waiter.start(runErrMsg);},function(){return waiter.reject(loadErrMsg);});});tasks[id]=task;return task;}};var add=function add(id,data){if(resultFns[id]!==undefined){resultFns[id](data);delete resultFns[id];}tasks[id]=promiseObj.resolve(data);};return{load:load,add:add};};var Resource=create$8();var each$k=Tools.each,extend$5=Tools.extend;var _extendClass,initializing;var Class=function Class(){};Class.extend=_extendClass=function extendClass(props){var self=this;var _super=self.prototype;var Class=function Class(){var i,mixins,mixin;var self=this;if(!initializing){if(self.init){self.init.apply(self,arguments);}mixins=self.Mixins;if(mixins){i=mixins.length;while(i--){mixin=mixins[i];if(mixin.init){mixin.init.apply(self,arguments);}}}}};var dummy=function dummy(){return this;};var createMethod=function createMethod(name,fn){return function(){var self=this;var tmp=self._super;self._super=_super[name];var ret=fn.apply(self,arguments);self._super=tmp;return ret;};};initializing=true;var prototype=new self();initializing=false;if(props.Mixins){each$k(props.Mixins,function(mixin){for(var name_1 in mixin){if(name_1!=='init'){props[name_1]=mixin[name_1];}}});if(_super.Mixins){props.Mixins=_super.Mixins.concat(props.Mixins);}}if(props.Methods){each$k(props.Methods.split(','),function(name){props[name]=dummy;});}if(props.Properties){each$k(props.Properties.split(','),function(name){var fieldName='_'+name;props[name]=function(value){var self=this;if(value!==undefined){self[fieldName]=value;return self;}return self[fieldName];};});}if(props.Statics){each$k(props.Statics,function(func,name){Class[name]=func;});}if(props.Defaults&&_super.Defaults){props.Defaults=extend$5({},_super.Defaults,props.Defaults);}each$1(props,function(member,name){if(typeof member==='function'&&_super[name]){prototype[name]=createMethod(name,member);}else{prototype[name]=member;}});Class.prototype=prototype;Class.constructor=Class;Class.extend=_extendClass;return Class;};var min$1=Math.min,max$1=Math.max,round$2=Math.round;var Color=function Color(value){var self={};var r=0,g=0,b=0;var rgb2hsv=function rgb2hsv(r,g,b){var h,s,v;h=0;s=0;v=0;r=r/255;g=g/255;b=b/255;var minRGB=min$1(r,min$1(g,b));var maxRGB=max$1(r,max$1(g,b));if(minRGB===maxRGB){v=minRGB;return{h:0,s:0,v:v*100};}var d=r===minRGB?g-b:b===minRGB?r-g:b-r;h=r===minRGB?3:b===minRGB?1:5;h=60*(h-d/(maxRGB-minRGB));s=(maxRGB-minRGB)/maxRGB;v=maxRGB;return{h:round$2(h),s:round$2(s*100),v:round$2(v*100)};};var hsvToRgb=function hsvToRgb(hue,saturation,brightness){hue=(parseInt(hue,10)||0)%360;saturation=parseInt(saturation,10)/100;brightness=parseInt(brightness,10)/100;saturation=max$1(0,min$1(saturation,1));brightness=max$1(0,min$1(brightness,1));if(saturation===0){r=g=b=round$2(255*brightness);return;}var side=hue/60;var chroma=brightness*saturation;var x=chroma*(1-Math.abs(side%2-1));var match=brightness-chroma;switch(Math.floor(side)){case 0:r=chroma;g=x;b=0;break;case 1:r=x;g=chroma;b=0;break;case 2:r=0;g=chroma;b=x;break;case 3:r=0;g=x;b=chroma;break;case 4:r=x;g=0;b=chroma;break;case 5:r=chroma;g=0;b=x;break;default:r=g=b=0;}r=round$2(255*(r+match));g=round$2(255*(g+match));b=round$2(255*(b+match));};var toHex=function toHex(){var hex=function hex(val){val=parseInt(val,10).toString(16);return val.length>1?val:'0'+val;};return'#'+hex(r)+hex(g)+hex(b);};var toRgb=function toRgb(){return{r:r,g:g,b:b};};var toHsv=function toHsv(){return rgb2hsv(r,g,b);};var parse=function parse(value){var matches;if(_typeof(value)==='object'){if('r'in value){r=value.r;g=value.g;b=value.b;}else if('v'in value){hsvToRgb(value.h,value.s,value.v);}}else{if(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value)){r=parseInt(matches[1],10);g=parseInt(matches[2],10);b=parseInt(matches[3],10);}else if(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)){r=parseInt(matches[1],16);g=parseInt(matches[2],16);b=parseInt(matches[3],16);}else if(matches=/#([0-F])([0-F])([0-F])/gi.exec(value)){r=parseInt(matches[1]+matches[1],16);g=parseInt(matches[2]+matches[2],16);b=parseInt(matches[3]+matches[3],16);}}r=r<0?0:r>255?255:r;g=g<0?0:g>255?255:g;b=b<0?0:b>255?255:b;return self;};if(value){parse(value);}self.toRgb=toRgb;self.toHsv=toHsv;self.toHex=toHex;self.parse=parse;return self;};var serialize=function serialize(obj){var data=JSON.stringify(obj);if(!isString(data)){return data;}return data.replace(/[\u0080-\uFFFF]/g,function(match){var hexCode=match.charCodeAt(0).toString(16);return"\\u"+'0000'.substring(hexCode.length)+hexCode;});};var JSONUtils={serialize:serialize,parse:function parse(text){try{return JSON.parse(text);}catch(ex){}}};var JSONP={callbacks:{},count:0,send:function send(settings){var self=this,dom=DOMUtils$1.DOM,count=settings.count!==undefined?settings.count:self.count;var id='tinymce_jsonp_'+count;self.callbacks[count]=function(json){dom.remove(id);delete self.callbacks[count];settings.callback(json);};dom.add(dom.doc.body,'script',{id:id,src:settings.url,type:'text/javascript'});self.count++;}};var XHR=_assign(_assign({},Observable),{send:function send(settings){var xhr,count=0;var ready=function ready(){if(!settings.async||xhr.readyState===4||count++>10000){if(settings.success&&count<10000&&xhr.status===200){settings.success.call(settings.success_scope,''+xhr.responseText,xhr,settings);}else if(settings.error){settings.error.call(settings.error_scope,count>10000?'TIMED_OUT':'GENERAL',xhr,settings);}xhr=null;}else{Delay.setTimeout(ready,10);}};settings.scope=settings.scope||this;settings.success_scope=settings.success_scope||settings.scope;settings.error_scope=settings.error_scope||settings.scope;settings.async=settings.async!==false;settings.data=settings.data||'';XHR.fire('beforeInitialize',{settings:settings});xhr=new XMLHttpRequest();if(xhr.overrideMimeType){xhr.overrideMimeType(settings.content_type);}xhr.open(settings.type||(settings.data?'POST':'GET'),settings.url,settings.async);if(settings.crossDomain){xhr.withCredentials=true;}if(settings.content_type){xhr.setRequestHeader('Content-Type',settings.content_type);}if(settings.requestheaders){Tools.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value);});}xhr.setRequestHeader('X-Requested-With','XMLHttpRequest');xhr=XHR.fire('beforeSend',{xhr:xhr,settings:settings}).xhr;xhr.send(settings.data);if(!settings.async){return ready();}Delay.setTimeout(ready,10);}});var extend$6=Tools.extend;var JSONRequest=function(){function JSONRequest(settings){this.settings=extend$6({},settings);this.count=0;}JSONRequest.sendRPC=function(o){return new JSONRequest().send(o);};JSONRequest.prototype.send=function(args){var ecb=args.error,scb=args.success;var xhrArgs=extend$6(this.settings,args);xhrArgs.success=function(c,x){c=JSONUtils.parse(c);if(typeof c==='undefined'){c={error:'JSON Parse error.'};}if(c.error){ecb.call(xhrArgs.error_scope||xhrArgs.scope,c.error,x);}else{scb.call(xhrArgs.success_scope||xhrArgs.scope,c.result);}};xhrArgs.error=function(ty,x){if(ecb){ecb.call(xhrArgs.error_scope||xhrArgs.scope,ty,x);}};xhrArgs.data=JSONUtils.serialize({id:args.id||'c'+this.count++,method:args.method,params:args.params});xhrArgs.content_type='application/json';XHR.send(xhrArgs);};return JSONRequest;}();var create$9=function create$9(){return function(){var data={};var keys=[];var storage={getItem:function getItem(key){var item=data[key];return item?item:null;},setItem:function setItem(key,value){keys.push(key);data[key]=String(value);},key:function key(index){return keys[index];},removeItem:function removeItem(key){keys=keys.filter(function(k){return k===key;});delete data[key];},clear:function clear(){keys=[];data={};},length:0};Object.defineProperty(storage,'length',{get:function get(){return keys.length;},configurable:false,enumerable:false});return storage;}();};var localStorage;try{var test='__storage_test__';localStorage=window.localStorage;localStorage.setItem(test,test);localStorage.removeItem(test);}catch(e){localStorage=create$9();}var LocalStorage=localStorage;var publicApi={geom:{Rect:Rect},util:{Promise:promiseObj,Delay:Delay,Tools:Tools,VK:VK,URI:URI,Class:Class,EventDispatcher:EventDispatcher,Observable:Observable,I18n:I18n,XHR:XHR,JSON:JSONUtils,JSONRequest:JSONRequest,JSONP:JSONP,LocalStorage:LocalStorage,Color:Color},dom:{EventUtils:EventUtils,Sizzle:Sizzle,DomQuery:DomQuery,TreeWalker:DomTreeWalker,TextSeeker:TextSeeker,DOMUtils:DOMUtils$1,ScriptLoader:ScriptLoader,RangeUtils:RangeUtils$1,Serializer:DomSerializer,StyleSheetLoader:StyleSheetLoader,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager$1,Selection:EditorSelection,Event:EventUtils.Event},html:{Styles:Styles,Entities:Entities,Node:AstNode,Schema:Schema,SaxParser:SaxParser$1,DomParser:DomParser,Writer:Writer,Serializer:HtmlSerializer},Env:Env,AddOnManager:AddOnManager$1,Annotator:Annotator,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:EditorObservable,Shortcuts:Shortcuts,Editor:Editor,FocusManager:FocusManager,EditorManager:EditorManager,DOM:DOMUtils$1.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:PluginManager,ThemeManager:ThemeManager,IconManager:IconManager,Resource:Resource,trim:Tools.trim,isArray:Tools.isArray,is:Tools.is,toArray:Tools.toArray,makeMap:Tools.makeMap,each:Tools.each,map:Tools.map,grep:Tools.grep,inArray:Tools.inArray,extend:Tools.extend,create:Tools.create,walk:Tools.walk,createNS:Tools.createNS,resolve:Tools.resolve,explode:Tools.explode,_addCacheSuffix:Tools._addCacheSuffix,isOpera:Env.opera,isWebKit:Env.webkit,isIE:Env.ie,isGecko:Env.gecko,isMac:Env.mac};var tinymce=Tools.extend(EditorManager,publicApi);var exportToModuleLoaders=function exportToModuleLoaders(tinymce){if((typeof module==="undefined"?"undefined":_typeof(module))==='object'){try{module.exports=tinymce;}catch(_){}}};var exportToWindowGlobal=function exportToWindowGlobal(tinymce){window.tinymce=tinymce;window.tinyMCE=tinymce;};exportToWindowGlobal(tinymce);exportToModuleLoaders(tinymce);})();}).call(window);

/***/ }),

/***/ "./node_modules/edx-ui-toolkit/src/js/dropdown-menu/dropdown-menu-view.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * A Backbone view that renders a fully accessible dropdown menu.
 *
 * Initialize the view by passing in the following attributes:
 *
 *~~~ javascript
 * view = new DropdownMenuView({
 *     className: 'space separated string of classes for element',
 *     model: new Backbone.Model({
 *         main: {
 *             image: 'http://placehold.it/40x40',
 *             screenreader_label: 'Dashboard for: ',
 *             text: 'username',
 *             url: 'dashboard'
 *         },
 *         button: {
 *             icon: 'icon-angle-down',
 *             label: 'User options dropdown'
 *         },
 *         items: [
 *             {
 *                 text: 'Account',
 *                 url: 'account_settings'
 *             }, {
 *                 text: 'Sign Out',
 *                 url: 'logout'
 *             }
 *         ]
 *     }),
 *     parent: 'selector for parent element that will be replaced with dropdown menu',
 *     ...
 * });
 *~~~
 * @module DropdownMenuView
 */


!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2), __webpack_require__(0), __webpack_require__(1), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/utils/constants.js"), __webpack_require__("./node_modules/edx-ui-toolkit/src/js/dropdown-menu/dropdown.underscore")], __WEBPACK_AMD_DEFINE_RESULT__ = function (Backbone, $, _, constants, DropdownTpl) {
  var DropdownMenuView = Backbone.View.extend({
    tpl: _.template(DropdownTpl),
    events: {
      'click .js-dropdown-button': 'clickOpenDropdown',
      'click a': 'analyticsLinkClick',
      keydown: 'viewKeypress'
    },
    dropdownButton: '.js-dropdown-button',
    menu: '.dropdown-menu',
    initialize: function (options) {
      if (options.parent) {
        this.$parent = $(options.parent);
      }

      this.menuId = options.menuId || 'dropdown-menu-' + this.cid;
      this.keyBack = [constants.keyCodes.up, constants.keyCodes.left];
      this.keyForward = [constants.keyCodes.down, constants.keyCodes.right];
      this.keyClose = [constants.keyCodes.esc, constants.keyCodes.space];
    },
    className: function () {
      return this.options.className;
    },
    render: function () {
      /**
       * Set in the render function to prevent error when
       * view is used with a pre-rendered DOM
       */
      this.model.set({
        menuId: this.menuId
      });
      this.$el.html(this.tpl(this.model.toJSON()));
      this.$parent.replaceWith(this.$el);
      this.postRender();
      return this;
    },
    postRender: function () {
      this.$menu = this.$('.dropdown-menu');
      this.$page = $(document);
      this.$dropdownButton = this.$(this.dropdownButton);
      this.$lastItem = this.$menu.find('li:last-child a');
    },

    /**
     * Function to track analytics.
     *
     * By default it doesn't do anything, to utilize please
     * extend the View and implement a method such as the
     * following:
     *
     *~~~ javascript
     * var $link = $(event.target),
     *     label = $link.hasClass('menu-title') ? 'Dashboard' : $link.html().trim();
     *
     * window.analytics.track('user_dropdown.clicked', {
     *     category: 'navigation',
     *     label: label,
     *     link: $link.attr('href')
     * });
     *~~~
     *
     * @param {object} event The event to be tracked.
     * @returns {*} The event.
     */
    analyticsLinkClick: function (event) {
      return event;
    },
    clickCloseDropdown: function (event, context) {
      var $el = $(event.target) || $(document),
          $btn; // When using edX Pattern Library icons the target
      // is sometimes not the button.

      if (!$el.hasClass(this.dropdownButton)) {
        // If there is a parent dropdown button that is the element to test
        $btn = $el.closest(this.dropdownButton);

        if ($btn.length > 0) {
          $el = $btn;
        }
      }

      if (!$el.hasClass('button-more') && !$el.hasClass('has-dropdown')) {
        context.closeDropdownMenu();
      }
    },
    clickOpenDropdown: function (event) {
      event.preventDefault();
      this.openMenu(this.$dropdownButton);
    },
    closeDropdownMenu: function () {
      var $open = this.$(this.menu);
      $open.removeClass('is-visible').addClass('is-hidden');
      this.$dropdownButton.removeClass('is-active').attr('aria-expanded', 'false');
    },
    focusFirstItem: function () {
      this.$menu.find('.dropdown-item:first-child .action').focus();
    },
    focusLastItem: function () {
      this.$lastItem.focus();
    },
    handlerIsAction: function (key, $el) {
      if (_.contains(this.keyForward, key)) {
        this.nextMenuItemLink($el);
      } else if (_.contains(this.keyBack, key)) {
        this.previousMenuItemLink($el);
      }
    },
    handlerIsButton: function (key, event) {
      if (_.contains(this.keyForward, key)) {
        this.focusFirstItem(); // if up arrow or left arrow key pressed or shift+tab
      } else if (_.contains(this.keyBack, key) || key === constants.keyCodes.tab && event.shiftKey) {
        event.preventDefault();
        this.focusLastItem();
      }
    },
    handlerIsMenu: function (key) {
      if (_.contains(this.keyForward, key)) {
        this.focusFirstItem();
      } else if (_.contains(this.keyBack, key)) {
        this.$dropdownButton.focus();
      }
    },
    handlerPageClicks: function (context) {
      // Only want 1 event listener for click.dropdown
      // on the page so unbind for instantiating
      this.$page.off('click.dropdown');
      this.$page.on('click.dropdown', function (event) {
        context.clickCloseDropdown(event, context);
      });
    },
    nextMenuItemLink: function ($el) {
      var items = this.$('.dropdown-menu').children('.dropdown-item').find('.action'),
          itemsCount = items.length - 1,
          index = items.index($el),
          next = index + 1;

      if (index === itemsCount) {
        this.$dropdownButton.focus();
      } else {
        items.eq(next).focus();
      }
    },
    openMenu: function ($btn) {
      var $menu = this.$menu;

      if ($menu.hasClass('is-visible')) {
        this.closeDropdownMenu();
      } else {
        $btn.addClass('is-active').attr('aria-expanded', 'true');
        $menu.removeClass('is-hidden').addClass('is-visible');
        $menu.focus();
        this.setOrientation();
        this.handlerPageClicks(this);
      }
    },
    previousMenuItemLink: function ($el) {
      var items = this.$('.dropdown-menu').children('.dropdown-item').find('.action'),
          index = items.index($el),
          prev = index - 1;

      if (index === 0) {
        this.$dropdownButton.focus();
      } else {
        items.eq(prev).focus();
      }
    },
    setOrientation: function () {
      var midpoint = $(window).width() / 2,
          alignClass = this.$dropdownButton.offset().left > midpoint ? 'align-right' : 'align-left';
      this.$menu.removeClass('align-left align-right').addClass(alignClass);
    },
    viewKeypress: function (event) {
      var key = event.keyCode,
          $el = $(event.target);

      if (_.contains(this.keyForward, key) || _.contains(this.keyBack, key)) {
        // Prevent default behavior if one of our trigger keys
        event.preventDefault();
      }

      if (key === constants.keyCodes.tab && !event.shiftKey && _.first($el) === _.first(this.$lastItem)) {
        event.preventDefault();
        this.$dropdownButton.focus();
      } else if (_.contains(this.keyClose, key)) {
        this.closeDropdownMenu();
        this.$dropdownButton.focus();
      } else if ($el.hasClass('action')) {
        // Key handlers for when a menu item has focus
        this.handlerIsAction(key, $el);
      } else if ($el.hasClass('dropdown-menu')) {
        // Key handlers for when the menu itself has focus, before an item within it receives focus
        this.handlerIsMenu(key);
      } else if ($el.hasClass('has-dropdown')) {
        // Key handlers for when the button that opens the menu has focus
        this.handlerIsButton(key, event);
      }
    }
  });
  return DropdownMenuView;
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./node_modules/edx-ui-toolkit/src/js/dropdown-menu/dropdown.underscore":
/***/ (function(module, exports) {

module.exports = "<a href=\"<%- main.url %>\" class=\"menu-title\">\n    <% if (main.screenreader_label) { %>\n        <span class=\"sr-only\"><%- main.screenreader_label %> </span>\n    <% } %>\n    <% if (main.image) { %>\n        <img class=\"menu-image\" src=\"<%- main.image %>\" alt=\"\">\n    <% } %>\n    <%- main.text %>\n</a>\n<button type=\"button\" class=\"menu-button button-more has-dropdown js-dropdown-button <% if (!button.icon) { %>default-icon<% } %>\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-controls=\"<%- menuId %>\">\n    <% if (button.icon) { %>\n        <span class=\"icon <%- button.icon %>\" aria-hidden=\"true\"></span>\n    <% } %>\n    <span class=\"sr-only\"><%- button.label %></span>\n</button>\n<ul class=\"dropdown-menu list-divided is-hidden\" id=\"<%- menuId %>\" tabindex=\"-1\">\n    <% _.each(items, function(item, index) { %>\n        <li class=\"dropdown-item item has-block-link\">\n            <a href=\"<%- item.url %>\" class=\"action\"><%- item.text %></a>\n        </li>\n    <% }); %>\n</ul>\n"

/***/ }),

/***/ "./node_modules/edx-ui-toolkit/src/js/utils/constants.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Reusable constants.
 */
(function(define) {
    'use strict';
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
        /**
         * Reusable constants.
         *
         * ### keys - A mapping of key names to their corresponding identifiers.
         * ### keyCodes - A mapping of key names to their corresponding keyCodes (DEPRECATED).
         *
         * - `constants.keys.tab` - the tab key
         * - `constants.keys.enter` - the enter key
         * - `constants.keys.esc` - the escape key
         * - `constants.keys.space` - the space key
         * - `constants.keys.left` - the left arrow key
         * - `constants.keys.up` - the up arrow key
         * - `constants.keys.right` - the right arrow key
         * - `constants.keys.down` - the down arrow key
         *
         * @class constants
         */
        return {
            keys: {
                tab: 'Tab',
                enter: 'Enter',
                esc: 'Escape',
                space: 'Space',
                left: 'ArrowLeft',
                up: 'ArrowUp',
                right: 'ArrowRight',
                down: 'ArrowDown'
            },
            // NOTE: keyCode is deprecated. Use the `key` or `code` event property if possible.
            // See: https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode
            keyCodes: {
                tab: 9,
                enter: 13,
                esc: 27,
                space: 32,
                left: 37,
                up: 38,
                right: 39,
                down: 40
            }
        };
    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
}).call(
    this,
    // Pick a define function as follows:
    // 1. Use the default 'define' function if it is available
    // 2. If not, use 'RequireJS.define' if that is available
    // 3. else use the GlobalLoader to install the class into the edx namespace
    // eslint-disable-next-line no-nested-ternary
    __webpack_require__("./node_modules/webpack/buildin/amd-define.js")
);


/***/ }),

/***/ "./node_modules/scriptjs/dist/script.js":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!
  * $script.js JS loader & dependency manager
  * https://github.com/ded/script.js
  * (c) Dustin Diaz 2014 | License MIT
  */

(function (name, definition) {
  if (typeof module != 'undefined' && module.exports) module.exports = definition()
  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
				__WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))
  else this[name] = definition()
})('$script', function () {
  var doc = document
    , head = doc.getElementsByTagName('head')[0]
    , s = 'string'
    , f = false
    , push = 'push'
    , readyState = 'readyState'
    , onreadystatechange = 'onreadystatechange'
    , list = {}
    , ids = {}
    , delay = {}
    , scripts = {}
    , scriptpath
    , urlArgs

  function every(ar, fn) {
    for (var i = 0, j = ar.length; i < j; ++i) if (!fn(ar[i])) return f
    return 1
  }
  function each(ar, fn) {
    every(ar, function (el) {
      return !fn(el)
    })
  }

  function $script(paths, idOrDone, optDone) {
    paths = paths[push] ? paths : [paths]
    var idOrDoneIsDone = idOrDone && idOrDone.call
      , done = idOrDoneIsDone ? idOrDone : optDone
      , id = idOrDoneIsDone ? paths.join('') : idOrDone
      , queue = paths.length
    function loopFn(item) {
      return item.call ? item() : list[item]
    }
    function callback() {
      if (!--queue) {
        list[id] = 1
        done && done()
        for (var dset in delay) {
          every(dset.split('|'), loopFn) && !each(delay[dset], loopFn) && (delay[dset] = [])
        }
      }
    }
    setTimeout(function () {
      each(paths, function loading(path, force) {
        if (path === null) return callback()
        
        if (!force && !/^https?:\/\//.test(path) && scriptpath) {
          path = (path.indexOf('.js') === -1) ? scriptpath + path + '.js' : scriptpath + path;
        }
        
        if (scripts[path]) {
          if (id) ids[id] = 1
          return (scripts[path] == 2) ? callback() : setTimeout(function () { loading(path, true) }, 0)
        }

        scripts[path] = 1
        if (id) ids[id] = 1
        create(path, callback)
      })
    }, 0)
    return $script
  }

  function create(path, fn) {
    var el = doc.createElement('script'), loaded
    el.onload = el.onerror = el[onreadystatechange] = function () {
      if ((el[readyState] && !(/^c|loade/.test(el[readyState]))) || loaded) return;
      el.onload = el[onreadystatechange] = null
      loaded = 1
      scripts[path] = 2
      fn()
    }
    el.async = 1
    el.src = urlArgs ? path + (path.indexOf('?') === -1 ? '?' : '&') + urlArgs : path;
    head.insertBefore(el, head.lastChild)
  }

  $script.get = create

  $script.order = function (scripts, id, done) {
    (function callback(s) {
      s = scripts.shift()
      !scripts.length ? $script(s, id, done) : $script(s, callback)
    }())
  }

  $script.path = function (p) {
    scriptpath = p
  }
  $script.urlArgs = function (str) {
    urlArgs = str;
  }
  $script.ready = function (deps, ready, req) {
    deps = deps[push] ? deps : [deps]
    var missing = [];
    !each(deps, function (dep) {
      list[dep] || missing[push](dep);
    }) && every(deps, function (dep) {return list[dep]}) ?
      ready() : !function (key) {
      delay[key] = delay[key] || []
      delay[key][push](ready)
      req && req(missing)
    }(deps.join('|'))
    return $script
  }

  $script.done = function (idOrDone) {
    $script([null], idOrDone)
  }

  return $script
});


/***/ }),

/***/ "./xmodule/js/src/xmodule.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(_, $) {/*** IMPORTS FROM imports-loader ***/
(function () {
  (function () {
    'use strict';

    var XModule = {};

    XModule.Descriptor = function () {
      /*
       * Bind the module to an element. This may be called multiple times,
       * if the element content has changed and so the module needs to be rebound
       *
       * @method: constructor
       * @param {html element} the .xmodule_edit section containing all of the descriptor content
       */
      var Descriptor = function Descriptor(element) {
        this.element = element;
        this.update = _.bind(this.update, this);
      };
      /*
       * Register a callback method to be called when the state of this
       * descriptor is updated. The callback will be passed the results
       * of calling the save method on this descriptor.
       */


      Descriptor.prototype.onUpdate = function (callback) {
        if (!this.callbacks) {
          this.callbacks = [];
        }

        this.callbacks.push(callback);
      };
      /*
       * Notify registered callbacks that the state of this descriptor has changed
       */


      Descriptor.prototype.update = function () {
        var data, callbacks, i, length;
        data = this.save();
        callbacks = this.callbacks;
        length = callbacks.length;
        $.each(callbacks, function (index, callback) {
          callback(data);
        });
      };
      /*
       * Return the current state of the descriptor (to be written to the module store)
       *
       * @method: save
       * @returns {object} An object containing children and data attributes (both optional).
       *                   The contents of the attributes will be saved to the server
       */


      Descriptor.prototype.save = function () {
        return {};
      };

      return Descriptor;
    }();

    this.XBlockToXModuleShim = function (runtime, element, initArgs) {
      /*
       * Load a single module (either an edit module or a display module)
       * from the supplied element, which should have a data-type attribute
       * specifying the class to load
       */
      var moduleType, module;

      if (initArgs) {
        moduleType = initArgs['xmodule-type'];
      }

      if (!moduleType) {
        moduleType = $(element).data('type');
      }

      if (moduleType === 'None') {
        return;
      }

      try {
        module = new window[moduleType](element, runtime);

        if ($(element).hasClass('xmodule_edit')) {
          $(document).trigger('XModule.loaded.edit', [element, module]);
        }

        if ($(element).hasClass('xmodule_display')) {
          $(document).trigger('XModule.loaded.display', [element, module]);
        }

        return module;
      } catch (error) {
        console.error('Unable to load ' + moduleType + ': ' + error.message);
      }
    }; // Export this module. We do it at the end when everything is ready
    // because some RequireJS scripts require this module. If
    // `window.XModule` appears as defined before this file has a chance
    // to execute fully, then there is a chance that RequireJS will execute
    // some script prematurely.


    this.XModule = XModule;
  }).call(this);
}).call(window);
/*** EXPORTS FROM exports-loader ***/

module.exports = window.XModule;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(1), __webpack_require__(0)))

/***/ }),

/***/ 3:
/***/ (function(module, exports) {

(function() { module.exports = window["gettext"]; }());

/***/ }),

/***/ 6:
/***/ (function(module, exports) {

(function() { module.exports = window["URI"]; }());

/***/ })

},["./cms/static/js/factories/edit_tabs.js"])));
//# sourceMappingURL=edit_tabs.js.map