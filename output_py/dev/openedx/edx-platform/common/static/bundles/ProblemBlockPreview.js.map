{"version":3,"sources":["webpack:///./common/static/xmodule/modules/js/001-3918b2d4f383c04fed8227cc9f523d6e.js","webpack:///./common/static/xmodule/modules/js/002-7de2e4f56b8dbadb90e5de21d0fd31a5.js","webpack:///./common/static/xmodule/modules/js/003-b3206f2283964743c4772b9d72c67d64.js?f7fe***","webpack:///./common/static/xmodule/modules/js/004-b0c34afa95eaa6b45d843d92ca523a94.js","webpack:///./common/static/xmodule/modules/js/005-fc8bd2dc5b96b86d1abefdd417dd8ba5.js"],"names":["JavascriptLoader","executeModuleScripts","el","callback","callbackCalled","completed","completionHandlerGenerator","loaded","placeholders","find","length","i","ref","results","push","index","allComplete","flag","len","undefined","each","placeholder","s","src","$","attr","document","createElement","setAttribute","onload","appendChild","remove","call","window","indexOfHelper","indexOf","item","Problem","element","that","hint_button","prototype","apply","arguments","enableSubmitButtonAfterTimeout","enableSubmitButtonAfterResponse","enableSubmitButton","enable","changeText","disableAllButtonsWhileRunning","operationCallback","isFromCheckOperation","submitAnswersAndSubmitButton","bind","refreshAnswers","updateMathML","jax","refreshMath","event","save_internal","save","gentle_alert","msg","clear_all_notifications","show","reset_internal","reset","get_sr_status","contents","submit_internal","submit","submit_fd","focus_on_save_notification","focus_on_hint_notification","focus_on_submit_notification","focus_on_notification","type","scroll_to_problem_meta","submit_save_waitfor","setupInputTypes","poll","prevTimeout","focusCallback","queueing","forceUpdate","response","updateProgress","renderProgressState","id","data","element_id","url","content","has_timed_out","has_response","render","selector","problemPrefix","MathJax","Hub","Queue","hasOwnProperty","update_schematics","replace","inputs","click","reviewButton","submitButton","submitButtonLabel","submitButtonSubmitText","text","submitButtonSubmittingText","hintButton","resetButton","showButton","saveButton","saveNotification","showAnswerNotification","gentleAlertNotification","submitNotification","focus","ev","icon","target","children","globalTooltipManager","openTooltip","blur","hide","removeClass","addClass","bindResetCorrectness","Collapsible","setCollapsibles","keyup","graded","progress","progressTemplate","curScore","totalScore","attemptsUsed","ngettext","edx","StringUtils","interpolate","earned","num_points","possible","progress_changed","current_score","total_possible","attempts_used","trigger","queued_items","num_queued_items","queuePollerID","clearTimeout","setTimeout","previousTimeout","postWithPrefix","newTimeout","new_queued_items","html","setHtml","HTML","promise","done","gettext","inputAjax","inputId","dispatch","input_id","inputtypeDisplays","inputtype","classes","cls","setupMethod","split","inputtypeSetupMethods","inp","is","e","name","alert","message","questionTitle","animate","scrollTop","offset","top","notification","hintIndex","abortSubmission","error","errorHtml","errors","fd","fileNotSelected","fileTooLarge","maxFileSize","requiredFilesNotSubmitted","settings","timeoutId","unallowedFileSubmitted","FormData","allowedFiles","file","maxSize","requiredFiles","loopI","loopLen","files","filename","splice","size","append","value","joinHtml","interpolateHtml","toString","processData","contentType","complete","success","Logger","log","answers","responseJSON","ajaxWithPrefix","SR","readTexts","entrance_exam_passed","parent","postMessage","addedStatus","ariaLabel","labeledStatus","parentSection","statusElement","template","closest","label","status","readText","problem","key","safeKey","answer","isArray","display","showMethod","inputtypeShowAnswerMethods","correct_status_html","saveMessage","elid","eqn","mathjaxPreprocessor","preprocessorTag","getAllJax","val","root","toMathML","exception","restart","Callback","After","schematic","update_value","CodeMirror","serialize","answered","atLeastOneTextInputFound","oneTextInputFilled","textField","on","choicegroupBlock","checked","j","checkboxOrRadio","removeAttr","selectField","selectedOption","trim","$inputtypes","add","bindMethod","bindResetCorrectnessByInputtype","formulaequationinput","$p","choicegroup","$element","match","$status","style","$select","textline","preprocessor","preprocessorClass","preprocessorClassName","fn","cminput","container","CodeMirrorEditor","CodeMirrorTextArea","linenumbers","mode","spaces","tabsize","Array","parseInt","join","fromTextArea","lineNumbers","indentUnit","tabSize","matchBrackets","lineWrapping","indentWithTabs","smartIndent","extraKeys","Esc","Tab","cm","replaceSelection","getInputField","correctStatusHtml","choice","$inputLabel","$inputStatus","hasClass","choicetextgroup","imageinput","canvas","types","context","rectangle","ctx","coords","rects","reg","rect","abs","height","points","width","Math","exec","stroke","fill","regions","parseCoords","coordinates","JSON","parse","region","beginPath","idx","point","moveTo","lineTo","closePath","getContext","console","fillStyle","strokeStyle","lineWidth","allButtons","initiallyEnabledButtons","filter","button","enableButtons","always","buttons","changeSubmitButtonText","forEach","disabled","submitCanBeEnabled","hintContainer","nextIndex","hint_index","hintMsgContainer","should_enable_next_hint","toggleFull","toggleHint","linkBottom","linkTop","short_custom","elt","close_text","open_text","$el","new_text","preventDefault","siblings","slideToggle","toggleClass","ImageInput","ImageInputConstructor","constructor","clickHandler","elementId","crossEl","inputEl","posX","offsetX","pageX","left","posY","offsetY","pageY","result","round","css","visibility","cktsim","T_VOLTAGE","T_CURRENT","v_newt_lim","v_abstol","i_abstol","eps","dc_max_iters","max_tran_iters","time_step_increase_factor","lte_step_decrease_factor","nr_step_decrease_factor","reltol","lterel","res_check_abs","sqrt","res_check_rel","Circuit","node_map","ntypes","initial_conditions","devices","device_map","voltage_sources","current_sources","finalized","diddc","node_index","periods","gnd_node","node","ntype","ic","finalize","N","matrix","mat_make","Gl","G","C","soln_max","abstol","solution","rhs","load_linear","n_vsrc","GV","branch","rGV","mat_rank","load_netlist","netlist","component","connections","found_ground","properties","r","d","c","l","v","opamp","n","p","find_solution","load","maxiters","soln","d_sol","abssum_compare","converged","abssum_old","abssum_rhs","use_limiting","down_count","thresh","iter","mat_solve_rq","problem_node","dc","load_dc","ckt","mat_v_mult","mat_copy","iterations","tran","ntpts","tstart","tstop","probenames","no_dc","load_tran","time","q","dqdt","alpha0","alpha1","oldq","alpha2","old2q","beta0","beta1","oldc","mat_scale_add","interp_coeffs","t","t0","t1","t2","dtt0","dtt1","dtt2","dt0dt1","dt0dt2","dt1dt2","pick_step","step_index","min_shrink_factor","max_growth_factor","oldt","old2t","old3t","trapcoeff","maxlteratio","ltecheck","pred","oldsol","old2sol","old3sol","lte","lteratio","max","new_step","lte_step_ratio","pow","min_step","min","max_step","old3q","ar","algebraic","period","per","ceil","max_nsteps","ac","npts","fstart","fstop","source_name","matrixac","load_ac","delta_f","exp","LN10","phase_offset","f","omega","PI","solac","mat_solve","mag","phase","atan2","phasei","L","phase_jump","add_device","n1","n2","parse_number","Resistor","area","Diode","Capacitor","Inductor","VSource","ISource","np","nn","no","ng","A","ratio","Opamp","g","Fet","add_two_terminal","M","get_two_terminal","x","xi_minus_xj","add_conductance_l","add_conductance","add_capacitance","add_to_Gl","add_to_G","add_to_C","add_to_rhs","mat","b","scale","m","temp","B","scalea","scaleb","Nr","Mc","R","one_if_alg","row","col","dest","mat_copy_transposed","Mo","Nc","max_abs_entry","the_rank","start_col","max_v","max_row","mat_scale","max_nonzero_row","maxsumsq","rowp","Mr","sumsq","row_norm","Mrp","inner","max_col","Device","breakpoint","ord","ch","charCodeAt","default_v","slen","multiplier","charAt","start","exponent","parse_source","inflection_point","fun","slice","args","end","arg_end","arg_value","h","w","pwl_source","v1","v2","td","tr","freq","duty_cycle","Infinity","t_change","t_pw","tf","pw","t3","t4","voffset","va","sin","tv_pairs","repeat","nvals","fmod","last_t","last_v","next_t","next_v","numerator","denominator","quotient","floor","npos","nneg","anode","cathode","ais","vt","exp_arg_max","exp_max","vd","exp_arg","temp1","temp2","abs_exp_arg","d_arg","quad","gd","gain","invA","type_sign","kp","beta","lambda","vds","vgs","vgst","gmgs","ids","gds","module","schematics","getAttribute","Schematic","err","msgdiv","border","margins","padding","createTextNode","parentNode","insertBefore","background_style","element_style","thumb_style","normal_style","component_style","selected_style","grid_style","annotation_style","property_size","annotation_size","parts_map","Ground","Label","OpAmp","NFet","PFet","Probe","Ammeter","sch_clipboard","input","show_grid","grid","origin_x","origin_y","cursor_x","cursor_y","window_list","edits_allowed","parts","parts_bin","part","Part","pm","set_component","analyses","diagram_only","submit_analyses","tools","toolbar","add_tool","grid_icon","toggle_grid","enable_tool","cut_icon","cut","copy_icon","copy","paste_icon","paste","dc_analysis","setup_ac_analysis","ac_npts","ac_fstart","ac_fstop","ac_source_name","transient_analysis","tran_npts","tran_tstop","sctl_r","sctl_x","sctl_y","zctl_left","zctl_top","bg_image","tabIndex","borderStyle","borderWidth","borderColor","outline","addEventListener","schematic_mouse_move","schematic_mouse_enter","schematic_mouse_leave","schematic_mouse_down","schematic_mouse_up","schematic_mouse_wheel","schematic_double_click","schematic_key_down","schematic_key_up","status_div","status_height","connection_points","components","dragging","select_rect","wire","operating_point","dc_results","ac_results","transient_results","ctrlKey","shiftKey","altKey","cmdKey","table","rules","frame","backgroundColor","verticalAlign","colSpan","tool","wrapper","position","parts_table","cellPadding","cellSpacing","parts_per_column","part_h","toplevel","onselectstart","nextSibling","load_schematic","zoomall","part_w","add_component","new_c","remove_component","find_connections","cp","location","add_connection_point","cplist","remove_connection_point","old_location","update_connection_point","add_wire","x1","y1","x2","y2","new_wire","Wire","move_end","split_wire","y","dx","dy","check_wires","cc","bisect","redraw_background","check_connection_points","locn","bisect_cp","clean_up_wires","c1","c2","e1","other_end","e2","e3","collinear","unselect_all","which","set_select","drag_begin","selected","move_begin","drag_x","drag_y","drag_end","help","open","rescale","nscale","cx","cy","zoom_factor","zoom_min","zoom_max","origin_min","origin_max","zoomin","zoomout","sch_w","bbox","sch_h","scale_x","scale_y","redraw","clone","initial_value","json","label_connection_points","clear_labels","add_default_labels","next_label","label_connections","get_next_label","propagate_label","stringify","json_with_analyses","extract_circuit","find_probes","info","probe_info","npts_lbl","fstart_lbl","fstop_lbl","source_name_lbl","fields","build_input","build_table","sch","dialog","ac_analysis","x_values","flist","values","fvlist","k","y_values","z_values","probes","probe_maxv","probe_color","array_max","all_max","color","v_max","graph2","graph","graph1","tstop_lbl","probe_list","probe_names","times","tlist","tvlist","x_legend","v_values","i_values","set_property","component_name","property","lineCap","fillRect","first_x","last_x","first_y","last_y","draw_line","min_x","max_x","min_y","max_y","draw","unsel_bbox","drawImage","selections","display_voltage","display_current","arc","strokeRect","cross_cursor","draw_arc","radius","start_radians","end_radians","anticlockwise","filled","draw_text","font","fillText","HTMLCanvasElement","relMouseCoords","totalOffsetX","totalOffsetY","currentElement","offsetLeft","offsetTop","offsetParent","mouse_x","mouse_y","page_x","page_y","srcElement","code","keyCode","rotate","new_part","select","drawCursor","mx","my","sx","sy","zx","zy","delta","reselect","was_previously_selected","move","canonicalize","wheelDelta","detail","edit_properties","nodeValue","append_message","title","plist","getElementsByClassName","field","dialog_check_for_ENTER","body","marginBotton","ok_button","dialog_okay","margin","cancel_button","dialog_cancel","textAlign","window_close","win","a","tbl","col1","col2","className","build_select","options","option","selectedIndex","draw_y","head","close_button","Image","close_icon","cssFloat","window_close_button","window_mouse_down","background","bring_to_front","insert","wlist","zIndex","removeChild","window_mouse_move","window_mouse_up","tracking_window","removeEventListener","tip","child","hidden","backgroundImage","innerHTML","classList","search","tool_enter","tool_leave","tool_click","enabled","tname","removeAttribute","tagName","toLowerCase","stopPropagation","help_icon","CanvasRenderingContext2D","dashedLineTo","fromX","fromY","toX","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","dash","ang","cos","view_limits","vmin","vmax","log_range","engineering_notation","nplaces","sign","log10","mantissa","mstring","mlen","endindex","substring","grid_pattern","cursor_pattern","y_legend","z_legend","pwidth","pheight","left_margin","top_margin","right_margin","bottom_margin","tick_length","x_min","array_min","x_max","x_limits","x_scale","plot_x","textBaseline","plot_y","y_max","y_scale","y_min","plot","y_limits","nx","ny","probe_colors_rgb","plot_z","z","z_max","z_scale","z_min","z_limits","tick_length_half","tick_delta","nz","translate","restore","cursor1_x","cursor2_x","graph_mouse_move","redraw_plot","plot_cursor","end_y","graph_x","tx","ty","z1","z2","gx","gy","cursor","xpart","part_enter","part_leave","part_mouse_down","part_mouse_up","set_location","right","offsetWidth","bottom","offsetHeight","bounding_box","between","inside","intersect","r1","r2","Component","rotation","props","conns","add_connection","offset_x","offset_y","ConnectionPoint","update_coords","transform_x","transform_y","update_location","amount","old_rotation","move_x","move_y","rot","nx1","ny1","nx2","ny2","draw_circle","rot_angle","aOrient","alignment","near","clear_label","vmap","connection_point_radius","ensureHTML","coincident","draw_x","toFixed","globalAlpha","p1","p2","p3","near_distance","x_plus_dx","y_plus_dy","D","probe_colors","color_choice","c_e1","c_e2","diode_types","w_over_l","W_L","dim","Source","params","source_functions","build_content","src_types","type_select","source_type_changed","run","first","labels","div","hasChildNodes","firstChild","component_slider","ui","sname","slider","cname","pname","suffix","choices","analysis"],"mappings":"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","file":"ProblemBlockPreview.js","sourcesContent":["/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n(function() {\n    'use strict';\n    this.JavascriptLoader = (function() {\n        function JavascriptLoader() {\n        }\n\n        /**\n         * Set of library functions that provide common interface for javascript loading\n         * for all module types. All functionality provided by JavascriptLoader should take\n         * place at module scope, i.e. don't run jQuery over entire page.\n         *\n         * executeModuleScripts:\n         *     Scan the module ('el') for \"script_placeholder\"s, then:\n         *\n         *     1) Fetch each script from server\n         *     2) Explicitly attach the script to the <head> of document\n         *     3) Explicitly wait for each script to be loaded\n         *     4) Return to callback function when all scripts loaded\n         */\n        JavascriptLoader.executeModuleScripts = function(el, callback) {\n            var callbackCalled, completed, completionHandlerGenerator, loaded, placeholders;\n            if (!callback) {\n                callback = null; // eslint-disable-line no-param-reassign\n            }\n            placeholders = el.find('.script_placeholder');\n            if (placeholders.length === 0) {\n                if (callback !== null) {\n                    callback();\n                }\n                return [];\n            }\n            // TODO: Verify the execution order of multiple placeholders\n            completed = (function() {\n                var i, ref, results;\n                results = [];\n                for (i = 1, ref = placeholders.length; ref >= 1 ? i <= ref : i >= ref; ref >= 1 ? ++i : --i) {\n                    results.push(false);\n                }\n                return results;\n            }());\n            callbackCalled = false;\n            completionHandlerGenerator = function(index) {\n                return function() {\n                    var allComplete, flag, i, len;\n                    allComplete = true;\n                    completed[index] = true;\n                    for (i = 0, len = completed.length; i < len; i++) {\n                        flag = completed[i];\n                        if (!flag) {\n                            allComplete = false;\n                            break;\n                        }\n                    }\n                    if (allComplete && !callbackCalled) {\n                        callbackCalled = true;\n                        if (callback !== null) {\n                            return callback();\n                        }\n                    }\n                    return undefined;\n                };\n            };\n            // Keep a map of what sources we're loaded from, and don't do it twice.\n            loaded = {};\n            return placeholders.each(function(index, placeholder) {\n                var s, src;\n                // TODO: Check if the script already exists in DOM. If so, (1) copy it\n                // into memory; (2) delete the DOM script element; (3) reappend it.\n                // This would prevent memory bloat and save a network request.\n                src = $(placeholder).attr('data-src');\n                if (!(src in loaded)) {\n                    loaded[src] = true;\n                    s = document.createElement('script');\n                    s.setAttribute('src', src);\n                    s.setAttribute('type', 'text/javascript');\n                    s.onload = completionHandlerGenerator(index);\n                    // Need to use the DOM elements directly or the scripts won't execute properly.\n                    $('head')[0].appendChild(s);\n                } else {\n                    // just call the completion callback directly, without reloading the file\n                    completionHandlerGenerator(index)();\n                }\n                return $(placeholder).remove();\n            });\n        };\n\n        return JavascriptLoader;\n    }());\n}).call(this);\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/001-3918b2d4f383c04fed8227cc9f523d6e.js","/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n/* global MathJax, Collapsible, interpolate, JavascriptLoader, Logger, CodeMirror */\n// Note: this code was originally converted from CoffeeScript, and thus follows some\n// coding conventions that are discouraged by eslint. Some warnings have been suppressed\n// to avoid substantial rewriting of the code. Allow the eslint suppressions to exceed\n// the max line length of 120.\n/* eslint max-len: [\"error\", 120, { \"ignoreComments\": true }] */\n\n(function() {\n    'use strict';\n    var indexOfHelper = [].indexOf ||\n        function(item) {\n            var i, len;\n            for (i = 0, len = this.length; i < len; i++) {\n                if (i in this && this[i] === item) {\n                    return i;\n                }\n            }\n            return -1;\n        };\n\n    this.Problem = (function() {\n        function Problem(element) {\n            var that = this;\n            this.hint_button = function() {\n                return Problem.prototype.hint_button.apply(that, arguments);\n            };\n            this.enableSubmitButtonAfterTimeout = function() {\n                return Problem.prototype.enableSubmitButtonAfterTimeout.apply(that, arguments);\n            };\n            this.enableSubmitButtonAfterResponse = function() {\n                return Problem.prototype.enableSubmitButtonAfterResponse.apply(that, arguments);\n            };\n            this.enableSubmitButton = function(enable, changeText) {\n                if (changeText === null || changeText === undefined) {\n                    changeText = true; // eslint-disable-line no-param-reassign\n                }\n                return Problem.prototype.enableSubmitButton.apply(that, arguments);\n            };\n            this.disableAllButtonsWhileRunning = function(\n                operationCallback, isFromCheckOperation // eslint-disable-line no-unused-vars\n            ) {\n                return Problem.prototype.disableAllButtonsWhileRunning.apply(that, arguments);\n            };\n            this.submitAnswersAndSubmitButton = function(bind) {\n                if (bind === null || bind === undefined) {\n                    bind = false;  // eslint-disable-line no-param-reassign\n                }\n                return Problem.prototype.submitAnswersAndSubmitButton.apply(that, arguments);\n            };\n            this.refreshAnswers = function() {\n                return Problem.prototype.refreshAnswers.apply(that, arguments);\n            };\n            this.updateMathML = function(jax, el) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.updateMathML.apply(that, arguments);\n            };\n            this.refreshMath = function(event, el) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.refreshMath.apply(that, arguments);\n            };\n            this.save_internal = function() {\n                return Problem.prototype.save_internal.apply(that, arguments);\n            };\n            this.save = function() {\n                return Problem.prototype.save.apply(that, arguments);\n            };\n            this.gentle_alert = function(msg) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.gentle_alert.apply(that, arguments);\n            };\n            this.clear_all_notifications = function() {\n                return Problem.prototype.clear_all_notifications.apply(that, arguments);\n            };\n            this.show = function() {\n                return Problem.prototype.show.apply(that, arguments);\n            };\n            this.reset_internal = function() {\n                return Problem.prototype.reset_internal.apply(that, arguments);\n            };\n            this.reset = function() {\n                return Problem.prototype.reset.apply(that, arguments);\n            };\n            this.get_sr_status = function(contents) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.get_sr_status.apply(that, arguments);\n            };\n            this.submit_internal = function() {\n                return Problem.prototype.submit_internal.apply(that, arguments);\n            };\n            this.submit = function() {\n                return Problem.prototype.submit.apply(that, arguments);\n            };\n            this.submit_fd = function() {\n                return Problem.prototype.submit_fd.apply(that, arguments);\n            };\n            this.focus_on_save_notification = function() {\n                return Problem.prototype.focus_on_save_notification.apply(that, arguments);\n            };\n            this.focus_on_hint_notification = function() {\n                return Problem.prototype.focus_on_hint_notification.apply(that, arguments);\n            };\n            this.focus_on_submit_notification = function() {\n                return Problem.prototype.focus_on_submit_notification.apply(that, arguments);\n            };\n            this.focus_on_notification = function(type) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.focus_on_notification.apply(that, arguments);\n            };\n            this.scroll_to_problem_meta = function() {\n                return Problem.prototype.scroll_to_problem_meta.apply(that, arguments);\n            };\n            this.submit_save_waitfor = function(callback) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.submit_save_waitfor.apply(that, arguments);\n            };\n            this.setupInputTypes = function() {\n                return Problem.prototype.setupInputTypes.apply(that, arguments);\n            };\n            this.poll = function(prevTimeout, focusCallback // eslint-disable-line no-unused-vars\n            ) {\n                return Problem.prototype.poll.apply(that, arguments);\n            };\n            this.queueing = function(focusCallback) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.queueing.apply(that, arguments);\n            };\n            this.forceUpdate = function(response) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.forceUpdate.apply(that, arguments);\n            };\n            this.updateProgress = function(response) { // eslint-disable-line no-unused-vars\n                return Problem.prototype.updateProgress.apply(that, arguments);\n            };\n            this.renderProgressState = function() {\n                return Problem.prototype.renderProgressState.apply(that, arguments);\n            };\n            this.bind = function() {\n                return Problem.prototype.bind.apply(that, arguments);\n            };\n            this.el = $(element).find('.problems-wrapper');\n            this.id = this.el.data('problem-id');\n            this.element_id = this.el.attr('id');\n            this.url = this.el.data('url');\n            this.content = this.el.data('content');\n\n            // has_timed_out and has_response are used to ensure that\n            // we wait a minimum of ~ 1s before transitioning the submit\n            // button from disabled to enabled\n            this.has_timed_out = false;\n            this.has_response = false;\n            this.render(this.content);\n        }\n\n        Problem.prototype.$ = function(selector) {\n            return $(selector, this.el);\n        };\n\n        Problem.prototype.bind = function() {\n            var problemPrefix,\n                that = this;\n            if (typeof MathJax !== 'undefined' && MathJax !== null) {\n                this.el.find('.problem > div').each(function(index, element) {\n                    return MathJax.Hub.Queue(['Typeset', MathJax.Hub, element]);\n                });\n            }\n            if (window.hasOwnProperty('update_schematics')) {\n                window.update_schematics();\n            }\n            problemPrefix = this.element_id.replace(/problem_/, '');\n            this.inputs = this.$('[id^=\"input_' + problemPrefix + '_\"]');\n            this.$('div.action button').click(this.refreshAnswers);\n            this.reviewButton = this.$('.notification-btn.review-btn');\n            this.reviewButton.click(this.scroll_to_problem_meta);\n            this.submitButton = this.$('.action .submit');\n            this.submitButtonLabel = this.$('.action .submit .submit-label');\n            this.submitButtonSubmitText = this.submitButtonLabel.text();\n            this.submitButtonSubmittingText = this.submitButton.data('submitting');\n            this.submitButton.click(this.submit_fd);\n            this.hintButton = this.$('.action .hint-button');\n            this.hintButton.click(this.hint_button);\n            this.resetButton = this.$('.action .reset');\n            this.resetButton.click(this.reset);\n            this.showButton = this.$('.action .show');\n            this.showButton.click(this.show);\n            this.saveButton = this.$('.action .save');\n            this.saveNotification = this.$('.notification-save');\n            this.showAnswerNotification = this.$('.notification-show-answer');\n            this.saveButton.click(this.save);\n            this.gentleAlertNotification = this.$('.notification-gentle-alert');\n            this.submitNotification = this.$('.notification-submit');\n\n            // Accessibility helper for sighted keyboard users to show <clarification> tooltips on focus:\n            this.$('.clarification').focus(function(ev) {\n                var icon;\n                icon = $(ev.target).children('i');\n                return window.globalTooltipManager.openTooltip(icon);\n            });\n            this.$('.clarification').blur(function() {\n                return window.globalTooltipManager.hide();\n            });\n            this.$('.review-btn').focus(function(ev) {\n                return $(ev.target).removeClass('sr');\n            });\n            this.$('.review-btn').blur(function(ev) {\n                return $(ev.target).addClass('sr');\n            });\n            this.bindResetCorrectness();\n            if (this.submitButton.length) {\n                this.submitAnswersAndSubmitButton(true);\n            }\n            Collapsible.setCollapsibles(this.el);\n            this.$('input.math').keyup(this.refreshMath);\n            if (typeof MathJax !== 'undefined' && MathJax !== null) {\n                this.$('input.math').each(function(index, element) {\n                    return MathJax.Hub.Queue([that.refreshMath, null, element]);\n                });\n            }\n        };\n\n        Problem.prototype.renderProgressState = function() {\n            var graded, progress, progressTemplate, curScore, totalScore, attemptsUsed;\n            curScore = this.el.data('problem-score');\n            totalScore = this.el.data('problem-total-possible');\n            attemptsUsed = this.el.data('attempts-used');\n            graded = this.el.data('graded');\n\n            // The problem is ungraded if it's explicitly marked as such, or if the total possible score is 0\n            if (graded === 'True' && totalScore !== 0) {\n                graded = true;\n            } else {\n                graded = false;\n            }\n\n            if (curScore === undefined || totalScore === undefined) {\n                // Render an empty string.\n                progressTemplate = '';\n            } else if (curScore === null || curScore === 'None') {\n                // Render 'x point(s) possible (un/graded, results hidden)' if no current score provided.\n                if (graded) {\n                    progressTemplate = ngettext(\n                        // Translators: {num_points} is the number of points possible (examples: 1, 3, 10).;\n                        '{num_points} point possible (graded, results hidden)',\n                        '{num_points} points possible (graded, results hidden)',\n                        totalScore\n                    );\n                } else {\n                    progressTemplate = ngettext(\n                        // Translators: {num_points} is the number of points possible (examples: 1, 3, 10).;\n                        '{num_points} point possible (ungraded, results hidden)',\n                        '{num_points} points possible (ungraded, results hidden)',\n                        totalScore\n                    );\n                }\n            } else if ((attemptsUsed === 0 || totalScore === 0) && curScore === 0) {\n                // Render 'x point(s) possible' if student has not yet attempted question\n                // But if staff has overridden score to a non-zero number, show it\n                if (graded) {\n                    progressTemplate = ngettext(\n                        // Translators: {num_points} is the number of points possible (examples: 1, 3, 10).;\n                        '{num_points} point possible (graded)', '{num_points} points possible (graded)',\n                        totalScore\n                    );\n                } else {\n                    progressTemplate = ngettext(\n                        // Translators: {num_points} is the number of points possible (examples: 1, 3, 10).;\n                        '{num_points} point possible (ungraded)', '{num_points} points possible (ungraded)',\n                        totalScore\n                    );\n                }\n            } else {\n                // Render 'x/y point(s)' if student has attempted question\n                if (graded) {\n                    progressTemplate = ngettext(\n                        // This comment needs to be on one line to be properly scraped for the translators.\n                        // Translators: {earned} is the number of points earned. {possible} is the total number of points (examples: 0/1, 1/1, 2/3, 5/10). The total number of points will always be at least 1. We pluralize based on the total number of points (example: 0/1 point; 1/2 points);\n                        '{earned}/{possible} point (graded)', '{earned}/{possible} points (graded)',\n                        totalScore\n                    );\n                } else {\n                    progressTemplate = ngettext(\n                        // This comment needs to be on one line to be properly scraped for the translators.\n                        // Translators: {earned} is the number of points earned. {possible} is the total number of points (examples: 0/1, 1/1, 2/3, 5/10). The total number of points will always be at least 1. We pluralize based on the total number of points (example: 0/1 point; 1/2 points);\n                        '{earned}/{possible} point (ungraded)', '{earned}/{possible} points (ungraded)',\n                        totalScore\n                    );\n                }\n            }\n            progress = edx.StringUtils.interpolate(\n                progressTemplate, {\n                    earned: curScore,\n                    num_points: totalScore,\n                    possible: totalScore\n                }\n            );\n            return this.$('.problem-progress').text(progress);\n        };\n\n        Problem.prototype.updateProgress = function(response) {\n            if (response.progress_changed) {\n                this.el.data('problem-score', response.current_score);\n                this.el.data('problem-total-possible', response.total_possible);\n                this.el.data('attempts-used', response.attempts_used);\n                this.el.trigger('progressChanged');\n            }\n            return this.renderProgressState();\n        };\n\n        Problem.prototype.forceUpdate = function(response) {\n            this.el.data('problem-score', response.current_score);\n            this.el.data('problem-total-possible', response.total_possible);\n            this.el.data('attempts-used', response.attempts_used);\n            this.el.trigger('progressChanged');\n            return this.renderProgressState();\n        };\n\n        Problem.prototype.queueing = function(focusCallback) {\n            var that = this;\n            this.queued_items = this.$('.xqueue');\n            this.num_queued_items = this.queued_items.length;\n            if (this.num_queued_items > 0) {\n                if (window.queuePollerID) { // Only one poller 'thread' per Problem\n                    window.clearTimeout(window.queuePollerID);\n                }\n                window.queuePollerID = window.setTimeout(function() {\n                    return that.poll(1000, focusCallback);\n                }, 1000);\n            }\n        };\n\n        Problem.prototype.poll = function(previousTimeout, focusCallback) {\n            var that = this;\n            return $.postWithPrefix('' + this.url + '/problem_get', function(response) {\n                var newTimeout;\n                // If queueing status changed, then render\n                that.new_queued_items = $(response.html).find('.xqueue');\n                if (that.new_queued_items.length !== that.num_queued_items) {\n                    edx.HtmlUtils.setHtml(that.el, edx.HtmlUtils.HTML(response.html)).promise().done(function() {\n                        return typeof focusCallback === 'function' ? focusCallback() : void 0;\n                    });\n                    JavascriptLoader.executeModuleScripts(that.el, function() {\n                        that.setupInputTypes();\n                        that.bind();\n                    });\n                }\n                that.num_queued_items = that.new_queued_items.length;\n                if (that.num_queued_items === 0) {\n                    that.forceUpdate(response);\n                    delete window.queuePollerID;\n                } else {\n                    newTimeout = previousTimeout * 2;\n                    // if the timeout is greather than 1 minute\n                    if (newTimeout >= 60000) {\n                        delete window.queuePollerID;\n                        that.gentle_alert(\n                            gettext('The grading process is still running. Refresh the page to see updates.')\n                        );\n                    } else {\n                        window.queuePollerID = window.setTimeout(function() {\n                            return that.poll(newTimeout, focusCallback);\n                        }, newTimeout);\n                    }\n                }\n            });\n        };\n\n        /**\n         * Use this if you want to make an ajax call on the input type object\n         * static method so you don't have to instantiate a Problem in order to use it\n         *\n         * Input:\n         *     url: the AJAX url of the problem\n         *     inputId: the inputId of the input you would like to make the call on\n         *         NOTE: the id is the ${id} part of \"input_${id}\" during rendering\n         *             If this function is passed the entire prefixed id, the backend may have trouble\n         *             finding the correct input\n         *     dispatch: string that indicates how this data should be handled by the inputtype\n         *     data: dictionary of data to send to the server\n         *     callback: the function that will be called once the AJAX call has been completed.\n         *          It will be passed a response object\n         */\n        Problem.inputAjax = function(url, inputId, dispatch, data, callback) {\n            data.dispatch = dispatch; // eslint-disable-line no-param-reassign\n            data.input_id = inputId; // eslint-disable-line no-param-reassign\n            return $.postWithPrefix('' + url + '/input_ajax', data, callback);\n        };\n\n        Problem.prototype.render = function(content, focusCallback) {\n            var that = this;\n            if (content) {\n                edx.HtmlUtils.setHtml(this.el, edx.HtmlUtils.HTML(content));\n                return JavascriptLoader.executeModuleScripts(this.el, function() {\n                    that.setupInputTypes();\n                    that.bind();\n                    that.queueing(focusCallback);\n                    that.renderProgressState();\n                    return typeof focusCallback === 'function' ? focusCallback() : void 0;\n                });\n            } else {\n                return $.postWithPrefix('' + this.url + '/problem_get', function(response) {\n                    edx.HtmlUtils.setHtml(that.el, edx.HtmlUtils.HTML(response.html));\n                    return JavascriptLoader.executeModuleScripts(that.el, function() {\n                        that.setupInputTypes();\n                        that.bind();\n                        that.queueing();\n                        return that.forceUpdate(response);\n                    });\n                });\n            }\n        };\n\n        Problem.prototype.setupInputTypes = function() {\n            var that = this;\n            this.inputtypeDisplays = {};\n            return this.el.find('.capa_inputtype').each(function(index, inputtype) {\n                var classes, cls, id, setupMethod, i, len, results;\n                classes = $(inputtype).attr('class').split(' ');\n                id = $(inputtype).attr('id');\n                results = [];\n                for (i = 0, len = classes.length; i < len; i++) {\n                    cls = classes[i];\n                    setupMethod = that.inputtypeSetupMethods[cls];\n                    if (setupMethod != null) {\n                        results.push(that.inputtypeDisplays[id] = setupMethod(inputtype));\n                    } else {\n                        results.push(void 0);\n                    }\n                }\n                return results;\n            });\n        };\n\n        /**\n         * If some function wants to be called before sending the answer to the\n         * server, give it a chance to do so.\n         *\n         * submit_save_waitfor allows the callee to send alerts if the user's input is\n         * invalid. To do so, the callee must throw an exception named \"WaitforException\".\n         * This and any other errors or exceptions that arise from the callee are rethrown\n         * and abort the submission.\n         *\n         * In order to use this feature, add a 'data-waitfor' attribute to the input,\n         * and specify the function to be called by the submit button before sending off @answers\n         */\n        Problem.prototype.submit_save_waitfor = function(callback) {\n            var flag, inp, i, len, ref,\n                that = this;\n            flag = false;\n            ref = this.inputs;\n            for (i = 0, len = ref.length; i < len; i++) {\n                inp = ref[i];\n                if ($(inp).is('input[waitfor]')) {\n                    try {\n                        $(inp).data('waitfor')(function() {\n                            that.refreshAnswers();\n                            return callback();\n                        });\n                    } catch (e) {\n                        if (e.name === 'Waitfor Exception') {\n                            alert(e.message); // eslint-disable-line no-alert\n                        } else {\n                            alert( // eslint-disable-line no-alert\n                                gettext('Could not grade your answer. The submission was aborted.')\n                            );\n                        }\n                        throw e;\n                    }\n                    flag = true;\n                } else {\n                    flag = false;\n                }\n            }\n            return flag;\n        };\n\n        // Scroll to problem metadata and next focus is problem input\n        Problem.prototype.scroll_to_problem_meta = function() {\n            var questionTitle;\n            questionTitle = this.$('.problem-header');\n            if (questionTitle.length > 0) {\n                $('html, body').animate({\n                    scrollTop: questionTitle.offset().top\n                }, 500);\n                questionTitle.focus();\n            }\n        };\n\n        Problem.prototype.focus_on_notification = function(type) {\n            var notification;\n            notification = this.$('.notification-' + type);\n            if (notification.length > 0) {\n                notification.focus();\n            }\n        };\n\n        Problem.prototype.focus_on_submit_notification = function() {\n            this.focus_on_notification('submit');\n        };\n\n        Problem.prototype.focus_on_hint_notification = function(hintIndex) {\n            this.$('.notification-hint .notification-message > ol > li.hint-index-' + hintIndex).focus();\n        };\n\n        Problem.prototype.focus_on_save_notification = function() {\n            this.focus_on_notification('save');\n        };\n\n        /**\n         * 'submit_fd' uses FormData to allow file submissions in the 'problem_check' dispatch,\n         *      in addition to simple querystring-based answers\n         *\n         * NOTE: The dispatch 'problem_check' is being singled out for the use of FormData;\n         *       maybe preferable to consolidate all dispatches to use FormData\n         */\n        Problem.prototype.submit_fd = function() {\n            var abortSubmission, error, errorHtml, errors, fd, fileNotSelected, fileTooLarge, maxFileSize,\n                requiredFilesNotSubmitted, settings, timeoutId, unallowedFileSubmitted, i, len,\n                that = this;\n\n            // If there are no file inputs in the problem, we can fall back on submit.\n            if (this.el.find('input:file').length === 0) {\n                this.submit();\n                return;\n            }\n            this.enableSubmitButton(false);\n            if (!window.FormData) {\n                alert(gettext('Submission aborted! Sorry, your browser does not support file uploads. If you can, please use Chrome or Safari which have been verified to support file uploads.')); // eslint-disable-line max-len, no-alert\n                this.enableSubmitButton(true);\n                return;\n            }\n            timeoutId = this.enableSubmitButtonAfterTimeout();\n            fd = new FormData();\n\n            // Sanity checks on submission\n            maxFileSize = 4 * 1000 * 1000;\n            fileTooLarge = false;\n            fileNotSelected = false;\n            requiredFilesNotSubmitted = false;\n            unallowedFileSubmitted = false;\n\n            errors = [];\n            this.inputs.each(function(index, element) {\n                var allowedFiles, file, maxSize, requiredFiles, loopI, loopLen, ref;\n                if (element.type === 'file') {\n                    requiredFiles = $(element).data('required_files');\n                    allowedFiles = $(element).data('allowed_files');\n                    ref = element.files;\n                    for (loopI = 0, loopLen = ref.length; loopI < loopLen; loopI++) {\n                        file = ref[loopI];\n                        if (allowedFiles.length !== 0 && indexOfHelper.call(allowedFiles, file.name) < 0) {\n                            unallowedFileSubmitted = true;\n                            errors.push(edx.StringUtils.interpolate(\n                                gettext('You submitted {filename}; only {allowedFiles} are allowed.'), {\n                                    filename: file.name,\n                                    allowedFiles: allowedFiles\n                                }\n                            ));\n                        }\n                        if (indexOfHelper.call(requiredFiles, file.name) >= 0) {\n                            requiredFiles.splice(requiredFiles.indexOf(file.name), 1);\n                        }\n                        if (file.size > maxFileSize) {\n                            fileTooLarge = true;\n                            maxSize = maxFileSize / (1000 * 1000);\n                            errors.push(edx.StringUtils.interpolate(\n                                gettext('Your file {filename} is too large (max size: {maxSize}MB).'), {\n                                    filename: file.name,\n                                    maxSize: maxSize\n                                }\n                            ));\n                        }\n                        fd.append(element.id, file);  // xss-lint: disable=javascript-jquery-append\n                    }\n                    if (element.files.length === 0) {\n                        fileNotSelected = true;\n                        // In case we want to allow submissions with no file\n                        fd.append(element.id, '');  // xss-lint: disable=javascript-jquery-append\n                    }\n                    if (requiredFiles.length !== 0) {\n                        requiredFilesNotSubmitted = true;\n                        errors.push(edx.StringUtils.interpolate(\n                            gettext('You did not submit the required files: {requiredFiles}.'), {\n                                requiredFiles: requiredFiles\n                            }\n                        ));\n                    }\n                } else {\n                    fd.append(element.id, element.value);  // xss-lint: disable=javascript-jquery-append\n                }\n            });\n            if (fileNotSelected) {\n                errors.push(gettext('You did not select any files to submit.'));\n            }\n            errorHtml = '';\n            for (i = 0, len = errors.length; i < len; i++) {\n                error = errors[i];\n                errorHtml = edx.HtmlUtils.joinHtml(\n                    errorHtml,\n                    edx.HtmlUtils.interpolateHtml(edx.HtmlUtils.HTML('<li>{error}</li>'), {error: error})\n                );\n            }\n            errorHtml = edx.HtmlUtils.interpolateHtml(edx.HtmlUtils.HTML('<ul>{errors}</ul>'), {errors: errorHtml});\n            this.gentle_alert(errorHtml.toString());\n            abortSubmission = fileTooLarge || fileNotSelected || unallowedFileSubmitted || requiredFilesNotSubmitted;\n            if (abortSubmission) {\n                window.clearTimeout(timeoutId);\n                this.enableSubmitButton(true);\n            } else {\n                settings = {\n                    type: 'POST',\n                    data: fd,\n                    processData: false,\n                    contentType: false,\n                    complete: this.enableSubmitButtonAfterResponse,\n                    success: function(response) {\n                        switch (response.success) {\n                        case 'submitted':\n                        case 'incorrect':\n                        case 'correct':\n                            that.render(response.contents);\n                            that.updateProgress(response);\n                            break;\n                        default:\n                            that.gentle_alert(response.success);\n                        }\n                        return Logger.log('problem_graded', [that.answers, response.contents], that.id);\n                    },\n                    error: function(response) {\n                        that.gentle_alert(response.responseJSON.success);\n                    }\n                };\n                $.ajaxWithPrefix('' + this.url + '/problem_check', settings);\n            }\n        };\n\n        Problem.prototype.submit = function() {\n            if (!this.submit_save_waitfor(this.submit_internal)) {\n                this.disableAllButtonsWhileRunning(this.submit_internal, true);\n            }\n        };\n\n        Problem.prototype.submit_internal = function() {\n            var that = this;\n            Logger.log('problem_check', this.answers);\n            return $.postWithPrefix('' + this.url + '/problem_check', this.answers, function(response) {\n                switch (response.success) {\n                case 'submitted':\n                case 'incorrect':\n                case 'correct':\n                    window.SR.readTexts(that.get_sr_status(response.contents));\n                    that.el.trigger('contentChanged', [that.id, response.contents, response]);\n                    that.render(response.contents, that.focus_on_submit_notification);\n                    that.updateProgress(response);\n                    // This is used by the Learning MFE to know when the Entrance Exam has been passed\n                    // for a user. The MFE is then able to respond appropriately.\n                    if (response.entrance_exam_passed) {\n                        window.parent.postMessage({type: 'entranceExam.passed'}, '*');\n                    }\n                    break;\n                default:\n                    that.saveNotification.hide();\n                    that.gentle_alert(response.success);\n                }\n                return Logger.log('problem_graded', [that.answers, response.contents], that.id);\n            });\n        };\n\n        /**\n         * This method builds up an array of strings to send to the page screen-reader span.\n         * It first gets all elements with class \"status\", and then looks to see if they are contained\n         * in sections with aria-labels. If so, labels are prepended to the status element text.\n         * If not, just the text of the status elements are returned.\n         */\n        Problem.prototype.get_sr_status = function(contents) {\n            var addedStatus, ariaLabel, element, labeledStatus, parentSection, statusElement, template, i, len;\n            statusElement = $(contents).find('.status');\n            labeledStatus = [];\n            for (i = 0, len = statusElement.length; i < len; i++) {\n                element = statusElement[i];\n                parentSection = $(element).closest('.wrapper-problem-response');\n                addedStatus = false;\n                if (parentSection) {\n                    ariaLabel = parentSection.attr('aria-label');\n                    if (ariaLabel) {\n                        // Translators: This is only translated to allow for reordering of label and associated status.;\n                        template = gettext('{label}: {status}');\n                        labeledStatus.push(edx.StringUtils.interpolate(\n                            template, {\n                                label: ariaLabel,\n                                status: $(element).text()\n                            }\n                        ));\n                        addedStatus = true;\n                    }\n                }\n                if (!addedStatus) {\n                    labeledStatus.push($(element).text());\n                }\n            }\n            return labeledStatus;\n        };\n\n        Problem.prototype.reset = function() {\n            return this.disableAllButtonsWhileRunning(this.reset_internal, false);\n        };\n\n        Problem.prototype.reset_internal = function() {\n            var that = this;\n            Logger.log('problem_reset', this.answers);\n            return $.postWithPrefix('' + this.url + '/problem_reset', {\n                id: this.id\n            }, function(response) {\n                if (response.success) {\n                    that.el.trigger('contentChanged', [that.id, response.html, response]);\n                    that.render(response.html, that.scroll_to_problem_meta);\n                    that.updateProgress(response);\n                    return window.SR.readText(gettext('This problem has been reset.'));\n                } else {\n                    return that.gentle_alert(response.msg);\n                }\n            });\n        };\n\n        // TODO this needs modification to deal with javascript responses; perhaps we\n        // need something where responsetypes can define their own behavior when show\n        // is called.\n        Problem.prototype.show = function() {\n            var that = this;\n            Logger.log('problem_show', {\n                problem: this.id\n            });\n            return $.postWithPrefix('' + this.url + '/problem_show', function(response) {\n                var answers;\n                answers = response.answers;\n                $.each(answers, function(key, value) {\n                    var safeKey = key.replace(':', '\\\\:'); // fix for courses which use url_names with colons, e.g. problem:question1\n                    var answer;\n                    if (!$.isArray(value)) {\n                        answer = that.$('#answer_' + safeKey + ', #solution_' + safeKey);\n                        edx.HtmlUtils.setHtml(answer, edx.HtmlUtils.HTML(value));\n                        Collapsible.setCollapsibles(answer);\n\n                        // Sometimes, `value` is just a string containing a MathJax formula.\n                        // If this is the case, jQuery will throw an error in some corner cases\n                        // because of an incorrect selector. We setup a try..catch so that\n                        // the script doesn't break in such cases.\n                        //\n                        // We will fallback to the second `if statement` below, if an\n                        // error is thrown by jQuery.\n                        try {\n                            return $(value).find('.detailed-solution');\n                        } catch (e) {\n                            return {};\n                        }\n\n                        // TODO remove the above once everything is extracted into its own\n                        // inputtype functions.\n                    }\n                });\n                that.el.find('.capa_inputtype').each(function(index, inputtype) {\n                    var classes, cls, display, showMethod, i, len, results;\n                    classes = $(inputtype).attr('class').split(' ');\n                    results = [];\n                    for (i = 0, len = classes.length; i < len; i++) {\n                        cls = classes[i];\n                        display = that.inputtypeDisplays[$(inputtype).attr('id')];\n                        showMethod = that.inputtypeShowAnswerMethods[cls];\n                        if (showMethod != null) {\n                            results.push(showMethod(inputtype, display, answers, response.correct_status_html));\n                        } else {\n                            results.push(void 0);\n                        }\n                    }\n                    return results;\n                });\n                if (typeof MathJax !== 'undefined' && MathJax !== null) {\n                    that.el.find('.problem > div').each(function(index, element) {\n                        return MathJax.Hub.Queue(['Typeset', MathJax.Hub, element]);\n                    });\n                }\n                that.el.find('.show').attr('disabled', 'disabled');\n                that.updateProgress(response);\n                that.clear_all_notifications();\n                that.showAnswerNotification.show();\n                that.focus_on_notification('show-answer');\n            });\n        };\n\n        Problem.prototype.clear_all_notifications = function() {\n            this.submitNotification.remove();\n            this.gentleAlertNotification.hide();\n            this.saveNotification.hide();\n            this.showAnswerNotification.hide();\n        };\n\n        Problem.prototype.gentle_alert = function(msg) {\n            edx.HtmlUtils.setHtml(\n                this.el.find('.notification-gentle-alert .notification-message'),\n                edx.HtmlUtils.HTML(msg)\n            );\n            this.clear_all_notifications();\n            this.gentleAlertNotification.show();\n            this.gentleAlertNotification.focus();\n        };\n\n        Problem.prototype.save = function() {\n            if (!this.submit_save_waitfor(this.save_internal)) {\n                this.disableAllButtonsWhileRunning(this.save_internal, false);\n            }\n        };\n\n        Problem.prototype.save_internal = function() {\n            var that = this;\n            Logger.log('problem_save', this.answers);\n            return $.postWithPrefix('' + this.url + '/problem_save', this.answers, function(response) {\n                var saveMessage;\n                saveMessage = response.msg;\n                if (response.success) {\n                    that.el.trigger('contentChanged', [that.id, response.html, response]);\n                    edx.HtmlUtils.setHtml(\n                        that.el.find('.notification-save .notification-message'),\n                        edx.HtmlUtils.HTML(saveMessage)\n                    );\n                    that.clear_all_notifications();\n                    that.el.find('.wrapper-problem-response .message').hide();\n                    that.saveNotification.show();\n                    that.focus_on_save_notification();\n                } else {\n                    that.gentle_alert(saveMessage);\n                }\n            });\n        };\n\n        Problem.prototype.refreshMath = function(event, element) {\n            var elid, eqn, jax, mathjaxPreprocessor, preprocessorTag, target;\n            if (!element) {\n                element = event.target; // eslint-disable-line no-param-reassign\n            }\n            elid = element.id.replace(/^input_/, '');\n            target = 'display_' + elid;\n\n            // MathJax preprocessor is loaded by 'setupInputTypes'\n            preprocessorTag = 'inputtype_' + elid;\n            mathjaxPreprocessor = this.inputtypeDisplays[preprocessorTag];\n            if (typeof MathJax !== 'undefined' && MathJax !== null && MathJax.Hub.getAllJax(target)[0]) {\n                jax = MathJax.Hub.getAllJax(target)[0];\n                eqn = $(element).val();\n                if (mathjaxPreprocessor) {\n                    eqn = mathjaxPreprocessor(eqn);\n                }\n                MathJax.Hub.Queue(['Text', jax, eqn], [this.updateMathML, jax, element]);\n            }\n        };\n\n        Problem.prototype.updateMathML = function(jax, element) {\n            try {\n                $('#' + element.id + '_dynamath').val(jax.root.toMathML(''));\n            } catch (exception) {\n                if (!exception.restart) {\n                    throw exception;\n                }\n                if (typeof MathJax !== 'undefined' && MathJax !== null) {\n                    MathJax.Callback.After([this.refreshMath, jax], exception.restart);\n                }\n            }\n        };\n\n        Problem.prototype.refreshAnswers = function() {\n            this.$('input.schematic').each(function(index, element) {\n                return element.schematic.update_value();\n            });\n            this.$('.CodeMirror').each(function(index, element) {\n                if (element.CodeMirror.save) {\n                    element.CodeMirror.save();\n                }\n            });\n            this.answers = this.inputs.serialize();\n        };\n\n        /**\n         * Used to check available answers and if something is checked (or the answer is set in some textbox),\n         * the \"Submit\" button becomes enabled. Otherwise it is disabled by default.\n         *\n         * Arguments:\n         *    bind (boolean): used on the first check to attach event handlers to input fields\n         *       to change \"Submit\" enable status in case of some manipulations with answers\n         */\n        Problem.prototype.submitAnswersAndSubmitButton = function(bind) {\n            var answered, atLeastOneTextInputFound, oneTextInputFilled,\n                that = this;\n            if (bind === null || bind === undefined) {\n                bind = false; // eslint-disable-line no-param-reassign\n            }\n            answered = true;\n            atLeastOneTextInputFound = false;\n            oneTextInputFilled = false;\n            this.el.find('input:text').each(function(i, textField) {\n                if ($(textField).is(':visible')) {\n                    atLeastOneTextInputFound = true;\n                    if ($(textField).val() !== '') {\n                        oneTextInputFilled = true;\n                    }\n                    if (bind) {\n                        $(textField).on('input', function() {\n                            that.saveNotification.hide();\n                            that.showAnswerNotification.hide();\n                            that.submitAnswersAndSubmitButton();\n                        });\n                    }\n                }\n            });\n            if (atLeastOneTextInputFound && !oneTextInputFilled) {\n                answered = false;\n            }\n            this.el.find('.choicegroup').each(function(i, choicegroupBlock) {\n                var checked;\n                checked = false;\n                $(choicegroupBlock).find('input[type=checkbox], input[type=radio]').\n                    each(function(j, checkboxOrRadio) {\n                        if ($(checkboxOrRadio).is(':checked')) {\n                            checked = true;\n                        }\n                        if (bind) {\n                            $(checkboxOrRadio).on('click', function() {\n                                that.saveNotification.hide();\n                                that.el.find('.show').removeAttr('disabled');\n                                that.showAnswerNotification.hide();\n                                that.submitAnswersAndSubmitButton();\n                            });\n                        }\n                    });\n                if (!checked) {\n                    answered = false;\n                }\n            });\n            this.el.find('select').each(function(i, selectField) {\n                var selectedOption = $(selectField).find('option:selected').text()\n                    .trim();\n                if (selectedOption === 'Select an option') {\n                    answered = false;\n                }\n                if (bind) {\n                    $(selectField).on('change', function() {\n                        that.saveNotification.hide();\n                        that.showAnswerNotification.hide();\n                        that.submitAnswersAndSubmitButton();\n                    });\n                }\n            });\n            if (answered) {\n                return this.enableSubmitButton(true);\n            } else {\n                return this.enableSubmitButton(false, false);\n            }\n        };\n\n        Problem.prototype.bindResetCorrectness = function() {\n            // Loop through all input types.\n            // Bind the reset functions at that scope.\n            var $inputtypes,\n                that = this;\n            $inputtypes = this.el.find('.capa_inputtype').add(this.el.find('.inputtype'));\n            return $inputtypes.each(function(index, inputtype) {\n                var bindMethod, classes, cls, i, len, results;\n                classes = $(inputtype).attr('class').split(' ');\n                results = [];\n                for (i = 0, len = classes.length; i < len; i++) {\n                    cls = classes[i];\n                    bindMethod = that.bindResetCorrectnessByInputtype[cls];\n                    if (bindMethod != null) {\n                        results.push(bindMethod(inputtype));\n                    } else {\n                        results.push(void 0);\n                    }\n                }\n                return results;\n            });\n        };\n\n        // Find all places where each input type displays its correct-ness\n        // Replace them with their original state--'unanswered'.\n        Problem.prototype.bindResetCorrectnessByInputtype = {\n            // These are run at the scope of the capa inputtype\n            // They should set handlers on each <input> to reset the whole.\n            formulaequationinput: function(element) {\n                return $(element).find('input').on('input', function() {\n                    var $p;\n                    $p = $(element).find('span.status');\n                    $p.removeClass('correct incorrect submitted');\n                    return $p.parent().removeAttr('class').addClass('unsubmitted');\n                });\n            },\n            choicegroup: function(element) {\n                var $element, id;\n                $element = $(element);\n                id = ($element.attr('id').match(/^inputtype_(.*)$/))[1];\n                return $element.find('input').on('change', function() {\n                    var $status;\n                    $status = $('#status_' + id);\n                    if ($status[0]) {\n                        $status.removeAttr('class').addClass('status unanswered');\n                    } else {\n                        $('<span>', {\n                            class: 'status unanswered',\n                            style: 'display: inline-block;',\n                            id: 'status_' + id\n                        });\n                    }\n                    $element.find('label').find('span.status.correct').remove();\n                    return $element.find('label').removeAttr('class');\n                });\n            },\n            'option-input': function(element) {\n                var $select, id;\n                $select = $(element).find('select');\n                id = ($select.attr('id').match(/^input_(.*)$/))[1];\n                return $select.on('change', function() {\n                    return $('#status_' + id).removeAttr('class').addClass('unanswered')\n                        .find('.sr')\n                        .text(gettext('unsubmitted'));\n                });\n            },\n            textline: function(element) {\n                return $(element).find('input').on('input', function() {\n                    var $p;\n                    $p = $(element).find('span.status');\n                    $p.removeClass('correct incorrect submitted');\n                    return $p.parent().removeClass('correct incorrect').addClass('unsubmitted');\n                });\n            }\n        };\n\n        Problem.prototype.inputtypeSetupMethods = {\n            'text-input-dynamath': function(element) {\n                /*\n                 Return: function (eqn) -> eqn that preprocesses the user formula input before\n                 it is fed into MathJax. Return 'false' if no preprocessor specified\n                 */\n                var data, preprocessor, preprocessorClass, preprocessorClassName;\n                data = $(element).find('.text-input-dynamath_data');\n                preprocessorClassName = data.data('preprocessor');\n                preprocessorClass = window[preprocessorClassName];\n                if (preprocessorClass == null) {\n                    return false;\n                } else {\n                    preprocessor = new preprocessorClass();\n                    return preprocessor.fn;\n                }\n            },\n            cminput: function(container) {\n                var CodeMirrorEditor, CodeMirrorTextArea, element, id, linenumbers, mode, spaces, tabsize;\n                element = $(container).find('textarea');\n                tabsize = element.data('tabsize');\n                mode = element.data('mode');\n                linenumbers = element.data('linenums');\n                spaces = Array(parseInt(tabsize, 10) + 1).join(' ');\n                CodeMirrorEditor = CodeMirror.fromTextArea(element[0], {\n                    lineNumbers: linenumbers,\n                    indentUnit: tabsize,\n                    tabSize: tabsize,\n                    mode: mode,\n                    matchBrackets: true,\n                    lineWrapping: true,\n                    indentWithTabs: false,\n                    smartIndent: false,\n                    extraKeys: {\n                        Esc: function() {\n                            $('.grader-status').focus();\n                            return false;\n                        },\n                        Tab: function(cm) {\n                            cm.replaceSelection(spaces, 'end');\n                            return false;\n                        }\n                    }\n                });\n                id = element.attr('id').replace(/^input_/, '');\n                CodeMirrorTextArea = CodeMirrorEditor.getInputField();\n                CodeMirrorTextArea.setAttribute('id', 'cm-textarea-' + id);\n                CodeMirrorTextArea.setAttribute('aria-describedby', 'cm-editor-exit-message-' + id + ' status_' + id);\n                return CodeMirrorEditor;\n            }\n        };\n\n        Problem.prototype.inputtypeShowAnswerMethods = {\n            choicegroup: function(element, display, answers, correctStatusHtml) {\n                var answer, choice, inputId, i, len, results, $element, $inputLabel, $inputStatus;\n                $element = $(element);\n                inputId = $element.attr('id').replace(/inputtype_/, '');\n                inputId = inputId.replace(':', '\\\\:'); // fix for courses which use url_names with colons, e.g. problem:question1\n                answer = answers[inputId];\n                results = [];\n                for (i = 0, len = answer.length; i < len; i++) {\n                    choice = answer[i];\n                    $inputLabel = $element.find('#input_' + inputId + '_' + choice + ' + label');\n                    $inputStatus = $element.find('#status_' + inputId);\n                    // If the correct answer was already Submitted before \"Show Answer\" was selected,\n                    // the status HTML will already be present. Otherwise, inject the status HTML.\n\n                    // If the learner clicked a different answer after Submit, their submitted answers\n                    // will be marked as \"unanswered\". In that case, for correct answers update the\n                    // classes accordingly.\n                    if ($inputStatus.hasClass('unanswered')) {\n                        edx.HtmlUtils.append($inputLabel, edx.HtmlUtils.HTML(correctStatusHtml));\n                        $inputLabel.addClass('choicegroup_correct');\n                    } else if (!$inputLabel.hasClass('choicegroup_correct')) {\n                        // If the status HTML is not already present (due to clicking Submit), append\n                        // the status HTML for correct answers.\n                        edx.HtmlUtils.append($inputLabel, edx.HtmlUtils.HTML(correctStatusHtml));\n                        $inputLabel.removeClass('choicegroup_incorrect');\n                        results.push($inputLabel.addClass('choicegroup_correct'));\n                    }\n                }\n                return results;\n            },\n            choicetextgroup: function(element, display, answers) {\n                var answer, choice, inputId, i, len, results, $element;\n                $element = $(element);\n                inputId = $element.attr('id').replace(/inputtype_/, '');\n                answer = answers[inputId];\n                results = [];\n                for (i = 0, len = answer.length; i < len; i++) {\n                    choice = answer[i];\n                    results.push($element.find('section#forinput' + choice).addClass('choicetextgroup_show_correct'));\n                }\n                return results;\n            },\n            imageinput: function(element, display, answers) {\n                // answers is a dict of (answer_id, answer_text) for each answer for this question.\n                //\n                // @Examples:\n                // {'anwser_id': {\n                //    'rectangle': '(10,10)-(20,30);(12,12)-(40,60)',\n                //    'regions': '[[10,10], [30,30], [10, 30], [30, 10]]'\n                // } }\n                var canvas, container, id, types, context, $element;\n                types = {\n                    rectangle: function(ctx, coords) {\n                        var rects, reg;\n                        reg = /^\\(([0-9]+),([0-9]+)\\)-\\(([0-9]+),([0-9]+)\\)$/;\n                        rects = coords.replace(/\\s*/g, '').split(/;/);\n                        $.each(rects, function(index, rect) {\n                            var abs, height, points, width;\n                            abs = Math.abs;\n                            points = reg.exec(rect);\n                            if (points) {\n                                width = abs(points[3] - points[1]);\n                                height = abs(points[4] - points[2]);\n                                ctx.rect(points[1], points[2], width, height);\n                            }\n                        });\n                        ctx.stroke();\n                        return ctx.fill();\n                    },\n                    regions: function(ctx, coords) {\n                        var parseCoords;\n                        parseCoords = function(coordinates) {\n                            var reg;\n                            reg = JSON.parse(coordinates);\n\n                            // Regions is list of lists [region1, region2, region3, ...] where regionN\n                            // is disordered list of points: [[1,1], [100,100], [50,50], [20, 70]].\n                            // If there is only one region in the list, simpler notation can be used:\n                            // regions=\"[[10,10], [30,30], [10, 30], [30, 10]]\" (without explicitly\n                            // setting outer list)\n                            if (typeof reg[0][0][0] === 'undefined') {\n                                // we have [[1,2],[3,4],[5,6]] - single region\n                                // instead of [[[1,2],[3,4],[5,6], [[1,2],[3,4],[5,6]]]\n                                // or [[[1,2],[3,4],[5,6]]] - multiple regions syntax\n                                reg = [reg];\n                            }\n                            return reg;\n                        };\n                        return $.each(parseCoords(coords), function(index, region) {\n                            ctx.beginPath();\n                            $.each(region, function(idx, point) {\n                                if (idx === 0) {\n                                    return ctx.moveTo(point[0], point[1]);\n                                } else {\n                                    return ctx.lineTo(point[0], point[1]);\n                                }\n                            });\n                            ctx.closePath();\n                            ctx.stroke();\n                            return ctx.fill();\n                        });\n                    }\n                };\n                $element = $(element);\n                id = $element.attr('id').replace(/inputtype_/, '');\n                container = $element.find('#answer_' + id);\n                canvas = document.createElement('canvas');\n                canvas.width = container.data('width');\n                canvas.height = container.data('height');\n                if (canvas.getContext) {\n                    context = canvas.getContext('2d');\n                } else {\n                    console.log('Canvas is not supported.'); // eslint-disable-line no-console\n                }\n                context.fillStyle = 'rgba(255,255,255,.3)';\n                context.strokeStyle = '#FF0000';\n                context.lineWidth = '2';\n                if (answers[id]) {\n                    $.each(answers[id], function(key, value) {\n                        if ((types[key] !== null && types[key] !== undefined) && value) {\n                            types[key](context, value);\n                        }\n                    });\n                    edx.HtmlUtils.setHtml(container, edx.HtmlUtils.HTML(canvas));\n                } else {\n                    console.log('Answer is absent for image input with id=' + id); // eslint-disable-line no-console\n                }\n            }\n        };\n\n        /**\n         * Used to keep the buttons disabled while operationCallback is running.\n         *\n         * params:\n         *      'operationCallback' is an operation to be run.\n         *      isFromCheckOperation' is a boolean to keep track if 'operationCallback' was\n         *           from submit, if so then text of submit button will be changed as well.\n         *\n         */\n        Problem.prototype.disableAllButtonsWhileRunning = function(operationCallback, isFromCheckOperation) {\n            var that = this;\n            var allButtons = [this.resetButton, this.saveButton, this.showButton, this.hintButton, this.submitButton];\n            var initiallyEnabledButtons = allButtons.filter(function(button) {\n                return !button.attr('disabled');\n            });\n            this.enableButtons(initiallyEnabledButtons, false, isFromCheckOperation);\n            return operationCallback().always(function() {\n                return that.enableButtons(initiallyEnabledButtons, true, isFromCheckOperation);\n            });\n        };\n\n        /**\n         * Enables/disables buttons by removing/adding the disabled attribute. The submit button is checked\n         *     separately due to the changing text it contains.\n         *\n         * params:\n         *     'buttons' is an array of buttons that will have their 'disabled' attribute modified\n         *     'enable' a boolean to either enable or disable the buttons passed in the first parameter\n         *     'changeSubmitButtonText' is a boolean to keep track if operation was initiated\n         *         from submit so that text of submit button will also be changed while disabling/enabling\n         *         the submit button.\n         */\n        Problem.prototype.enableButtons = function(buttons, enable, changeSubmitButtonText) {\n            var that = this;\n            buttons.forEach(function(button) {\n                if (button.hasClass('submit')) {\n                    that.enableSubmitButton(enable, changeSubmitButtonText);\n                } else if (enable) {\n                    button.removeAttr('disabled');\n                } else {\n                    button.attr({disabled: 'disabled'});\n                }\n            });\n        };\n\n        /**\n         *  Used to disable submit button to reduce chance of accidental double-submissions.\n         *\n         * params:\n         *     'enable' is a boolean to determine enabling/disabling of submit button.\n         *     'changeText' is a boolean to determine if there is need to change the\n         *         text of submit button as well.\n         */\n        Problem.prototype.enableSubmitButton = function(enable, changeText) {\n            var submitCanBeEnabled;\n            if (changeText === null || changeText === undefined) {\n                changeText = true; // eslint-disable-line no-param-reassign\n            }\n            if (enable) {\n                submitCanBeEnabled = this.submitButton.data('should-enable-submit-button') === 'True';\n                if (submitCanBeEnabled) {\n                    this.submitButton.removeAttr('disabled');\n                }\n                if (changeText) {\n                    this.submitButtonLabel.text(this.submitButtonSubmitText);\n                }\n            } else {\n                this.submitButton.attr({disabled: 'disabled'});\n                if (changeText) {\n                    this.submitButtonLabel.text(this.submitButtonSubmittingText);\n                }\n            }\n        };\n\n        Problem.prototype.enableSubmitButtonAfterResponse = function() {\n            this.has_response = true;\n            if (!this.has_timed_out) {\n                // Server has returned response before our timeout.\n                return this.enableSubmitButton(false);\n            } else {\n                return this.enableSubmitButton(true);\n            }\n        };\n\n        Problem.prototype.enableSubmitButtonAfterTimeout = function() {\n            var enableSubmitButton,\n                that = this;\n            this.has_timed_out = false;\n            this.has_response = false;\n            enableSubmitButton = function() {\n                that.has_timed_out = true;\n                if (that.has_response) {\n                    that.enableSubmitButton(true);\n                }\n            };\n            return window.setTimeout(enableSubmitButton, 750);\n        };\n\n        Problem.prototype.hint_button = function() {\n            // Store the index of the currently shown hint as an attribute.\n            // Use that to compute the next hint number when the button is clicked.\n            var hintContainer, hintIndex, nextIndex,\n                that = this;\n            hintContainer = this.$('.problem-hint');\n            hintIndex = hintContainer.attr('hint_index');\n            if (hintIndex === void 0) {\n                nextIndex = 0;\n            } else {\n                nextIndex = parseInt(hintIndex, 10) + 1;\n            }\n            return $.postWithPrefix('' + this.url + '/hint_button', {\n                hint_index: nextIndex,\n                input_id: this.id\n            }, function(response) {\n                var hintMsgContainer;\n                if (response.success) {\n                    hintMsgContainer = that.$('.problem-hint .notification-message');\n                    hintContainer.attr('hint_index', response.hint_index);\n                    edx.HtmlUtils.setHtml(hintMsgContainer, edx.HtmlUtils.HTML(response.msg));\n                    MathJax.Hub.Queue(['Typeset', MathJax.Hub, hintContainer[0]]);\n                    if (response.should_enable_next_hint) {\n                        that.hintButton.removeAttr('disabled');\n                    } else {\n                        that.hintButton.attr({disabled: 'disabled'});\n                    }\n                    that.el.find('.notification-hint').show();\n                    that.focus_on_hint_notification(nextIndex);\n                } else {\n                    that.gentle_alert(response.msg);\n                }\n            });\n        };\n\n        return Problem;\n    }).call(this);\n}).call(this);\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/002-7de2e4f56b8dbadb90e5de21d0fd31a5.js","/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n(function(undefined) {\n    'use strict';\n\n    // [module Collapsible]\n    //\n    // [description]\n    //     Set of library functions that provide a simple way to add\n    //     collapsible functionality to elements.\n    this.Collapsible = {\n        setCollapsibles: setCollapsibles,\n        toggleFull: toggleFull,\n        toggleHint: toggleHint\n    };\n\n    return;\n\n    // [function setCollapsibles]\n    //\n    // [description]\n    //     Scan element's content for generic collapsible containers.\n    //\n    // [params]\n    //     el: container\n    function setCollapsibles(el) {\n        var linkBottom, linkTop, short_custom;\n\n        linkTop = '<a href=\"#\" class=\"full full-top\">See full output</a>';\n        linkBottom = '<a href=\"#\" class=\"full full-bottom\">See full output</a>';\n\n        // Standard longform + shortfom pattern.\n        el.find('.longform').hide();\n        el.find('.shortform').append(linkTop, linkBottom); // xss-lint: disable=javascript-jquery-append\n\n        // Custom longform + shortform text pattern.\n        short_custom = el.find('.shortform-custom');\n\n        // Set up each one individually.\n        short_custom.each(function(index, elt) {\n            var close_text, open_text;\n\n            open_text = $(elt).data('open-text');\n            close_text = $(elt).data('close-text');\n            edx.HtmlUtils.append(\n                $(elt),\n                edx.HtmlUtils.joinHtml(\n                    edx.HtmlUtils.HTML(\"<a href='#' class='full-custom'>\"),\n                    gettext(open_text),\n                    edx.HtmlUtils.HTML('</a>')\n                )\n            );\n\n            $(elt).find('.full-custom').click(function(event) {\n                Collapsible.toggleFull(event, open_text, close_text);\n            });\n        });\n\n        // Collapsible pattern.\n        el.find('.collapsible header + section').hide();\n\n        // Set up triggers.\n        el.find('.full').click(function(event) {\n            Collapsible.toggleFull(event, 'See full output', 'Hide output');\n        });\n        el.find('.collapsible header a').click(Collapsible.toggleHint);\n    }\n\n    // [function toggleFull]\n    //\n    // [description]\n    //     Toggle the display of full text for a collapsible element.\n    //\n    // [params]\n    //     event: jQuery event object associated with the event that\n    //         triggered this callback function.\n    //     open_text: text that should be displayed when the collapsible\n    //         is open.\n    //     close_text: text that should be displayed when the collapsible\n    //         is closed.\n    function toggleFull(event, open_text, close_text) {\n        var $el, new_text, parent;\n\n        event.preventDefault();\n\n        parent = $(event.target).parent();\n        parent.siblings().slideToggle();\n        parent.parent().toggleClass('open');\n\n        if ($(event.target).text() === open_text) {\n            new_text = close_text;\n        } else {\n            new_text = open_text;\n        }\n\n        if ($(event.target).hasClass('full')) {\n            $el = parent.find('.full');\n        } else {\n            $el = $(event.target);\n        }\n\n        $el.text(new_text);\n    }\n\n    // [function toggleHint]\n    //\n    // [description]\n    //     Toggle the collapsible open to show the hint.\n    //\n    // [params]\n    //     event: jQuery event object associated with the event that\n    //         triggered this callback function.\n    function toggleHint(event) {\n        event.preventDefault();\n\n        $(event.target).parent().siblings().slideToggle();\n        $(event.target).parent().parent().toggleClass('open');\n    }\n}).call(this);\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/003-b3206f2283964743c4772b9d72c67d64.js","/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n/**\n * Simple image input\n *\n *\n * Click on image. Update the coordinates of a dot on the image.\n * The new coordinates are the location of the click.\n */\n\n/**\n * 'The wise adapt themselves to circumstances, as water molds itself to the\n * pitcher.'\n *\n * ~ Chinese Proverb\n */\n\nwindow.ImageInput = (function($, undefined) {\n    var ImageInput = ImageInputConstructor;\n\n    ImageInput.prototype = {\n        constructor: ImageInputConstructor,\n        clickHandler: clickHandler\n    };\n\n    return ImageInput;\n\n    function ImageInputConstructor(elementId) {\n        this.el = $('#imageinput_' + elementId);\n        this.crossEl = $('#cross_' + elementId);\n        this.inputEl = $('#input_' + elementId);\n\n        this.el.on('click', this.clickHandler.bind(this));\n    }\n\n    function clickHandler(event) {\n        var offset = this.el.offset(),\n            posX = event.offsetX ?\n                event.offsetX : event.pageX - offset.left,\n            posY = event.offsetY ?\n                event.offsetY : event.pageY - offset.top,\n\n            // To reduce differences between values returned by different kinds\n            // of browsers, we round `posX` and `posY`.\n            //\n            // IE10: `posX` and `posY` - float.\n            // Chrome, FF: `posX` and `posY` - integers.\n            result = '[' + Math.round(posX) + ',' + Math.round(posY) + ']';\n\n        this.crossEl.css({\n            left: posX - 15,\n            top: posY - 15,\n            visibility: 'visible'\n        });\n\n        this.inputEl.val(result);\n    }\n}).call(this, window.jQuery);\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/004-b0c34afa95eaa6b45d843d92ca523a94.js","/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n/* eslint-disable */\n\n//////////////////////////////////////////////////////////////////////////////\n//\n//  Circuit simulator\n//\n//////////////////////////////////////////////////////////////////////////////\n\n// Copyright (C) 2011 Massachusetts Institute of Technology\n\n\n// create a circuit for simulation using \"new cktsim.Circuit()\"\n\n// for modified nodal analysis (MNA) stamps see\n// http://www.analog-electronics.eu/analog-electronics/modified-nodal-analysis/modified-nodal-analysis.xhtml\n\nvar cktsim = (function() {\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Circuit\n\t//\n\t//////////////////////////////////////////////////////////////////////////////\n\n    // types of \"nodes\" in the linear system\n    var T_VOLTAGE = 0;\n    var T_CURRENT = 1;\n\n    var v_newt_lim = 0.3; // Voltage limited Newton great for Mos/diodes\n    var v_abstol = 1e-6; // Absolute voltage error tolerance\n    var i_abstol = 1e-12; // Absolute current error tolerance\n    var eps = 1.0e-12; // A very small number compared to one.\n    var dc_max_iters = 1000; // max iterations before giving up\n    var max_tran_iters = 20; // max iterations before giving up\n    var time_step_increase_factor = 2.0; // How much can lte let timestep grow.\n    var lte_step_decrease_factor = 8; // Limit lte one-iter timestep shrink.\n    var nr_step_decrease_factor = 4; // Newton failure timestep shrink.\n    var reltol = 0.0001; // Relative tol to max observed value\n    var lterel = 10; // LTE/Newton tolerance ratio (> 10!)\n    var res_check_abs = Math.sqrt(i_abstol); // Loose Newton residue check\n    var res_check_rel = Math.sqrt(reltol); // Loose Newton residue check\n\n\tfunction Circuit() {\n        this.node_map = [];\n\t    this.ntypes = [];\n        this.initial_conditions = [];\n        this.devices = [];\n        this.device_map = [];\n        this.voltage_sources = [];\n        this.current_sources = [];\n\t    this.finalized = false;\n\t    this.diddc = false;\n\t    this.node_index = -1;\n\t    this.periods = 1\n\t}\n\n\t// index of ground node\n\tCircuit.prototype.gnd_node = function() {\n\t    return -1;\n\t}\n\n\t// allocate a new node index\n\tCircuit.prototype.node = function(name,ntype,ic) {\n\t    this.node_index += 1;\n\t    if (name) this.node_map[name] = this.node_index;\n\t    this.ntypes.push(ntype);\n\t    this.initial_conditions.push(ic);\n\t    return this.node_index;\n\t}\n\n\t// call to finalize the circuit in preparation for simulation\n\tCircuit.prototype.finalize = function() {\n\t    if (!this.finalized) {\n\t\tthis.finalized = true;\n\t\tthis.N = this.node_index + 1;  // number of nodes\n\n\t\t// give each device a chance to finalize itself\n\t\tfor (var i = this.devices.length - 1; i >= 0; --i)\n\t\t    this.devices[i].finalize(this);\n\n\t\t// set up augmented matrix and various temp vectors\n\t\tthis.matrix = mat_make(this.N, this.N+1);\n\t\tthis.Gl = mat_make(this.N, this.N);  // Matrix for linear conductances\n\t\tthis.G = mat_make(this.N, this.N);  // Complete conductance matrix\n\t\tthis.C = mat_make(this.N, this.N);  // Matrix for linear L's and C's\n\n\t\tthis.soln_max = new Array(this.N);   // max abs value seen for each unknown\n\t\tthis.abstol = new Array(this.N);\n\t\tthis.solution = new Array(this.N);\n\t\tthis.rhs = new Array(this.N);\n\t\tfor (var i = this.N - 1; i >= 0; --i) {\n\t\t    this.soln_max[i] = 0.0;\n\t\t    this.abstol[i] = this.ntypes[i] == T_VOLTAGE ? v_abstol : i_abstol;\n\t\t    this.solution[i] = 0.0;\n\t\t    this.rhs[i] = 0.0;\n\t\t}\n\n\t\t// Load up the linear elements once and for all\n\t\tfor (var i = this.devices.length - 1; i >= 0; --i) {\n\t\t    this.devices[i].load_linear(this)\n\t\t}\n\n\t\t// Check for voltage source loops.\n        var n_vsrc = this.voltage_sources.length;\n\t\tif (n_vsrc > 0) { // At least one voltage source\n\t\t    var GV = mat_make(n_vsrc, this.N);  // Loop check\n\t\t    for (var i = n_vsrc - 1; i >= 0; --i) {\n\t\t\tvar branch = this.voltage_sources[i].branch;\n\t\t\tfor (var j = this.N - 1; j >= 0; j--)\n\t\t\t    GV[i][j] = this.Gl[branch][j];\n\t\t    }\n\t\t    var rGV = mat_rank(GV);\n\t\t    if (rGV < n_vsrc) {\n\t\t\talert('Warning!!! Circuit has a voltage source loop or a source or current probe shorted by a wire, please remove the source or the wire causing the short.');\n\t\t\talert('Warning!!! Simulator might produce meaningless results or no result with illegal circuits.');\n\t\t\treturn false;\n\t\t    }\n\t\t}\n\t    }\n\t    return true;\n\t}\n\n\t// load circuit from JSON netlist (see schematic.js)\n\tCircuit.prototype.load_netlist = function(netlist) {\n\t    // set up mapping for all ground connections\n\t    for (var i = netlist.length - 1; i >= 0; --i) {\n\t\tvar component = netlist[i];\n\t\tvar type = component[0];\n\t\tif (type == 'g') {\n\t\t    var connections = component[3];\n\t\t    this.node_map[connections[0]] = this.gnd_node();\n\t\t}\n\t    }\n\n\t    // process each component in the JSON netlist (see schematic.js for format)\n\t    var found_ground = false;\n\t    for (var i = netlist.length - 1; i >= 0; --i) {\n\t\tvar component = netlist[i];\n\t\tvar type = component[0];\n\n\t\t// ignore wires, ground connections, scope probes and view info\n\t\tif (type == 'view' || type == 'w' || type == 'g' || type == 's' || type == 'L') {\n\t\t    continue;\n\t\t}\n\n\t\tvar properties = component[2];\n\t\tvar name = properties['name'];\n\t\tif (name==undefined || name=='')\n\t\t    name = '_' + properties['_json_'].toString();\n\n\t\t// convert node names to circuit indicies\n\t\tvar connections = component[3];\n\t\tfor (var j = connections.length - 1; j >= 0; --j) {\n\t\t    var node = connections[j];\n\t\t    var index = this.node_map[node];\n\t\t    if (index == undefined) index = this.node(node,T_VOLTAGE);\n\t\t    else if (index == this.gnd_node()) found_ground = true;\n\t\t    connections[j] = index;\n\t\t}\n\n\t\t// process the component\n\t\tif (type == 'r')\t// resistor\n\t\t    this.r(connections[0],connections[1],properties['r'],name);\n\t\telse if (type == 'd')\t// diode\n\t\t    this.d(connections[0],connections[1],properties['area'],properties['type'],name);\n\t\telse if (type == 'c')   // capacitor\n\t\t    this.c(connections[0],connections[1],properties['c'],name);\n\t\telse if (type == 'l')\t// inductor\n\t\t    this.l(connections[0],connections[1],properties['l'],name);\n\t\telse if (type == 'v') \t// voltage source\n\t\t    this.v(connections[0],connections[1],properties['value'],name);\n\t\telse if (type == 'i') \t// current source\n\t\t    this.i(connections[0],connections[1],properties['value'],name);\n\t\telse if (type == 'o') \t// op amp\n\t\t    this.opamp(connections[0],connections[1],connections[2],connections[3],properties['A'],name);\n\t\telse if (type == 'n') \t// n fet\n\t\t    this.n(connections[0],connections[1],connections[2],properties['W/L'],name);\n\t\telse if (type == 'p') \t// p fet\n\t\t    this.p(connections[0],connections[1],connections[2],properties['W/L'],name);\n\t\telse if (type == 'a') \t// current probe == 0-volt voltage source\n\t\t    this.v(connections[0],connections[1],'0',name);\n\t    }\n\n\t    if (!found_ground) { // No ground on schematic\n\t\talert('Please make at least one connection to ground  (inverted T symbol)');\n\t\treturn false;\n\t    }\n\t    return true;\n\t}\n\n\t// if converges: updates this.solution, this.soln_max, returns iter count\n\t// otherwise: return undefined and set this.problem_node\n\t// Load should compute -f and df/dx (note the sign pattern!)\n        Circuit.prototype.find_solution = function(load,maxiters) {\n\t    var soln = this.solution;\n\t    var rhs = this.rhs;\n\t    var d_sol = [];\n\t    var abssum_compare;\n\t    var converged,abssum_old=0, abssum_rhs;\n\t    var use_limiting = false;\n\t    var down_count = 0;\n        var thresh;\n\n\t    // iteratively solve until values convere or iteration limit exceeded\n\t    for (var iter = 0; iter < maxiters; iter++) {\n\t\t// set up equations\n\t\tload(this,soln,rhs);\n\n\t\t// Compute norm of rhs, assume variables of v type go with eqns of i type\n\t\tabssum_rhs = 0;\n\t\tfor (var i = this.N - 1; i >= 0; --i)\n\t\t    if (this.ntypes[i] == T_VOLTAGE)\n\t\t\tabssum_rhs += Math.abs(rhs[i]);\n\n\t\tif ((iter > 0) && (use_limiting == false) && (abssum_old < abssum_rhs)) {\n\t\t    // Old rhsnorm was better, undo last iter and turn on limiting\n\t\t    for (var i = this.N - 1; i >= 0; --i)\n\t\t\tsoln[i] -= d_sol[i];\n\t\t    iter -= 1;\n\t\t    use_limiting = true;\n\t\t}\n\t        else {  // Compute the Newton delta\n\t\t    d_sol = mat_solve_rq(this.matrix,rhs);\n\n\t\t    // If norm going down for ten iters, stop limiting\n\t\t    if (abssum_rhs < abssum_old)\n\t\t\tdown_count += 1;\n\t\t    else\n\t\t\tdown_count = 0;\n\t\t    if (down_count > 10) {\n\t\t\tuse_limiting = false;\n\t\t\tdown_count = 0;\n\t\t    }\n\n\t\t    // Update norm of rhs\n\t\t    abssum_old = abssum_rhs;\n\t\t}\n\n\t\t// Update the worst case abssum for comparison.\n\t\tif ((iter == 0) || (abssum_rhs > abssum_compare))\n\t\t    abssum_compare = abssum_rhs;\n\n\t\t// Check residue convergence, but loosely, and give up\n\t\t// on last iteration\n\t\tif ( (iter < (maxiters - 1)) &&\n\t\t     (abssum_rhs > (res_check_abs+res_check_rel*abssum_compare)))\n\t\t    converged = false;\n\t\telse converged = true;\n\n\n\t\t// Update solution and check delta convergence\n\t\tfor (var i = this.N - 1; i >= 0; --i) {\n\t\t    // Simple voltage step limiting to encourage Newton convergence\n\t\t    if (use_limiting) {\n\t\t\tif (this.ntypes[i] == T_VOLTAGE) {\n\t\t\t    d_sol[i] = (d_sol[i] > v_newt_lim) ? v_newt_lim : d_sol[i];\n\t\t\t    d_sol[i] = (d_sol[i] < -v_newt_lim) ? -v_newt_lim : d_sol[i];\n\t\t\t}\n\t\t    }\n\t\t    soln[i] += d_sol[i];\n\t\t    thresh = this.abstol[i] + reltol*this.soln_max[i];\n\t\t    if (Math.abs(d_sol[i]) > thresh) {\n\t\t\tconverged = false;\n\t\t\tthis.problem_node = i;\n\t\t    }\n\t\t}\n\n                if (converged == true) {\n\t\t    for (var i = this.N - 1; i >= 0; --i)\n\t\t\tif (Math.abs(soln[i]) > this.soln_max[i])\n\t\t\t    this.soln_max[i] = Math.abs(soln[i]);\n\t\t    return iter+1;\n\t\t}\n\t    }\n\t    return undefined;\n\t}\n\n\t// DC analysis\n\tCircuit.prototype.dc = function() {\n\t    // Allocation matrices for linear part, etc.\n\t    if (this.finalize() == false)\n\t\treturn undefined;\n\n\t    // Define -f and df/dx for Newton solver\n\t    function load_dc(ckt,soln,rhs) {\n\t\t// rhs is initialized to -Gl * soln\n\t\tmat_v_mult(ckt.Gl, soln, rhs, -1.0);\n\t\t// G matrix is initialized with linear Gl\n\t\tmat_copy(ckt.Gl,ckt.G);\n\t\t// Now load up the nonlinear parts of rhs and G\n\t\tfor (var i = ckt.devices.length - 1; i >= 0; --i)\n\t\t\tckt.devices[i].load_dc(ckt,soln,rhs);\n\t\t// G matrix is copied in to the system matrix\n\t\tmat_copy(ckt.G,ckt.matrix);\n\t    }\n\n\t    // find the operating point\n\t    var iterations = this.find_solution(load_dc,dc_max_iters);\n\n\t    if (typeof iterations == 'undefined') {\n\t    // too many iterations\n\t\tif (this.current_sources.length > 0) {\n\t\t    alert('Newton Method Failed, do your current sources have a conductive path to ground?');\n\t\t} else {\n\t\t    alert('Newton Method Failed, it may be your circuit or it may be our simulator.');\n\t\t}\n\n\t\treturn undefined\n\t    } else {\n\t\t// Note that a dc solution was computed\n\t\tthis.diddc = true;\n\t\t// create solution dictionary\n        var result = [];\n\t\t// capture node voltages\n\t\tfor (var name in this.node_map) {\n\t\t    var index = this.node_map[name];\n\t\t    result[name] = (index == -1) ? 0 : this.solution[index];\n\t\t}\n\t\t// capture branch currents from voltage sources\n\t\tfor (var i = this.voltage_sources.length - 1; i >= 0; --i) {\n\t\t    var v = this.voltage_sources[i];\n\t\t    result['I('+v.name+')'] = this.solution[v.branch];\n\t\t}\n\t\treturn result;\n\t    }\n\t}\n\n\t// Transient analysis (needs work!)\n        Circuit.prototype.tran = function(ntpts, tstart, tstop, probenames, no_dc) {\n\n\t    // Define -f and df/dx for Newton solver\n\t    function load_tran(ckt,soln,rhs) {\n\t\t// Crnt is initialized to -Gl * soln\n\t\tmat_v_mult(ckt.Gl, soln, ckt.c,-1.0);\n\t\t// G matrix is initialized with linear Gl\n\t\tmat_copy(ckt.Gl,ckt.G);\n\t\t// Now load up the nonlinear parts of crnt and G\n\t\tfor (var i = ckt.devices.length - 1; i >= 0; --i)\n\t\t    ckt.devices[i].load_tran(ckt,soln,ckt.c,ckt.time);\n\t\t// Exploit the fact that storage elements are linear\n\t\tmat_v_mult(ckt.C, soln, ckt.q, 1.0);\n\t\t// -rhs = c - dqdt\n\t\tfor (var i = ckt.N-1; i >= 0; --i) {\n\t\t    var dqdt = ckt.alpha0*ckt.q[i] + ckt.alpha1*ckt.oldq[i] +\n\t\t\tckt.alpha2*ckt.old2q[i];\n\t\t    rhs[i] = ckt.beta0[i]*ckt.c[i] + ckt.beta1[i]*ckt.oldc[i] - dqdt;\n\t\t}\n\t\t// matrix = beta0*G + alpha0*C.\n\t\tmat_scale_add(ckt.G,ckt.C,ckt.beta0,ckt.alpha0,ckt.matrix);\n\t    }\n\n\t    var p = new Array(3);\n\t    function interp_coeffs(t, t0, t1, t2) {\n\t\t// Poly coefficients\n\t\tvar dtt0 = (t - t0);\n\t\tvar dtt1 = (t - t1);\n\t\tvar dtt2 = (t - t2);\n\t\tvar dt0dt1 = (t0 - t1);\n\t\tvar dt0dt2 = (t0 - t2);\n\t\tvar dt1dt2 = (t1 - t2);\n\t\tp[0] = (dtt1*dtt2)/(dt0dt1 * dt0dt2);\n\t\tp[1] = (dtt0*dtt2)/(-dt0dt1 * dt1dt2);\n\t\tp[2] = (dtt0*dtt1)/(dt0dt2 * dt1dt2);\n\t\treturn p;\n\t    }\n\n\t    function pick_step(ckt, step_index) {\n\t\tvar min_shrink_factor = 1.0/lte_step_decrease_factor;\n\t        var max_growth_factor = time_step_increase_factor;\n\t\tvar N = ckt.N;\n\t\tvar p = interp_coeffs(ckt.time, ckt.oldt, ckt.old2t, ckt.old3t);\n\t\tvar trapcoeff = 0.5*(ckt.time - ckt.oldt)/(ckt.time - ckt.old3t);\n\t\tvar maxlteratio = 0.0;\n\t\tfor (var i = ckt.N-1; i >= 0; --i) {\n\t\t    if (ckt.ltecheck[i]) { // Check lte on variable\n\t\t\tvar pred = p[0]*ckt.oldsol[i] + p[1]*ckt.old2sol[i] + p[2]*ckt.old3sol[i];\n\t\t\tvar lte = Math.abs((ckt.solution[i] - pred))*trapcoeff;\n\t\t\tvar lteratio = lte/(lterel*(ckt.abstol[i] + reltol*ckt.soln_max[i]));\n\t\t\tmaxlteratio = Math.max(maxlteratio, lteratio);\n\t\t    }\n\t\t}\n\t\tvar new_step;\n\t\tvar lte_step_ratio = 1.0/Math.pow(maxlteratio,1/3); // Cube root because trap\n\t\tif (lte_step_ratio < 1.0) { // Shrink the timestep to make lte\n\t\t    lte_step_ratio = Math.max(lte_step_ratio,min_shrink_factor);\n\t\t    new_step = (ckt.time - ckt.oldt)*0.75*lte_step_ratio;\n\t\t    new_step = Math.max(new_step, ckt.min_step);\n\t\t} else {\n\t\t    lte_step_ratio = Math.min(lte_step_ratio, max_growth_factor);\n\t\t    if (lte_step_ratio > 1.2)  /* Increase timestep due to lte. */\n\t\t\tnew_step = (ckt.time - ckt.oldt) * lte_step_ratio / 1.2;\n\t\t    else\n\t\t\tnew_step = (ckt.time - ckt.oldt);\n\t\t    new_step = Math.min(new_step, ckt.max_step);\n\t\t}\n\t\treturn new_step;\n\t    }\n\n\t    // Standard to do a dc analysis before transient\n\t    // Otherwise, do the setup also done in dc.\n\t    no_dc = false;\n\t    if ((this.diddc == false) && (no_dc == false)) {\n\t\tif (this.dc() == undefined) { // DC failed, realloc mats and vects.\n\t\t    alert('DC failed, trying transient analysis from zero.');\n\t\t    this.finalized = false;  // Reset the finalization.\n\t\t    if (this.finalize() == false)\n\t\t\treturn undefined;\n\t\t}\n\t    }\n\t    else {\n\t\tif (this.finalize() == false) // Allocate matrices and vectors.\n\t\t    return undefined;\n\t    }\n\n\t    // Tired of typing this, and using \"with\" generates hate mail.\n\t    var N = this.N;\n\n\t    // build array to hold list of results for each variable\n\t    // last entry is for timepoints.\n\t    var response = new Array(N + 1);\n        for (var i = N; i >= 0; --i) response[i] = [];\n\n\t    // Allocate back vectors for up to a second order method\n\t    this.old3sol = new Array(this.N);\n\t    this.old3q = new Array(this.N);\n\t    this.old2sol = new Array(this.N);\n\t    this.old2q = new Array(this.N);\n\t    this.oldsol = new Array(this.N);\n\t    this.oldq = new Array(this.N);\n\t    this.q = new Array(this.N);\n\t    this.oldc = new Array(this.N);\n\t    this.c = new Array(this.N);\n\t    this.alpha0 = 1.0;\n\t    this.alpha1 = 0.0;\n\t    this.alpha2 = 0.0;\n\t    this.beta0 = new Array(this.N);\n\t    this.beta1 = new Array(this.N);\n\n\t    // Mark a set of algebraic variable (don't miss hidden ones!).\n\t    this.ar = this.algebraic(this.C);\n\n\t    // Non-algebraic variables and probe variables get lte\n\t    this.ltecheck = new Array(this.N);\n\t    for (var i = N; i >= 0; --i)\n\t\tthis.ltecheck[i] = (this.ar[i] == 0);\n\n\t    for (var name in this.node_map) {\n\t\tvar index = this.node_map[name];\n\t\tfor (var i = probenames.length; i >= 0; --i) {\n\t\t    if (name == probenames[i]) {\n\t\t\tthis.ltecheck[index] = true;\n\t\t\tbreak;\n\t\t    }\n\t\t}\n\t    }\n\n\t    // Check for periodic sources\n\t    var period = tstop - tstart;\n\t    for (var i = this.voltage_sources.length - 1; i >= 0; --i) {\n\t\tvar per = this.voltage_sources[i].src.period;\n\t\tif (per > 0)\n\t\t    period = Math.min(period, per);\n\t    }\n\t    for (var i = this.current_sources.length - 1; i >= 0; --i) {\n\t\tvar per = this.current_sources[i].src.period;\n\t\tif (per > 0)\n\t\t    period = Math.min(period, per);\n\t    }\n\t    this.periods = Math.ceil((tstop - tstart)/period);\n\n\t    this.time = tstart;\n\t    // ntpts adjusted by numbers of periods in input\n\t    this.max_step = (tstop - tstart)/(this.periods*ntpts);\n\t    this.min_step = this.max_step/1e8;\n\t    var new_step = this.max_step/1e6;\n\t    this.oldt = this.time - new_step;\n\n\t    // Initialize old crnts, charges, and solutions.\n\t    load_tran(this,this.solution,this.rhs)\n\t    for (var i = N-1; i >= 0; --i) {\n\t\tthis.old3sol[i] = this.solution[i];\n\t\tthis.old2sol[i] = this.solution[i];\n\t\tthis.oldsol[i] = this.solution[i];\n\t\tthis.old3q[i] = this.q[i];\n\t\tthis.old2q[i] = this.q[i];\n\t\tthis.oldq[i] = this.q[i];\n\t\tthis.oldc[i] = this.c[i];\n\t    }\n\n\t    var beta0,beta1;\n\t    // Start with two pseudo-Euler steps, maximum 50000 steps/period\n\t    var max_nsteps = this.periods*50000;\n\t    for(var step_index = -3; step_index < max_nsteps; step_index++) {\n\t\t// Save the just computed solution, and move back q and c.\n\t\tfor (var i = this.N - 1; i >= 0; --i) {\n\t\t    if (step_index >= 0)\n\t\t\tresponse[i].push(this.solution[i]);\n\t\t    this.oldc[i] = this.c[i];\n\t\t    this.old3sol[i] = this.old2sol[i];\n\t\t    this.old2sol[i] = this.oldsol[i];\n\t\t    this.oldsol[i] = this.solution[i];\n\t\t    this.old3q[i] = this.oldq[i];\n\t\t    this.old2q[i] = this.oldq[i];\n\t\t    this.oldq[i] = this.q[i];\n\t\t}\n\n\t\tif (step_index < 0) {  // Take a prestep using BE\n\t\t    this.old3t = this.old2t - (this.oldt-this.old2t)\n\t\t    this.old2t = this.oldt - (tstart-this.oldt)\n\t\t    this.oldt = tstart - (this.time - this.oldt);\n\t\t    this.time = tstart;\n\t\t    beta0 = 1.0;\n\t\t    beta1 = 0.0;\n\t\t} else {  // Take a regular step\n\t\t    // Save the time, and rotate time wheel\n\t\t    response[this.N].push(this.time);\n\t\t    this.old3t = this.old2t;\n\t\t    this.old2t = this.oldt;\n\t\t    this.oldt = this.time;\n\t\t    // Make sure we come smoothly in to the interval end.\n\t\t    if (this.time >= tstop) break;  // We're done.\n\t\t    else if(this.time + new_step > tstop)\n\t\t\tthis.time = tstop;\n\t\t    else if(this.time + 1.5*new_step > tstop)\n\t\t\tthis.time += (2/3)*(tstop - this.time);\n\t\t    else\n\t\t\tthis.time += new_step;\n\n\t\t    // Use trap (average old and new crnts.\n\t\t    beta0 = 0.5;\n\t\t    beta1 = 0.5;\n\t\t}\n\n\t\t// For trap rule, turn off current avging for algebraic eqns\n\t\tfor (var i = this.N - 1; i >= 0; --i) {\n\t\t    this.beta0[i] = beta0 + this.ar[i]*beta1;\n\t\t    this.beta1[i] = (1.0 - this.ar[i])*beta1;\n\t\t}\n\n\t\t// Loop to find NR converging timestep with okay LTE\n\t\twhile (true) {\n\t\t    // Set the timestep coefficients (alpha2 is for bdf2).\n\t\t    this.alpha0 = 1.0/(this.time - this.oldt);\n\t\t    this.alpha1 = -this.alpha0;\n\t\t    this.alpha2 = 0;\n\n\t\t    // If timestep is 1/10,000th of tstop, just use BE.\n\t\t    if ((this.time-this.oldt) < 1.0e-4*tstop) {\n\t\t\tfor (var i = this.N - 1; i >= 0; --i) {\n\t\t\t    this.beta0[i] = 1.0;\n\t\t\t    this.beta1[i] = 0.0;\n\t\t\t}\n\t\t    }\n\t\t    // Use Newton to compute the solution.\n\t\t    var iterations = this.find_solution(load_tran,max_tran_iters);\n\n\t\t    // If NR succeeds and stepsize is at min, accept and newstep=maxgrowth*minstep.\n\t\t    // Else if Newton Fails, shrink step by a factor and try again\n\t\t    // Else LTE picks new step, if bigger accept current step and go on.\n\t\t    if ((iterations != undefined) &&\n\t\t\t(step_index <= 0 || (this.time-this.oldt) < (1+reltol)*this.min_step)) {\n\t\t\tif (step_index > 0) new_step = time_step_increase_factor*this.min_step;\n\t\t\tbreak;\n\t\t    } else if (iterations == undefined) {  // NR nonconvergence, shrink by factor\n\t\t\tthis.time = this.oldt +\n\t\t\t    (this.time - this.oldt)/nr_step_decrease_factor;\n\t\t    } else {  // Check the LTE and shrink step if needed.\n\t\t\tnew_step = pick_step(this, step_index);\n\t\t\tif (new_step < (1.0 - reltol)*(this.time - this.oldt)) {\n\t\t\t    this.time = this.oldt + new_step;  // Try again\n\t\t\t}\n\t\t\telse\n\t\t\t    break;  // LTE okay, new_step for next step\n\t\t    }\n\t\t}\n\t    }\n\n\t    // create solution dictionary\n        var result = [];\n\t    for (var name in this.node_map) {\n\t\tvar index = this.node_map[name];\n\t\tresult[name] = (index == -1) ? 0 : response[index];\n\t    }\n\t    // capture branch currents from voltage sources\n\t    for (var i = this.voltage_sources.length - 1; i >= 0; --i) {\n\t\tvar v = this.voltage_sources[i];\n\t\tresult['I('+v.name+')'] = response[v.branch];\n\t    }\n\n\t    result['_time_'] = response[this.N];\n\t    return result;\n\t}\n\n\t// AC analysis: npts/decade for freqs in range [fstart,fstop]\n\t// result['_frequencies_'] = vector of log10(sample freqs)\n\t// result['xxx'] = vector of dB(response for node xxx)\n        // NOTE: Normalization removed in schematic.js, jkw.\n        Circuit.prototype.ac = function(npts,fstart,fstop,source_name) {\n\n\t    if (this.dc() == undefined) { // DC failed, realloc mats and vects.\n\t\treturn undefined;\n\t    }\n\n\t    var N = this.N;\n\t    var G = this.G;\n\t    var C = this.C;\n\n\t    // Complex numbers, we're going to need a bigger boat\n\t    var matrixac = mat_make(2*N, (2*N)+1);\n\n            // Get the source used for ac\n\t    if (this.device_map[source_name] === undefined) {\n\t\talert('AC analysis refers to unknown source ' + source_name);\n\t\treturn 'AC analysis failed, unknown source';\n\t    }\n\t    this.device_map[source_name].load_ac(this,this.rhs);\n\n\t    // build array to hold list of magnitude and phases for each node\n\t    // last entry is for frequency values\n\t    var response = new Array(2*N + 1);\n        for (var i = 2*N; i >= 0; --i) response[i] = [];\n\n\t    // multiplicative frequency increase between freq points\n\t    var delta_f = Math.exp(Math.LN10/npts);\n\n\t    var phase_offset = new Array(N);\n\t    for (var i = N-1; i >= 0; --i) phase_offset[i] = 0;\n\n\t    var f = fstart;\n\t    fstop *= 1.0001;  // capture that last freq point!\n\t    while (f <= fstop) {\n\t\tvar omega = 2 * Math.PI * f;\n\t\tresponse[2*N].push(f);   // 2*N for magnitude and phase\n\n\t\t// Find complex x+jy that sats Gx-omega*Cy=rhs; omega*Cx+Gy=0\n\t\t// Note: solac[0:N-1]=x, solac[N:2N-1]=y\n\t\tfor (var i = N-1; i >= 0; --i) {\n\t\t    // First the rhs, replicated for real and imaginary\n\t\t    matrixac[i][2*N] = this.rhs[i];\n\t\t    matrixac[i+N][2*N] = 0;\n\n\t\t    for (var j = N-1; j >= 0; --j) {\n\t\t\tmatrixac[i][j] = G[i][j];\n\t\t\tmatrixac[i+N][j+N] = G[i][j];\n\t\t\tmatrixac[i][j+N] = -omega*C[i][j];\n\t\t\tmatrixac[i+N][j] = omega*C[i][j];\n\t\t    }\n\t\t}\n\n\t\t// Compute the small signal response\n\t\tvar solac = mat_solve(matrixac);\n\n\t\t// Save magnitude and phase\n\t\tfor (var i = N - 1; i >= 0; --i) {\n\t\t    var mag = Math.sqrt(solac[i]*solac[i] + solac[i+N]*solac[i+N]);\n\t\t    response[i].push(mag);\n\n\t\t    // Avoid wrapping phase, add or sub 180 for each jump\n\t\t    var phase = 180*(Math.atan2(solac[i+N],solac[i])/Math.PI);\n\t\t    var phasei = response[i+N];\n\t\t    var L = phasei.length;\n\t\t    // Look for a one-step jump greater than 90 degrees\n\t\t    if (L > 1) {\n\t\t\tvar phase_jump = phase + phase_offset[i] - phasei[L-1];\n\t\t\tif (phase_jump > 90) {\n\t\t\t    phase_offset[i] -= 360;\n\t\t\t} else if (phase_jump < -90) {\n\t\t\t    phase_offset[i] += 360;\n\t\t\t}\n\t\t    }\n\t\t    response[i+N].push(phase + phase_offset[i]);\n\t\t}\n\t\tf *= delta_f;    // increment frequency\n\t    }\n\n\t    // create solution dictionary\n        var result = [];\n\t    for (var name in this.node_map) {\n\t\tvar index = this.node_map[name];\n\t\tresult[name] = (index == -1) ? 0 : response[index];\n\t\tresult[name+'_phase'] = (index == -1) ? 0 : response[index+N];\n\t    }\n\t    result['_frequencies_'] = response[2*N];\n\t    return result;\n\t}\n\n        // Helper for adding devices to a circuit, warns on duplicate device names.\n        Circuit.prototype.add_device = function(d,name) {\n\t    // Add device to list of devices and to device map\n\t    this.devices.push(d);\n\t    d.name = name;\n\t    if (name) {\n\t\tif (this.device_map[name] === undefined)\n\t\t    this.device_map[name] = d;\n\t\telse {\n\t\t    alert('Warning: two circuit elements share the same name ' + name);\n\t\t    this.device_map[name] = d;\n\t\t}\n\t    }\n\t    return d;\n\t}\n\n\tCircuit.prototype.r = function(n1,n2,v,name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof v) == 'string') {\n\t\tv = parse_number(v,undefined);\n\t\tif (v === undefined) return undefined;\n\t    }\n\n\t    if (v != 0) {\n\t\tvar d = new Resistor(n1,n2,v);\n\t\treturn this.add_device(d, name);\n\t    } else return this.v(n1,n2,'0',name);   // zero resistance == 0V voltage source\n\t}\n\n\tCircuit.prototype.d = function(n1,n2,area,type,name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof area) == 'string') {\n\t\tarea = parse_number(area,undefined);\n\t\tif (area === undefined) return undefined;\n\t    }\n\n\t    if (area != 0) {\n\t\tvar d = new Diode(n1,n2,area,type);\n\t\treturn this.add_device(d, name);\n\t    } // zero area diodes discarded.\n\t}\n\n\tCircuit.prototype.c = function(n1,n2,v,name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof v) == 'string') {\n\t\tv = parse_number(v,undefined);\n\t\tif (v === undefined) return undefined;\n\t    }\n\t    var d = new Capacitor(n1,n2,v);\n\t    return this.add_device(d, name);\n\t}\n\n\tCircuit.prototype.l = function(n1,n2,v,name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof v) == 'string') {\n\t\tv = parse_number(v,undefined);\n\t\tif (v === undefined) return undefined;\n\t    }\n\t    var branch = this.node(undefined,T_CURRENT);\n\t    var d = new Inductor(n1,n2,branch,v);\n\t    return this.add_device(d, name);\n\t}\n\n        Circuit.prototype.v = function(n1,n2,v,name) {\n\t    var branch = this.node(undefined,T_CURRENT);\n\t    var d = new VSource(n1,n2,branch,v);\n\t    this.voltage_sources.push(d);\n\t    return this.add_device(d, name);\n\t}\n\n\tCircuit.prototype.i = function(n1,n2,v,name) {\n\t    var d = new ISource(n1,n2,v);\n\t    this.current_sources.push(d);\n\t    return this.add_device(d, name);\n\t}\n\n        Circuit.prototype.opamp = function(np,nn,no,ng,A,name) {\n            var ratio;\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof A) == 'string') {\n\t\tratio = parse_number(A,undefined);\n\t\tif (A === undefined) return undefined;\n\t    }\n\t    var branch = this.node(undefined,T_CURRENT);\n\t    var d = new Opamp(np,nn,no,ng,branch,A,name);\n\t    return this.add_device(d, name);\n\t}\n\n        Circuit.prototype.n = function(d,g,s, ratio, name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof ratio) == 'string') {\n\t\tratio = parse_number(ratio,undefined);\n\t\tif (ratio === undefined) return undefined;\n\t    }\n\t    var d = new Fet(d,g,s,ratio,name,'n');\n\t    return this.add_device(d, name);\n\t}\n\n        Circuit.prototype.p = function(d,g,s, ratio, name) {\n\t    // try to convert string value into numeric value, barf if we can't\n\t    if ((typeof ratio) == 'string') {\n\t\tratio = parse_number(ratio,undefined);\n\t\tif (ratio === undefined) return undefined;\n\t    }\n\t    var d = new Fet(d,g,s,ratio,name,'p');\n\t    return this.add_device(d, name);\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Support for creating conductance and capacitance matrices associated with\n        //  modified nodal analysis (unknowns are node voltages and inductor and voltage\n        //  source currents).\n        //  The linearized circuit is written as\n        //          C d/dt x = G x + rhs\n        //  x - vector of node voltages and element currents\n        //  rhs - vector of source values\n        //  C - Matrix whose values are capacitances and inductances, has many zero rows.\n        //  G - Matrix whose values are conductances and +-1's.\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// add val component between two nodes to matrix M\n\t// Index of -1 refers to ground node\n        Circuit.prototype.add_two_terminal = function(i,j,g,M) {\n\t    if (i >= 0) {\n\t\tM[i][i] += g;\n\t\tif (j >= 0) {\n\t\t    M[i][j] -= g;\n\t\t    M[j][i] -= g;\n\t\t    M[j][j] += g;\n\t\t}\n\t    } else if (j >= 0)\n\t\tM[j][j] += g;\n\t}\n\n\t// add val component between two nodes to matrix M\n\t// Index of -1 refers to ground node\n        Circuit.prototype.get_two_terminal = function(i,j,x) {\n\t    var xi_minus_xj = 0;\n\t    if (i >= 0) xi_minus_xj = x[i];\n\t    if (j >= 0) xi_minus_xj -= x[j];\n\t    return xi_minus_xj\n\t}\n\n        Circuit.prototype.add_conductance_l = function(i,j,g) {\n            this.add_two_terminal(i,j,g, this.Gl)\n\t}\n\n        Circuit.prototype.add_conductance = function(i,j,g) {\n            this.add_two_terminal(i,j,g, this.G)\n\t}\n\n        Circuit.prototype.add_capacitance = function(i,j,c) {\n            this.add_two_terminal(i,j,c,this.C)\n\t}\n\n\t// add individual conductance to Gl matrix\n\tCircuit.prototype.add_to_Gl = function(i,j,g) {\n\t    if (i >=0 && j >= 0)\n\t\tthis.Gl[i][j] += g;\n\t}\n\n\t// add individual conductance to Gl matrix\n\tCircuit.prototype.add_to_G = function(i,j,g) {\n\t    if (i >=0 && j >= 0)\n\t\tthis.G[i][j] += g;\n\t}\n\n\t// add individual capacitance to C matrix\n\tCircuit.prototype.add_to_C = function(i,j,c) {\n\t    if (i >=0 && j >= 0)\n\t\tthis.C[i][j] += c;\n\t}\n\n\t// add source info to rhs\n        Circuit.prototype.add_to_rhs = function(i,v,rhs) {\n\t    if (i >= 0)\trhs[i] += v;\n\t}\n\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Generic matrix support - making, copying, factoring, rank, etc\n\t//  Note, Matrices are stored using nested javascript arrays.\n\t////////////////////////////////////////////////////////////////////////////////\n\n        // Allocate an NxM matrix\n        function mat_make(N,M) {\n\t    var mat = new Array(N);\n\t    for (var i = N - 1; i >= 0; --i) {\n\t\tmat[i] = new Array(M);\n\t\tfor (var j = M - 1; j >= 0; --j) {\n\t\t    mat[i][j] = 0.0;\n\t\t}\n\t    }\n\t    return mat;\n\t}\n\n        // Form b = scale*Mx\n        function mat_v_mult(M,x,b,scale) {\n\t    var n = M.length;\n\t    var m = M[0].length;\n\n\t    if (n != b.length || m != x.length)\n\t\tthrow 'Rows of M mismatched to b or cols mismatch to x.';\n\n\t    for (var i = 0; i < n; i++) {\n\t\tvar temp = 0;\n\t\tfor (var j = 0; j < m; j++) temp += M[i][j]*x[j];\n\t\tb[i] = scale*temp;  // Recall the neg in the name\n\t    }\n\t}\n\n        // C = scalea*A + scaleb*B, scalea, scaleb eithers numbers or arrays (row scaling)\n        function mat_scale_add(A, B, scalea, scaleb, C) {\n\t    var n = A.length;\n\t    var m = A[0].length;\n\n\t    if (n > B.length || m > B[0].length)\n\t\tthrow 'Row or columns of A to large for B';\n\t    if (n > C.length || m > C[0].length)\n\t\tthrow 'Row or columns of A to large for C';\n\t    if ((typeof scalea == 'number') && (typeof scaleb == 'number'))\n\t\tfor (var i = 0; i < n; i++)\n\t\t    for (var j = 0; j < m; j++)\n\t\t\tC[i][j] = scalea*A[i][j] + scaleb*B[i][j];\n\t    else if ((typeof scaleb == 'number') && (scalea instanceof Array))\n\t\tfor (var i = 0; i < n; i++)\n\t\t    for (var j = 0; j < m; j++)\n\t\t\tC[i][j] = scalea[i]*A[i][j] + scaleb*B[i][j];\n\t    else if ((typeof scaleb instanceof Array) && (scalea instanceof Array))\n\t\tfor (var i = 0; i < n; i++)\n\t\t    for (var j = 0; j < m; j++)\n\t\t\tC[i][j] = scalea[i]*A[i][j] + scaleb[i]*B[i][j];\n\t    else\n\t\tthrow 'scalea and scaleb must be scalars or Arrays';\n\t}\n\n        // Returns a vector of ones and zeros, ones denote algebraic\n        // variables (rows that can be removed without changing rank(M).\n        Circuit.prototype.algebraic = function(M) {\n\t    var Nr = M.length\n\t    var Mc = mat_make(Nr, Nr);\n\t    mat_copy(M,Mc);\n\t    var R = mat_rank(Mc);\n\n\t    var one_if_alg = new Array(Nr);\n\t    for (var row = 0; row < Nr; row++) {  // psuedo gnd row small\n\t\tfor (var col = Nr - 1; col >= 0; --col)\n\t\t    Mc[row][col] = 0;\n\t\tif (mat_rank(Mc) == R)  // Zeroing row left rank unchanged\n\t\t    one_if_alg[row] = 1;\n\t\telse { // Zeroing row changed rank, put back\n\t\t    for (var col = Nr - 1; col >= 0; --col)\n\t\t\tMc[row][col] = M[row][col];\n\t\t    one_if_alg[row] = 0;\n\t\t}\n\t    }\n\t    return one_if_alg;\n\t}\n\n        // Copy A -> using the bounds of A\n\tfunction mat_copy(src,dest) {\n\t    var n = src.length;\n\t    var m = src[0].length;\n\t    if (n > dest.length || m >  dest[0].length)\n\t\tthrow 'Rows or cols > rows or cols of dest';\n\n\t    for (var i = 0; i < n; i++)\n\t\tfor (var j = 0; j < m; j++)\n\t\t    dest[i][j] = src[i][j];\n\t}\n        // Copy and transpose A -> using the bounds of A\n\tfunction mat_copy_transposed(src,dest) {\n\t    var n = src.length;\n\t    var m = src[0].length;\n\t    if (n > dest[0].length || m >  dest.length)\n\t\tthrow 'Rows or cols > cols or rows of dest';\n\n\t    for (var i = 0; i < n; i++)\n\t\tfor (var j = 0; j < m; j++)\n\t\t    dest[j][i] = src[i][j];\n\t}\n\n\n\t// Uses GE to determine rank.\n        function mat_rank(Mo) {\n\t    var Nr = Mo.length;  // Number of rows\n\t    var Nc = Mo[0].length;  // Number of columns\n\t    var temp,i,j;\n\t    // Make a copy to avoid overwriting\n        var M = mat_make(Nr, Nc);\n\t    mat_copy(Mo,M);\n\n\t    // Find matrix maximum entry\n\t    var max_abs_entry = 0;\n\t    for(var row = Nr-1; row >= 0; --row) {\n\t\tfor(var col = Nr-1; col >= 0; --col) {\n\t\t    if (Math.abs(M[row][col]) > max_abs_entry)\n\t\t\tmax_abs_entry = Math.abs(M[row][col]);\n\t\t}\n\t    }\n\n\t    // Gaussian elimination to find rank\n\t    var the_rank = 0;\n\t    var start_col = 0;\n\t    for (var row = 0; row < Nr; row++) {\n\t\t// Search for first nonzero column in the remaining rows.\n\t\tfor (var col = start_col; col < Nc; col++) {\n\t\t    var max_v = Math.abs(M[row][col]);\n\t\t    var max_row = row;\n\t\t    for (var i = row + 1; i < Nr; i++) {\n\t\t\ttemp = Math.abs(M[i][col]);\n\t\t\tif (temp > max_v) { max_v = temp; max_row = i; }\n\t\t    }\n\t\t    // if max_v non_zero, column is nonzero, eliminate in subsequent rows\n\t\t    if (Math.abs(max_v) > eps*max_abs_entry) {\n\t\t\tstart_col = col+1;\n\t\t\tthe_rank += 1;\n\t\t        // Swap rows to get max in M[row][col]\n\t\t\ttemp = M[row];\n\t\t\tM[row] = M[max_row];\n\t\t\tM[max_row] = temp;\n\n\t\t\t// now eliminate this column for all subsequent rows\n\t\t\tfor (var i = row + 1; i < Nr; i++) {\n\t\t\t    temp = M[i][col]/M[row][col];   // multiplier for current row\n\t\t\t    if (temp != 0)  // subtract\n\t\t\t    for (var j = col; j < Nc; j++) M[i][j] -= M[row][j]*temp;\n\t\t\t}\n\t\t\t// Now move on to the next row\n\t\t\tbreak;\n\t\t    }\n\t\t}\n\t    }\n\n\t    return the_rank;\n\t}\n\n\t// Solve Mx=b and return vector x using R^TQ^T factorization.\n        // Multiplication by R^T implicit, should be null-space free soln.\n        // M should have the extra column!\n        // Almost everything is in-lined for speed, sigh.\n        function mat_solve_rq(M, rhs) {\n            var scale;\n\t    var Nr = M.length;  // Number of rows\n\t    var Nc = M[0].length;  // Number of columns\n\n\t    // Copy the rhs in to the last column of M if one is given.\n\t    if (rhs != null) {\n\t\tfor (var row = Nr - 1; row >= 0; --row)\n\t\t    M[row][Nc-1] = rhs[row];\n\t    }\n\n\t    var mat_scale = 0; // Sets the scale for comparison to zero.\n\t    var max_nonzero_row = Nr-1;  // Assumes M nonsingular.\n\t    for (var row = 0; row < Nr; row++) {\n\t\t// Find largest row with largest 2-norm\n\t\tvar max_row = row;\n\t\tvar maxsumsq = 0;\n\t\tfor (var rowp = row; rowp < Nr; rowp++) {\n\t\t    var Mr = M[rowp];\n\t\t    var sumsq = 0;\n\t\t    for (var col = Nc-2; col >= 0; --col)  // Last col=rhs\n\t\t\tsumsq += Mr[col]*Mr[col];\n\t\t    if ((row == rowp) || (sumsq > maxsumsq)) {\n\t\t\tmax_row = rowp;\n\t\t\tmaxsumsq = sumsq;\n\t\t    }\n\t\t}\n\t\tif (max_row > row) { // Swap rows if not max row\n\t\t    var temp = M[row];\n\t\t    M[row] = M[max_row];\n\t\t    M[max_row] = temp;\n\t\t}\n\n\t\t// Calculate row norm, save if this is first (largest)\n        var row_norm = Math.sqrt(maxsumsq);\n\t\tif (row == 0) mat_scale = row_norm;\n\n\t\t// Check for all zero rows\n\t\tif (row_norm > mat_scale*eps)\n\t\t    scale = 1.0/row_norm;\n\t\telse {\n\t\t    max_nonzero_row = row - 1;  // Rest will be nullspace of M\n\t\t    break;\n\t\t}\n\n\t\t// Nonzero row, eliminate from rows below\n\t\tvar Mr = M[row];\n\t\tfor (var col =  Nc-1; col >= 0; --col) // Scale rhs also\n\t\t    Mr[col] *= scale;\n\t\tfor (var rowp = row + 1; rowp < Nr; rowp++) { // Update.\n\t\t    var Mrp = M[rowp];\n\t\t    var inner = 0;\n\t\t    for (var col =  Nc-2; col >= 0; --col)  // Project\n\t\t\tinner += Mr[col]*Mrp[col];\n\t\t    for (var col =  Nc-1; col >= 0; --col) // Ortho (rhs also)\n\t\t\tMrp[col] -= inner *Mr[col];\n\t\t}\n\t    }\n\n\t    // Last Column of M has inv(R^T)*rhs.  Scale rows of Q to get x.\n\t    var x = new Array(Nc-1);\n\t    for (var col = Nc-2; col >= 0; --col)\n\t\tx[col] = 0;\n\t    for (var row = max_nonzero_row; row >= 0; --row) {\n\t\tMr = M[row];\n\t\tfor (var col = Nc-2; col >= 0; --col) {\n\t\t    x[col] += Mr[col]*Mr[Nc-1];\n\t\t}\n\t    }\n\n\t    return x;\n\t}\n\n\t// solve Mx=b and return vector x given augmented matrix M = [A | b]\n\t// Uses Gaussian elimination with partial pivoting\n        function mat_solve(M,rhs) {\n\t    var N = M.length;      // augmented matrix M has N rows, N+1 columns\n\t    var temp,i,j;\n\n\t    // Copy the rhs in to the last column of M if one is given.\n\t    if (rhs != null) {\n\t\tfor (var row = 0; row < N ; row++)\n\t\t    M[row][N] = rhs[row];\n\t    }\n\n\t    // gaussian elimination\n\t    for (var col = 0; col < N ; col++) {\n\t\t// find pivot: largest abs(v) in this column of remaining rows\n\t\tvar max_v = Math.abs(M[col][col]);\n\t\tvar max_col = col;\n\t\tfor (i = col + 1; i < N; i++) {\n\t\t    temp = Math.abs(M[i][col]);\n\t\t    if (temp > max_v) { max_v = temp; max_col = i; }\n\t\t}\n\n\t\t// if no value found, generate a small conductance to gnd\n\t\t// otherwise swap current row with pivot row\n\t\tif (max_v == 0) M[col][col] = eps;\n\t\telse {\n\t\t    temp = M[col];\n\t\t    M[col] = M[max_col];\n\t\t    M[max_col] = temp;\n\t\t}\n\n\t\t// now eliminate this column for all subsequent rows\n\t\tfor (i = col + 1; i < N; i++) {\n\t\t    temp = M[i][col]/M[col][col];   // multiplier we'll use for current row\n\t\t    if (temp != 0)\n\t\t\t// subtract current row from row we're working on\n\t\t\t// remember to process b too!\n\t\t\tfor (j = col; j <= N; j++) M[i][j] -= M[col][j]*temp;\n\t\t}\n\t    }\n\n\t    // matrix is now upper triangular, so solve for elements of x starting\n\t    // with the last row\n\t    var x = new Array(N);\n\t    for (i = N-1; i >= 0; --i) {\n\t\ttemp = M[i][N];   // grab b[i] from augmented matrix as RHS\n\t\t// subtract LHS term from RHS using known x values\n\t\tfor (j = N-1; j > i; --j) temp -= M[i][j]*x[j];\n\t\t// now compute new x value\n\t\tx[i] = temp/M[i][i];\n\t    }\n\n\t    return x;\n\t}\n\n\t// test solution code, expect x = [2,3,-1]\n\t//M = [[2,1,-1,8],[-3,-1,2,-11],[-2,1,2,-3]];\n\t//x = mat_solve(M);\n\t//y = 1;  // so we have place to set a breakpoint :)\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Device base class\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Device() {\n\t}\n\n\t// complete initial set up of device\n\tDevice.prototype.finalize = function() {\n\t}\n\n        // Load the linear elements in to Gl and C\n        Device.prototype.load_linear = function(ckt) {\n\t}\n\n\t// load linear system equations for dc analysis\n\t// (inductors shorted and capacitors opened)\n        Device.prototype.load_dc = function(ckt,soln,rhs) {\n\t}\n\n\t// load linear system equations for tran analysis\n\tDevice.prototype.load_tran = function(ckt,soln) {\n\t}\n\n\t// load linear system equations for ac analysis:\n\t// current sources open, voltage sources shorted\n\t// linear models at operating point for everyone else\n\tDevice.prototype.load_ac = function(ckt,rhs) {\n\t}\n\n\t// return time of next breakpoint for the device\n\tDevice.prototype.breakpoint = function(time) {\n\t    return undefined;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Parse numbers in engineering notation\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\t// convert first character of argument into an integer\n\tfunction ord(ch) {\n\t    return ch.charCodeAt(0);\n\t}\n\n\t// convert string argument to a number, accepting usual notations\n\t// (hex, octal, binary, decimal, floating point) plus engineering\n\t// scale factors (eg, 1k = 1000.0 = 1e3).\n\t// return default if argument couldn't be interpreted as a number\n\tfunction parse_number(s,default_v) {\n\t    var slen = s.length;\n\t    var multiplier = 1;\n\t    var result = 0;\n\t    var index = 0;\n\n\t    // skip leading whitespace\n\t    while (index < slen && s.charAt(index) <= ' ') index += 1;\n\t    if (index == slen) return default_v;\n\n\t    // check for leading sign\n\t    if (s.charAt(index) == '-') {\n\t\tmultiplier = -1;\n\t\tindex += 1;\n\t    } else if (s.charAt(index) == '+')\n\t\tindex += 1;\n\t    var start = index;   // remember where digits start\n\n\t    // if leading digit is 0, check for hex, octal or binary notation\n\t    if (index >= slen) return default_v;\n\t    else if (s.charAt(index) == '0') {\n\t\tindex += 1;\n\t\tif (index >= slen) return 0;\n\t\tif (s.charAt(index) == 'x' || s.charAt(index) == 'X') { // hex\n\t\t    while (true) {\n\t\t\tindex += 1;\n\t\t\tif (index >= slen) break;\n\t\t\tif (s.charAt(index) >= '0' && s.charAt(index) <= '9')\n\t\t\t    result = result*16 + ord(s.charAt(index)) - ord('0');\n\t\t\telse if (s.charAt(index) >= 'A' && s.charAt(index) <= 'F')\n\t\t\t    result = result*16 + ord(s.charAt(index)) - ord('A') + 10;\n\t\t\telse if (s.charAt(index) >= 'a' && s.charAt(index) <= 'f')\n\t\t\t    result = result*16 + ord(s.charAt(index)) - ord('a') + 10;\n\t\t\telse break;\n\t\t    }\n\t\t    return result*multiplier;\n\t\t} else if (s.charAt(index) == 'b' || s.charAt(index) == 'B') {  // binary\n\t\t    while (true) {\n\t\t\tindex += 1;\n\t\t\tif (index >= slen) break;\n\t\t\tif (s.charAt(index) >= '0' && s.charAt(index) <= '1')\n\t\t\t    result = result*2 + ord(s.charAt(index)) - ord('0');\n\t\t\telse break;\n\t\t    }\n\t\t    return result*multiplier;\n\t\t} else if (s.charAt(index) != '.') { // octal\n\t\t    while (true) {\n\t\t\tif (s.charAt(index) >= '0' && s.charAt(index) <= '7')\n\t\t\t    result = result*8 + ord(s.charAt(index)) - ord('0');\n\t\t\telse break;\n\t\t\tindex += 1;\n\t\t\tif (index >= slen) break;\n\t\t    }\n\t\t    return result*multiplier;\n\t\t}\n\t    }\n\t    // read decimal integer or floating-point number\n\t    while (true) {\n\t\tif (s.charAt(index) >= '0' && s.charAt(index) <= '9')\n\t\t    result = result*10 + ord(s.charAt(index)) - ord('0');\n\t\telse break;\n\t\tindex += 1;\n\t\tif (index >= slen) break;\n\t    }\n\n\t    // fractional part?\n\t    if (index < slen && s.charAt(index) == '.') {\n\t\twhile (true) {\n\t\t    index += 1;\n\t\t    if (index >= slen) break;\n\t\t    if (s.charAt(index) >= '0' && s.charAt(index) <= '9') {\n\t\t\tresult = result*10 + ord(s.charAt(index)) - ord('0');\n\t\t\tmultiplier *= 0.1;\n\t\t    } else break;\n\t\t}\n\t    }\n\n\t    // if we haven't seen any digits yet, don't check\n\t    // for exponents or scale factors\n\t    if (index == start) return default_v;\n\n\t    // type of multiplier determines type of result:\n\t    // multiplier is a float if we've seen digits past\n\t    // a decimal point, otherwise it's an int or long.\n\t    // Up to this point result is an int or long.\n\t    result *= multiplier;\n\n\t    // now check for exponent or engineering scale factor.  If there\n\t    // is one, result will be a float.\n\t    if (index < slen) {\n\t\tvar scale = s.charAt(index);\n\t\tindex += 1;\n\t\tif (scale == 'e' || scale == 'E') {\n\t\t    var exponent = 0;\n\t\t    multiplier = 10.0;\n\t\t    if (index < slen) {\n\t\t\tif (s.charAt(index) == '+') index += 1;\n\t\t\telse if (s.charAt(index) == '-') {\n\t\t\t    index += 1;\n\t\t\t    multiplier = 0.1;\n\t\t\t}\n\t\t    }\n\t\t    while (index < slen) {\n\t\t\tif (s.charAt(index) >= '0' && s.charAt(index) <= '9') {\n\t\t\t    exponent = exponent*10 + ord(s.charAt(index)) - ord('0');\n\t\t\t    index += 1;\n\t\t\t} else break;\n\t\t    }\n\t\t    while (exponent > 0) {\n\t\t\texponent -= 1;\n\t\t\tresult *= multiplier;\n\t\t    }\n\t\t} else if (scale == 't' || scale == 'T') result *= 1e12;\n\t\telse if (scale == 'g' || scale == 'G') result *= 1e9;\n\t\telse if (scale == 'M') result *= 1e6;\n\t\telse if (scale == 'k' || scale == 'K') result *= 1e3;\n\t\telse if (scale == 'm') result *= 1e-3;\n\t\telse if (scale == 'u' || scale == 'U') result *= 1e-6;\n\t\telse if (scale == 'n' || scale == 'N') result *= 1e-9;\n\t\telse if (scale == 'p' || scale == 'P') result *= 1e-12;\n\t\telse if (scale == 'f' || scale == 'F') result *= 1e-15;\n\t    }\n\t    // ignore any remaining chars, eg, 1kohms returns 1000\n\t    return result;\n\t}\n\n\tCircuit.prototype.parse_number = parse_number;  // make it easy to call from outside\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Sources\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\t// argument is a string describing the source's value (see comments for details)\n\t// source types: dc,step,square,triangle,sin,pulse,pwl,pwl_repeating\n\n\t// returns an object with the following attributes:\n\t//   fun -- name of source function\n\t//   args -- list of argument values\n\t//   value(t) -- compute source value at time t\n\t//   inflection_point(t) -- compute time after t when a time point is needed\n\t//   dc -- value at time 0\n\t//   period -- repeat period for periodic sources (0 if not periodic)\n\n\tfunction parse_source(v) {\n\t    // generic parser: parse v as either <value> or <fun>(<value>,...)\n        var src = {};\n\t    src.period = 0; // Default not periodic\n\t    src.value = function(t) { return 0; }  // overridden below\n\t    src.inflection_point = function(t) { return undefined; };  // may be overridden below\n\n\t    // see if there's a \"(\" in the description\n\t    var index = v.indexOf('(');\n\t    var ch;\n\t    if (index >= 0) {\n\t\tsrc.fun = v.slice(0,index);   // function name is before the \"(\"\n\t\tsrc.args = [];\t// we'll push argument values onto this list\n\t\tvar end = v.indexOf(')',index);\n\t\tif (end == -1) end = v.length;\n\n\t\tindex += 1;     // start parsing right after \"(\"\n\t\twhile (index < end) {\n\t\t    // figure out where next argument value starts\n\t\t    ch = v.charAt(index);\n\t\t    if (ch <= ' ') { index++; continue; }\n\t\t    // and where it ends\n\t\t    var arg_end = v.indexOf(',',index);\n\t\t    if (arg_end == -1) arg_end = end;\n\t\t    // parse and save result in our list of arg values\n\t\t    src.args.push(parse_number(v.slice(index,arg_end),undefined));\n\t\t    index = arg_end + 1;\n\t\t}\n\t    } else {\n\t\tsrc.fun = 'dc';\n\t\tsrc.args = [parse_number(v,0)];\n\t    }\n\n\t    // post-processing for constant sources\n\t    // dc(v)\n\t    if (src.fun == 'dc') {\n\t\tvar v = arg_value(src.args,0,0);\n\t\tsrc.args = [v];\n\t\tsrc.value = function(t) { return v; }  // closure\n\t    }\n\n\t    // post-processing for impulse sources\n\t    // impulse(height,width)\n\t    else if (src.fun == 'impulse') {\n\t\tvar h = arg_value(src.args,0,1);  // default height: 1\n\t\tvar w = Math.abs(arg_value(src.args,2,1e-9));  // default width: 1ns\n\t\tsrc.args = [h,w];  // remember any defaulted values\n\t\tpwl_source(src,[0,0,w/2,h,w,0],false);\n\t    }\n\n\t    // post-processing for step sources\n\t    // step(v_init,v_plateau,t_delay,t_rise)\n\t    else if (src.fun == 'step') {\n\t\tvar v1 = arg_value(src.args,0,0);  // default init value: 0V\n\t\tvar v2 = arg_value(src.args,1,1);  // default plateau value: 1V\n\t\tvar td = Math.max(0,arg_value(src.args,2,0));  // time step starts\n\t\tvar tr = Math.abs(arg_value(src.args,3,1e-9));  // default rise time: 1ns\n\t\tsrc.args = [v1,v2,td,tr];  // remember any defaulted values\n\t\tpwl_source(src,[td,v1,td+tr,v2],false);\n\t    }\n\n\t    // post-processing for square wave\n\t    // square(v_init,v_plateau,freq,duty_cycle)\n\t    else if (src.fun == 'square') {\n\t\tvar v1 = arg_value(src.args,0,0);  // default init value: 0V\n\t\tvar v2 = arg_value(src.args,1,1);  // default plateau value: 1V\n\t\tvar freq = Math.abs(arg_value(src.args,2,1));  // default frequency: 1Hz\n\t\tvar duty_cycle  = Math.min(100,Math.abs(arg_value(src.args,3,50)));  // default duty cycle: 0.5\n\t\tsrc.args = [v1,v2,freq,duty_cycle];  // remember any defaulted values\n\n\t\tvar per = freq == 0 ? Infinity : 1/freq;\n\t\tvar t_change = 0.01 * per;   // rise and fall time\n\t\tvar t_pw = .01 * duty_cycle * 0.98 * per;  // fraction of cycle minus rise and fall time\n\t\tpwl_source(src,[0,v1,t_change,v2,t_change+t_pw,\n\t\t\t\tv2,t_change+t_pw+t_change,v1,per,v1],true);\n\t    }\n\n\t    // post-processing for triangle\n\t    // triangle(v_init,v_plateua,t_period)\n\t    else if (src.fun == 'triangle') {\n\t\tvar v1 = arg_value(src.args,0,0);  // default init value: 0V\n\t\tvar v2 = arg_value(src.args,1,1);  // default plateau value: 1V\n\t\tvar freq = Math.abs(arg_value(src.args,2,1));  // default frequency: 1s\n\t\tsrc.args = [v1,v2,freq];  // remember any defaulted values\n\n\t\tvar per = freq == 0 ? Infinity : 1/freq;\n\t\tpwl_source(src,[0,v1,per/2,v2,per,v1],true);\n\t    }\n\n\t    // post-processing for pwl and pwlr sources\n\t    // pwl[r](t1,v1,t2,v2,...)\n\t    else if (src.fun == 'pwl' || src.fun == 'pwl_repeating') {\n\t\tpwl_source(src,src.args,src.fun == 'pwl_repeating');\n\t    }\n\n\t    // post-processing for pulsed sources\n\t    // pulse(v_init,v_plateau,t_delay,t_rise,t_fall,t_width,t_period)\n\t    else if (src.fun == 'pulse') {\n\t\tvar v1 = arg_value(src.args,0,0);  // default init value: 0V\n\t\tvar v2 = arg_value(src.args,1,1);  // default plateau value: 1V\n\t\tvar td = Math.max(0,arg_value(src.args,2,0));  // time pulse starts\n\t\tvar tr = Math.abs(arg_value(src.args,3,1e-9));  // default rise time: 1ns\n\t\tvar tf = Math.abs(arg_value(src.args,4,1e-9));  // default rise time: 1ns\n\t\tvar pw = Math.abs(arg_value(src.args,5,1e9));  // default pulse width: \"infinite\"\n\t\tvar per = Math.abs(arg_value(src.args,6,1e9));  // default period: \"infinite\"\n\t\tsrc.args = [v1,v2,td,tr,tf,pw,per];\n\n\t\tvar t1 = td;       // time when v1 -> v2 transition starts\n\t\tvar t2 = t1 + tr;  // time when v1 -> v2 transition ends\n\t\tvar t3 = t2 + pw;  // time when v2 -> v1 transition starts\n\t\tvar t4 = t3 + tf;  // time when v2 -> v1 transition ends\n\n\t\tpwl_source(src,[t1,v1, t2,v2, t3,v2, t4,v1, per,v1],true);\n\t    }\n\n\t    // post-processing for sinusoidal sources\n\t    // sin(v_offset,v_amplitude,freq_hz,t_delay,phase_offset_degrees)\n\t    else if (src.fun == 'sin') {\n\t\tvar voffset = arg_value(src.args,0,0);  // default offset voltage: 0V\n\t\tvar va = arg_value(src.args,1,1);  // default amplitude: -1V to 1V\n\t\tvar freq = Math.abs(arg_value(src.args,2,1));  // default frequency: 1Hz\n\t\tsrc.period = 1.0/freq;\n\n\t\tvar td = Math.max(0,arg_value(src.args,3,0));  // default time delay: 0sec\n\t\tvar phase = arg_value(src.args,4,0);  // default phase offset: 0 degrees\n\t\tsrc.args = [voffset,va,freq,td,phase];\n\n\t\tphase /= 360.0;\n\n\t\t// return value of source at time t\n\t\tsrc.value = function(t) {  // closure\n\t\t    if (t < td) return voffset + va*Math.sin(2*Math.PI*phase);\n\t\t    else return voffset + va*Math.sin(2*Math.PI*(freq*(t - td) + phase));\n\t\t}\n\n\t\t// return time of next inflection point after time t\n\t\tsrc.inflection_point = function(t) {\t// closure\n\t\t    if (t < td) return td;\n\t\t    else return undefined;\n\t\t}\n\t    }\n\n\t    // object has all the necessary info to compute the source value and inflection points\n\t    src.dc = src.value(0);   // DC value is value at time 0\n\t    return src;\n\t}\n\n\tfunction pwl_source(src,tv_pairs,repeat) {\n\t    var nvals = tv_pairs.length;\n\t    if (repeat)\n\t\tsrc.period = tv_pairs[nvals-2];  // Repeat period of source\n\t    if (nvals % 2 == 1) npts -= 1;  // make sure it's even!\n\n\t    if (nvals <= 2) {\n\t\t// handle degenerate case\n\t\tsrc.value = function(t) { return nvals == 2 ? tv_pairs[1] : 0; }\n\t\tsrc.inflection_point = function(t) { return undefined; }\n\t    } else {\n\t\tsrc.value = function(t) { // closure\n\t\t    if (repeat)\n\t\t\t// make time periodic if values are to be repeated\n\t\t\tt = Math.fmod(t,tv_pairs[nvals-2]);\n\t\t    var last_t = tv_pairs[0];\n\t\t    var last_v = tv_pairs[1];\n\t\t    if (t > last_t) {\n\t\t\tvar next_t,next_v;\n\t\t\tfor (var i = 2; i < nvals; i += 2) {\n\t\t\t    next_t = tv_pairs[i];\n\t\t\t    next_v = tv_pairs[i+1];\n\t\t\t    if (next_t > last_t)  // defend against bogus tv pairs\n\t\t\t\tif (t < next_t)\n\t\t\t\t    return last_v + (next_v - last_v)*(t - last_t)/(next_t - last_t);\n\t\t\t    last_t = next_t;\n\t\t\t    last_v = next_v;\n\t\t\t}\n\t\t    }\n\t\t    return last_v;\n\t\t}\n\t\tsrc.inflection_point = function(t) {  // closure\n\t\t    if (repeat)\n\t\t\t// make time periodic if values are to be repeated\n\t\t\tt = Math.fmod(t,tv_pairs[nvals-2]);\n\t\t    for (var i = 0; i < nvals; i += 2) {\n\t\t\tvar next_t = tv_pairs[i];\n\t\t\tif (t < next_t) return next_t;\n\t\t    }\n\t\t    return undefined;\n\t\t}\n\t    }\n\t}\n\n\t// helper function: return args[index] if present, else default_v\n\tfunction arg_value(args,index,default_v) {\n\t    if (index < args.length) {\n\t\tvar result = args[index];\n\t\tif (result === undefined) result = default_v;\n\t\treturn result;\n\t    } else return default_v;\n\t}\n\n\t// we need fmod in the Math library!\n\tMath.fmod = function(numerator,denominator) {\n\t    var quotient = Math.floor(numerator/denominator);\n\t    return numerator - quotient*denominator;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Sources\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n        function VSource(npos,nneg,branch,v) {\n\t    Device.call(this);\n\t    this.src = parse_source(v);\n\t    this.npos = npos;\n\t    this.nneg = nneg;\n\t    this.branch = branch;\n\t}\n\tVSource.prototype = new Device();\n\tVSource.prototype.constructor = VSource;\n\n\t// load linear part for source evaluation\n        VSource.prototype.load_linear = function(ckt) {\n\t    // MNA stamp for independent voltage source\n\t    ckt.add_to_Gl(this.branch,this.npos,1.0);\n\t    ckt.add_to_Gl(this.branch,this.nneg,-1.0);\n\t    ckt.add_to_Gl(this.npos,this.branch,1.0);\n\t    ckt.add_to_Gl(this.nneg,this.branch,-1.0);\n\t}\n\n\t// Source voltage added to b.\n        VSource.prototype.load_dc = function(ckt,soln,rhs) {\n\t    ckt.add_to_rhs(this.branch,this.src.dc,rhs);\n\t}\n\n\t// Load time-dependent value for voltage source for tran\n        VSource.prototype.load_tran = function(ckt,soln,rhs,time) {\n\t    ckt.add_to_rhs(this.branch,this.src.value(time),rhs);\n\t}\n\n\t// return time of next breakpoint for the device\n\tVSource.prototype.breakpoint = function(time) {\n\t    return this.src.inflection_point(time);\n\t}\n\n\t// small signal model ac value\n        VSource.prototype.load_ac = function(ckt,rhs) {\n\t    ckt.add_to_rhs(this.branch,1.0,rhs);\n\t}\n\n\tfunction ISource(npos,nneg,v) {\n\t    Device.call(this);\n\t    this.src = parse_source(v);\n\t    this.npos = npos;\n\t    this.nneg = nneg;\n\t}\n\tISource.prototype = new Device();\n\tISource.prototype.constructor = ISource;\n\n        ISource.prototype.load_linear = function(ckt) {\n\t    // Current source is open when off, no linear contribution\n\t}\n\n\t// load linear system equations for dc analysis\n\tISource.prototype.load_dc = function(ckt,soln,rhs) {\n\t    var is = this.src.dc;\n\n\t    // MNA stamp for independent current source\n\t    ckt.add_to_rhs(this.npos,-is,rhs);  // current flow into npos\n\t    ckt.add_to_rhs(this.nneg,is,rhs);   // and out of nneg\n\t}\n\n\t// load linear system equations for tran analysis (just like DC)\n        ISource.prototype.load_tran = function(ckt,soln,rhs,time) {\n\t    var is = this.src.value(time);\n\n\t    // MNA stamp for independent current source\n\t    ckt.add_to_rhs(this.npos,-is,rhs);  // current flow into npos\n\t    ckt.add_to_rhs(this.nneg,is,rhs);   // and out of nneg\n\t}\n\n\t// return time of next breakpoint for the device\n\tISource.prototype.breakpoint = function(time) {\n\t    return this.src.inflection_point(time);\n\t}\n\n\t// small signal model: open circuit\n        ISource.prototype.load_ac = function(ckt,rhs) {\n\t    // MNA stamp for independent current source\n\t    ckt.add_to_rhs(this.npos,-1.0,rhs);  // current flow into npos\n\t    ckt.add_to_rhs(this.nneg,1.0,rhs);   // and out of nneg\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Resistor\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tfunction Resistor(n1,n2,v) {\n\t    Device.call(this);\n\t    this.n1 = n1;\n\t    this.n2 = n2;\n\t    this.g = 1.0/v;\n\t}\n\tResistor.prototype = new Device();\n\tResistor.prototype.constructor = Resistor;\n\n        Resistor.prototype.load_linear = function(ckt) {\n\t    // MNA stamp for admittance g\n\t    ckt.add_conductance_l(this.n1,this.n2,this.g);\n\t}\n\n\tResistor.prototype.load_dc = function(ckt) {\n\t    // Nothing to see here, move along.\n\t}\n\n\tResistor.prototype.load_tran = function(ckt,soln) {\n\t}\n\n\tResistor.prototype.load_ac = function(ckt) {\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Diode\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tfunction Diode(n1,n2,v,type) {\n\t    Device.call(this);\n\t    this.anode = n1;\n\t    this.cathode = n2;\n\t    this.area = v;\n\t    this.type = type;  // 'normal' or 'ideal'\n\t    this.is = 1.0e-14;\n\t    this.ais = this.area * this.is;\n\t    this.vt = (type == 'normal') ? 25.8e-3 : 0.1e-3;  // 26mv or .1mv\n\t    this.exp_arg_max = 50;  // less than single precision max.\n\t    this.exp_max = Math.exp(this.exp_arg_max);\n\t}\n\tDiode.prototype = new Device();\n        Diode.prototype.constructor = Diode;\n\n        Diode.prototype.load_linear = function(ckt) {\n\t    // Diode is not linear, has no linear piece.\n\t}\n\n        Diode.prototype.load_dc = function(ckt,soln,rhs) {\n\t    var vd = ckt.get_two_terminal(this.anode, this.cathode, soln);\n\t    var exp_arg = vd / this.vt;\n\t    var temp1, temp2;\n\t    // Estimate exponential with a quadratic if arg too big.\n\t    var abs_exp_arg = Math.abs(exp_arg);\n\t    var d_arg = abs_exp_arg - this.exp_arg_max;\n\t    if (d_arg > 0) {\n\t\tvar quad = 1 + d_arg + 0.5*d_arg*d_arg;\n\t\ttemp1 = this.exp_max * quad;\n\t\ttemp2 = this.exp_max * (1 + d_arg);\n\t    } else {\n\t\ttemp1 = Math.exp(abs_exp_arg);\n\t\ttemp2 = temp1;\n\t    }\n\t    if (exp_arg < 0) {  // Use exp(-x) = 1.0/exp(x)\n\t\ttemp1 = 1.0/temp1;\n\t\ttemp2 = (temp1*temp2)*temp1;\n\t    }\n\t    var id = this.ais * (temp1 - 1);\n\t    var gd = this.ais * (temp2 / this.vt);\n\n\t    // MNA stamp for independent current source\n\t    ckt.add_to_rhs(this.anode,-id,rhs);  // current flows into anode\n\t    ckt.add_to_rhs(this.cathode,id,rhs);   // and out of cathode\n\t    ckt.add_conductance(this.anode,this.cathode,gd);\n\t}\n\n        Diode.prototype.load_tran = function(ckt,soln,rhs,time) {\n\t    this.load_dc(ckt,soln,rhs);\n\t}\n\n\tDiode.prototype.load_ac = function(ckt) {\n\t}\n\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Capacitor\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tfunction Capacitor(n1,n2,v) {\n\t    Device.call(this);\n\t    this.n1 = n1;\n\t    this.n2 = n2;\n\t    this.value = v;\n\t}\n\tCapacitor.prototype = new Device();\n\tCapacitor.prototype.constructor = Capacitor;\n\n        Capacitor.prototype.load_linear = function(ckt) {\n\t    // MNA stamp for capacitance matrix\n\t    ckt.add_capacitance(this.n1,this.n2,this.value);\n\t}\n\n\tCapacitor.prototype.load_dc = function(ckt,soln,rhs) {\n\t}\n\n\tCapacitor.prototype.load_ac = function(ckt) {\n\t}\n\n\tCapacitor.prototype.load_tran = function(ckt) {\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Inductor\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tfunction Inductor(n1,n2,branch,v) {\n\t    Device.call(this);\n\t    this.n1 = n1;\n\t    this.n2 = n2;\n\t    this.branch = branch;\n\t    this.value = v;\n\t}\n\tInductor.prototype = new Device();\n\tInductor.prototype.constructor = Inductor;\n\n        Inductor.prototype.load_linear = function(ckt) {\n\t    // MNA stamp for inductor linear part\n\t    // L on diag of C because L di/dt = v(n1) - v(n2)\n\t    ckt.add_to_Gl(this.n1,this.branch,1);\n\t    ckt.add_to_Gl(this.n2,this.branch,-1);\n\t    ckt.add_to_Gl(this.branch,this.n1,-1);\n\t    ckt.add_to_Gl(this.branch,this.n2,1);\n\t    ckt.add_to_C(this.branch,this.branch,this.value)\n\t}\n\n\tInductor.prototype.load_dc = function(ckt,soln,rhs) {\n\t    // Inductor is a short at dc, so is linear.\n\t}\n\n\tInductor.prototype.load_ac = function(ckt) {\n\t}\n\n\tInductor.prototype.load_tran = function(ckt) {\n\t}\n\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Simple Voltage-Controlled Voltage Source Op Amp model\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n        function Opamp(np,nn,no,ng,branch,A,name) {\n\t    Device.call(this);\n\t    this.np = np;\n\t    this.nn = nn;\n\t    this.no = no;\n\t    this.ng = ng;\n\t    this.branch = branch;\n\t    this.gain = A;\n\t    this.name = name;\n\t}\n\n\tOpamp.prototype = new Device();\n        Opamp.prototype.constructor = Opamp;\n        Opamp.prototype.load_linear = function(ckt) {\n            // MNA stamp for VCVS: 1/A(v(no) - v(ng)) - (v(np)-v(nn))) = 0.\n\t    var invA = 1.0/this.gain;\n\t    ckt.add_to_Gl(this.no,this.branch,1);\n\t    ckt.add_to_Gl(this.ng,this.branch,-1);\n\t    ckt.add_to_Gl(this.branch,this.no,invA);\n\t    ckt.add_to_Gl(this.branch,this.ng,-invA);\n\t    ckt.add_to_Gl(this.branch,this.np,-1);\n\t    ckt.add_to_Gl(this.branch,this.nn,1);\n\t}\n\n\tOpamp.prototype.load_dc = function(ckt,soln,rhs) {\n\t    // Op-amp is linear.\n\t}\n\n\tOpamp.prototype.load_ac = function(ckt) {\n\t}\n\n\tOpamp.prototype.load_tran = function(ckt) {\n\t}\n\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Simplified MOS FET with no bulk connection and no body effect.\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n        function Fet(d,g,s,ratio,name,type) {\n\t    Device.call(this);\n\t    this.d = d;\n\t    this.g = g;\n\t    this.s = s;\n\t    this.name = name;\n\t    this.ratio = ratio;\n\t    if (type != 'n' && type != 'p')\n\t    { throw 'fet type is not n or p';\n\t    }\n\t    this.type_sign = (type == 'n') ? 1 : -1;\n\t    this.vt = 0.5;\n\t    this.kp = 20e-6;\n            this.beta = this.kp * this.ratio;\n\t    this.lambda = 0.05;\n\t}\n\tFet.prototype = new Device();\n        Fet.prototype.constructor = Fet;\n\n        Fet.prototype.load_linear = function(ckt) {\n\t    // FET's are nonlinear, just like javascript progammers\n\t}\n\n        Fet.prototype.load_dc = function(ckt,soln,rhs) {\n\t    var vds = this.type_sign * ckt.get_two_terminal(this.d, this.s, soln);\n\t    if (vds < 0) { // Drain and source have swapped roles\n\t\tvar temp = this.d;\n\t\tthis.d = this.s;\n\t\tthis.s = temp;\n\t\tvds = this.type_sign * ckt.get_two_terminal(this.d, this.s, soln);\n\t    }\n\t    var vgs = this.type_sign * ckt.get_two_terminal(this.g, this.s, soln);\n\t    var vgst = vgs - this.vt;\n\t    var gmgs,ids,gds;\n\t    if (vgst > 0.0 ) { // vgst < 0, transistor off, no subthreshold here.\n\t\tif (vgst < vds) { /* Saturation. */\n\t    \tgmgs =  this.beta * (1 + (this.lambda * vds)) * vgst;\n\t    \tids = this.type_sign * 0.5 * gmgs * vgst;\n\t    \tgds = 0.5 * this.beta * vgst * vgst * this.lambda;\n\t\t} else {  /* Linear region */\n\t    \tgmgs =  this.beta * (1 + this.lambda * vds);\n\t    \tids = this.type_sign * gmgs * vds * (vgst - 0.50 * vds);\n\t    \tgds = gmgs * (vgst - vds) + this.beta * this.lambda * vds * (vgst - 0.5 * vds);\n\t    \tgmgs *= vds;\n\t\t}\n\t\tckt.add_to_rhs(this.d,-ids,rhs);  // current flows into the drain\n\t\tckt.add_to_rhs(this.s, ids,rhs);   // and out the source\n\t\tckt.add_conductance(this.d,this.s,gds);\n\t\tckt.add_to_G(this.s,this.s, gmgs);\n\t\tckt.add_to_G(this.d,this.s,-gmgs);\n\t\tckt.add_to_G(this.d,this.g, gmgs);\n\t\tckt.add_to_G(this.s,this.g,-gmgs);\n\t    }\n\t}\n\n\tFet.prototype.load_tran = function(ckt,soln,rhs) {\n\t    this.load_dc(ckt,soln,rhs);\n\t}\n\n\tFet.prototype.load_ac = function(ckt) {\n\t}\n\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Module definition\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\tvar module = {\n\t    'Circuit': Circuit,\n\t    'parse_number': parse_number,\n\t    'parse_source': parse_source\n\t}\n\treturn module;\n    }());\n\n/////////////////////////////////////////////////////////////////////////////\n//\n//  Simple schematic capture\n//\n////////////////////////////////////////////////////////////////////////////////\n\n// Copyright (C) 2011 Massachusetts Institute of Technology\n\n// add schematics to a document with\n//\n//   <input type=\"hidden\" class=\"schematic\" name=\"unique_form_id\" value=\"JSON netlist...\" .../>\n//\n// other attributes you can add to the input tag:\n//   width -- width in pixels of diagram\n//   height -- height in pixels of diagram\n//   parts -- comma-separated list of parts for parts bin (see parts_map),\n//            parts=\"\" disables editing of diagram\n\n// JSON schematic representation:\n//  sch :=  [part, part, ...]\n//  part := [type, coords, properties, connections]\n//  type := string (see parts_map)\n//  coords := [number, ...]  // (x,y,rot) or (x1,y1,x2,y2)\n//  properties := {name: value, ...}\n//  connections := [node, ...]   // one per connection point in canoncial order\n//  node := string\n// need a netlist? just use the part's type, properites and connections\n\n// TO DO:\n// - wire labels?\n// - zoom/scroll canvas\n// - rotate multiple objects around their center of mass\n// - rubber band wires when moving components\n\n// set up each schematic entry widget\nfunction update_schematics() {\n    // set up each schematic on the page\n    var schematics = $('.schematic');\n    for (var i = 0; i < schematics.length; ++i)\n\tif (schematics[i].getAttribute(\"loaded\") != \"true\") {\n\t    try {\n\t\tnew schematic.Schematic(schematics[i]);\n\t    } catch (err) {\n\t\tvar msgdiv = document.createElement('div');\n\t\tmsgdiv.style.border = 'thick solid #FF0000';\n\t\tmsgdiv.style.margins = '20px';\n\t\tmsgdiv.style.padding = '20px';\n\t\tvar msg = document.createTextNode('Sorry, there a browser error in starting the schematic tool.  The tool is known to be compatible with the latest versions of Firefox and Chrome, which we recommend you use.');\n\t\tmsgdiv.appendChild(msg);\n\t\tschematics[i].parentNode.insertBefore(msgdiv,schematics[i]);\n\t    }\n\t    schematics[i].setAttribute(\"loaded\",\"true\");\n\t}\n}\nwindow.update_schematics = update_schematics;\n\nschematic = (function() {\n    var background_style = 'rgb(220,220,220)';\n    var element_style = 'rgb(255,255,255)';\n    var thumb_style = 'rgb(128,128,128)';\n    var normal_style = 'rgb(0,0,0)';  // default drawing color\n    var component_style = 'rgb(64,64,255)';  // color for unselected components\n    var selected_style = 'rgb(64,255,64)';  // highlight color for selected components\n    var grid_style = \"rgb(128,128,128)\";\n    var annotation_style = 'rgb(255,64,64)';  // color for diagram annotations\n    var property_size = 5;  // point size for Component property text\n    var annotation_size = 6;  // point size for diagram annotations\n\n    var parts_map = {\n\t    'g': [Ground, 'Ground connection'],\n\t    'L': [Label, 'Node label'],\n\t    'v': [VSource, 'Voltage source'],\n\t    'i': [ISource, 'Current source'],\n\t    'r': [Resistor, 'Resistor'],\n\t    'c': [Capacitor, 'Capacitor'],\n\t    'l': [Inductor, 'Inductor'],\n\t    'o': [OpAmp, 'Op Amp'],\n\t    'd': [Diode, 'Diode'],\n\t    'n': [NFet, 'NFet'],\n\t    'p': [PFet, 'PFet'],\n\t    's': [Probe, 'Voltage Probe'],\n\t    'a': [Ammeter, 'Current Probe']\n\t};\n\n\t// global clipboard\n\tif (typeof sch_clipboard == 'undefined')\n\t    sch_clipboard = [];\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Schematic = diagram + parts bin + status area\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// setup a schematic by populating the <div> with the appropriate children\n\tfunction Schematic(input) {\n\t    // set up diagram viewing parameters\n\t    this.show_grid = true;\n\t    this.grid = 8;\n\t    this.scale = 2;\n\t    this.origin_x = input.getAttribute(\"origin_x\");\n\t    if (this.origin_x == undefined) this.origin_x = 0;\n\t    this.origin_y = input.getAttribute(\"origin_y\");\n\t    if (this.origin_y == undefined) this.origin_y = 0;\n\t    this.cursor_x = 0;\n\t    this.cursor_y = 0;\n\t    this.window_list = [];  // list of pop-up windows in increasing z order\n\n\t    // use user-supplied list of parts if supplied\n\t    // else just populate parts bin with all the parts\n\t    this.edits_allowed = true;\n\t    var parts = input.getAttribute('parts');\n\t    if (parts == undefined || parts == 'None') {\n            parts = [];\n\t\tfor (var p in parts_map) parts.push(p);\n\t    } else if (parts == '') {\n\t\tthis.edits_allowed = false;\n\t\tparts = [];\n\t    } else parts = parts.split(',');\n\n\t    // now add the parts to the parts bin\n\t    this.parts_bin = [];\n\t    for (var i = 0; i < parts.length; i++) {\n\t\tvar part = new Part(this);\n\t\tvar pm = parts_map[parts[i]];\n\t\tpart.set_component(new pm[0](0,0,0),pm[1]);\n\t\tthis.parts_bin.push(part);\n\t    }\n\n\t    // use user-supplied list of analyses, otherwise provide them all\n\t    // analyses=\"\" means no analyses\n\t    var analyses = input.getAttribute('analyses');\n\t    if (analyses == undefined || analyses == 'None')\n\t\tanalyses = ['dc','ac','tran'];\n\t    else if (analyses == '') analyses = [];\n\t    else analyses = analyses.split(',');\n\n\t    if (parts.length == 0 && analyses.length == 0) this.diagram_only = true;\n\t    else this.diagram_only = false;\n\n\t    // see what we need to submit.  Expecting attribute of the form\n\t    // submit_analyses=\"{'tran':[[node_name,t1,t2,t3],...],\n\t    //                   'ac':[[node_name,f1,f2,...],...]}\"\n\t    var submit = input.getAttribute('submit_analyses');\n\t    if (submit && submit.indexOf('{') != -1)\n\t\tthis.submit_analyses = JSON.parse(submit);\n\t    else\n\t\tthis.submit_analyses = undefined;\n\n\t    // toolbar\n        this.tools = [];\n\t    this.toolbar = [];\n\n        /* DISABLE HELP BUTTON (target URL not consistent with multicourse hierarchy) -- SJSU\n\t    if (!this.diagram_only) {\n\t\tthis.tools['help'] = this.add_tool(help_icon,'Help: display help page',this.help);\n\t\tthis.enable_tool('help',true);\n\t\tthis.toolbar.push(null);  // spacer\n\t    }\n        END DISABLE HELP BUTTON -- SJSU */\n\n\t    if (this.edits_allowed) {\n\t\tthis.tools['grid'] = this.add_tool(grid_icon,'Grid: toggle grid display',this.toggle_grid);\n\t\tthis.enable_tool('grid',true);\n\t\tthis.tools['cut'] = this.add_tool(cut_icon,'Cut: move selected components from diagram to the clipboard',this.cut);\n\t\tthis.tools['copy'] = this.add_tool(copy_icon,'Copy: copy selected components into the clipboard',this.copy);\n\t\tthis.tools['paste'] = this.add_tool(paste_icon,'Paste: copy clipboard into the diagram',this.paste);\n\t\tthis.toolbar.push(null);  // spacer\n\t    }\n\n\t    // simulation interface if cktsim.js is loaded\n\t    if (typeof cktsim != 'undefined') {\n\t\tif (analyses.indexOf('dc') != -1) {\n\t\t    this.tools['dc'] = this.add_tool('DC','DC Analysis',this.dc_analysis);\n\t\t    this.enable_tool('dc',true);\n\t\t    this.dc_max_iters = '1000';  // default values dc solution\n\t\t}\n\n\t\tif (analyses.indexOf('ac') != -1) {\n\t\t    this.tools['ac'] = this.add_tool('AC','AC Small-Signal Analysis',this.setup_ac_analysis);\n\t\t    this.enable_tool('ac',true);\n\t\t    this.ac_npts = '50'; // default values for AC Analysis\n\t\t    this.ac_fstart = '10';\n\t\t    this.ac_fstop = '1G';\n\t\t    this.ac_source_name = undefined;\n\t\t}\n\n\t\tif (analyses.indexOf('tran') != -1) {\n\t\t    this.tools['tran'] = this.add_tool('TRAN','Transient Analysis',this.transient_analysis);\n\t\t    this.enable_tool('tran',true);\n\t\t    this.tran_npts = '100';  // default values for transient analysis\n\t\t    this.tran_tstop = '1';\n\t\t}\n\t    }\n\n\t    // set up diagram canvas\n\t    this.canvas = document.createElement('canvas');\n\t    this.width = input.getAttribute('width');\n\t    this.width = parseInt(this.width == undefined ? '400' : this.width);\n\t    this.canvas.width = this.width;\n\t    this.height = input.getAttribute('height');\n\t    this.height = parseInt(this.height == undefined ? '300' : this.height);\n\t    this.canvas.height = this.height;\n\n\t    this.sctl_r = 16;   // scrolling control parameters\n\t    this.sctl_x = this.sctl_r + 8;   // upper left\n\t    this.sctl_y = this.sctl_r + 8;\n\t    this.zctl_left = this.sctl_x - 8;\n\t    this.zctl_top = this.sctl_y + this.sctl_r + 8;\n\n\t    // repaint simply draws this buffer and then adds selected elements on top\n\t    this.bg_image = document.createElement('canvas');\n\t    this.bg_image.width = this.width;\n\t    this.bg_image.height = this.height;\n\n\t    if (!this.diagram_only) {\n        this.canvas.tabIndex = 0; // so we get keystrokes\n\t\tthis.canvas.style.borderStyle = 'solid';\n\t\tthis.canvas.style.borderWidth = '1px';\n\t\tthis.canvas.style.borderColor = grid_style;\n\t\tthis.canvas.style.outline = 'none';\n\t    }\n\n\t    this.canvas.schematic = this;\n\t    if (this.edits_allowed) {\n\t\tthis.canvas.addEventListener('mousemove',schematic_mouse_move,false);\n\t\tthis.canvas.addEventListener('mouseover',schematic_mouse_enter,false);\n\t\tthis.canvas.addEventListener('mouseout',schematic_mouse_leave,false);\n\t\tthis.canvas.addEventListener('mousedown',schematic_mouse_down,false);\n\t\tthis.canvas.addEventListener('mouseup',schematic_mouse_up,false);\n\t\tthis.canvas.addEventListener('mousewheel',schematic_mouse_wheel,false);\n\t\tthis.canvas.addEventListener('DOMMouseScroll',schematic_mouse_wheel,false);  // for FF\n\t\tthis.canvas.addEventListener('dblclick',schematic_double_click,false);\n\t\tthis.canvas.addEventListener('keydown',schematic_key_down,false);\n\t\tthis.canvas.addEventListener('keyup',schematic_key_up,false);\n\t    }\n\n\t    // set up message area\n\t    if (!this.diagram_only) {\n\t\tthis.status_div = document.createElement('div');\n\t\tthis.status = document.createTextNode('');\n\t\tthis.status_div.appendChild(this.status);\n\t\tthis.status_div.style.height = status_height + 'px';\n\t    } else this.status_div = undefined;\n\n        this.connection_points = []; // location string => list of cp's\n\t    this.components = [];\n\t    this.dragging = false;\n\t    this.select_rect = undefined;\n\t    this.wire = undefined;\n\t    this.operating_point = undefined;  // result from DC analysis\n\t    this.dc_results = undefined;   // saved analysis results for submission\n\t    this.ac_results = undefined;   // saved analysis results for submission\n\t    this.transient_results = undefined;   // saved analysis results for submission\n\n\t    // state of modifier keys\n\t    this.ctrlKey = false;\n\t    this.shiftKey = false;\n\t    this.altKey = false;\n\t    this.cmdKey = false;\n\n\t    // make sure other code can find us!\n\t    input.schematic = this;\n\t    this.input = input;\n\n\t    // set up DOM -- use nested tables to do the layout\n\t    var table,tr,td;\n\t    table = document.createElement('table');\n\t    table.rules = 'none';\n\t    if (!this.diagram_only) {\n\t\ttable.frame = 'box';\n\t\ttable.style.borderStyle = 'solid';\n\t\ttable.style.borderWidth = '2px';\n\t\ttable.style.borderColor = normal_style;\n\t\ttable.style.backgroundColor = background_style;\n\t    }\n\n\t    // add tools to DOM\n\t    if (this.toolbar.length > 0) {\n\t\ttr = document.createElement('tr');\n\t\ttable.appendChild(tr);\n\t\ttd = document.createElement('td');\n\t\ttd.style.verticalAlign = 'top';\n\t\ttd.colSpan = 2;\n\t\ttr.appendChild(td);\n\t\tfor (var i = 0; i < this.toolbar.length; ++i) {\n\t\t    var tool = this.toolbar[i];\n\t\t    if (tool != null) td.appendChild(tool);\n\t\t}\n\t    }\n\n\t    // add canvas and parts bin to DOM\n\t    tr = document.createElement('tr');\n\t    table.appendChild(tr);\n\n\t    td = document.createElement('td');\n\t    tr.appendChild(td);\n\t    var wrapper = document.createElement('div'); // for inserting pop-up windows\n\t    td.appendChild(wrapper);\n\t    wrapper.style.position = 'relative';  // so we can position subwindows\n\t    wrapper.appendChild(this.canvas);\n\n\t    td = document.createElement('td');\n\t    td.style.verticalAlign = 'top';\n\t    tr.appendChild(td);\n\t    var parts_table = document.createElement('table');\n\t    td.appendChild(parts_table);\n\t    parts_table.rules = 'none';\n\t    parts_table.frame = 'void';\n\t    parts_table.cellPadding = '0';\n\t    parts_table.cellSpacing = '0';\n\n\t    // fill in parts_table\n\t    var parts_per_column = Math.floor(this.height / (part_h + 5));  // mysterious extra padding\n\t    for (var i = 0; i < parts_per_column; ++i) {\n\t\ttr = document.createElement('tr');\n\t\tparts_table.appendChild(tr);\n\t\tfor (var j = i; j < this.parts_bin.length; j += parts_per_column) {\n\t\t    td = document.createElement('td');\n\t\t    tr.appendChild(td);\n\t\t    td.appendChild(this.parts_bin[j].canvas);\n\t\t}\n\t    }\n\n\t    if (this.status_div != undefined) {\n\t\ttr = document.createElement('tr');\n\t\ttable.appendChild(tr);\n\t\ttd = document.createElement('td');\n\t\ttr.appendChild(td);\n\t\ttd.colSpan = 2;\n\t\ttd.appendChild(this.status_div);\n\t    }\n\n\t    // add to dom\n\t    // avoid Chrome bug that changes to text cursor whenever\n\t    // drag starts.  Just do this in schematic tool...\n\t    var toplevel = document.createElement('div');\n\t    toplevel.onselectstart = function(){ return false; };\n\t    toplevel.appendChild(table);\n\t    this.input.parentNode.insertBefore(toplevel,this.input.nextSibling);\n\n\t    // process initial contents of diagram\n\t    this.load_schematic(this.input.getAttribute('value'),\n\t\t\t\tthis.input.getAttribute('initial_value'));\n\n\t    // start by centering diagram on the screen\n\t    this.zoomall();\n\t}\n\n\tvar part_w = 42;   // size of a parts bin compartment\n\tvar part_h = 42;\n\tvar status_height = 18;\n\n\tSchematic.prototype.add_component = function(new_c) {\n\t    this.components.push(new_c);\n\t    // create undoable edit record here\n\t}\n\n\tSchematic.prototype.remove_component = function(c) {\n\t    var index = this.components.indexOf(c);\n\t    if (index != -1) this.components.splice(index,1);\n\t}\n\n\tSchematic.prototype.find_connections = function(cp) {\n\t    return this.connection_points[cp.location];\n\t}\n\n\tSchematic.prototype.add_connection_point = function(cp) {\n\t    var cplist = this.connection_points[cp.location];\n\t    if (cplist) cplist.push(cp);\n\t    else {\n\t\tcplist = [cp];\n\t\tthis.connection_points[cp.location] = cplist;\n\t    }\n\n\t    return cplist;\n\t}\n\n\tSchematic.prototype.remove_connection_point = function(cp,old_location) {\n\t    // remove cp from list at old location\n\t    var cplist = this.connection_points[old_location];\n\t    if (cplist) {\n\t\tvar index = cplist.indexOf(cp);\n\t\tif (index != -1) {\n\t\t    cplist.splice(index,1);\n\t\t    // if no more connections at this location, remove\n\t\t    // entry from array to keep our search time short\n\t\t    if (cplist.length == 0)\n\t\t\tdelete this.connection_points[old_location];\n\t\t}\n\t    }\n\t}\n\n\tSchematic.prototype.update_connection_point = function(cp,old_location) {\n\t    this.remove_connection_point(cp,old_location);\n\t    return this.add_connection_point(cp);\n\t}\n\n\tSchematic.prototype.add_wire = function(x1,y1,x2,y2) {\n\t    var new_wire = new Wire(x1,y1,x2,y2);\n\t    new_wire.add(this);\n\t    new_wire.move_end();\n\t    return new_wire;\n\t}\n\n\tSchematic.prototype.split_wire = function(w,cp) {\n\t    // remove bisected wire\n\t    w.remove();\n\n\t    // add two new wires with connection point cp in the middle\n\t    this.add_wire(w.x,w.y,cp.x,cp.y);\n\t    this.add_wire(w.x+w.dx,w.y+w.dy,cp.x,cp.y);\n\t}\n\n\t// see if connection points of component c split any wires\n\tSchematic.prototype.check_wires = function(c) {\n\t    for (var i = 0; i < this.components.length; i++) {\n\t\tvar cc = this.components[i];\n\t\tif (cc != c) {  // don't check a component against itself\n\t\t    // only wires will return non-null from a bisect call\n\t\t    var cp = cc.bisect(c);\n\t\t    if (cp) {\n\t\t\t// cc is a wire bisected by connection point cp\n\t\t\tthis.split_wire(cc,cp);\n\t\t\tthis.redraw_background();\n\t\t    }\n\t\t}\n\t    }\n\t}\n\n\t// see if there are any existing connection points that bisect wire w\n\tSchematic.prototype.check_connection_points = function(w) {\n\t    for (var locn in this.connection_points) {\n\t\tvar cplist = this.connection_points[locn];\n\t\tif (cplist && w.bisect_cp(cplist[0])) {\n\t\t    this.split_wire(w,cplist[0]);\n\t\t    this.redraw_background();\n\n\t\t    // stop here, new wires introduced by split will do their own checks\n\t\t    return;\n\t\t}\n\t    }\n\t}\n\n\t// merge collinear wires sharing an end point\n\tSchematic.prototype.clean_up_wires = function() {\n\t    for (var locn in this.connection_points) {\n\t\tvar cplist = this.connection_points[locn];\n\t\tif (cplist && cplist.length == 2) {\n\t\t    // found a connection with just two connections, see if they're wires\n\t\t    var c1 = cplist[0].parent;\n\t\t    var c2 = cplist[1].parent;\n\t\t    if (c1.type == 'w' && c2.type == 'w') {\n\t\t\tvar e1 = c1.other_end(cplist[0]);\n\t\t\tvar e2 = c2.other_end(cplist[1]);\n\t\t\tvar e3 = cplist[0];  // point shared by the two wires\n\t\t\tif (collinear(e1,e2,e3)) {\n\t\t\t    c1.remove();\n\t\t\t    c2.remove();\n\t\t\t    this.add_wire(e1.x,e1.y,e2.x,e2.y);\n\t\t\t}\n\t\t    }\n\t\t}\n\t    }\n\t}\n\n\tSchematic.prototype.unselect_all = function(which) {\n\t    this.operating_point = undefined;  // remove annotations\n\t    for (var i = this.components.length - 1; i >= 0; --i)\n\t\tif (i != which) this.components[i].set_select(false);\n\t}\n\n\tSchematic.prototype.drag_begin = function() {\n\t    // let components know they're about to move\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar component = this.components[i];\n\t\tif (component.selected) component.move_begin();\n\t    }\n\n\t    // remember where drag started\n\t    this.drag_x = this.cursor_x;\n\t    this.drag_y = this.cursor_y;\n\t    this.dragging = true;\n\t}\n\n\tSchematic.prototype.drag_end = function() {\n\t    // let components know they're done moving\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar component = this.components[i];\n\t\tif (component.selected) component.move_end();\n\t    }\n\t    this.dragging = false;\n\t    this.clean_up_wires();\n\t    this.redraw_background();\n\t}\n\n\tSchematic.prototype.help = function() {\n\t    window.open('/static/handouts/schematic_tutorial.pdf');\n\t}\n\n\t// zoom diagram around given coords\n\tSchematic.prototype.rescale = function(nscale,cx,cy) {\n\t    if (cx == undefined) {\n\t\t// use current center point if no point has been specified\n\t\tcx = this.origin_x + this.width/(2*this.scale);\n\t\tcy = this.origin_y + this.height/(2*this.scale);\n\t    }\n\n\t    this.origin_x += cx*(this.scale - nscale);\n\t    this.origin_y += cy*(this.scale - nscale);\n\t    this.scale = nscale;\n\t    this.redraw_background();\n\t}\n\n\tSchematic.prototype.toggle_grid = function() {\n\t    this.show_grid = !this.show_grid;\n\t    this.redraw_background();\n\t}\n\n\tvar zoom_factor = 1.25;    // scaling is some power of zoom_factor\n\tvar zoom_min = 0.5;\n\tvar zoom_max = 4.0;\n\tvar origin_min = -200;    // in grids\n\tvar origin_max = 200;\n\n\tSchematic.prototype.zoomin = function() {\n\t    var nscale = this.scale * zoom_factor;\n\t    if (nscale < zoom_max) {\n\t\t// keep center of view unchanged\n\t\tthis.origin_x += (this.width/2)*(1.0/this.scale - 1.0/nscale);\n\t\tthis.origin_y += (this.height/2)*(1.0/this.scale - 1.0/nscale);\n\t\tthis.scale = nscale;\n\t\tthis.redraw_background();\n\t    }\n\t}\n\n\tSchematic.prototype.zoomout = function() {\n\t    var nscale = this.scale / zoom_factor;\n\t    if (nscale > zoom_min) {\n\t\t// keep center of view unchanged\n\t\tthis.origin_x += (this.width/2)*(1.0/this.scale - 1.0/nscale);\n\t\tthis.origin_y += (this.height/2)*(1.0/this.scale - 1.0/nscale);\n\t\tthis.scale = nscale;\n\t\tthis.redraw_background();\n\t    }\n\t}\n\n\tSchematic.prototype.zoomall = function() {\n\t    // w,h for schematic including a 25% margin on all sides\n\t    var sch_w = 1.5*(this.bbox[2] - this.bbox[0]);\n\t    var sch_h = 1.5*(this.bbox[3] - this.bbox[1]);\n\n\t    if (sch_w == 0 && sch_h == 0) {\n\t\tthis.origin_x = 0;\n\t\tthis.origin_y = 0;\n\t\tthis.scale = 2;\n\t    } else {\n\t\t// compute scales that would make schematic fit, choose smallest\n\t\tvar scale_x = this.width/sch_w;\n\t\tvar scale_y = this.height/sch_h;\n\t\tthis.scale = Math.pow(zoom_factor,Math.ceil(Math.log(Math.min(scale_x,scale_y))/Math.log(zoom_factor)));\n\t\tif (this.scale < zoom_min) this.scale = zoom_min;\n\t\telse if (this.scale > zoom_max) this.scale = zoom_max;\n\n\t\t// center the schematic\n\t\tthis.origin_x = (this.bbox[2] + this.bbox[0])/2 - this.width/(2*this.scale);\n\t\tthis.origin_y = (this.bbox[3] + this.bbox[1])/2 - this.height/(2*this.scale);\n\t    }\n\n\t    this.redraw_background();\n\t}\n\n\tSchematic.prototype.cut = function() {\n\t    // clear previous contents\n\t    sch_clipboard = [];\n\n\t    // look for selected components, move them to clipboard.\n\t    for (var i = this.components.length - 1; i >=0; --i) {\n\t\tvar c = this.components[i];\n\t\tif (c.selected) {\n\t\t    c.remove();\n\t\t    sch_clipboard.push(c);\n\t\t}\n\t    }\n\n\t    // update diagram view\n\t    this.redraw();\n\t}\n\n\tSchematic.prototype.copy = function() {\n\t    // clear previous contents\n\t    sch_clipboard = [];\n\n\t    // look for selected components, copy them to clipboard.\n\t    for (var i = this.components.length - 1; i >=0; --i) {\n\t\tvar c = this.components[i];\n\t\tif (c.selected)\n\t\t    sch_clipboard.push(c.clone(c.x,c.y));\n\t    }\n\t}\n\n\tSchematic.prototype.paste = function() {\n\t    // compute left,top of bounding box for origins of\n\t    // components in the clipboard\n\t    var left = undefined;\n\t    var top = undefined;\n\t    for (var i = sch_clipboard.length - 1; i >= 0; --i) {\n\t\tvar c = sch_clipboard[i];\n\t\tleft = left ? Math.min(left,c.x) : c.x;\n\t\ttop = top ? Math.min(top,c.y) : c.y;\n\t    }\n\n\t    this.message('cursor '+this.cursor_x+','+this.cursor_y);\n\n\t    // clear current selections\n\t    this.unselect_all(-1);\n\t    this.redraw_background();  // so we see any components that got unselected\n\n\t    // make clones of components on the clipboard, positioning\n\t    // them relative to the cursor\n\t    for (var i = sch_clipboard.length - 1; i >= 0; --i) {\n\t\tvar c = sch_clipboard[i];\n\t\tvar new_c = c.clone(this.cursor_x + (c.x - left),this.cursor_y + (c.y - top));\n\t\tnew_c.set_select(true);\n\t\tnew_c.add(this);\n\t    }\n\n\t    this.redraw();\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Netlist and Simulation interface\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// load diagram from JSON representation\n\tSchematic.prototype.load_schematic = function(value,initial_value) {\n\t    // use default value if no schematic info in value\n\t    if (value == undefined || value.indexOf('[') == -1)\n\t\tvalue = initial_value;\n\t    if (value && value.indexOf('[') != -1) {\n\t\t// convert string value into data structure\n\t\tvar json = JSON.parse(value);\n\n\t\t// top level is a list of components\n\t\tfor (var i = json.length - 1; i >= 0; --i) {\n\t\t    var c = json[i];\n\t\t    if (c[0] == 'view') {\n\t\t\tthis.ac_fstart = c[5];\n\t\t\tthis.ac_fstop = c[6];\n\t\t\tthis.ac_source_name = c[7];\n\t\t\tthis.tran_npts = c[8];\n\t\t\tthis.tran_tstop = c[9];\n\t\t\tthis.dc_max_iters = c[10];\n\t\t    } else if (c[0] == 'w') {\n\t\t\t// wire\n\t\t\tthis.add_wire(c[1][0],c[1][1],c[1][2],c[1][3]);\n\t\t    } else if (c[0] == 'dc') {\n\t\t\tthis.dc_results = c[1];\n\t\t    } else if (c[0] == 'transient') {\n\t\t\tthis.transient_results = c[1];\n\t\t    } else if (c[0] == 'ac') {\n\t\t\tthis.ac_results = c[1];\n\t\t    } else {\n\t\t\t// ordinary component\n\t\t\t//  c := [type, coords, properties, connections]\n\t\t\tvar type = c[0];\n\t\t\tvar coords = c[1];\n\t\t\tvar properties = c[2];\n\n\t\t\tvar part = new parts_map[type][0](coords[0],coords[1],coords[2]);\n\t\t\tfor (var name in properties)\n\t\t\t    part.properties[name] = properties[name];\n\n\t\t\tpart.add(this);\n\t\t    }\n\t\t}\n\t    }\n\n\t    this.redraw_background();\n\t}\n\n\t// label all the nodes in the circuit\n\tSchematic.prototype.label_connection_points = function() {\n\t    // start by clearing all the connection point labels\n\t    for (var i = this.components.length - 1; i >=0; --i)\n\t\tthis.components[i].clear_labels();\n\n\t    // components are in charge of labeling their unlabeled connections.\n\t    // labels given to connection points will propagate to coincident connection\n\t    // points and across Wires.\n\n\t    // let special components like GND label their connection(s)\n\t    for (var i = this.components.length - 1; i >=0; --i)\n\t\tthis.components[i].add_default_labels();\n\n\t    // now have components generate labels for unlabeled connections\n\t    this.next_label = 0;\n\t    for (var i = this.components.length - 1; i >=0; --i)\n\t\tthis.components[i].label_connections();\n\t}\n\n\tSchematic.prototype.get_next_label = function() {\n\t    // generate next label in sequence\n\t    this.next_label += 1;\n\t    return this.next_label.toString();\n\t}\n\n\t// propagate label to coincident connection points\n\tSchematic.prototype.propagate_label = function(label,location) {\n\t    var cplist = this.connection_points[location];\n\t    for (var i = cplist.length - 1; i >= 0; --i)\n\t\tcplist[i].propagate_label(label);\n\t}\n\n\t// update the value field of our corresponding input field with JSON\n\t// representation of schematic\n\tSchematic.prototype.update_value = function() {\n\t    // label connection points\n\t    this.label_connection_points();\n\n\t    // build JSON data structure, convert to string value for\n\t    // input field\n\t    this.input.value = JSON.stringify(this.json_with_analyses());\n\t}\n\n\tSchematic.prototype.json = function() {\n\t    var json = [];\n\n\t    // output all the components/wires in the diagram\n\t    var n = this.components.length;\n\t    for (var i = 0; i < n; i++)\n\t\tjson.push(this.components[i].json(i));\n\n\t    // capture the current view parameters\n\t    json.push(['view',this.origin_x,this.origin_y,this.scale,\n\t\t       this.ac_npts,this.ac_fstart,this.ac_fstop,\n\t\t       this.ac_source_name,this.tran_npts,this.tran_tstop,\n\t\t       this.dc_max_iters]);\n\n\t    return json;\n\t}\n\n\tSchematic.prototype.json_with_analyses = function() {\n\t    var json = this.json();\n\n\t    if (this.dc_results != undefined) json.push(['dc',this.dc_results]);\n\t    if (this.ac_results != undefined) json.push(['ac',this.ac_results]);\n\t    if (this.transient_results != undefined) json.push(['transient',this.transient_results]);\n\n\t    return json;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Simulation interface\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tSchematic.prototype.extract_circuit = function() {\n\t    // give all the circuit nodes a name, extract netlist\n\t    this.label_connection_points();\n\t    var netlist = this.json();\n\n\t    // since we've done the heavy lifting, update input field value\n\t    // so user can grab diagram if they want\n\t    this.input.value = JSON.stringify(netlist);\n\n\t    // create a circuit from the netlist\n\t    var ckt = new cktsim.Circuit();\n\t    if (ckt.load_netlist(netlist))\n\t\treturn ckt;\n\t    else\n\t\treturn null;\n\t}\n\n\tSchematic.prototype.dc_analysis = function() {\n\t    // remove any previous annotations\n\t    this.unselect_all(-1);\n\t    this.redraw_background();\n\n\t    var ckt = this.extract_circuit();\n\t    if (ckt === null) return;\n\n\t    // run the analysis\n\t    this.operating_point = ckt.dc();\n\n\t    if (this.operating_point != undefined) {\n\t\t// save a copy of the results for submission\n\t\tthis.dc_results = {};\n\t\tfor (var i in this.operating_point) this.dc_results[i] = this.operating_point[i];\n\n\t\t// display results on diagram\n\t\tthis.redraw();\n\t    }\n\t}\n\n\t// return a list of [color,node_label,offset,type] for each probe in the diagram\n\t// type == 'voltage' or 'current'\n\tSchematic.prototype.find_probes = function() {\n\t    var result = [];\n\t    var result = [];\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar c = this.components[i];\n\t\tvar info = c.probe_info();\n\t\tif (info != undefined) result.push(c.probe_info());\n\t    }\n\t    return result;\n\t}\n\n\t// use a dialog to get AC analysis parameters\n\tSchematic.prototype.setup_ac_analysis = function() {\n\t    this.unselect_all(-1);\n\t    this.redraw_background();\n\n\t    var npts_lbl = 'Number of points/decade';\n\t    var fstart_lbl = 'Starting frequency (Hz)';\n\t    var fstop_lbl = 'Ending frequency (Hz)';\n\t    var source_name_lbl = 'Name of V or I source for ac'\n\n\t    if (this.find_probes().length == 0) {\n\t\talert(\"AC Analysis: there are no voltage probes in the diagram!\");\n\t\treturn;\n\t    }\n\n        var fields = [];\n\t    fields[fstart_lbl] = build_input('text',10,this.ac_fstart);\n\t    fields[fstop_lbl] = build_input('text',10,this.ac_fstop);\n\t    fields[source_name_lbl] = build_input('text',10,this.ac_source_name);\n\n\t    var content = build_table(fields);\n\t    content.fields = fields;\n\t    content.sch = this;\n\n\t    this.dialog('AC Analysis',content,function(content) {\n\t\t    var sch = content.sch;\n\n\t\t    // retrieve parameters, remember for next time\n\t\t    sch.ac_fstart = content.fields[fstart_lbl].value;\n\t\t    sch.ac_fstop = content.fields[fstop_lbl].value;\n\t\t    sch.ac_source_name = content.fields[source_name_lbl].value;\n\n\t\t    sch.ac_analysis(cktsim.parse_number(sch.ac_npts),\n\t\t\t\t    cktsim.parse_number(sch.ac_fstart),\n\t\t\t\t    cktsim.parse_number(sch.ac_fstop),\n\t\t\t\t    sch.ac_source_name);\n\t\t});\n\t}\n\n\tSchematic.prototype.ac_analysis = function(npts,fstart,fstop,ac_source_name) {\n\t    var ckt = this.extract_circuit();\n\t    if (ckt === null) return;\n\t    var results = ckt.ac(npts,fstart,fstop,ac_source_name);\n\n\t    if (typeof results == 'string')\n\t\tthis.message(results);\n\t    else {\n\t\tvar x_values = results['_frequencies_'];\n\n\t\t// x axis will be a log scale\n\t\tfor (var i = x_values.length - 1; i >= 0; --i)\n\t\t    x_values[i] = Math.log(x_values[i])/Math.LN10;\n\n\t\tif (this.submit_analyses != undefined) {\n\t\t    var submit = this.submit_analyses['ac'];\n\t\t    if (submit != undefined) {\n\t\t\t// save a copy of the results for submission\n\t\t\tthis.ac_results = {};\n\n\t\t\t// save requested values for each requested node\n\t\t\tfor (var j = 0; j < submit.length; j++) {\n\t\t\t    var flist = submit[j];    // [node_name,f1,f2,...]\n\t\t\t    var node = flist[0];\n\t\t\t    var values = results[node];\n\t\t\t    var fvlist = [];\n\t\t\t    // for each requested freq, interpolate response value\n\t\t\t    for (var k = 1; k < flist.length; k++) {\n\t\t\t\tvar f = flist[k];\n\t\t\t\tvar v = interpolate(f,x_values,values);\n\t\t\t\t// convert to dB\n\t\t\t\tfvlist.push([f,v == undefined ? 'undefined' : 20.0 * Math.log(v)/Math.LN10]);\n\t\t\t    }\n\t\t\t    // save results as list of [f,response] paris\n\t\t\t    this.ac_results[node] = fvlist;\n\t\t\t}\n\t\t    }\n\t\t}\n\n\t\t// set up plot values for each node with a probe\n\t\tvar y_values = [];  // list of [color, result_array]\n\t\tvar z_values = [];  // list of [color, result_array]\n\t\tvar probes = this.find_probes();\n\t\tvar probe_maxv = [];\n\t\tvar probe_color = [];\n\n\t\t// Check for probe with near zero transfer function and warn\n\t\tfor (var i = probes.length - 1; i >= 0; --i) {\n\t\t    if (probes[i][3] != 'voltage') continue;\n\t\t    probe_color[i] = probes[i][0];\n\t\t    var label = probes[i][1];\n\t\t    var v = results[label];\n\t\t    probe_maxv[i] = array_max(v); // magnitudes always > 0\n\t\t}\n\n        var all_max = array_max(probe_maxv);\n\t\tif (all_max < 1.0e-16) {\n\t\t    alert('Zero ac response, -infinity on DB scale.');\n\t\t} else {\n\t\t    for (var i = probes.length - 1; i >= 0; --i) {\n\t\t\tif (probes[i][3] != 'voltage') continue;\n\t\t\tif ((probe_maxv[i] / all_max) < 1.0e-10) {\n\t\t\t    alert('Near zero ac response, remove ' + probe_color[i] + ' probe');\n\t\t\t    return;\n\t\t\t}\n\t\t    }\n\t\t}\n\n\t\tfor (var i = probes.length - 1; i >= 0; --i) {\n\t\t    if (probes[i][3] != 'voltage') continue;\n\t\t    var color = probes[i][0];\n\t\t    var label = probes[i][1];\n\t\t    var offset = cktsim.parse_number(probes[i][2]);\n\t\t    var v = results[label];\n\t\t    // convert values into dB relative to source amplitude\n\t\t    var v_max = 1;\n\t\t    for (var j = v.length - 1; j >= 0; --j)\n\t\t\t// convert each value to dB relative to max\n\t\t\tv[j] = 20.0 * Math.log(v[j]/v_max)/Math.LN10;\n\t\t    y_values.push([color,offset,v]);\n\n\t\t    var v = results[label+'_phase'];\n\t\t    z_values.push([color,0,v]);\n\t\t}\n\n\t\t// graph the result and display in a window\n\t\tvar graph2 = this.graph(x_values,'log(Frequency in Hz)',z_values,'degrees');\n\t\tthis.window('AC Analysis - Phase',graph2);\n\t\tvar graph1 = this.graph(x_values,'log(Frequency in Hz)',y_values,'dB');\n\t\tthis.window('AC Analysis - Magnitude',graph1,50);\n\t    }\n\t}\n\n\tSchematic.prototype.transient_analysis = function() {\n\t    this.unselect_all(-1);\n\t    this.redraw_background();\n\n\t    var npts_lbl = 'Minimum number of timepoints';\n\t    var tstop_lbl = 'Stop Time (seconds)';\n\t    var probes = this.find_probes();\n\t    if (probes.length == 0) {\n\t\talert(\"Transient Analysis: there are no probes in the diagram!\");\n\t\treturn;\n\t    }\n\n        var fields = [];\n\t    fields[tstop_lbl] = build_input('text',10,this.tran_tstop);\n\n\t    var content = build_table(fields);\n\t    content.fields = fields;\n\t    content.sch = this;\n\n\t    this.dialog('Transient Analysis',content,function(content) {\n\t\t    var sch = content.sch;\n\t\t    var ckt = sch.extract_circuit();\n\t\t    if (ckt === null) return;\n\n\t\t    // retrieve parameters, remember for next time\n\t\t    sch.tran_tstop = content.fields[tstop_lbl].value;\n\n\t\t    // gather a list of nodes that are being probed.  These\n\t\t    // will be added to the list of nodes checked during the\n\t\t    // LTE calculations in transient analysis\n\t\t    var probe_list = sch.find_probes();\n\t\t    var probe_names = new Array(probe_list.length);\n\t\t    for (var i = probe_list.length - 1; i >= 0; --i)\n\t\t\tprobe_names[i] = probe_list[i][1];\n\n\t\t    // run the analysis\n\t\t    var results = ckt.tran(ckt.parse_number(sch.tran_npts), 0,\n\t\t\t\t\t   ckt.parse_number(sch.tran_tstop), probe_names, false);\n\n\t\t    if (typeof results == 'string')\n\t\t\tsch.message(results);\n\t\t    else {\n\t\t\tif (sch.submit_analyses != undefined) {\n\t\t\t    var submit = sch.submit_analyses['tran'];\n\t\t\t    if (submit != undefined) {\n\t\t\t\t// save a copy of the results for submission\n\t\t\t\tsch.transient_results = {};\n\t\t\t\tvar times = results['_time_'];\n\n\t\t\t\t// save requested values for each requested node\n\t\t\t\tfor (var j = 0; j < submit.length; j++) {\n\t\t\t\t    var tlist = submit[j];    // [node_name,t1,t2,...]\n\t\t\t\t    var node = tlist[0];\n\t\t\t\t    var values = results[node];\n\t\t\t\t    var tvlist = [];\n\t\t\t\t    // for each requested time, interpolate waveform value\n\t\t\t\t    for (var k = 1; k < tlist.length; k++) {\n\t\t\t\t\tvar t = tlist[k];\n\t\t\t\t\tvar v = interpolate(t,times,values);\n\t\t\t\t\ttvlist.push([t,v == undefined ? 'undefined' : v]);\n\t\t\t\t    }\n\t\t\t\t    // save results as list of [t,value] pairs\n\t\t\t\t    sch.transient_results[node] = tvlist;\n\t\t\t\t}\n\t\t\t    }\n\t\t\t}\n\n\t\t\tvar x_values = results['_time_'];\n\t\t\tvar x_legend = 'Time';\n\n\t\t\t// set up plot values for each node with a probe\n\t\t\tvar v_values = [];  // voltage values: list of [color, result_array]\n\t\t\tvar i_values = [];  // current values: list of [color, result_array]\n\t\t\tvar probes = sch.find_probes();\n\n\t\t\tfor (var i = probes.length - 1; i >= 0; --i) {\n\t\t\t    var color = probes[i][0];\n\t\t\t    var label = probes[i][1];\n\t\t\t    var offset = cktsim.parse_number(probes[i][2]);\n\t\t\t    var v = results[label];\n\t\t\t    if (v == undefined) {\n\t\t\t\talert('The ' + color + ' probe is connected to node ' + '\"' + label + '\"' + ' which is not an actual circuit node');\n\t\t\t    } else if (probes[i][3] == 'voltage') {\n\t\t\t\tif (color == 'x-axis') {\n\t\t\t\t    x_values = v;\n\t\t\t\t    x_legend = 'Voltage';\n\t\t\t\t} else v_values.push([color,offset,v]);\n\t\t\t    } else {\n\t\t\t\tif (color == 'x-axis') {\n\t\t\t\t    x_values = v;\n\t\t\t\t    x_legend = 'Current';\n\t\t\t\t} else i_values.push([color,offset,v]);\n\t\t\t    }\n\t\t\t}\n\n\t\t\t// graph the result and display in a window\n\t\t\tvar graph = sch.graph(x_values,x_legend,v_values,'Voltage',i_values,'Current');\n\t\t\tsch.window('Results of Transient Analysis',graph);\n\t\t    }\n\t    })\n\t}\n\n\t// t is the time at which we want a value\n\t// times is a list of timepoints from the simulation\n\tfunction interpolate(t,times,values) {\n\t    if (values == undefined) return undefined;\n\n\t    for (var i = 0; i < times.length; i++)\n\t\tif (t < times[i]) {\n\t\t    // t falls between times[i-1] and times[i]\n\t\t    var t1 = (i == 0) ? times[0] : times[i-1];\n\t\t    var t2 = times[i];\n\n\t\t    if (t2 == undefined) return undefined;\n\n\t\t    var v1 = (i == 0) ? values[0] : values[i-1];\n\t\t    var v2 = values[i];\n\t\t    var v = v1;\n\t\t    if (t != t1) v += (t - t1)*(v2 - v1)/(t2 - t1);\n\t\t    return v;\n\t\t}\n\t}\n\n\t// external interface for setting the property value of a named component\n\tSchematic.prototype.set_property = function(component_name,property,value) {\n\t    this.unselect_all(-1);\n\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar component = this.components[i];\n\t\tif (component.properties['name'] == component_name) {\n\t\t    component.properties[property] = value.toString();\n\t\t    break;\n\t\t}\n\t    }\n\n\t    this.redraw_background();\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Drawing support -- deals with scaling and scrolling of diagrama\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// here to redraw background image containing static portions of the schematic.\n\t// Also redraws dynamic portion.\n\tSchematic.prototype.redraw_background = function() {\n\t    var c = this.bg_image.getContext('2d');\n\n\t    c.lineCap = 'round';\n\n\t    // paint background color\n\t    c.fillStyle = element_style;\n\t    c.fillRect(0,0,this.width,this.height);\n\n\t    if (!this.diagram_only && this.show_grid) {\n\t\t// grid\n\t\tc.strokeStyle = grid_style;\n\t\tvar first_x = this.origin_x;\n\t\tvar last_x = first_x + this.width/this.scale;\n\t\tvar first_y = this.origin_y;\n\t\tvar last_y = first_y + this.height/this.scale;\n\n\t\tfor (var i = this.grid*Math.ceil(first_x/this.grid); i < last_x; i += this.grid)\n\t\t    this.draw_line(c,i,first_y,i,last_y,0.1);\n\n\t\tfor (var i = this.grid*Math.ceil(first_y/this.grid); i < last_y; i += this.grid)\n\t\t    this.draw_line(c,first_x,i,last_x,i,0.1);\n\t    }\n\n\t    // unselected components\n\t    var min_x = Infinity;  // compute bounding box for diagram\n\t    var max_x = -Infinity;\n\t    var min_y = Infinity;\n\t    var max_y = -Infinity;\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar component = this.components[i];\n\t\tif (!component.selected) {\n\t\t    component.draw(c);\n\t\t    min_x = Math.min(component.bbox[0],min_x);\n\t\t    max_x = Math.max(component.bbox[2],max_x);\n\t\t    min_y = Math.min(component.bbox[1],min_y);\n\t\t    max_y = Math.max(component.bbox[3],max_y);\n\t\t}\n\t    }\n\t    this.unsel_bbox = [min_x,min_y,max_x,max_y];\n\t    this.redraw();   // background changed, redraw on screen\n\t}\n\n\t// redraw what user sees = static image + dynamic parts\n\tSchematic.prototype.redraw = function() {\n\t    var c = this.canvas.getContext('2d');\n\n\t    // put static image in the background\n\t    c.drawImage(this.bg_image, 0, 0);\n\n\t    // selected components\n\t    var min_x = this.unsel_bbox[0];   // compute bounding box for diagram\n\t    var max_x = this.unsel_bbox[2];\n\t    var min_y = this.unsel_bbox[1];\n\t    var max_y = this.unsel_bbox[3];\n\t    var selections = false;\n\t    for (var i = this.components.length - 1; i >= 0; --i) {\n\t\tvar component = this.components[i];\n\t\tif (component.selected) {\n\t\t    component.draw(c);\n\t\t    selections = true;\n\t\t    min_x = Math.min(component.bbox[0],min_x);\n\t\t    max_x = Math.max(component.bbox[2],max_x);\n\t\t    min_y = Math.min(component.bbox[1],min_y);\n\t\t    max_y = Math.max(component.bbox[3],max_y);\n\t\t}\n\t    }\n\t    if (min_x == Infinity) this.bbox = [0,0,0,0];\n\t    else this.bbox = [min_x,min_y,max_x,max_y];\n\t    this.enable_tool('cut',selections);\n\t    this.enable_tool('copy',selections);\n\t    this.enable_tool('paste',sch_clipboard.length > 0);\n\n\t    // connection points: draw one at each location\n\t    for (var location in this.connection_points) {\n\t\tvar cplist = this.connection_points[location];\n\t\tcplist[0].draw(c,cplist.length);\n\t    }\n\n\t    // draw new wire\n\t    if (this.wire) {\n\t\tvar r = this.wire;\n\t\tc.strokeStyle = selected_style;\n\t\tthis.draw_line(c,r[0],r[1],r[2],r[3],1);\n\t    }\n\n\t    // draw selection rectangle\n\t    if (this.select_rect) {\n\t\tvar r = this.select_rect;\n\t\tc.lineWidth = 1;\n\t\tc.strokeStyle = selected_style;\n\t\tc.beginPath();\n\t\tc.moveTo(r[0],r[1]);\n\t\tc.lineTo(r[0],r[3]);\n\t\tc.lineTo(r[2],r[3]);\n\t\tc.lineTo(r[2],r[1]);\n\t\tc.lineTo(r[0],r[1]);\n\t\tc.stroke();\n\t    }\n\n\t    // display operating point results\n\t    if (this.operating_point) {\n\t\tif (typeof this.operating_point == 'string')\n\t\t    this.message(this.operating_point);\n\t\telse {\n\t\t    // make a copy of the operating_point info so we can mess with it\n            var temp = [];\n\t\t    for (var i in this.operating_point) temp[i] = this.operating_point[i];\n\n\t\t    // run through connection points displaying (once) the voltage\n\t\t    // for each electrical node\n\t\t    for (var location in this.connection_points)\n\t\t\t(this.connection_points[location])[0].display_voltage(c,temp);\n\n\t\t    // let components display branch current info if available\n\t\t    for (var i = this.components.length - 1; i >= 0; --i)\n\t\t\tthis.components[i].display_current(c,temp)\n\t\t}\n\t    }\n\n\t    // add scrolling/zooming control\n\t    if (!this.diagram_only) {\n\t\tvar r = this.sctl_r;\n\t\tvar x = this.sctl_x;\n\t\tvar y = this.sctl_y;\n\n\t\t// circle with border\n\t\tc.fillStyle = element_style;\n\t\tc.beginPath();\n\t\tc.arc(x,y,r,0,2*Math.PI);\n\t\tc.fill();\n\n\t\tc.strokeStyle = grid_style;\n\t\tc.lineWidth = 0.5;\n\t\tc.beginPath();\n\t\tc.arc(x,y,r,0,2*Math.PI);\n\t\tc.stroke();\n\n\t\t// direction markers for scroll\n\t\tc.lineWidth = 3;\n\t\tc.beginPath();\n\n\t\tc.moveTo(x + 4,y - r + 8);   // north\n\t\tc.lineTo(x,y - r + 4);\n\t\tc.lineTo(x - 4,y - r + 8);\n\n\t\tc.moveTo(x + r - 8,y + 4);   // east\n\t\tc.lineTo(x + r - 4,y);\n\t\tc.lineTo(x + r - 8,y - 4);\n\n\t\tc.moveTo(x + 4,y + r - 8);   // south\n\t\tc.lineTo(x,y + r - 4);\n\t\tc.lineTo(x - 4,y + r - 8);\n\n\t\tc.moveTo(x - r + 8,y + 4);   // west\n\t\tc.lineTo(x - r + 4,y);\n\t\tc.lineTo(x - r + 8,y - 4);\n\n\t\tc.stroke();\n\n\t\t// zoom control\n\t\tx = this.zctl_left;\n\t\ty = this.zctl_top;\n\t\tc.lineWidth = 0.5;\n\t\tc.fillStyle = element_style;    // background\n\t\tc.fillRect(x,y,16,48);\n\t\tc.strokeStyle = grid_style;     // border\n\t\tc.strokeRect(x,y,16,48);\n\t\tc.lineWidth = 1.0;\n\t\tc.beginPath();\n\t\t// zoom in label\n\t\tc.moveTo(x+4,y+8); c.lineTo(x+12,y+8); c.moveTo(x+8,y+4); c.lineTo(x+8,y+12);\n\t\t// zoom out label\n\t\tc.moveTo(x+4,y+24); c.lineTo(x+12,y+24);\n\t\t// surround label\n\t\tc.strokeRect(x+4,y+36,8,8);\n\t\tc.stroke();\n\t    }\n\t}\n\n\t// draws a cross cursor\n\tSchematic.prototype.cross_cursor = function(c,x,y) {\n\t    this.draw_line(c,x-this.grid,y,x+this.grid,y,1);\n\t    this.draw_line(c,x,y-this.grid,x,y+this.grid,1);\n\t}\n\n\tSchematic.prototype.moveTo = function(c,x,y) {\n\t    c.moveTo((x - this.origin_x) * this.scale,(y - this.origin_y) * this.scale);\n\t}\n\n\tSchematic.prototype.lineTo = function(c,x,y) {\n\t    c.lineTo((x - this.origin_x) * this.scale,(y - this.origin_y) * this.scale);\n\t}\n\n\tSchematic.prototype.draw_line = function(c,x1,y1,x2,y2,width) {\n\t    c.lineWidth = width*this.scale;\n\t    c.beginPath();\n\t    c.moveTo((x1 - this.origin_x) * this.scale,(y1 - this.origin_y) * this.scale);\n\t    c.lineTo((x2 - this.origin_x) * this.scale,(y2 - this.origin_y) * this.scale);\n\t    c.stroke();\n\t}\n\n\tSchematic.prototype.draw_arc = function(c,x,y,radius,start_radians,end_radians,anticlockwise,width,filled) {\n\t    c.lineWidth = width*this.scale;\n\t    c.beginPath();\n\t    c.arc((x - this.origin_x)*this.scale,(y - this.origin_y)*this.scale,radius*this.scale,\n\t\t  start_radians,end_radians,anticlockwise);\n\t    if (filled) c.fill();\n\t    else c.stroke();\n\t}\n\n\tSchematic.prototype.draw_text = function(c,text,x,y,size) {\n\t    c.font = size*this.scale+'pt sans-serif'\n\t    c.fillText(text,(x - this.origin_x) * this.scale,(y - this.origin_y) * this.scale);\n\t}\n\n\t// add method to canvas to compute relative coords for event\n\ttry {\n\t\tif (HTMLCanvasElement)\n\t\t HTMLCanvasElement.prototype.relMouseCoords = function(event){\n\t\t    // run up the DOM tree to figure out coords for top,left of canvas\n\t\t    var totalOffsetX = 0;\n\t\t    var totalOffsetY = 0;\n\t\t    var currentElement = this;\n\t\t    do {\n\t\t\ttotalOffsetX += currentElement.offsetLeft;\n\t\t\ttotalOffsetY += currentElement.offsetTop;\n\t\t    }\n\t\t    while (currentElement = currentElement.offsetParent);\n\n\t\t    // now compute relative position of click within the canvas\n\t\t    this.mouse_x = event.pageX - totalOffsetX;\n\t\t    this.mouse_y = event.pageY - totalOffsetY;\n\t\t    this.page_x = event.pageX;\n\t\t    this.page_y = event.pageY;\n\t\t }\n\t}\n\tcatch (err) { // ignore\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Event handling\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// process keystrokes, consuming those that are meaningful to us\n\tfunction schematic_key_down(event) {\n\t    if (!event) event = window.event;\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\t    var code = event.keyCode;\n\n\t    // keep track of modifier key state\n\t    if (code == 16) sch.shiftKey = true;\n\t    else if (code == 17) sch.ctrlKey = true;\n\t    else if (code == 18) sch.altKey = true;\n\t    else if (code == 91) sch.cmdKey = true;\n\n\t    // backspace or delete: delete selected components\n\t    else if (code == 8 || code == 46) {\n\t\t// delete selected components\n\t\tfor (var i = sch.components.length - 1; i >= 0; --i) {\n\t\t    var component = sch.components[i];\n\t\t    if (component.selected) component.remove();\n\t\t}\n\t\tsch.clean_up_wires();\n\t\tsch.redraw_background();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t    }\n\n\t    // cmd/ctrl x: cut\n\t    else if ((sch.ctrlKey || sch.cmdKey) && code == 88) {\n\t\tsch.cut();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t    }\n\n\t    // cmd/ctrl c: copy\n\t    else if ((sch.ctrlKey || sch.cmdKey) && code == 67) {\n\t\tsch.copy();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t    }\n\n\t    // cmd/ctrl v: paste\n\t    else if ((sch.ctrlKey || sch.cmdKey) && code == 86) {\n\t\tsch.paste();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t    }\n\n\t    // 'r': rotate component\n\t    else if (!sch.ctrlKey && !sch.altKey && !sch.cmdKey && code == 82) {\n\t\t// rotate\n\t\tfor (var i = sch.components.length - 1; i >= 0; --i) {\n\t\t    var component = sch.components[i];\n\t\t    if (component.selected) {\n\t\t\tcomponent.rotate(1);\n\t\t\tsch.check_wires(component);\n\t\t    }\n\t\t}\n\t\tsch.clean_up_wires();\n\t\tsch.redraw_background();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t    }\n\n\t    else return true;\n\n\t    // consume keystroke\n\t    sch.redraw();\n\t    event.preventDefault();\n\t    return false;\n\t}\n\n\tfunction schematic_key_up(event) {\n\t    if (!event) event = window.event;\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\t    var code = event.keyCode;\n\n\t    if (code == 16) sch.shiftKey = false;\n\t    else if (code == 17) sch.ctrlKey = false;\n\t    else if (code == 18) sch.altKey = false;\n\t    else if (code == 91) sch.cmdKey = false;\n\t}\n\n\tfunction schematic_mouse_enter(event) {\n\t    if (!event) event = window.event;\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    // see if user has selected a new part\n\t    if (sch.new_part) {\n\t\t// grab incoming part, turn off selection of parts bin\n\t\tvar part = sch.new_part;\n\t\tsch.new_part = undefined;\n\t\tpart.select(false);\n\n\t\t// unselect everything else in the schematic, add part and select it\n\t\tsch.unselect_all(-1);\n\t\tsch.redraw_background();  // so we see any components that got unselected\n\n\t\t// make a clone of the component in the parts bin\n\t\tpart = part.component.clone(sch.cursor_x,sch.cursor_y);\n\t\tpart.add(sch);  // add it to schematic\n\t\tpart.set_select(true);\n\n\t\t// and start dragging it\n\t\tsch.drag_begin();\n\t    }\n\n\t    sch.drawCursor = true;\n\t    sch.redraw();\n\t    sch.canvas.focus();  // capture key strokes\n\t    return false;\n\t}\n\n\tfunction schematic_mouse_leave(event) {\n\t    if (!event) event = window.event;\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\t    sch.drawCursor = false;\n\t    sch.redraw();\n\t    return false;\n\t}\n\n\tfunction schematic_mouse_down(event) {\n\t    if (!event) event = window.event;\n\t    else event.preventDefault();\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    // determine where event happened in schematic coordinates\n\t    sch.canvas.relMouseCoords(event);\n\n\t    var mx = sch.canvas.mouse_x;\n\t    var my = sch.canvas.mouse_y;\n\t    var sx = mx - sch.sctl_x;\n\t    var sy = my - sch.sctl_y;\n\t    var zx = mx - sch.zctl_left;\n\t    var zy = my - sch.zctl_top;\n\t    if (sx*sx + sy*sy <= sch.sctl_r*sch.sctl_r) {   // click in scrolling control\n\t\t// click on scrolling control, check which quadrant\n\t\tif (Math.abs(sy) > Math.abs(sx)) {   // N or S\n\t\t    var delta = this.height / 8;\n\t\t    if (sy > 0) delta = -delta;\n\t\t    var temp = sch.origin_y - delta;\n\t\t    if (temp > origin_min*sch.grid && temp < origin_max*sch.grid) sch.origin_y = temp;\n\t\t} else {\t\t\t    // E or W\n\t\t    var delta = this.width / 8;\n\t\t    if (sx < 0) delta = -delta;\n\t\t    var temp = sch.origin_x + delta;\n\t\t    if (temp > origin_min*sch.grid && temp < origin_max*sch.grid) sch.origin_x = temp;\n\t\t}\n\t    } else if (zx >= 0 && zx < 16 && zy >= 0 && zy < 48) {   // click in zoom control\n\t\tif (zy < 16) sch.zoomin();\n\t\telse if (zy < 32) sch.zoomout();\n\t\telse sch.zoomall();\n\t    } else {\n\t\tvar x = mx/sch.scale + sch.origin_x;\n\t\tvar y = my/sch.scale + sch.origin_y;\n\t\tsch.cursor_x = Math.round(x/sch.grid) * sch.grid;\n\t\tsch.cursor_y = Math.round(y/sch.grid) * sch.grid;\n\n\t\t// is mouse over a connection point?  If so, start dragging a wire\n\t\tvar cplist = sch.connection_points[sch.cursor_x + ',' + sch.cursor_y];\n\t\tif (cplist && !event.shiftKey) {\n\t\t    sch.unselect_all(-1);\n\t\t    sch.wire = [sch.cursor_x,sch.cursor_y,sch.cursor_x,sch.cursor_y];\n\t\t} else {\n\t\t    // give all components a shot at processing the selection event\n\t\t    var which = -1;\n\t\t    for (var i = sch.components.length - 1; i >= 0; --i)\n\t\t\tif (sch.components[i].select(x,y,event.shiftKey)) {\n\t\t\t    if (sch.components[i].selected) {\n\t\t\t\tsch.drag_begin();\n\t\t\t\twhich = i;  // keep track of component we found\n\t\t\t    }\n\t\t\t    break;\n\t\t\t}\n\t\t    // did we just click on a previously selected component?\n\t\t    var reselect = which!=-1 && sch.components[which].was_previously_selected;\n\n\t\t    if (!event.shiftKey) {\n\t\t\t// if shift key isn't pressed and we didn't click on component\n\t\t\t// that was already selected, unselect everyone except component\n\t\t\t// we just clicked on\n\t\t\tif (!reselect) sch.unselect_all(which);\n\n\t\t\t// if there's nothing to drag, set up a selection rectangle\n\t\t\tif (!sch.dragging) sch.select_rect = [sch.canvas.mouse_x,sch.canvas.mouse_y,\n\t\t\t\t\t\t\t      sch.canvas.mouse_x,sch.canvas.mouse_y];\n\t\t    }\n\t\t}\n\t    }\n\n\t    sch.redraw_background();\n\t    return false;\n\t}\n\n\tfunction schematic_mouse_move(event) {\n\t    if (!event) event = window.event;\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    sch.canvas.relMouseCoords(event);\n\t    var x = sch.canvas.mouse_x/sch.scale + sch.origin_x;\n\t    var y = sch.canvas.mouse_y/sch.scale + sch.origin_y;\n\t    sch.cursor_x = Math.round(x/sch.grid) * sch.grid;\n\t    sch.cursor_y = Math.round(y/sch.grid) * sch.grid;\n\n\t    if (sch.wire) {\n\t\t// update new wire end point\n\t\tsch.wire[2] = sch.cursor_x;\n\t\tsch.wire[3] = sch.cursor_y;\n\t    } else if (sch.dragging) {\n\t\t// see how far we moved\n\t\tvar dx = sch.cursor_x - sch.drag_x;\n\t\tvar dy = sch.cursor_y - sch.drag_y;\n\t\tif (dx != 0 || dy != 0) {\n\t\t    // update position for next time\n\t\t    sch.drag_x = sch.cursor_x;\n\t\t    sch.drag_y = sch.cursor_y;\n\n\t\t    // give all components a shot at processing the event\n\t\t    for (var i = sch.components.length - 1; i >= 0; --i) {\n\t\t\tvar component = sch.components[i];\n\t\t\tif (component.selected) component.move(dx,dy);\n\t\t    }\n\t\t}\n\t    } else if (sch.select_rect) {\n\t\t// update moving corner of selection rectangle\n\t\tsch.select_rect[2] = sch.canvas.mouse_x;\n\t\tsch.select_rect[3] = sch.canvas.mouse_y;\n\t    }\n\n\t    // just redraw dynamic components\n\t    sch.redraw();\n\n\t    return false;\n\t}\n\n\tfunction schematic_mouse_up(event) {\n\t    if (!event) event = window.event;\n\t    else event.preventDefault();\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    // drawing a new wire\n\t    if (sch.wire) {\n\t\tvar r = sch.wire;\n\t\tsch.wire = undefined;\n\n\t\tif (r[0]!=r[2] || r[1]!=r[3]) {\n\t\t    // insert wire component\n\t\t    sch.add_wire(r[0],r[1],r[2],r[3]);\n\t\t    sch.clean_up_wires();\n\t\t    sch.redraw_background();\n\t\t} else sch.redraw();\n\t    }\n\n\t    // dragging\n\t    if (sch.dragging) sch.drag_end();\n\n\t    // selection rectangle\n\t    if (sch.select_rect) {\n\t\tvar r = sch.select_rect;\n\n\t\t// if select_rect is a point, we've already dealt with selection\n\t\t// in mouse_down handler\n\t\tif (r[0]!=r[2] || r[1]!=r[3]) {\n\t\t    // convert to schematic coordinates\n\t\t    var s = [r[0]/sch.scale + sch.origin_x, r[1]/sch.scale + sch.origin_y,\n\t\t\t     r[2]/sch.scale + sch.origin_x, r[3]/sch.scale + sch.origin_y];\n\t\t    canonicalize(s);\n\n\t\t    if (!event.shiftKey) sch.unselect_all();\n\n\t\t    // select components that intersect selection rectangle\n\t\t    for (var i = sch.components.length - 1; i >= 0; --i)\n\t\t\tsch.components[i].select_rect(s,event.shiftKey);\n\t\t}\n\n\t\tsch.select_rect = undefined;\n\t\tsch.redraw_background();\n\t    }\n\t    return false;\n\t}\n\n\tfunction schematic_mouse_wheel(event) {\n\t    if (!event) event = window.event;\n\t    else event.preventDefault();\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    var delta = 0;\n\t    if (event.wheelDelta) delta = event.wheelDelta;\n\t    else if (event.detail) delta = -event.detail;\n\n\t    if (delta) {\n\t\tvar nscale = (delta > 0) ? sch.scale*zoom_factor : sch.scale/zoom_factor;\n\n\t\tif (nscale > zoom_min && nscale < zoom_max) {\n\t\t    // zoom around current mouse position\n\t\t    sch.canvas.relMouseCoords(event);\n\t\t    var s = 1.0/sch.scale - 1.0/nscale;\n\t\t    sch.origin_x += sch.canvas.mouse_x*s;\n\t\t    sch.origin_y += sch.canvas.mouse_y*s;\n\t\t    sch.scale = nscale;\n\t\t    sch.redraw_background();\n\t\t}\n\t    }\n\t}\n\n\tfunction schematic_double_click(event) {\n\t    if (!event) event = window.event;\n\t    else event.preventDefault();\n\t    var sch = (window.event) ? event.srcElement.schematic : event.target.schematic;\n\n\t    // determine where event happened in schematic coordinates\n\t    sch.canvas.relMouseCoords(event);\n\t    var x = sch.canvas.mouse_x/sch.scale + sch.origin_x;\n\t    var y = sch.canvas.mouse_y/sch.scale + sch.origin_y;\n\t    sch.cursor_x = Math.round(x/sch.grid) * sch.grid;\n\t    sch.cursor_y = Math.round(y/sch.grid) * sch.grid;\n\n\t    // see if we double-clicked a component.  If so, edit it's properties\n\t    for (var i = sch.components.length - 1; i >= 0; --i)\n\t\tif (sch.components[i].edit_properties(x,y))\n\t\t    break;\n\n\t    return false;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Status message and dialogs\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tSchematic.prototype.message = function(message) {\n\t    this.status.nodeValue = message;\n\t}\n\n\tSchematic.prototype.append_message = function(message) {\n\t    this.status.nodeValue += ' / '+message;\n\t}\n\n\t// set up a dialog with specified title, content and two buttons at\n\t// the bottom: OK and Cancel.  If Cancel is clicked, dialog goes away\n\t// and we're done.  If OK is clicked, dialog goes away and the\n\t// callback function is called with the content as an argument (so\n\t// that the values of any fields can be captured).\n\tSchematic.prototype.dialog = function(title,content,callback) {\n\t    // create the div for the top level of the dialog, add to DOM\n\t    var dialog = document.createElement('div');\n\t    dialog.sch = this;\n\t    dialog.content = content;\n\t    dialog.callback = callback;\n\n\t    // look for property input fields in the content and give\n\t    // them a keypress listener that interprets ENTER as\n\t    // clicking OK.\n\t    var plist = content.getElementsByClassName('property');\n\t    for (var i = plist.length - 1; i >= 0; --i) {\n\t\tvar field = plist[i];\n\t\tfield.dialog = dialog;  // help event handler find us...\n\t\tfield.addEventListener('keypress',dialog_check_for_ENTER,false);\n\t    }\n\n\t    // div to hold the content\n\t    var body = document.createElement('div');\n\t    content.style.marginBotton = '5px';\n\t    body.appendChild(content);\n\t    body.style.padding = '5px';\n\t    dialog.appendChild(body);\n\n\t    var ok_button = document.createElement('span');\n\t    ok_button.appendChild(document.createTextNode('OK'));\n\t    ok_button.dialog = dialog;   // for the handler to use\n\t    ok_button.addEventListener('click',dialog_okay,false);\n\t    ok_button.style.display = 'inline';\n\t    ok_button.style.border = '1px solid';\n\t    ok_button.style.padding = '5px';\n\t    ok_button.style.margin = '10px';\n\n\t    var cancel_button = document.createElement('span');\n\t    cancel_button.appendChild(document.createTextNode('Cancel'));\n\t    cancel_button.dialog = dialog;   // for the handler to use\n\t    cancel_button.addEventListener('click',dialog_cancel,false);\n\t    cancel_button.style.display = 'inline';\n\t    cancel_button.style.border = '1px solid';\n\t    cancel_button.style.padding = '5px';\n\t    cancel_button.style.margin = '10px';\n\n\t    // div to hold the two buttons\n\t    var buttons = document.createElement('div');\n\t    buttons.style.textAlign = 'center';\n\t    buttons.appendChild(ok_button);\n\t    buttons.appendChild(cancel_button);\n\t    buttons.style.padding = '5px';\n\t    buttons.style.margin = '10px';\n\t    dialog.appendChild(buttons);\n\n\t    // put into an overlay window\n\t    this.window(title,dialog);\n\t}\n\n\tfunction dialog_cancel(event) {\n\t    if (!event) event = window.event;\n\t    var dialog = (window.event) ? event.srcElement.dialog : event.target.dialog;\n\n\t    window_close(dialog.win);\n\t}\n\n\tfunction dialog_okay(event) {\n\t    if (!event) event = window.event;\n\t    var dialog = (window.event) ? event.srcElement.dialog : event.target.dialog;\n\n\t    window_close(dialog.win);\n\n\t    if (dialog.callback) dialog.callback(dialog.content);\n\t}\n\n\t// callback for keypress in input fields: if user typed ENTER, act\n\t// like they clicked OK button.\n\tfunction dialog_check_for_ENTER(event) {\n\t    var key = (window.event) ? window.event.keyCode : event.keyCode;\n\t    if (key == 13) dialog_okay(event);\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Draggable, resizeable, closeable window\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// build a 2-column HTML table from an associative array (keys as text in\n\t// column 1, values in column 2).\n\tfunction build_table(a) {\n\t    var tbl = document.createElement('table');\n\n\t    // build a row for each element in associative array\n\t    for (var i in a) {\n\t\tvar label = document.createTextNode(i + ': ');\n\t\tvar col1 = document.createElement('td');\n\t\tcol1.appendChild(label);\n\t\tvar col2 = document.createElement('td');\n\t\tcol2.appendChild(a[i]);\n\t\tvar row = document.createElement('tr');\n\t\trow.appendChild(col1);\n\t\trow.appendChild(col2);\n\t\trow.style.verticalAlign = 'center';\n\t\ttbl.appendChild(row);\n\t    }\n\n\t    return tbl;\n\t}\n\n\tfunction build_input(type,size,value) {\n\t    var input = document.createElement('input');\n\t    input.type = type;\n\t    input.size = size;\n\t    input.className = 'property';  // make this easier to find later\n\t    if (value == undefined) input.value = '';\n\t    else input.value = value.toString();\n\t    return input;\n\t}\n\n\t// build a select widget using the strings found in the options array\n\tfunction build_select(options,selected) {\n\t    var select = document.createElement('select');\n\t    for (var i = 0; i < options.length; i++) {\n\t\tvar option = document.createElement('option');\n\t\toption.text = options[i];\n\t\tselect.add(option);\n\t\tif (options[i] == selected) select.selectedIndex = i;\n\t    }\n\t    return select;\n\t}\n\n\tSchematic.prototype.window = function(title,content,offset) {\n\t    // create the div for the top level of the window\n\t    var win = document.createElement('div');\n\t    win.sch = this;\n\t    win.content = content;\n\t    win.drag_x = undefined;\n\t    win.draw_y = undefined;\n\n\t    // div to hold the title\n\t    var head = document.createElement('div');\n\t    head.style.backgroundColor = 'black';\n\t    head.style.color = 'white';\n\t    head.style.textAlign = 'center';\n\t    head.style.padding = '5px';\n\t    head.appendChild(document.createTextNode(title));\n\t    head.win = win;\n\t    win.head = head;\n\n\t    var close_button = new Image();\n\t    close_button.src = close_icon;\n\t    close_button.style.cssFloat = 'right';\n\t    close_button.addEventListener('click',window_close_button,false);\n\t    close_button.win = win;\n\t    head.appendChild(close_button);\n\n\t    win.appendChild(head);\n\n\t    // capture mouse events in title bar\n\t    head.addEventListener('mousedown',window_mouse_down,false);\n\n\t    // div to hold the content\n\t    //var body = document.createElement('div');\n\t    //body.appendChild(content);\n\t    win.appendChild(content);\n\t    content.win = win;   // so content can contact us\n\n\t    // compute location relative to canvas\n\t    if (offset == undefined) offset = 0;\n\t    win.left = this.canvas.mouse_x + offset;\n\t    win.top = this.canvas.mouse_y + offset;\n\n\t    // add to DOM\n\t    win.style.background = 'white';\n\t    win.style.position = 'absolute';\n\t    win.style.left = win.left + 'px';\n\t    win.style.top = win.top + 'px';\n\t    win.style.border = '2px solid';\n\n\t    this.canvas.parentNode.insertBefore(win,this.canvas);\n\t    bring_to_front(win,true);\n\t}\n\n\t// adjust zIndex of pop-up window so that it is in front\n\tfunction bring_to_front(win,insert) {\n\t    var wlist = win.sch.window_list;\n\t    var i = wlist.indexOf(win);\n\n\t    // remove from current position (if any) in window list\n\t    if (i != -1) wlist.splice(i,1);\n\n\t    // if requested, add to end of window list\n\t    if (insert) wlist.push(win);\n\n\t    // adjust all zIndex values\n\t    for (i = 0; i < wlist.length; i += 1)\n\t\twlist[i].style.zIndex = 1000 + i;\n\t}\n\n\t// close the window\n\tfunction window_close(win) {\n\t    // remove the window from the top-level div of the schematic\n\t    win.parentNode.removeChild(win);\n\n\t    // remove from list of pop-up windows\n\t    bring_to_front(win,false);\n\t}\n\n\tfunction window_close_button(event) {\n\t    if (!event) event = window.event;\n\t    var src = (window.event) ? event.srcElement : event.target;\n\t    window_close(src.win);\n\t}\n\n\t// capture mouse events in title bar of window\n\tfunction window_mouse_down(event) {\n\t    if (!event) event = window.event;\n\t    var src = (window.event) ? event.srcElement : event.target;\n\t    var win = src.win;\n\n\t    bring_to_front(win,true);\n\n\t    // add handlers to document so we capture them no matter what\n\t    document.addEventListener('mousemove',window_mouse_move,false);\n\t    document.addEventListener('mouseup',window_mouse_up,false);\n\t    document.tracking_window = win;\n\n\t    // remember where mouse is so we can compute dx,dy during drag\n\t    win.drag_x = event.pageX;\n\t    win.drag_y = event.pageY;\n\n\t    return false;\n\t}\n\n\tfunction window_mouse_up(event) {\n\t    var win = document.tracking_window;\n\n\t    // show's over folks...\n\t    document.removeEventListener('mousemove',window_mouse_move,false);\n\t    document.removeEventListener('mouseup',window_mouse_up,false);\n\t    document.tracking_window = undefined;\n\t    win.drag_x = undefined;\n\t    win.drag_y = undefined;\n\t    return true;  // consume event\n\t}\n\n\tfunction window_mouse_move(event) {\n\t    var win = document.tracking_window;\n\n\t    if (win.drag_x) {\n\t\tvar dx = event.pageX - win.drag_x;\n\t\tvar dy = event.pageY - win.drag_y;\n\n\t\t// move the window\n\t\twin.left += dx;\n\t\twin.top += dy;\n\t\twin.style.left = win.left + 'px';\n\t\twin.style.top = win.top + 'px';\n\n\t\t// update reference point\n\t\twin.drag_x += dx;\n\t\twin.drag_y += dy;\n\n\t\treturn true;  // consume event\n\t    }\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Toolbar\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tSchematic.prototype.add_tool = function(icon,tip,callback) {\n\t    var tool, child, label, hidden;\n\n        tool = document.createElement('button');\n        child = document.createElement('img');\n        label = document.createElement('span');\n        hidden = document.createElement('span');\n\n        tool.style.backgroundImage = 'none';\n        tool.setAttribute('title', tip);\n        label.innerHTML = tip;\n        label.classList.add('sr');\n        hidden.setAttribute('aria-hidden', 'true');\n\n\t    if (icon.search('data:image') != -1) {\n            child.setAttribute('src', icon);\n            child.setAttribute('alt', '');\n            tool.appendChild(child);\n\t    } else {\n            tool.style.font = 'small-caps small sans-serif';\n            hidden.innerHTML = icon;\n            tool.appendChild(hidden);\n            tool.appendChild(label);\n\t    }\n\n\t    // decorate tool\n        tool.style.height = '32px';\n        tool.style.width = 'auto';\n        tool.style.verticalAlign = 'top';\n\n\t    // set up event processing\n\t    tool.addEventListener('mouseover',tool_enter,false);\n\t    tool.addEventListener('mouseout',tool_leave,false);\n\t    tool.addEventListener('click',tool_click,false);\n\n\t    // add to toolbar\n\t    tool.sch = this;\n\t    tool.tip = tip;\n\t    tool.callback = callback;\n\t    this.toolbar.push(tool);\n\n\t    tool.enabled = false;\n\n\t    return tool;\n\t}\n\n\tSchematic.prototype.enable_tool = function(tname,which) {\n\t    var tool = this.tools[tname];\n\n\t    if (tool != undefined) {\n        tool.removeAttribute('disabled');\n\t\ttool.enabled = which;\n\n\t\t// if disabling tool, remove border and tip\n\t\tif (!which) {\n\t\t    tool.sch.message('');\n            tool.setAttribute('disabled', 'true');\n\t\t}\n\t    }\n\t}\n\n\t// highlight tool button by turning on border, changing background\n\tfunction tool_enter(event) {\n\t    if (!event) event = window.event;\n        var tool = event.target;\n        if (event.target.tagName.toLowerCase() == 'img' || event.target.tagName.toLowerCase() == 'span') {\n            tool = event.target.parentNode;\n        }\n        if (tool.enabled) {\n\t\ttool.sch.message(tool.tip);\n\t    }\n        event.stopPropagation();\n\t}\n\n\t// unhighlight tool button by turning off border, reverting to normal background\n\tfunction tool_leave(event) {\n\t    if (!event) event = window.event;\n        var tool = event.target;\n        if (event.target.tagName.toLowerCase() == 'img' || event.target.tagName.toLowerCase() == 'span') {\n            tool = event.target.parentNode;\n        }\n\t    if (tool.enabled) {\n\t\ttool.sch.message('');\n\t    }\n        event.stopPropagation();\n\t}\n\n\t// handle click on a tool\n\tfunction tool_click(event) {\n\t    if (!event) event = window.event;\n        var tool = event.target;\n        if (event.target.tagName.toLowerCase() == 'img' || event.target.tagName.toLowerCase() == 'span') {\n            tool = event.target.parentNode;\n        }\n\t    if (tool.enabled) {\n\t\ttool.sch.canvas.relMouseCoords(event);  // so we can position pop-up window correctly\n\t\ttool.callback.call(tool.sch);\n\t    }\n        event.stopPropagation();\n\t}\n\n\tvar help_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABgFBMVEUARMwAZsz///8AM5kGqP+s1/8AeuARp/8AZ803qPsAXNYAdNwAZcxZuv9auf99xv8AdNoEd9uTzP8AYsgAivQTl/cAj/V9xf8Ad90AeN5PtP8AUMoAj/oRiOgprf84qfwAb9UAifAAdtwAf+UAgOYActgAk/oAie8cqP8AbtQAXtkXof8AatBNuP8AbdMAgukXcOEAXdcAlP0AhuwJmv0prv8YceGCyP8AbtUAZd8elvMAZcsAW9Ucpv8AjfM3sP8AiO4AWdNOuP8AddsPgeIAhOoAbdT///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABH5RCxAAAASHRSTlP//////////////////////////////////////////////////////////////////////////////////////////////wCc7PJgAAAAAWJLR0R/SL9x5QAAAAlwSFlzAAAASAAAAEgARslrPgAAAAl2cEFnAAAAEAAAABAAXMatwwAAAK5JREFUGNM1zwcOwjAMBVAHQ9PFbIG27L333pve/0bEBr5kyf9JkWIIKYLDK3CNcZgUiE0QFIuuu89kBIHIDy5TUOmXSknBsFxDRAXMJ4FIZOeqA41lxQVB+w/1L9RyO+B+fLwJ7q/OOUfd9FvDkQJDmyyuoLqWGtsVBq3RnAHcUlXbNgSEWPY8n570dH2F6h94Sqe3BAdd7xKEKKVTACg4UuL3OMQoB/F3LRGF1w/Arhm2Q9w2ZQAAACV0RVh0Y3JlYXRlLWRhdGUAMjAwOC0xMC0yM1QxMTo1ODozNiswODowMKkTWd4AAAAldEVYdG1vZGlmeS1kYXRlADIwMDgtMTAtMjNUMTE6NTk6NTArMDg6MDC833hpAAAAAElFTkSuQmCC';\n\n\tvar cut_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1QocFh0xaEFkXgAAArRJREFUOMuFk11Ik1EYx59z3nevr9vUfaXbbPgVaHjRVRB0YZRJV0XeZCIRaGmWWKhpgZAElaV9gYgQlBjoEPRKkCS6DAK1MG0zNvJj7zZ1m+51X+92zttNzmFa5+78/w8//s/znIMg5TzrfXIOAN7zPO9tunm7dI/Xz7LspTvNrbpUHadeGIYZu9XYrI1Go8t9/a87Uz0Fq7hw5nS55sWrnk8HAggh/E+HHdfV1lcQQo7t6E97HpeZc82m7ZCIKKUnDgRgjENLS7+AT0tDsVisdCcFy7JThYWF4HF7KKXU8a8EFTabDVZdK6iutr44kUic6nnePVBSUqJAgMHhdAAAWA8E3G299xljvLy4aAc+jUeSJB3X6/TXZAqwvrFGAWCiraXj4YEAAABKaeXCjwV5bc0DjTeaVPFEHIliEObm5iQA6Npb/xegraVjGmM8ZF+00WBwC2s0GhDcgizL8ru2lo7p/wL+pJianZnGTqcD0jkeMt8ORhBCb/arRXuFMaOxl1B6Pb65qSblZTIz+REVGHNAIHQLITRQ6fG07wsYM5k6437/g6MmEyQoRd6tTdkX3h5mZVRVkJ3D8BxHJVkG5/o6KLKyrla63UPJFsbN5hrJ5+sqNhrpwsrKVDASlgJBEdfEaU2UIzqWwTQQEhOO1dUPR/R6EvP5BsfN5t2XOmowCPNFRWSEYe4DAMxYLCGrUpnY8UcYhnzJNQcBAIYxbv+Wn09GDQZhd4ixmF6SJFJFyKMJleqlgmV5hLE9OWmOm1Hz6arJjIy+y5R2gyxTIMSwC+A4Qa1UMl/z8mImna5pXhC8iszMK8mPpNU2fHe5Ng4fOtQwa7HECKUYMA4AADAAANVarc/l95/0SxIbAJA5tfrsRUFI7twqiu7q7GyPNxDI8YfDGl8k4lOoVOetouj+DaDzOgfcNME8AAAAAElFTkSuQmCC';\n\n\tvar copy_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsSAAALEgHS3X78AAAAd0lEQVQ4y9WTsQ7AIAhE7wj//69dHKWLJqSlFOtUFpXA8SAIbBrHaR9yAAA6L2bvGiRvPtltQa+OqMrFPCo1jFhoRytBmXgqUCH5GUEkWCbova8TeBORfBNJVpYIrbVJdwDjY5hjJfk4vFnAzMDxiEqmo/fJAHACspMyA7UYnWgAAAAASUVORK5CYII=';\n\n\tvar paste_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVQ4y6WSMUsDMRiGn6RteoJSENS5oCdFR3+D0MHBciA4uujiVrq0o1NBcBEEFycXRzcnf4GDINTiL7BTr9LeJdfGoaX0ei21+MFHAsn7fG9eAjOqXCwoz/NKgAWs53mlcrGgZt0VE3s7fdhsfgHguttztTHA5+0ZjUaDzdM7HEeRy60C0G7/EASa78cLXNelcPkw1qYnkVprfN/n+6aEUgqlFFJKjDForclms2itYzZigH6/Tz6fp9PpAFC8fp3h/J2rw42P2ksLADkNMMbgOA6O4wzfZW2sAWovrb3janUn4cAYgzGGRWWtRQjRPKpUdmOAKIrGgCiK5gKEGGb/XK9/JhwEQUC32yUMw7nTJ0ExQK/Xw/d9BoPBeMqiigHCMEQIQSqV+pM4AbCAXEKcAGAtKSn/AYCE/UVZpIEVYA1ASkkmkxl/mqfzg5ExG1tP7t8AtoAOwDqwP4pgmd4H1n8B+QWeF/d+HLAAAAAASUVORK5CYII=';\n\n\tvar close_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACOUlEQVR42m2TzWtTQRTF30ysxE9E0VZKaapBa1OJxtRAW7XVGOrCKijFIEqXbgQFwf/BTReia7GUuBEUF5Y2YiMKKn6iKEqRom1DtAsjStGaGX9v3iQ+Y4Z35t6ZOfe8uXdmhFPVDqRSktYvpBzAxphaBQpKqSdalTLYO7fHxnWZL/zBfclkWAbksBBip7cmHEGvDd3raFlVUoOj2Wz+H4H9vT0RGQhMMLHGkxaienduuJV6p0ql5PjdiRlD2rurO0jwM9zWWnG1dPhyWql9ht3T1XmKwEtAaLNVMUT3AFyBsAz7g9lBbBc4+zcb54joTnQIKeRDZjrcvyNQxG9A5Bd2NwIZ+Gn8e2AxmHNFbTbXRWc8FoRcJLjObtDtbjB3DLtALZbws3l8d/0aOOzLZlYktkfX4eS9epuiehlqZ+TRi5cny8zEtuhVVo/7eabW8a2RFdivwlbPbu079uDT129yZYEd7W17oNzCXe4rdFHE2lrd0SRosbX5TXAK5EAd5NPYi9gF0AtGwSIrcN9IRTeFLxB8zp7RPAExMAUxAw7h3wRpdh+SQjzHBm0KZ4xA+8aWRgivzLU16TvuLZsB8UqyjvMYNDOu98rgfEQ8UklmS6hpQCs9ghuwdShfSKF9Ezb/n5x939upT7mKwOamRogqjchlhit9R+XbhGlfeGgn3k/Pjv33mNwWXl8f4sWdJ+Yow9W+JTetYSkDQ5P5wuear7HcNjSs5Upqd60ZLAXfwPSHwpyu5v4BhpTicEl0i9QAAAAASUVORK5CYII=';\n\n\tvar grid_icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsSAAALEgHS3X78AAAAMklEQVQ4y2NkYGD4z0ABYGFgYGD4/x/VDEZGRqLFmCixnYGBYRAYwMgwGoijgTgsAhEAq84fH/l+ELYAAAAASUVORK5CYII=';\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Graphing\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\t// add dashed lines!\n\t// from http://davidowens.wordpress.com/2010/09/07/html-5-canvas-and-dashed-lines/\n\ttry {\n\t\tif (CanvasRenderingContext2D)\n\t\t\tCanvasRenderingContext2D.prototype.dashedLineTo = function(fromX, fromY, toX, toY, pattern) {\n\t\t\t    // Our growth rate for our line can be one of the following:\n\t\t\t    //   (+,+), (+,-), (-,+), (-,-)\n\t\t\t    // Because of this, our algorithm needs to understand if the x-coord and\n\t\t\t    // y-coord should be getting smaller or larger and properly cap the values\n\t\t\t    // based on (x,y).\n\t\t\t    var lt = function (a, b) { return a <= b; };\n\t\t\t    var gt = function (a, b) { return a >= b; };\n\t\t\t    var capmin = function (a, b) { return Math.min(a, b); };\n\t\t\t    var capmax = function (a, b) { return Math.max(a, b); };\n\t\t\t    var checkX = { thereYet: gt, cap: capmin };\n\t\t\t    var checkY = { thereYet: gt, cap: capmin };\n\n\t\t\t    if (fromY - toY > 0) {\n\t\t\t\tcheckY.thereYet = lt;\n\t\t\t\tcheckY.cap = capmax;\n\t\t\t    }\n\t\t\t    if (fromX - toX > 0) {\n\t\t\t\tcheckX.thereYet = lt;\n\t\t\t\tcheckX.cap = capmax;\n\t\t\t    }\n\n\t\t\t    this.moveTo(fromX, fromY);\n\t\t\t    var offsetX = fromX;\n\t\t\t    var offsetY = fromY;\n\t\t\t    var idx = 0, dash = true;\n\t\t\t    while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n\t\t\t\tvar ang = Math.atan2(toY - fromY, toX - fromX);\n\t\t\t\tvar len = pattern[idx];\n\n\t\t\t\toffsetX = checkX.cap(toX, offsetX + (Math.cos(ang) * len));\n\t\t\t\toffsetY = checkY.cap(toY, offsetY + (Math.sin(ang) * len));\n\n\t\t\t\tif (dash) this.lineTo(offsetX, offsetY);\n\t\t\t\telse this.moveTo(offsetX, offsetY);\n\n\t\t\t\tidx = (idx + 1) % pattern.length;\n\t\t\t\tdash = !dash;\n\t\t\t    }\n\t\t\t};\n\t}\n\tcatch (err) { //noop\n\t}\n\t// given a range of values, return a new range [vmin',vmax'] where the limits\n\t// have been chosen \"nicely\".  Taken from matplotlib.ticker.LinearLocator\n\tfunction view_limits(vmin,vmax) {\n\t    // deal with degenerate case...\n\t    if (vmin == vmax) {\n\t\tif (vmin == 0) { vmin = -0.5; vmax = 0.5; }\n\t\telse {\n\t\t    vmin = vmin > 0 ? 0.9*vmin : 1.1*vmin;\n\t\t    vmax = vmax > 0 ? 1.1*vmax : 0.9*vmax;\n\t\t}\n\t    }\n\n\t    var log_range = Math.log(vmax - vmin)/Math.LN10;\n\t    var exponent = Math.floor(log_range);\n\t    //if (log_range - exponent < 0.5) exponent -= 1;\n\t    var scale = Math.pow(10,-exponent);\n\t    vmin = Math.floor(scale*vmin)/scale;\n\t    vmax = Math.ceil(scale*vmax)/scale;\n\n\t    return [vmin,vmax,1.0/scale];\n\t}\n\n\tfunction engineering_notation(n,nplaces,trim) {\n\t    if (n == 0) return '0';\n\t    if (n == undefined) return 'undefined';\n\t    if (trim == undefined) trim = true;\n\n\t    var sign = n < 0 ? -1 : 1;\n\t    var log10 = Math.log(sign*n)/Math.LN10;\n\t    var exp = Math.floor(log10/3);   // powers of 1000\n\t    var mantissa = sign*Math.pow(10,log10 - 3*exp);\n\n\t    // keep specified number of places following decimal point\n\t    var mstring = (mantissa + sign*0.5*Math.pow(10,-nplaces)).toString();\n\t    var mlen = mstring.length;\n\t    var endindex = mstring.indexOf('.');\n\t    if (endindex != -1) {\n\t\tif (nplaces > 0) {\n\t\t    endindex += nplaces + 1;\n\t\t    if (endindex > mlen) endindex = mlen;\n\t\t    if (trim) {\n\t\t\twhile (mstring.charAt(endindex-1) == '0') endindex -= 1;\n\t\t\tif (mstring.charAt(endindex-1) == '.') endindex -= 1;\n\t\t    }\n\t\t}\n\t\tif (endindex < mlen)\n\t\t    mstring = mstring.substring(0,endindex);\n\t    }\n\n\t    switch(exp) {\n\t    case -5:\treturn mstring+\"f\";\n\t    case -4:\treturn mstring+\"p\";\n\t    case -3:\treturn mstring+\"n\";\n\t    case -2:\treturn mstring+\"u\";\n\t    case -1:\treturn mstring+\"m\";\n\t    case 0:\treturn mstring;\n\t    case 1:\treturn mstring+\"K\";\n\t    case 2:\treturn mstring+\"M\";\n\t    case 3:\treturn mstring+\"G\";\n\t    }\n\n\t    // don't have a good suffix, so just print the number\n\t    return n.toString();\n\t}\n\n\tvar grid_pattern = [1,2];\n\tvar cursor_pattern = [5,5];\n\n\t// x_values is an array of x coordinates for each of the plots\n\t// y_values is an array of [color, value_array], one entry for each plot on left vertical axis\n\t// z_values is an array of [color, value_array], one entry for each plot on right vertical axis\n\tSchematic.prototype.graph = function(x_values,x_legend,y_values,y_legend,z_values,z_legend) {\n\t    var pwidth = 400;\t// dimensions of actual plot\n\t    var pheight = 300;\t// dimensions of actual plot\n\t    var left_margin = (y_values != undefined && y_values.length > 0) ? 55 : 25;\n\t    var top_margin = 25;\n\t    var right_margin = (z_values != undefined && z_values.length > 0) ? 55 : 25;\n\t    var bottom_margin = 45;\n\t    var tick_length = 5;\n\n\t    var w = pwidth + left_margin + right_margin;\n\t    var h = pheight + top_margin + bottom_margin;\n\n\t    var canvas = document.createElement('canvas');\n\t    canvas.width = w;\n\t    canvas.height = h;\n\n\t    // the graph itself will be drawn here and this image will be copied\n\t    // onto canvas, where it can be overlayed with mouse cursors, etc.\n\t    var bg_image = document.createElement('canvas');\n\t    bg_image.width = w;\n\t    bg_image.height = h;\n\t    canvas.bg_image = bg_image;\t// so we can find it during event handling\n\n\t    // start by painting an opaque background\n\t    var c = bg_image.getContext('2d');\n\t    c.fillStyle = background_style;\n\t    c.fillRect(0,0,w,h);\n\t    c.fillStyle = element_style;\n\t    c.fillRect(left_margin,top_margin,pwidth,pheight);\n\n\t    // figure out scaling for plots\n\t    var x_min = array_min(x_values);\n\t    var x_max = array_max(x_values);\n\t    var x_limits = view_limits(x_min,x_max);\n\t    x_min = x_limits[0];\n\t    x_max = x_limits[1];\n\t    var x_scale = pwidth/(x_max - x_min);\n\n\t    function plot_x(x) {\n\t\treturn (x - x_min)*x_scale + left_margin;\n\t    }\n\n\t    // draw x grid\n\t    c.strokeStyle = grid_style;\n\t    c.lineWidth = 1;\n\t    c.fillStyle = normal_style;\n\t    c.font = '10pt sans-serif';\n\t    c.textAlign = 'center';\n\t    c.textBaseline = 'top';\n\t    var end = top_margin + pheight;\n\t    for (var x = x_min; x <= x_max; x += x_limits[2]) {\n\t\tvar temp = plot_x(x) + 0.5;  // keep lines crisp!\n\n\t\t// grid line\n\t\tc.beginPath();\n\t\tif (x == x_min) {\n\t\t    c.moveTo(temp,top_margin);\n\t\t    c.lineTo(temp,end);\n\t\t} else\n\t\t    c.dashedLineTo(temp,top_margin,temp,end,grid_pattern);\n\t\tc.stroke();\n\n\t\t// tick mark\n\t\tc.beginPath();\n\t\tc.moveTo(temp,end);\n\t\tc.lineTo(temp,end + tick_length);\n\t\tc.stroke();\n\t\tc.fillText(engineering_notation(x,2),temp,end + tick_length);\n\t    }\n\n\t    if (y_values != undefined && y_values.length > 0) {\n\t\tvar y_min = Infinity;\n\t\tvar y_max = -Infinity;\n\t\tvar plot;\n\t\tfor (plot = y_values.length - 1; plot >= 0; --plot) {\n\t\t    var values = y_values[plot][2];\n\t\t    if (values == undefined) continue;  // no data points\n\t\t    var offset = y_values[plot][1];\n\t\t    var temp = array_min(values) + offset;\n\t\t    if (temp < y_min) y_min = temp;\n\t\t    temp = array_max(values) + offset;\n\t\t    if (temp > y_max) y_max = temp;\n\t\t}\n\t\tvar y_limits = view_limits(y_min,y_max);\n\t\ty_min = y_limits[0];\n\t\ty_max = y_limits[1];\n\t\tvar y_scale = pheight/(y_max - y_min);\n\n\t\tfunction plot_y(y) {\n\t\t    return (y_max - y)*y_scale + top_margin;\n\t\t}\n\n\t\t// draw y grid\n\t\tc.textAlign = 'right';\n\t\tc.textBaseline = 'middle';\n\t\tfor (var y = y_min; y <= y_max; y += y_limits[2]) {\n\t\t    if (Math.abs(y/y_max) < 0.001) y = 0.0; // Just 3 digits\n\t\t    var temp = plot_y(y) + 0.5;  // keep lines crisp!\n\n\t\t    // grid line\n\t\t    c.beginPath();\n\t\t    if (y == y_min) {\n\t\t\tc.moveTo(left_margin,temp);\n\t\t\tc.lineTo(left_margin + pwidth,temp);\n\t\t    } else\n\t\t\tc.dashedLineTo(left_margin,temp,left_margin + pwidth,temp,grid_pattern);\n\t\t    c.stroke();\n\n\t\t    // tick mark\n\t\t    c.beginPath();\n\t\t    c.moveTo(left_margin - tick_length,temp);\n\t\t    c.lineTo(left_margin,temp);\n\t\t    c.stroke();\n\t\t    c.fillText(engineering_notation(y,2),left_margin - tick_length -2,temp);\n\t\t}\n\n\t\t// now draw each plot\n\t\tvar x,y;\n\t\tvar nx,ny;\n\t\tc.lineWidth = 3;\n\t\tc.lineCap = 'round';\n\t\tfor (plot = y_values.length - 1; plot >= 0; --plot) {\n\t\t    var color = probe_colors_rgb[y_values[plot][0]];\n\t\t    if (color == undefined) continue;  // no plot color (== x-axis)\n\t\t    c.strokeStyle = color;\n\t\t    var values = y_values[plot][2];\n\t\t    if (values == undefined) continue;  // no data points\n\t\t    var offset = y_values[plot][1];\n\n\t\t    x = plot_x(x_values[0]);\n\t\t    y = plot_y(values[0] + offset);\n\t\t    c.beginPath();\n\t\t    c.moveTo(x,y);\n\t\t    for (var i = 1; i < x_values.length; i++) {\n\t\t\tnx = plot_x(x_values[i]);\n\t\t\tny = plot_y(values[i] + offset);\n\t\t\tc.lineTo(nx,ny);\n\t\t\tx = nx;\n\t\t\ty = ny;\n\t\t\tif (i % 100 == 99) {\n\t\t\t    // too many lineTo's cause canvas to break\n\t\t\t    c.stroke();\n\t\t\t    c.beginPath();\n\t\t\t    c.moveTo(x,y);\n\t\t\t}\n\t\t    }\n\t\t    c.stroke();\n\t\t}\n\t    }\n\n\t    if (z_values != undefined && z_values.length > 0) {\n\t\tvar z_min = Infinity;\n\t\tvar z_max = -Infinity;\n\t\tfor (plot = z_values.length - 1; plot >= 0; --plot) {\n\t\t    var values = z_values[plot][2];\n\t\t    if (values == undefined) continue;  // no data points\n\t\t    var offset = z_values[plot][1];\n\t\t    var temp = array_min(values) + offset;\n\t\t    if (temp < z_min) z_min = temp;\n\t\t    temp = array_max(values) + offset;\n\t\t    if (temp > z_max) z_max = temp;\n\t\t}\n\t\tvar z_limits = view_limits(z_min,z_max);\n\t\tz_min = z_limits[0];\n\t\tz_max = z_limits[1];\n\t\tvar z_scale = pheight/(z_max - z_min);\n\n\t\tfunction plot_z(z) {\n\t\t    return (z_max - z)*z_scale + top_margin;\n\t\t}\n\n\t\t// draw z ticks\n\t\tc.textAlign = 'left';\n\t\tc.textBaseline = 'middle';\n\t\tc.lineWidth = 1;\n\t\tc.strokeStyle = normal_style;\n\t\tvar tick_length_half = Math.floor(tick_length/2);\n\t\tvar tick_delta = tick_length - tick_length_half;\n\t\tfor (var z = z_min; z <= z_max; z += z_limits[2]) {\n\t\t    if (Math.abs(z/z_max) < 0.001) z = 0.0; // Just 3 digits\n\t\t    var temp = plot_z(z) + 0.5;  // keep lines crisp!\n\n\t\t    // tick mark\n\t\t    c.beginPath();\n\t\t    c.moveTo(left_margin + pwidth - tick_length_half,temp);\n\t\t    c.lineTo(left_margin + pwidth + tick_delta,temp);\n\t\t    c.stroke();\n\t\t    c.fillText(engineering_notation(z,2),left_margin + pwidth + tick_length + 2,temp);\n\t\t}\n\n\t\tvar z;\n\t\tvar nz;\n\t\tc.lineWidth = 3;\n\t\tfor (plot = z_values.length - 1; plot >= 0; --plot) {\n\t\t    var color = probe_colors_rgb[z_values[plot][0]];\n\t\t    if (color == undefined) continue;  // no plot color (== x-axis)\n\t\t    c.strokeStyle = color;\n\t\t    var values = z_values[plot][2];\n\t\t    if (values == undefined) continue;  // no data points\n\t\t    var offset = z_values[plot][1];\n\n\t\t    x = plot_x(x_values[0]);\n\t\t    z = plot_z(values[0] + offset);\n\t\t    c.beginPath();\n\t\t    c.moveTo(x,z);\n\t\t    for (var i = 1; i < x_values.length; i++) {\n\t\t\tnx = plot_x(x_values[i]);\n\t\t\tnz = plot_z(values[i] + offset);\n\t\t\tc.lineTo(nx,nz);\n\t\t\tx = nx;\n\t\t\tz = nz;\n\t\t\tif (i % 100 == 99) {\n\t\t\t    // too many lineTo's cause canvas to break\n\t\t\t    c.stroke();\n\t\t\t    c.beginPath();\n\t\t\t    c.moveTo(x,z);\n\t\t\t}\n\t\t    }\n\t\t    c.stroke();\n\t\t}\n\t    }\n\n\t    // draw legends\n\t    c.font = '12pt sans-serif';\n\t    c.textAlign = 'center';\n\t    c.textBaseline = 'bottom';\n\t    c.fillText(x_legend,left_margin + pwidth/2,h - 5);\n\n\t    if (y_values != undefined && y_values.length > 0) {\n\t\tc.textBaseline = 'top';\n\t\tc.save();\n\t\tc.translate(5 ,top_margin + pheight/2);\n\t\tc.rotate(-Math.PI/2);\n\t\tc.fillText(y_legend,0,0);\n\t\tc.restore();\n\t    }\n\n\t    if (z_values != undefined && z_values.length > 0) {\n\t\tc.textBaseline = 'bottom';\n\t\tc.save();\n\t\tc.translate(w-5 ,top_margin + pheight/2);\n\t\tc.rotate(-Math.PI/2);\n\t\tc.fillText(z_legend,0,0);\n\t\tc.restore();\n\t    }\n\n\t    // save info need for interactions with the graph\n\t    canvas.x_values = x_values;\n\t    canvas.y_values = y_values;\n\t    canvas.z_values = z_values;\n\t    canvas.x_legend = x_legend;\n\t    canvas.y_legend = y_legend;\n\t    canvas.z_legend = y_legend;\n\t    canvas.x_min = x_min;\n\t    canvas.x_scale = x_scale;\n\t    canvas.y_min = y_min;\n\t    canvas.y_scale = y_scale;\n\t    canvas.z_min = z_min;\n\t    canvas.z_scale = z_scale;\n\t    canvas.left_margin = left_margin;\n\t    canvas.top_margin = top_margin;\n\t    canvas.pwidth = pwidth;\n\t    canvas.pheight = pheight;\n\t    canvas.tick_length = tick_length;\n\n\t    canvas.cursor1_x = undefined;\n\t    canvas.cursor2_x = undefined;\n\t    canvas.sch = this;\n\n\t    // do something useful when user mouses over graph\n\t    canvas.addEventListener('mousemove',graph_mouse_move,false);\n\n\t    // return our masterpiece\n\t    redraw_plot(canvas);\n\t    return canvas;\n\t}\n\n\tfunction array_max(a) {\n        var max = -Infinity;\n\t    for (var i = a.length - 1; i >= 0; --i)\n\t\tif (a[i] > max) max = a[i];\n\t    return max;\n\t}\n\n\tfunction array_min(a) {\n        var min = Infinity;\n\t    for (var i = a.length - 1; i >= 0; --i)\n\t\tif (a[i] < min) min = a[i];\n\t    return min;\n\t}\n\n\tfunction plot_cursor(c,graph,cursor_x,left_margin) {\n\t    // draw dashed vertical marker that follows mouse\n\t    var x = graph.left_margin + cursor_x;\n\t    var end_y = graph.top_margin + graph.pheight + graph.tick_length;\n\t    c.strokeStyle = grid_style;\n\t    c.lineWidth = 1;\n\t    c.beginPath();\n\t    c.dashedLineTo(x,graph.top_margin,x,end_y,cursor_pattern);\n\t    c.stroke();\n\n\t    // add x label at bottom of marker\n\t    var graph_x = cursor_x/graph.x_scale + graph.x_min;\n\t    c.font = '10pt sans-serif';\n\t    c.textAlign = 'center';\n\t    c.textBaseline = 'top';\n\t    c.fillStyle = background_style;\n\t    c.fillText('\\u2588\\u2588\\u2588\\u2588\\u2588',x,end_y);\n\t    c.fillStyle = normal_style;\n\t    c.fillText(engineering_notation(graph_x,3,false),x,end_y);\n\n\t    // compute which points marker is between\n\t    var x_values = graph.x_values;\n\t    var len = x_values.length;\n\t    var index = 0;\n\t    while (index < len && graph_x >= x_values[index]) index += 1;\n\t    var x1 = (index == 0) ? x_values[0] : x_values[index-1];\n\t    var x2 = x_values[index];\n\n\t    if (x2 != undefined) {\n\t\t// for each plot, interpolate and output value at intersection with marker\n\t\tc.textAlign = 'left';\n\t\tvar tx = graph.left_margin + left_margin;\n\t\tvar ty = graph.top_margin;\n\t\tif (graph.y_values != undefined) {\n\t\t    for (var plot = 0; plot < graph.y_values.length; plot++) {\n\t\t\tvar values = graph.y_values[plot][2];\n\t\t\tvar color = probe_colors_rgb[graph.y_values[plot][0]];\n\t\t\tif (values == undefined || color == undefined) continue;  // no data points or x-axis\n\n\t\t\t// interpolate signal value at graph_x using values[index-1] and values[index]\n\t\t\tvar y1 = (index == 0) ? values[0] : values[index-1];\n\t\t\tvar y2 = values[index];\n\t\t\tvar y = y1;\n\t\t\tif (graph_x != x1) y += (graph_x - x1)*(y2 - y1)/(x2 - x1);\n\n\t\t\t// annotate plot with value of signal at marker\n\t\t\tc.fillStyle = element_style;\n\t\t\tc.fillText('\\u2588\\u2588\\u2588\\u2588\\u2588',tx-3,ty);\n\t\t\tc.fillStyle = color;\n\t\t\tc.fillText(engineering_notation(y,3,false),tx,ty);\n\t\t\tty += 14;\n\t\t    }\n\t\t}\n\n\t\tc.textAlign = 'right';\n\t\tif (graph.z_values != undefined) {\n\t\t    var tx = graph.left_margin + graph.pwidth - left_margin;\n\t\t    var ty = graph.top_margin;\n\t\t    for (var plot = 0; plot < graph.z_values.length; plot++) {\n\t\t\tvar values = graph.z_values[plot][2];\n\t\t\tvar color = probe_colors_rgb[graph.z_values[plot][0]];\n\t\t\tif (values == undefined || color == undefined) continue;  // no data points or x-axis\n\n\t\t\t// interpolate signal value at graph_x using values[index-1] and values[index]\n\t\t\tvar z1 = (index == 0) ? values[0]: values[index-1];\n\t\t\tvar z2 = values[index];\n\t\t\tvar z = z1;\n\t\t\tif (graph_x != x1) z += (graph_x - x1)*(z2 - z1)/(x2 - x1);\n\n\t\t\t// annotate plot with value of signal at marker\n\t\t\tc.fillStyle = element_style;\n\t\t\tc.fillText('\\u2588\\u2588\\u2588\\u2588\\u2588',tx+3,ty);\n\t\t\tc.fillStyle = color;\n\t\t\tc.fillText(engineering_notation(z,3,false),tx,ty);\n\t\t\tty += 14;\n\t\t    }\n\t\t}\n\t    }\n\t}\n\n\tfunction redraw_plot(graph) {\n\t    var c = graph.getContext('2d');\n\t    c.drawImage(graph.bg_image,0,0);\n\n\t    if (graph.cursor1_x != undefined) plot_cursor(c,graph,graph.cursor1_x,4);\n\t    if (graph.cursor2_x != undefined) plot_cursor(c,graph,graph.cursor2_x,30);\n\n\t    /*\n\t    if (graph.cursor1_x != undefined) {\n\t\t// draw dashed vertical marker that follows mouse\n\t\tvar x = graph.left_margin + graph.cursor1_x;\n\t\tvar end_y = graph.top_margin + graph.pheight + graph.tick_length;\n\t\tc.strokeStyle = grid_style;\n\t\tc.lineWidth = 1;\n\t\tc.beginPath();\n\t\tc.dashedLineTo(x,graph.top_margin,x,end_y,cursor_pattern);\n\t\tc.stroke();\n\n\t\t// add x label at bottom of marker\n\t\tvar graph_x = graph.cursor1_x/graph.x_scale + graph.x_min;\n\t\tc.font = '10pt sans-serif';\n\t\tc.textAlign = 'center';\n\t\tc.textBaseline = 'top';\n\t\tc.fillStyle = background_style;\n\t\tc.fillText('\\u2588\\u2588\\u2588\\u2588\\u2588',x,end_y);\n\t\tc.fillStyle = normal_style;\n\t\tc.fillText(engineering_notation(graph_x,3,false),x,end_y);\n\n\t\t// compute which points marker is between\n\t\tvar x_values = graph.x_values;\n\t\tvar len = x_values.length;\n\t\tvar index = 0;\n\t\twhile (index < len && graph_x >= x_values[index]) index += 1;\n\t\tvar x1 = (index == 0) ? x_values[0] : x_values[index-1];\n\t\tvar x2 = x_values[index];\n\n\t\tif (x2 != undefined) {\n\t\t    // for each plot, interpolate and output value at intersection with marker\n\t\t    c.textAlign = 'left';\n\t\t    var tx = graph.left_margin + 4;\n\t\t    var ty = graph.top_margin;\n\t\t    for (var plot = 0; plot < graph.y_values.length; plot++) {\n\t\t\tvar values = graph.y_values[plot][1];\n\n\t\t\t// interpolate signal value at graph_x using values[index-1] and values[index]\n\t\t\tvar y1 = (index == 0) ? values[0] : values[index-1];\n\t\t\tvar y2 = values[index];\n\t\t\tvar y = y1;\n\t\t\tif (graph_x != x1) y += (graph_x - x1)*(y2 - y1)/(x2 - x1);\n\n\t\t\t// annotate plot with value of signal at marker\n\t\t\tc.fillStyle = element_style;\n\t\t\tc.fillText('\\u2588\\u2588\\u2588\\u2588\\u2588',tx-3,ty);\n\t\t\tc.fillStyle = probe_colors_rgb[graph.y_values[plot][0]];\n\t\t\tc.fillText(engineering_notation(y,3,false),tx,ty);\n\t\t\tty += 14;\n\t\t    }\n\t\t}\n\t    }\n\t    */\n\t}\n\n\tfunction graph_mouse_move(event) {\n\t    if (!event) event = window.event;\n\t    var g = (window.event) ? event.srcElement : event.target;\n\n\t    g.relMouseCoords(event);\n\t    // not sure yet where the 3,-3 offset correction comes from (borders? padding?)\n\t    var gx = g.mouse_x - g.left_margin - 3;\n\t    var gy = g.pheight - (g.mouse_y - g.top_margin) + 3;\n\t    if (gx >= 0 && gx <= g.pwidth && gy >=0 && gy <= g.pheight) {\n\t\t//g.sch.message('button: '+event.button+', which: '+event.which);\n\t\tg.cursor1_x = gx;\n\t    } else {\n\t\tg.cursor1_x = undefined;\n\t\tg.cursor2_x = undefined;\n\t    }\n\n\t    redraw_plot(g);\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Parts bin\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// one instance will be created for each part in the parts bin\n\tfunction Part(sch) {\n\t    this.sch = sch;\n\t    this.component = undefined;\n\t    this.selected = false;\n\n\t    // set up canvas\n\t    this.canvas = document.createElement('canvas');\n\t    this.canvas.style.borderStyle = 'solid';\n\t    this.canvas.style.borderWidth = '1px';\n\t    this.canvas.style.borderColor = background_style;\n\t    //this.canvas.style.position = 'absolute';\n\t    this.canvas.style.cursor = 'default';\n\t    this.canvas.height = part_w;\n\t    this.canvas.width = part_h;\n\t    this.canvas.xpart = this;\n\n\t    this.canvas.addEventListener('mouseover',part_enter,false);\n\t    this.canvas.addEventListener('mouseout',part_leave,false);\n\t    this.canvas.addEventListener('mousedown',part_mouse_down,false);\n\t    this.canvas.addEventListener('mouseup',part_mouse_up,false);\n\n\t    // make the part \"clickable\" by registering a dummy click handler\n\t    // this should make things work on the iPad\n\t    this.canvas.addEventListener('click',function(){},false);\n\t}\n\n\tPart.prototype.set_location = function(left,top) {\n\t    this.canvas.style.left = left + 'px';\n\t    this.canvas.style.top = top + 'px';\n\t}\n\n\tPart.prototype.right = function() {\n\t    return this.canvas.offsetLeft + this.canvas.offsetWidth;\n\t}\n\n\tPart.prototype.bottom = function() {\n\t    return this.canvas.offsetTop + this.canvas.offsetHeight;\n\t}\n\n\tPart.prototype.set_component = function(component,tip) {\n\t    component.sch = this;\n\t    this.component = component;\n\t    this.tip = tip;\n\n\t    // figure out scaling and centering of parts icon\n\t    var b = component.bounding_box;\n\t    var dx = b[2] - b[0];\n\t    var dy = b[3] - b[1];\n\t    this.scale = 0.8; //Math.min(part_w/(1.2*dx),part_h/(1.2*dy));\n\t    this.origin_x = b[0] + dx/2.0 - part_w/(2.0*this.scale);\n\t    this.origin_y = b[1] + dy/2.0 - part_h/(2.0*this.scale);\n\n\t    this.redraw();\n\t}\n\n\tPart.prototype.redraw = function(part) {\n\t    var c = this.canvas.getContext('2d');\n\n\t    // paint background color\n\t    c.fillStyle = this.selected ? selected_style : background_style;\n\t    c.fillRect(0,0,part_w,part_h);\n\n\t    if (this.component) this.component.draw(c);\n\t}\n\n\tPart.prototype.select = function(which) {\n\t    this.selected = which;\n\t    this.redraw();\n\t}\n\n\tPart.prototype.update_connection_point = function(cp,old_location) {\n\t    // no connection points in the parts bin\n\t}\n\n\tPart.prototype.moveTo = function(c,x,y) {\n\t    c.moveTo((x - this.origin_x) * this.scale,(y - this.origin_y) * this.scale);\n\t}\n\n\tPart.prototype.lineTo = function(c,x,y) {\n\t    c.lineTo((x - this.origin_x) * this.scale,(y - this.origin_y) * this.scale);\n\t}\n\n\tPart.prototype.draw_line = function(c,x1,y1,x2,y2,width) {\n\t    c.lineWidth = width*this.scale;\n\t    c.beginPath();\n\t    c.moveTo((x1 - this.origin_x) * this.scale,(y1 - this.origin_y) * this.scale);\n\t    c.lineTo((x2 - this.origin_x) * this.scale,(y2 - this.origin_y) * this.scale);\n\t    c.stroke();\n\t}\n\n\tPart.prototype.draw_arc = function(c,x,y,radius,start_radians,end_radians,anticlockwise,width,filled) {\n\t    c.lineWidth = width*this.scale;\n\t    c.beginPath();\n\t    c.arc((x - this.origin_x)*this.scale,(y - this.origin_y)*this.scale,radius*this.scale,\n\t\t  start_radians,end_radians,anticlockwise);\n\t    if (filled) c.fill();\n\t    else c.stroke();\n\t}\n\n\tPart.prototype.draw_text = function(c,text,x,y,size) {\n\t    // no text displayed for the parts icon\n\t}\n\n\tfunction part_enter(event) {\n\t    if (!event) event = window.event;\n\t    var canvas = (window.event) ? event.srcElement : event.target;\n\t    var part = canvas.xpart;\n\n\t    // avoid Chrome bug that changes to text cursor whenever\n\t    // drag starts.  We'll restore the default handler at\n\t    // the appropriate point so behavior in other parts of\n\t    // the document are unaffected.\n\t    //part.sch.saved_onselectstart = document.onselectstart;\n\t    //document.onselectstart = function () { return false; };\n\n\t    canvas.style.borderColor = normal_style;\n\t    part.sch.message(part.tip+': drag onto diagram to insert');\n\t    return false;\n\t}\n\n\tfunction part_leave(event) {\n\t    if (!event) event = window.event;\n\t    var canvas = (window.event) ? event.srcElement : event.target;\n\t    var part = canvas.xpart;\n\n\t    if (typeof part.sch.new_part == 'undefined') {\n\t\t// leaving with no part selected?  revert handler\n\t\t//document.onselectstart = part.sch.saved_onselectstart;\n\t    }\n\n\t    canvas.style.borderColor = background_style;\n\t    part.sch.message('');\n\t    return false;\n\t}\n\n\tfunction part_mouse_down(event) {\n\t    if (!event) event = window.event;\n\t    var part = (window.event) ? event.srcElement.xpart : event.target.xpart;\n\n\t    part.select(true);\n\t    part.sch.new_part = part;\n\t    return false;\n\t}\n\n\tfunction part_mouse_up(event) {\n\t    if (!event) event = window.event;\n\t    var part = (window.event) ? event.srcElement.xpart : event.target.xpart;\n\n\t    part.select(false);\n\t    part.sch.new_part = undefined;\n\t    return false;\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Rectangle helper functions\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\t// rect is an array of the form [left,top,right,bottom]\n\n\t// ensure left < right, top < bottom\n\tfunction canonicalize(r) {\n\t    var temp;\n\n\t    // canonicalize bounding box\n\t    if (r[0] > r[2]) {\n\t\ttemp = r[0];\n\t\tr[0] = r[2];\n\t\tr[2] = temp;\n\t    }\n\t    if (r[1] > r[3]) {\n\t\ttemp = r[1];\n\t\tr[1] = r[3];\n\t\tr[3] = temp;\n\t    }\n\t}\n\n\tfunction between(x,x1,x2) {\n\t    return x1 <= x && x <= x2;\n\t}\n\n\tfunction inside(rect,x,y) {\n\t    return between(x,rect[0],rect[2]) && between(y,rect[1],rect[3]);\n\t}\n\n\t// only works for manhattan rectangles\n\tfunction intersect(r1,r2) {\n\t    // look for non-intersection, negate result\n\t    var result = !(r2[0] > r1[2] ||\n\t\t\t   r2[2] < r1[0] ||\n\t\t\t   r2[1] > r1[3] ||\n\t\t\t   r2[3] < r1[1]);\n\n\t    // if I try to return the above expression, javascript returns undefined!!!\n\t    return result;\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Component base class\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Component(type,x,y,rotation) {\n\t    this.sch = undefined;\n\t    this.type = type;\n\t    this.x = x;\n\t    this.y = y;\n\t    this.rotation = rotation;\n\t    this.selected = false;\n        this.properties = [];\n\t    this.bounding_box = [0,0,0,0];   // in device coords [left,top,right,bottom]\n\t    this.bbox = this.bounding_box;   // in absolute coords\n\t    this.connections = [];\n\t}\n\n\tComponent.prototype.json = function(index) {\n\t    this.properties['_json_'] = index; // remember where we are in the JSON list\n\n\t    var props = {};\n\t    for (var p in this.properties) props[p] = this.properties[p];\n\n\t    var conns = [];\n\t    for (var i = 0; i < this.connections.length; i++)\n\t\tconns.push(this.connections[i].json());\n\n\t    var json = [this.type,[this.x, this.y, this.rotation],props,conns];\n\t    return json;\n\t}\n\n\tComponent.prototype.add_connection = function(offset_x,offset_y) {\n\t    this.connections.push(new ConnectionPoint(this,offset_x,offset_y));\n\t}\n\n\tComponent.prototype.update_coords = function() {\n\t    var x = this.x;\n\t    var y = this.y;\n\n\t    // update bbox\n\t    var b = this.bounding_box;\n\t    this.bbox[0] = this.transform_x(b[0],b[1]) + x;\n\t    this.bbox[1] = this.transform_y(b[0],b[1]) + y;\n\t    this.bbox[2] = this.transform_x(b[2],b[3]) + x;\n\t    this.bbox[3] = this.transform_y(b[2],b[3]) + y;\n\t    canonicalize(this.bbox);\n\n\t    // update connections\n\t    for (var i = this.connections.length - 1; i >= 0; --i)\n\t\tthis.connections[i].update_location();\n\t}\n\n\tComponent.prototype.rotate = function(amount) {\n\t    var old_rotation = this.rotation;\n\t    this.rotation = (this.rotation + amount) % 8;\n\t    this.update_coords();\n\n\t    // create an undoable edit record here\n\t    // using old_rotation\n\t}\n\n\tComponent.prototype.move_begin = function() {\n\t    // remember where we started this move\n\t    this.move_x = this.x;\n\t    this.move_y = this.y;\n\t}\n\n\tComponent.prototype.move = function(dx,dy) {\n\t    // update coordinates\n\t    this.x += dx;\n\t    this.y += dy;\n\t    this.update_coords();\n\t}\n\n\tComponent.prototype.move_end = function() {\n\t    var dx = this.x - this.move_x;\n\t    var dy = this.y - this.move_y;\n\n\t    if (dx != 0 || dy != 0) {\n\t\t// create an undoable edit record here\n\n\t\tthis.sch.check_wires(this);\n\t    }\n\t}\n\n\tComponent.prototype.add = function(sch) {\n\t    this.sch = sch;   // we now belong to a schematic!\n\t    sch.add_component(this);\n\t    this.update_coords();\n\t}\n\n\tComponent.prototype.remove = function() {\n\t    // remove connection points from schematic\n\t    for (var i = this.connections.length - 1; i >= 0; --i) {\n\t\tvar cp = this.connections[i];\n\t\tthis.sch.remove_connection_point(cp,cp.location);\n\t    }\n\n\t    // remove component from schematic\n\t    this.sch.remove_component(this);\n\t    this.sch = undefined;\n\n\t    // create an undoable edit record here\n\t}\n\n\tComponent.prototype.transform_x = function(x,y) {\n\t    var rot = this.rotation;\n\t    if (rot == 0 || rot == 6) return x;\n\t    else if (rot == 1 || rot == 5) return -y;\n\t    else if (rot == 2 || rot == 4) return -x;\n\t    else return y;\n\t}\n\n\tComponent.prototype.transform_y = function(x,y) {\n\t    var rot = this.rotation;\n\t    if (rot == 1 || rot == 7) return x;\n\t    else if (rot == 2 || rot == 6) return -y;\n\t    else if (rot == 3 || rot == 5) return -x;\n\t    else return y;\n\t}\n\n\tComponent.prototype.moveTo = function(c,x,y) {\n\t    var nx = this.transform_x(x,y) + this.x;\n\t    var ny = this.transform_y(x,y) + this.y;\n\t    this.sch.moveTo(c,nx,ny);\n\t}\n\n\tComponent.prototype.lineTo = function(c,x,y) {\n\t    var nx = this.transform_x(x,y) + this.x;\n\t    var ny = this.transform_y(x,y) + this.y;\n\t    this.sch.lineTo(c,nx,ny);\n\t}\n\n\tComponent.prototype.draw_line = function(c,x1,y1,x2,y2) {\n\t    c.strokeStyle = this.selected ? selected_style :\n                            this.type == 'w' ? normal_style : component_style;\n\t    var nx1 = this.transform_x(x1,y1) + this.x;\n\t    var ny1 = this.transform_y(x1,y1) + this.y;\n\t    var nx2 = this.transform_x(x2,y2) + this.x;\n\t    var ny2 = this.transform_y(x2,y2) + this.y;\n\t    this.sch.draw_line(c,nx1,ny1,nx2,ny2,1);\n\t}\n\n\tComponent.prototype.draw_circle = function(c,x,y,radius,filled) {\n\t    if (filled) c.fillStyle = this.selected ? selected_style : normal_style;\n\t    else c.strokeStyle = this.selected ? selected_style :\n\t\t     this.type == 'w' ? normal_style : component_style;\n\t    var nx = this.transform_x(x,y) + this.x;\n\t    var ny = this.transform_y(x,y) + this.y;\n\n\t    this.sch.draw_arc(c,nx,ny,radius,0,2*Math.PI,false,1,filled);\n\t}\n\n    var rot_angle = [\n\t\t     0.0,\t\t// NORTH (identity)\n\t\t     Math.PI/2,\t// EAST (rot270)\n\t\t     Math.PI,\t// SOUTH (rot180)\n\t\t     3*Math.PI/2,  // WEST (rot90)\n\t\t     0.0,\t\t// RNORTH (negy)\n\t\t     Math.PI/2,\t// REAST (int-neg)\n\t\t     Math.PI,\t// RSOUTH (negx)\n\t\t     3*Math.PI/2,\t// RWEST (int-pos)\n     ];\n\n\tComponent.prototype.draw_arc = function(c,x,y,radius,start_radians,end_radians) {\n\t    c.strokeStyle = this.selected ? selected_style :\n                            this.type == 'w' ? normal_style : component_style;\n\t    var nx = this.transform_x(x,y) + this.x;\n\t    var ny = this.transform_y(x,y) + this.y;\n\t    this.sch.draw_arc(c,nx,ny,radius,\n\t\t\t      start_radians+rot_angle[this.rotation],end_radians+rot_angle[this.rotation],\n\t\t\t      false,1,false);\n\t}\n\n\tComponent.prototype.draw = function(c) {\n\t    /*\n\t    for (var i = this.connections.length - 1; i >= 0; --i) {\n\t\tvar cp = this.connections[i];\n\t\tcp.draw_x(c);\n\t    }\n\t    */\n\t}\n\n\t// result of rotating an alignment [rot*9 + align]\n    var aOrient = [\n\t\t   0, 1, 2, 3, 4, 5, 6, 7, 8,\t\t// NORTH (identity)\n\t\t   2, 5, 8, 1, 4, 7, 0, 3, 6, \t\t// EAST (rot270)\n\t\t   8, 7, 6, 5, 4, 3, 2, 1, 0,\t\t// SOUTH (rot180)\n\t\t   6, 3, 0, 7, 4, 1, 8, 5, 3,\t\t// WEST (rot90)\n\t\t   2, 1, 0, 5, 4, 3, 8, 7, 6,\t\t// RNORTH (negy)\n\t\t   8, 5, 2, 7, 4, 1, 6, 3, 0, \t\t// REAST (int-neg)\n\t\t   6, 7, 8, 3, 4, 5, 0, 1, 2,\t\t// RSOUTH (negx)\n\t\t   0, 3, 6, 1, 4, 7, 2, 5, 8\t\t// RWEST (int-pos)\n\t\t   ];\n\n    var textAlign = [\n\t\t     'left', 'center', 'right',\n\t\t     'left', 'center', 'right',\n\t\t     'left', 'center', 'right'\n\t\t     ];\n\n    var textBaseline = [\n\t\t\t'top', 'top', 'top',\n\t\t\t'middle', 'middle', 'middle',\n\t\t\t'bottom', 'bottom', 'bottom'\n\t\t\t];\n\n\tComponent.prototype.draw_text = function(c,text,x,y,alignment,size,fill) {\n\t    var a = aOrient[this.rotation*9 + alignment];\n\t    c.textAlign = textAlign[a];\n\t    c.textBaseline = textBaseline[a];\n\t    if (fill == undefined)\n\t\tc.fillStyle = this.selected ? selected_style : normal_style;\n\t    else\n\t\tc.fillStyle = fill;\n\t    this.sch.draw_text(c,text,\n\t\t\t       this.transform_x(x,y) + this.x,\n\t\t\t       this.transform_y(x,y) + this.y,\n\t\t\t       size);\n\t}\n\n\tComponent.prototype.set_select = function(which) {\n\t    if (which != this.selected) {\n\t\tthis.selected = which;\n\t\t// create an undoable edit record here\n\t    }\n\t}\n\n\tComponent.prototype.select = function(x,y,shiftKey) {\n\t    this.was_previously_selected = this.selected;\n\t    if (this.near(x,y)) {\n\t\tthis.set_select(shiftKey ? !this.selected : true);\n\t\treturn true;\n\t    } else return false;\n\t}\n\n\tComponent.prototype.select_rect = function(s) {\n\t    this.was_previously_selected = this.selected;\n\t    if (intersect(this.bbox,s))\n\t\tthis.set_select(true);\n\t}\n\n\t// if connection point of component c bisects the\n\t// wire represented by this compononent, return that\n\t// connection point.  Otherwise return null.\n\tComponent.prototype.bisect = function(c) {\n\t    return null;\n\t}\n\n\t// does mouse click fall on this component?\n\tComponent.prototype.near = function(x,y) {\n\t    return inside(this.bbox,x,y);\n\t}\n\n\tComponent.prototype.edit_properties = function(x,y) {\n\t    if (this.near(x,y)) {\n\t\t// make an <input> widget for each property\n        var fields = [];\n\t\tfor (var i in this.properties)\n\t\t    // underscore at beginning of property name => system property\n\t\t    if (i.charAt(0) != '_')\n\t\t\tfields[i] = build_input('text',10,this.properties[i]);\n\n\t\tvar content = build_table(fields);\n\t\tcontent.fields = fields;\n\t\tcontent.component = this;\n\n\t\tthis.sch.dialog('Edit Properties',content,function(content) {\n\t\t\tfor (var i in content.fields)\n\t\t\t    content.component.properties[i] = content.fields[i].value;\n\t\t\tcontent.component.sch.redraw_background();\n\t\t    });\n\t\treturn true;\n\t    } else return false;\n\t}\n\n\tComponent.prototype.clear_labels = function() {\n\t    for (var i = this.connections.length - 1; i >=0; --i) {\n\t\tthis.connections[i].clear_label();\n\t    }\n\t}\n\n\t// default action: don't propagate label\n\tComponent.prototype.propagate_label = function(label) {\n\t}\n\n\t// give components a chance to generate default labels for their connection(s)\n\t// default action: do nothing\n\tComponent.prototype.add_default_labels = function() {\n\t}\n\n\t// component should generate labels for all unlabeled connections\n\tComponent.prototype.label_connections = function() {\n\t    for (var i = this.connections.length - 1; i >=0; --i) {\n\t\tvar cp = this.connections[i];\n\t\tif (!cp.label)\n\t\t    cp.propagate_label(this.sch.get_next_label());\n\t    }\n\t}\n\n\t// default behavior: no probe info\n\tComponent.prototype.probe_info = function() { return undefined; }\n\n\t// default behavior: nothing to display for DC analysis\n\tComponent.prototype.display_current = function(c,vmap) {\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Connection point\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n    var connection_point_radius = 2;\n\n\tfunction ConnectionPoint(parent,x,y) {\n\t    this.parent = parent;\n\t    this.offset_x = x;\n\t    this.offset_y = y;\n\t    this.location = '';\n\t    this.update_location();\n\t    this.label = undefined;\n\t}\n\n\tConnectionPoint.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate('<ConnectionPoint ({offset_x},{offset_y}) {parent}>',\n\t    {\n\t\toffset_x: this.offset_x,\n\t\toffset_y: this.offset_y,\n\t\tparent: edx.HtmlUtils.ensureHTML(this.parent.toString())\n\t    });\n\t}\n\n\n\tConnectionPoint.prototype.json = function() {\n\t    return this.label;\n\t}\n\n\tConnectionPoint.prototype.clear_label = function() {\n\t    this.label = undefined;\n\t}\n\n\tConnectionPoint.prototype.propagate_label = function(label) {\n\t    // should we check if existing label is the same?  it should be...\n\n\t    if (this.label === undefined) {\n\t\t// label this connection point\n\t\tthis.label = label;\n\n\t\t// propagate label to coincident connection points\n\t\tthis.parent.sch.propagate_label(label,this.location);\n\n\t\t// possibly label other cp's for this device?\n\t\tthis.parent.propagate_label(label);\n\t    } else if (this.label != '0' && label != '0' && this.label != label)\n\t\talert(\"Node has two conflicting labels: \"+this.label+\", \"+label);\n\t}\n\n\tConnectionPoint.prototype.update_location = function() {\n\t    // update location string which we use as a key to find coincident connection points\n\t    var old_location = this.location;\n\t    var parent = this.parent;\n\t    var nx = parent.transform_x(this.offset_x,this.offset_y) + parent.x;\n\t    var ny = parent.transform_y(this.offset_x,this.offset_y) + parent.y;\n\t    this.x = nx;\n\t    this.y = ny;\n\t    this.location = nx + ',' + ny;\n\n\t    // add ourselves to the connection list for the new location\n\t    if (parent.sch)\n\t\tparent.sch.update_connection_point(this,old_location);\n\t}\n\n\tConnectionPoint.prototype.coincident = function(x,y) {\n\t    return this.x==x && this.y==y;\n\t}\n\n\tConnectionPoint.prototype.draw = function(c,n) {\n\t    if (n != 2)\n\t\tthis.parent.draw_circle(c,this.offset_x,this.offset_y,connection_point_radius,n > 2);\n\t}\n\n\tConnectionPoint.prototype.draw_x = function(c) {\n\t    this.parent.draw_line(c,this.offset_x-2,this.offset_y-2,this.offset_x+2,this.offset_y+2,grid_style);\n\t    this.parent.draw_line(c,this.offset_x+2,this.offset_y-2,this.offset_x-2,this.offset_y+2,grid_style);\n\t}\n\n\tConnectionPoint.prototype.display_voltage = function(c,vmap) {\n\t    var v = vmap[this.label];\n\t    if (v != undefined) {\n\t\tvar label = v.toFixed(2) + 'V';\n\n\t\t// first draw some solid blocks in the background\n\t\tc.globalAlpha = 0.85;\n\t\tthis.parent.draw_text(c,'\\u2588\\u2588\\u2588',this.offset_x,this.offset_y,\n\t\t\t\t      4,annotation_size,element_style);\n\t\tc.globalAlpha = 1.0;\n\n\t\t// display the node voltage at this connection point\n\t\tthis.parent.draw_text(c,label,this.offset_x,this.offset_y,\n\t\t\t\t      4,annotation_size,annotation_style);\n\n\t\t// only display each node voltage once\n\t\tdelete vmap[this.label];\n\t    }\n\t}\n\n\t// see if three connection points are collinear\n\tfunction collinear(p1,p2,p3) {\n\t    // from http://mathworld.wolfram.com/Collinear.html\n\t    var area = p1.x*(p2.y - p3.y) + p2.x*(p3.y - p1.y) + p3.x*(p1.y - p2.y);\n\t    return area == 0;\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Wire\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tvar near_distance = 2;   // how close to wire counts as \"near by\"\n\n\tfunction Wire(x1,y1,x2,y2) {\n\t    // arbitrarily call x1,y1 the origin\n\t    Component.call(this,'w',x1,y1,0);\n\t    this.dx = x2 - x1;\n\t    this.dy = y2 - y1;\n\t    this.add_connection(0,0);\n\t    this.add_connection(this.dx,this.dy);\n\n\t    // compute bounding box (expanded slightly)\n\t    var r = [0,0,this.dx,this.dy];\n\t    canonicalize(r);\n\t    r[0] -= near_distance;\n\t    r[1] -= near_distance;\n\t    r[2] += near_distance;\n\t    r[3] += near_distance;\n\t    this.bounding_box = r;\n\t    this.update_coords();    // update bbox\n\n\t    // used in selection calculations\n\t    this.len = Math.sqrt(this.dx*this.dx + this.dy*this.dy);\n\t}\n\tWire.prototype = new Component();\n\tWire.prototype.constructor = Wire;\n\n        Wire.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Wire ({x},{y}) ({x_plus_dx},{y_plus_dy})>',\n\t\t{\n\t\t    x: this.x,\n\t\t    y: this.y,\n\t\t    x_plus_dx: this.x + this.dx,\n\t\t    y_plus_dy: this.y + this.dy\n\t\t});\n\t}\n\n\t// return connection point at other end of wire from specified cp\n\tWire.prototype.other_end = function(cp) {\n\t    if (cp == this.connections[0]) return this.connections[1];\n\t    else if (cp == this.connections[1]) return this.connections[0];\n\t    else return undefined;\n\t}\n\n\tWire.prototype.json = function(index) {\n\t    var json = ['w',[this.x, this.y, this.x+this.dx, this.y+this.dy]];\n\t    return json;\n\t}\n\n\tWire.prototype.draw = function(c) {\n\t    this.draw_line(c,0,0,this.dx,this.dy);\n\t}\n\n\tWire.prototype.clone = function(x,y) {\n\t    return new Wire(x,y,x+this.dx,y+this.dy);\n\t}\n\n\tWire.prototype.near = function(x,y) {\n\t    // crude check: (x,y) within expanded bounding box of wire\n\t    if (inside(this.bbox,x,y)) {\n\t\t// compute distance between x,y and nearst point on line\n\t\t// http://www.allegro.cc/forums/thread/589720\n\t\tvar D = Math.abs((x - this.x)*this.dy - (y - this.y)*this.dx)/this.len;\n\t\tif (D <= near_distance) return true;\n\t    }\n\t    return false;\n\t}\n\n\t// selection rectangle selects wire only if it includes\n\t// one of the end points\n\tWire.prototype.select_rect = function(s) {\n\t    this.was_previously_selected = this.selected;\n\t    if (inside(s,this.x,this.y) || inside(s,this.x+this.dx,this.y+this.dy))\n\t\tthis.set_select(true);\n\t}\n\n\t// if connection point cp bisects the\n\t// wire represented by this compononent, return true\n\tWire.prototype.bisect_cp = function(cp) {\n\t    var x = cp.x;\n\t    var y = cp.y;\n\n\t    // crude check: (x,y) within expanded bounding box of wire\n\t    if (inside(this.bbox,x,y)) {\n\t\t// compute distance between x,y and nearst point on line\n\t\t// http://www.allegro.cc/forums/thread/589720\n\t\tvar D = Math.abs((x - this.x)*this.dy - (y - this.y)*this.dx)/this.len;\n\t\t// final check: ensure point isn't an end point of the wire\n\t\tif (D < 1 && !this.connections[0].coincident(x,y) && !this.connections[1].coincident(x,y))\n\t\t    return true;\n\t    }\n\t    return false;\n\t}\n\n\t// if some connection point of component c bisects the\n\t// wire represented by this compononent, return that\n\t// connection point.  Otherwise return null.\n\tWire.prototype.bisect = function(c) {\n\t    if (c == undefined) return;\n\t    for (var i = c.connections.length - 1; i >= 0; --i) {\n\t\tvar cp = c.connections[i];\n\t\tif (this.bisect_cp(cp)) return cp;\n\t    }\n\t    return null;\n\t}\n\n\tWire.prototype.move_end = function() {\n\t    // look for wires bisected by this wire\n\t    this.sch.check_wires(this);\n\n\t    // look for connection points that might bisect us\n\t    this.sch.check_connection_points(this);\n\t}\n\n\t// wires \"conduct\" their label to the other end\n\tWire.prototype.propagate_label = function(label) {\n\t    // don't worry about relabeling a cp, it won't recurse!\n\t    this.connections[0].propagate_label(label);\n\t    this.connections[1].propagate_label(label);\n\t}\n\n\t// Wires have no properties to edit\n\tWire.prototype.edit_properties = function(x,y) {\n\t    return false;\n\t}\n\n\t// some actual component will start the labeling of electrical nodes,\n\t// so do nothing here\n\tWire.prototype.label_connections = function() {\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Ground\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Ground(x,y,rotation) {\n\t    Component.call(this,'g',x,y,rotation);\n\t    this.add_connection(0,0);\n\t    this.bounding_box = [-6,0,6,8];\n\t    this.update_coords();\n\t}\n\tGround.prototype = new Component();\n\tGround.prototype.constructor = Ground;\n\n\tGround.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Ground ({x},{y})>',\n\t\t{\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tGround.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,8);\n\t    this.draw_line(c,-6,8,6,8);\n\t}\n\n\tGround.prototype.clone = function(x,y) {\n\t    return new Ground(x,y,this.rotation);\n\t}\n\n\t// Grounds no properties to edit\n\tGround.prototype.edit_properties = function(x,y) {\n\t    return false;\n\t}\n\n\t// give components a chance to generate a label for their connection(s)\n\t// default action: do nothing\n\tGround.prototype.add_default_labels = function() {\n\t    this.connections[0].propagate_label('0');   // canonical label for GND node\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Label\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Label(x,y,rotation,label) {\n\t    Component.call(this,'L',x,y,rotation);\n\t    this.properties['label'] = label ? label : '???';\n\t    this.add_connection(0,0);\n\t    this.bounding_box = [-2,0,2,8];\n\t    this.update_coords();\n\t}\n\tLabel.prototype = new Component();\n\tLabel.prototype.constructor = Label;\n\n\tLabel.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Label ({x},{y})>',\n\t\t{\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tLabel.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,8);\n\t    this.draw_text(c,this.properties['label'],0,9,1,property_size);\n\t}\n\n\tLabel.prototype.clone = function(x,y) {\n\t    return new Label(x,y,this.rotation,this.properties['label']);\n\t}\n\n\t// give components a chance to generate a label for their connection(s)\n\t// default action: do nothing\n\tLabel.prototype.add_default_labels = function() {\n\t    this.connections[0].propagate_label(this.properties['label']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Voltage Probe\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n    var probe_colors = ['red','green','blue','cyan','magenta','yellow','black','x-axis'];\n    var probe_colors_rgb = {\n\t    'red': 'rgb(255,64,64)',\n\t    'green': 'rgb(64,255,64)',\n\t    'blue': 'rgb(64,64,255)',\n\t    'cyan': 'rgb(64,255,255)',\n\t    'magenta' : 'rgb(255,64,255)',\n\t    'yellow': 'rgb(255,255,64)',\n\t    'black': 'rgb(0,0,0)',\n\t    'x-axis': undefined\n\t};\n\n\tfunction Probe(x,y,rotation,color,offset) {\n\t    Component.call(this,'s',x,y,rotation);\n\t    this.add_connection(0,0);\n\t    this.properties['color'] = color ? color : 'cyan';\n\t    this.properties['offset'] = (offset==undefined || offset=='') ? '0' : offset;\n\t    this.bounding_box = [0,0,27,-21];\n\t    this.update_coords();\n\t}\n\tProbe.prototype = new Component();\n\tProbe.prototype.constructor = Probe;\n\n\tProbe.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Probe ({x},{y})>',\n\t\t{\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tProbe.prototype.draw = function(c) {\n\t    // draw outline\n\t    this.draw_line(c,0,0,4,-4);\n\t    this.draw_line(c,2,-6,6,-2);\n\t    this.draw_line(c,2,-6,17,-21);\n\t    this.draw_line(c,6,-2,21,-17);\n\t    this.draw_line(c,17,-21,21,-17);\n\t    this.draw_arc(c,19,-11,8,3*Math.PI/2,0);\n\n\t    // fill body with plot color\n\t    var color = probe_colors_rgb[this.properties['color']];\n\t    if (color != undefined) {\n\t\tc.fillStyle = color;\n\t\tc.beginPath();\n\t\tthis.moveTo(c,2,-6);\n\t\tthis.lineTo(c,6,-2);\n\t\tthis.lineTo(c,21,-17);\n\t\tthis.lineTo(c,17,-21);\n\t\tthis.lineTo(c,2,-6);\n\t\tc.fill();\n\t    } else {\n\t\tthis.draw_text(c,this.properties['color'],27,-11,1,property_size);\n\t    }\n\t}\n\n\tProbe.prototype.clone = function(x,y) {\n\t    return new Probe(x,y,this.rotation,this.properties['color'],this.properties['offset']);\n\t}\n\n\tProbe.prototype.edit_properties = function(x,y) {\n\t    if (inside(this.bbox,x,y)) {\n        var fields = [];\n\t\tfields['Plot color'] = build_select(probe_colors,this.properties['color']);\n\t\tfields['Plot offset'] = build_input('text',10,this.properties['offset']);\n\n\t\tvar content = build_table(fields);\n\t\tcontent.fields = fields;\n\t\tcontent.component = this;\n\n\t\tthis.sch.dialog('Edit Properties',content,function(content) {\n\t\t\tvar color_choice = content.fields['Plot color'];\n\t\t\tcontent.component.properties['color'] = probe_colors[color_choice.selectedIndex];\n\t\t\tcontent.component.properties['offset'] = content.fields['Plot offset'].value;\n\t\t\tcontent.component.sch.redraw_background();\n\t\t    });\n\t\treturn true;\n\t    } else return false;\n\t}\n\n\t// return [color, node_label, offset, type] for this probe\n\tProbe.prototype.probe_info = function() {\n\t    var color = this.properties['color'];\n\t    var offset = this.properties['offset'];\n\t    if (offset==undefined || offset==\"\") offset = '0';\n\t    return [color,this.connections[0].label,offset,'voltage'];\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Ammeter Probe\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Ammeter(x,y,rotation,color,offset) {\n\t    Component.call(this,'a',x,y,rotation);\n\t    this.add_connection(0,0);   // pos\n\t    this.add_connection(16,0);   // neg\n\t    this.properties['color'] = color ? color : 'magenta';\n\t    this.properties['offset'] = (offset==undefined || offset=='') ? '0' : offset;\n\t    this.bounding_box = [-3,0,16,3];\n\t    this.update_coords();\n\t}\n\tAmmeter.prototype = new Component();\n\tAmmeter.prototype.constructor = Ammeter;\n\n\tAmmeter.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Ammeter ({x},{y})>',\n\t\t{\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tAmmeter.prototype.move_end = function() {\n\t    Component.prototype.move_end.call(this);   // do the normal processing\n\n\t    // special for current probes: see if probe has been placed\n\t    // in the middle of wire, creating three wire segments one\n\t    // of which is shorting the two terminals of the probe.  If\n\t    // so, auto remove the shorting segment.\n\t    var e1 = this.connections[0].location;\n\t    var e2 = this.connections[1].location;\n\t    var cplist = this.sch.find_connections(this.connections[0]);\n\t    for (var i = cplist.length - 1; i >= 0; --i) {\n\t\tvar c = cplist[i].parent;  // a component connected to ammeter terminal\n\t\t// look for a wire whose end points match those of the ammeter\n\t\tif (c.type == 'w') {\n\t\t    var c_e1 = c.connections[0].location;\n\t\t    var c_e2 = c.connections[1].location;\n\t\t    if ((e1 == c_e1 && c2 == c_e2) || (e1 == c_e2 && e2 == c_e1)) {\n\t\t\tc.remove();\n\t\t\tbreak;\n\t\t    }\n\t\t}\n\t    }\n\t}\n\n\tAmmeter.prototype.draw = function(c) {\n\t    this.draw_line(c,0,0,16,0);\n\n\t    // draw chevron in probe color\n\t    c.strokeStyle = probe_colors_rgb[this.properties['color']];\n\t    if (c.strokeStyle != undefined) {\n\t\tc.beginPath();\n\t\tthis.moveTo(c,6,-3);\n\t\tthis.lineTo(c,10,0);\n\t\tthis.lineTo(c,6,3);\n\t\tc.stroke();\n\t    }\n\t}\n\n\tAmmeter.prototype.clone = function(x,y) {\n\t    return new Ammeter(x,y,this.rotation,this.properties['color'],this.properties['offset']);\n\t}\n\n\t// share code with voltage probe\n\tAmmeter.prototype.edit_properties = Probe.prototype.edit_properties;\n\n\tAmmeter.prototype.label = function() {\n\t    var name = this.properties['name'];\n\t    var label = 'I(' + (name ? name : '_' + this.properties['_json_']) + ')';\n\t    return label;\n\t}\n\n\t// display current for DC analysis\n\tAmmeter.prototype.display_current = function(c,vmap) {\n\t    var label = this.label();\n\t    var v = vmap[label];\n\t    if (v != undefined) {\n\t\tvar i = engineering_notation(v,2) + 'A';\n\t\tthis.draw_text(c,i,8,-5,7,annotation_size,annotation_style);\n\n\t\t// only display each current once\n\t\tdelete vmap[label];\n\t    }\n\t}\n\n\t// return [color, current_label, offset, type] for this probe\n\tAmmeter.prototype.probe_info = function() {\n\t    var color = this.properties['color'];\n\t    var offset = this.properties['offset'];\n\t    if (offset==undefined || offset==\"\") offset = '0';\n\t    return [color,this.label(),offset,'current'];\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Resistor\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Resistor(x,y,rotation,name,r) {\n\t    Component.call(this,'r',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['r'] = r ? r : '1';\n\t    this.add_connection(0,0);\n\t    this.add_connection(0,48);\n\t    this.bounding_box = [-5,0,5,48];\n\t    this.update_coords();\n\t}\n\tResistor.prototype = new Component();\n\tResistor.prototype.constructor = Resistor;\n\n\tResistor.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Resistor {r} ({x},{y})>',\n\t\t{\n\t\t    r: this.properties['r'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tResistor.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,12);\n\t    this.draw_line(c,0,12,4,14);\n\t    this.draw_line(c,4,14,-4,18);\n\t    this.draw_line(c,-4,18,4,22);\n\t    this.draw_line(c,4,22,-4,26);\n\t    this.draw_line(c,-4,26,4,30);\n\t    this.draw_line(c,4,30,-4,34);\n\t    this.draw_line(c,-4,34,0,36);\n\t    this.draw_line(c,0,36,0,48);\n\t    if (this.properties['r'])\n\t\tthis.draw_text(c,this.properties['r']+'\\u03A9',5,24,3,property_size);\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],-5,24,5,property_size);\n\t}\n\n\tResistor.prototype.clone = function(x,y) {\n\t    return new Resistor(x,y,this.rotation,this.properties['name'],this.properties['r']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Capacitor\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Capacitor(x,y,rotation,name,c) {\n\t    Component.call(this,'c',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['c'] = c ? c : '1p';\n\t    this.add_connection(0,0);\n\t    this.add_connection(0,48);\n\t    this.bounding_box = [-8,0,8,48];\n\t    this.update_coords();\n\t}\n\tCapacitor.prototype = new Component();\n\tCapacitor.prototype.constructor = Capacitor;\n\n\tCapacitor.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Capacitor {r} ({x},{y})>',\n\t\t{\n\t\t    r: this.properties['r'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tCapacitor.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,22);\n\t    this.draw_line(c,-8,22,8,22);\n\t    this.draw_line(c,-8,26,8,26);\n\t    this.draw_line(c,0,26,0,48);\n\t    if (this.properties['c'])\n\t\tthis.draw_text(c,this.properties['c']+'F',9,24,3,property_size);\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],-9,24,5,property_size);\n\t}\n\n\tCapacitor.prototype.clone = function(x,y) {\n\t    return new Capacitor(x,y,this.rotation,this.properties['name'],this.properties['c']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Inductor\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Inductor(x,y,rotation,name,l) {\n\t    Component.call(this,'l',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['l'] = l ? l : '1n';\n\t    this.add_connection(0,0);\n\t    this.add_connection(0,48);\n\t    this.bounding_box = [-4,0,5,48];\n\t    this.update_coords();\n\t}\n\tInductor.prototype = new Component();\n\tInductor.prototype.constructor = Inductor;\n\n\tInductor.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Inductor {l}, ({x},{y})>',\n\t\t{\n\t\t    l: this.properties['l'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tInductor.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,14);\n\t    this.draw_arc(c,0,18,4,6*Math.PI/4,3*Math.PI/4);\n\t    this.draw_arc(c,0,24,4,5*Math.PI/4,3*Math.PI/4);\n\t    this.draw_arc(c,0,30,4,5*Math.PI/4,2*Math.PI/4);\n\t    this.draw_line(c,0,34,0,48);\n\n\t    if (this.properties['l'])\n\t\tthis.draw_text(c,this.properties['l']+'H',6,24,3,property_size);\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],-3,24,5,property_size);\n\t}\n\n\tInductor.prototype.clone = function(x,y) {\n\t    return new Inductor(x,y,this.rotation,this.properties['name'],this.properties['l']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Diode\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tvar diode_types = ['normal','ideal'];\n\n\tfunction Diode(x,y,rotation,name,area,type) {\n\t    Component.call(this,'d',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['area'] = area ? area : '1';\n\t    this.properties['type'] = type ? type : 'normal';\n\t    this.add_connection(0,0);   // anode\n\t    this.add_connection(0,48);  // cathode\n\t    this.bounding_box = (type == 'ideal') ? [-12,0,12,48] : [-8,0,8,48];\n\t    this.update_coords();\n\t}\n\tDiode.prototype = new Component();\n\tDiode.prototype.constructor = Diode;\n\n\tDiode.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<Diode {area} ({x},{y})>',\n\t\t{\n\t\t    area: this.properties['area'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tDiode.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,16);\n\t    this.draw_line(c,-8,16,8,16);\n\t    this.draw_line(c,-8,16,0,32);\n\t    this.draw_line(c,8,16,0,32);\n\t    this.draw_line(c,-8,32,8,32);\n\t    this.draw_line(c,0,32,0,48);\n\n\t    if (this.properties['type'] == 'ideal') {\n\t\t// put a box around an ideal diode\n\t\tthis.draw_line(c,-10,12,10,12);\n\t\tthis.draw_line(c,-10,12,-10,36);\n\t\tthis.draw_line(c,10,12,10,36);\n\t\tthis.draw_line(c,-10,36,10,36);\n\t    }\n\n\t    if (this.properties['area'])\n\t\tthis.draw_text(c,this.properties['area'],10,24,3,property_size);\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],-10,24,5,property_size);\n\t}\n\n\tDiode.prototype.clone = function(x,y) {\n\t    return new Diode(x,y,this.rotation,this.properties['name'],this.properties['area'],this.properties['type']);\n\t}\n\n\tDiode.prototype.edit_properties = function(x,y) {\n\t    if (inside(this.bbox,x,y)) {\n            var fields = [];\n\t\tfields['name'] = build_input('text',10,this.properties['name']);\n\t\tfields['area'] = build_input('text',10,this.properties['area']);\n\t\tfields['type'] = build_select(diode_types,this.properties['type']);\n\n\t\tvar content = build_table(fields);\n\t\tcontent.fields = fields;\n\t\tcontent.component = this;\n\n\t\tthis.sch.dialog('Edit Properties',content,function(content) {\n\t\t\tcontent.component.properties['name'] = content.fields['name'].value;\n\t\t\tcontent.component.properties['area'] = content.fields['area'].value;\n\t\t\tcontent.component.properties['type'] = diode_types[content.fields['type'].selectedIndex];\n\t\t\tcontent.component.sch.redraw_background();\n\t\t    });\n\t\treturn true;\n\t    } else return false;\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  N-channel Mosfet\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction NFet(x,y,rotation,name,w_over_l) {\n\t    Component.call(this,'n',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['W/L'] = w_over_l ? w_over_l : '2';\n\t    this.add_connection(0,0);   // drain\n\t    this.add_connection(-24,24);  // gate\n\t    this.add_connection(0,48);  // source\n\t    this.bounding_box = [-24,0,8,48];\n\t    this.update_coords();\n\t}\n\tNFet.prototype = new Component();\n\tNFet.prototype.constructor = NFet;\n\n\tNFet.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<NFet {W_L} ({x},{y})>',\n\t\t{\n\t\t    W_L: this.properties['W/L'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tNFet.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,16);\n\t    this.draw_line(c,-8,16,0,16);\n\t    this.draw_line(c,-8,16,-8,32);\n\t    this.draw_line(c,-8,32,0,32);\n\t    this.draw_line(c,0,32,0,48);\n\t    this.draw_line(c,-24,24,-12,24);\n\t    this.draw_line(c,-12,16,-12,32);\n\n\t    var dim = this.properties['W/L'];\n\t    if (this.properties['name']) {\n\t\tthis.draw_text(c,this.properties['name'],2,22,6,property_size);\n\t\tthis.draw_text(c,dim,2,26,0,property_size);\n\t    } else\n\t\tthis.draw_text(c,dim,2,24,3,property_size);\n\t}\n\n\tNFet.prototype.clone = function(x,y) {\n\t    return new NFet(x,y,this.rotation,this.properties['name'],this.properties['W/L']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  P-channel Mosfet\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction PFet(x,y,rotation,name,w_over_l) {\n\t    Component.call(this,'p',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['W/L'] = w_over_l ? w_over_l : '2';\n\t    this.add_connection(0,0);   // drain\n\t    this.add_connection(-24,24);  // gate\n\t    this.add_connection(0,48);  // source\n\t    this.bounding_box = [-24,0,8,48];\n\t    this.update_coords();\n\t}\n\tPFet.prototype = new Component();\n\tPFet.prototype.constructor = PFet;\n\n\tPFet.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate('<PFet {W_L} ({x},{y})>',\n\t    {\n\t\tW_L: this.properties['W/L'],\n\t\tx: this.x,\n\t\ty: this.y\n\t    });\n\t}\n\n\tPFet.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,16);\n\t    this.draw_line(c,-8,16,0,16);\n\t    this.draw_line(c,-8,16,-8,32);\n\t    this.draw_line(c,-8,32,0,32);\n\t    this.draw_line(c,0,32,0,48);\n\t    this.draw_line(c,-24,24,-16,24);\n\t    this.draw_circle(c,-14,24,2,false);\n\t    this.draw_line(c,-12,16,-12,32);\n\n\t    var dim = this.properties['W/L'];\n\t    if (this.properties['name']) {\n\t\tthis.draw_text(c,this.properties['name'],2,22,6,property_size);\n\t\tthis.draw_text(c,dim,2,26,0,property_size);\n\t    } else\n\t\tthis.draw_text(c,dim,2,24,3,property_size);\n\t}\n\n\tPFet.prototype.clone = function(x,y) {\n\t    return new PFet(x,y,this.rotation,this.properties['name'],this.properties['W/L']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Op Amp\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction OpAmp(x,y,rotation,name,A) {\n\t    Component.call(this,'o',x,y,rotation);\n\t    this.properties['name'] = name;\n\t    this.properties['A'] = A ? A : '30000';\n\t    this.add_connection(0,0);   // +\n\t    this.add_connection(0,16);  // -\n\t    this.add_connection(48,8);  // output\n\t    this.add_connection(24,32);  // ground\n\t    this.bounding_box = [0,-8,48,32];\n\t    this.update_coords();\n\t}\n\tOpAmp.prototype = new Component();\n\tOpAmp.prototype.constructor = OpAmp;\n\n\tOpAmp.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<OpAmp{A} ({x},{y})>',\n\t\t{\n\t\t    A: this.properties['A'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tOpAmp.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    // triangle\n\t    this.draw_line(c,8,-8,8,24);\n\t    this.draw_line(c,8,-8,40,8);\n\t    this.draw_line(c,8,24,40,8);\n\t    // inputs and output\n\t    this.draw_line(c,0,0,8,0);\n\t    this.draw_line(c,0,16,8,16);\n\t    this.draw_text(c,'gnd',37,18,property_size);\n\t    this.draw_line(c,40,8,48,8);\n\t    this.draw_line(c,24,16,24,32);\n\t    // + and -\n\t    this.draw_line(c,10,0,16,0);\n\t    this.draw_line(c,13,-3,13,3);\n\t    this.draw_line(c,10,16,16,16);\n\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],32,16,0,property_size);\n\t}\n\n\tOpAmp.prototype.clone = function(x,y) {\n\t    return new OpAmp(x,y,this.rotation,this.properties['name'],this.properties['A']);\n\t}\n\n\t////////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Source\n\t//\n\t////////////////////////////////////////////////////////////////////////////////\n\n\tfunction Source(x,y,rotation,name,type,value) {\n\t    Component.call(this,type,x,y,rotation);\n\t    this.properties['name'] = name;\n\t    if (value == undefined) value = 'dc(1)';\n\t    this.properties['value'] = value;\n\t    this.add_connection(0,0);\n\t    this.add_connection(0,48);\n\t    this.bounding_box = [-12,0,12,48];\n\t    this.update_coords();\n\t    this.content = document.createElement('div');  // used by edit_properties\n\t}\n\tSource.prototype = new Component();\n\tSource.prototype.constructor = Source;\n\n\tSource.prototype.toString = function() {\n\t    return edx.StringUtils.interpolate(\n\t\t'<{type}source {params} ({x},{y})>',\n\t\t{\n\t\t    type: this.type,\n\t\t    params: this.properties['params'],\n\t\t    x: this.x,\n\t\t    y: this.y\n\t\t});\n\t}\n\n\tSource.prototype.draw = function(c) {\n\t    Component.prototype.draw.call(this,c);   // give superclass a shot\n\t    this.draw_line(c,0,0,0,12);\n\t    this.draw_circle(c,0,24,12,false);\n\t    this.draw_line(c,0,36,0,48);\n\n\t    if (this.type == 'v') {  // voltage source\n\t\t// draw + and -\n\t\tthis.draw_line(c,0,15,0,21);\n\t\tthis.draw_line(c,-3,18,3,18);\n\t\tthis.draw_line(c,-3,30,3,30);\n\t    } else if (this.type == 'i') {  // current source\n\t\t// draw arrow: pos to neg\n\t\tthis.draw_line(c,0,15,0,32);\n\t\tthis.draw_line(c,-3,26,0,32);\n\t\tthis.draw_line(c,3,26,0,32);\n\t    }\n\n\t    if (this.properties['name'])\n\t\tthis.draw_text(c,this.properties['name'],-13,24,5,property_size);\n\t    if (this.properties['value'])\n\t\tthis.draw_text(c,this.properties['value'],13,24,3,property_size);\n\t}\n\n\t// map source function name to labels for each source parameter\n\tvar source_functions = {\n\t    'dc': ['DC value'],\n\n\t    'impulse': ['Height',\n\t\t\t'Width (secs)'],\n\n\t    'step': ['Initial value',\n\t\t     'Plateau value',\n\t\t     'Delay until step (secs)',\n\t\t     'Rise time (secs)'],\n\n\t    'square': ['Initial value',\n\t\t       'Plateau value',\n\t\t       'Frequency (Hz)',\n\t\t       'Duty cycle (%)'],\n\n\t    'triangle': ['Initial value',\n\t\t\t 'Plateau value',\n\t\t\t 'Frequency (Hz)'],\n\n\t    'pwl': ['Comma-separated list of alternating times and values'],\n\n\t    'pwl_repeating': ['Comma-separated list of alternating times and values'],\n\n\t    'pulse': ['Initial value',\n\t\t      'Plateau value',\n\t\t      'Delay until pulse (secs)',\n\t\t      'Time for first transition (secs)',\n\t\t      'Time for second transition (secs)',\n\t\t      'Pulse width (secs)',\n\t\t      'Period (secs)'],\n\n\t    'sin': ['Offset value',\n\t\t    'Amplitude',\n\t\t    'Frequency (Hz)',\n\t\t    'Delay until sin starts (secs)',\n\t\t    'Phase offset (degrees)']\n\t}\n\n\t// build property editor div\n\tSource.prototype.build_content = function(src) {\n\t    // make an <input> widget for each property\n\t    var fields = []\n\t    fields['name'] = build_input('text',10,this.properties['name']);\n\n\t    if (src == undefined) {\n\t\tfields['value'] = this.properties['value'];\n\t    } else {\n\t\t// fancy version: add select tag for source type\n\t\tvar src_types = [];\n\t\tfor (var t in source_functions) src_types.push(t);\n\t\tvar type_select = build_select(src_types,src.fun);\n\t\ttype_select.component = this;\n\t\ttype_select.addEventListener('change',source_type_changed,false)\n\t\tfields['type'] = type_select;\n\n\t\tif (src.fun == 'pwl' || src.run == 'pwl_repeating') {\n\t\t    var v = '';\n\t\t    var first = true;\n\t\t    for (var i = 0; i < src.args.length; i++) {\n\t\t\tif (first) first = false;\n\t\t\telse v += ',';\n\t\t\tv += engineering_notation(src.args[i],3);\n\t\t\tif (i % 2 == 0) v += 's';\n\t\t    }\n\t\t    fields[source_functions[src.fun][0]] = build_input('text',30,v);\n\t\t} else {\n\t\t    // followed separate input tag for each parameter\n\t\t    var labels = source_functions[src.fun];\n\t\t    for (var i = 0; i < labels.length; i++) {\n\t\t\tvar v = engineering_notation(src.args[i],3);\n\t\t\tfields[labels[i]] = build_input('text',10,v);\n\t\t    }\n\t\t}\n\t    }\n\n\t    var div = this.content;\n\t    if (div.hasChildNodes())\n\t\tdiv.removeChild(div.firstChild);  // remove table of input fields\n\t    div.appendChild(build_table(fields));\n\t    div.fields = fields;\n\t    div.component = this;\n\t    return div;\n\t}\n\n\tfunction source_type_changed(event) {\n\t    if (!event) event = window.event;\n\t    var select = (window.event) ? event.srcElement : event.target;\n\n\t    // see where to get source parameters from\n\t    var type = select.options[select.selectedIndex].value;\n\t    var src = undefined;\n\t    if (this.src != undefined && type == this.src.fun)\n\t\tsrc = this.src;\n\t    else if (typeof cktsim != 'undefined')\n\t\tsrc = cktsim.parse_source(type+'()');\n\n\t    select.component.build_content(src);\n\t}\n\n\tSource.prototype.edit_properties = function(x,y) {\n\t    if (this.near(x,y)) {\n\t\tthis.src = undefined;\n\t\tif (typeof cktsim != 'undefined')\n\t\t    this.src = cktsim.parse_source(this.properties['value']);\n\t\tvar content = this.build_content(this.src);\n\n\t\tthis.sch.dialog('Edit Properties',content,function(content) {\n\t\t\tvar c = content.component;\n\t\t\tvar fields = content.fields;\n\n\t\t\tvar first = true;\n\t\t\tvar value = '';\n\t\t\tfor (var label in fields) {\n\t\t\t    if (label == 'name')\n\t\t\t\tc.properties['name'] = fields['name'].value;\n\t\t\t    else if (label == 'value')  {\n\t\t\t\t// if unknown source type\n\t\t\t\tvalue = fields['value'].value;\n\t\t\t\tc.sch.redraw_background();\n\t\t\t\treturn;\n\t\t\t    } else if (label == 'type') {\n\t\t\t\tvar select = fields['type'];\n\t\t\t\tvalue = select.options[select.selectedIndex].value + '(';\n\t\t\t    } else {\n\t\t\t\tif (first) first = false;\n\t\t\t\telse value += ',';\n\t\t\t\tvalue += fields[label].value;\n\t\t\t    }\n\t\t\t}\n\t\t\tc.properties['value'] = value + ')';\n\t\t\tc.sch.redraw_background();\n\t\t    });\n\t\treturn true;\n\t    } else return false;\n\t}\n\n\tfunction VSource(x,y,rotation,name,value) {\n\t    Source.call(this,x,y,rotation,name,'v',value);\n\t    this.type = 'v';\n\t}\n\tVSource.prototype = new Component();\n\tVSource.prototype.constructor = VSource;\n\tVSource.prototype.toString = Source.prototype.toString;\n\tVSource.prototype.draw = Source.prototype.draw;\n\tVSource.prototype.clone = Source.prototype.clone;\n\tVSource.prototype.build_content = Source.prototype.build_content;\n\tVSource.prototype.edit_properties = Source.prototype.edit_properties;\n\n\t// display current for DC analysis\n\tVSource.prototype.display_current = function(c,vmap) {\n\t    var name = this.properties['name'];\n\t    var label = 'I(' + (name ? name : '_' + this.properties['_json_']) + ')';\n\t    var v = vmap[label];\n\t    if (v != undefined) {\n\t\t// first draw some solid blocks in the background\n\t\tc.globalAlpha = 0.5;\n\t\tthis.draw_text(c,'\\u2588\\u2588\\u2588',-8,8,4,annotation_size,element_style);\n\t\tc.globalAlpha = 1.0;\n\n\t\t// display the element current\n\t\tvar i = engineering_notation(v,2) + 'A';\n\t\tthis.draw_text(c,i,-3,5,5,annotation_size,annotation_style);\n\t\t// draw arrow for current\n\t\tthis.draw_line(c,-3,4,0,8);\n\t\tthis.draw_line(c,3,4,0,8);\n\t\t// only display each current once\n\t\tdelete vmap[label];\n\t    }\n\t}\n\n\tVSource.prototype.clone = function(x,y) {\n\t    return new VSource(x,y,this.rotation,this.properties['name'],this.properties['value']);\n\t}\n\n\tfunction ISource(x,y,rotation,name,value) {\n\t    Source.call(this,x,y,rotation,name,'i',value);\n\t    this.type = 'i';\n\t}\n\tISource.prototype = new Component();\n\tISource.prototype.constructor = ISource;\n\tISource.prototype.toString = Source.prototype.toString;\n\tISource.prototype.draw = Source.prototype.draw;\n\tISource.prototype.clone = Source.prototype.clone;\n\tISource.prototype.build_content = Source.prototype.build_content;\n\tISource.prototype.edit_properties = Source.prototype.edit_properties;\n\n\tISource.prototype.clone = function(x,y) {\n\t    return new ISource(x,y,this.rotation,this.properties['name'],this.properties['value']);\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  JQuery slider support for setting a component value\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tfunction component_slider(event,ui) {\n\t    var sname = $(this).slider(\"option\",\"schematic\");\n\n\t    // set value of specified component\n\t    var cname = $(this).slider(\"option\",\"component\");\n\t    var pname = $(this).slider(\"option\",\"property\");\n\t    var suffix = $(this).slider(\"option\",\"suffix\");\n\t    if (typeof suffix != \"string\") suffix = \"\";\n\n\t    var v = ui.value;\n\t    $(this).slider(\"value\",v);  // move slider's indicator\n\n\t    var choices = $(this).slider(\"option\",\"choices\");\n\t    if (choices instanceof Array) v = choices[v];\n\n\t    // selector may match several schematics\n\t    $(\".\" + sname).each(function(index,element) {\n\t\t    element.schematic.set_property(cname,pname,v.toString() + suffix);\n\t\t})\n\n\t    // perform requested analysis\n\t    var analysis = $(this).slider(\"option\",\"analysis\");\n\t    if (analysis == \"dc\")\n\t\t$(\".\" + sname).each(function(index,element) {\n\t\t\telement.schematic.dc_analysis();\n\t\t    })\n\n\t    return false;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////\n\t//\n\t//  Module definition\n\t//\n\t///////////////////////////////////////////////////////////////////////////////\n\n\tvar module = {\n\t    'Schematic': Schematic,\n\t    'component_slider': component_slider\n\t}\n\treturn module;\n}());\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/005-fc8bd2dc5b96b86d1abefdd417dd8ba5.js"],"sourceRoot":""}